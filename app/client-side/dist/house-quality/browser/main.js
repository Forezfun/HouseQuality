(self.webpackChunkHouseQuality=self.webpackChunkHouseQuality||[]).push([[792],{155:(zt,Bn,je)=>{var lt=je(185),N=/^\s+/;zt.exports=function dn(Mt){return Mt&&Mt.slice(0,lt(Mt)+1).replace(N,"")}},185:zt=>{var Bn=/\s/;zt.exports=function je(lt){for(var N=lt.length;N--&&Bn.test(lt.charAt(N)););return N}},259:(zt,Bn,je)=>{var lt=je(754),N=je(870),dn=je(901),Ut=lt?lt.toStringTag:void 0;zt.exports=function Ct(et){return null==et?void 0===et?"[object Undefined]":"[object Null]":Ut&&Ut in Object(et)?N(et):dn(et)}},344:(zt,Bn,je)=>{var lt=je(580),N=je(951),dn=je(547),dt=Math.max,Ut=Math.min;zt.exports=function Ct(et,Un,wn){var ui,gr,$i,Wr,rr,Ui,So=0,ql=!1,wr=!1,$r=!0;if("function"!=typeof et)throw new TypeError("Expected a function");function Tr(qi){var qr=ui,Eo=gr;return ui=gr=void 0,So=qi,Wr=et.apply(Eo,qr)}function La(qi){var qr=qi-Ui;return void 0===Ui||qr>=Un||qr<0||wr&&qi-So>=$i}function Ns(){var qi=N();if(La(qi))return fl(qi);rr=setTimeout(Ns,function co(qi){var Vi=Un-(qi-Ui);return wr?Ut(Vi,$i-(qi-So)):Vi}(qi))}function fl(qi){return rr=void 0,$r&&ui?Tr(qi):(ui=gr=void 0,Wr)}function qu(){var qi=N(),qr=La(qi);if(ui=arguments,gr=this,Ui=qi,qr){if(void 0===rr)return function Os(qi){return So=qi,rr=setTimeout(Ns,Un),ql?Tr(qi):Wr}(Ui);if(wr)return clearTimeout(rr),rr=setTimeout(Ns,Un),Tr(Ui)}return void 0===rr&&(rr=setTimeout(Ns,Un)),Wr}return Un=dn(Un)||0,lt(wn)&&(ql=!!wn.leading,$i=(wr="maxWait"in wn)?dt(dn(wn.maxWait)||0,Un):$i,$r="trailing"in wn?!!wn.trailing:$r),qu.cancel=function Xl(){void 0!==rr&&clearTimeout(rr),So=0,ui=Ui=gr=rr=void 0},qu.flush=function hl(){return void 0===rr?Wr:fl(N())},qu}},404:function(zt){zt.exports=function(){"use strict";function Bn(Ye,Ee){var Fe=Object.keys(Ye);if(Object.getOwnPropertySymbols){var Be=Object.getOwnPropertySymbols(Ye);Ee&&(Be=Be.filter(function(Dt){return Object.getOwnPropertyDescriptor(Ye,Dt).enumerable})),Fe.push.apply(Fe,Be)}return Fe}function je(Ye){for(var Ee=1;Ee<arguments.length;Ee++){var Fe=null!=arguments[Ee]?arguments[Ee]:{};Ee%2?Bn(Object(Fe),!0).forEach(function(Be){Mt(Ye,Be,Fe[Be])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ye,Object.getOwnPropertyDescriptors(Fe)):Bn(Object(Fe)).forEach(function(Be){Object.defineProperty(Ye,Be,Object.getOwnPropertyDescriptor(Fe,Be))})}return Ye}function N(Ye,Ee){for(var Fe=0;Fe<Ee.length;Fe++){var Be=Ee[Fe];Be.enumerable=Be.enumerable||!1,Be.configurable=!0,"value"in Be&&(Be.writable=!0),Object.defineProperty(Ye,Ct(Be.key),Be)}}function Mt(Ye,Ee,Fe){return(Ee=Ct(Ee))in Ye?Object.defineProperty(Ye,Ee,{value:Fe,enumerable:!0,configurable:!0,writable:!0}):Ye[Ee]=Fe,Ye}function dt(){return dt=Object.assign?Object.assign.bind():function(Ye){for(var Ee=1;Ee<arguments.length;Ee++){var Fe=arguments[Ee];for(var Be in Fe)Object.prototype.hasOwnProperty.call(Fe,Be)&&(Ye[Be]=Fe[Be])}return Ye},dt.apply(this,arguments)}function Ct(Ye){var Ee=function Ut(Ye,Ee){if("object"!=typeof Ye||null===Ye)return Ye;var Fe=Ye[Symbol.toPrimitive];if(void 0!==Fe){var Be=Fe.call(Ye,Ee||"default");if("object"!=typeof Be)return Be;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===Ee?String:Number)(Ye)}(Ye,"string");return"symbol"==typeof Ee?Ee:String(Ee)}var Ye,Ee,Fe,Be,Dt,Rt,Hi,zn,et={exports:{}};Ye=et,typeof window>"u"||(Ee=window,Fe=Ee.HTMLCanvasElement&&Ee.HTMLCanvasElement.prototype,Be=Ee.Blob&&function(){try{return!!new Blob}catch{return!1}}(),Dt=Be&&Ee.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch{return!1}}(),Rt=Ee.BlobBuilder||Ee.WebKitBlobBuilder||Ee.MozBlobBuilder||Ee.MSBlobBuilder,Hi=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,zn=(Be||Rt)&&Ee.atob&&Ee.ArrayBuffer&&Ee.Uint8Array&&function(an){var En,_i,Ii,To,oi,Gt,ko,pi,la;if(!(En=an.match(Hi)))throw new Error("invalid data URI");for(_i=En[2]?En[1]:"text/plain"+(En[3]||";charset=US-ASCII"),Ii=!!En[4],To=an.slice(En[0].length),oi=Ii?atob(To):decodeURIComponent(To),Gt=new ArrayBuffer(oi.length),ko=new Uint8Array(Gt),pi=0;pi<oi.length;pi+=1)ko[pi]=oi.charCodeAt(pi);return Be?new Blob([Dt?ko:Gt],{type:_i}):((la=new Rt).append(Gt),la.getBlob(_i))},Ee.HTMLCanvasElement&&!Fe.toBlob&&(Fe.mozGetAsFile?Fe.toBlob=function(an,En,_i){var Ii=this;setTimeout(function(){an(_i&&Fe.toDataURL&&zn?zn(Ii.toDataURL(En,_i)):Ii.mozGetAsFile("blob",En))})}:Fe.toDataURL&&zn&&(Fe.toBlob=Fe.msToBlob?function(an,En,_i){var Ii=this;setTimeout(function(){an((En&&"image/png"!==En||_i)&&Fe.toDataURL&&zn?zn(Ii.toDataURL(En,_i)):Ii.msToBlob(En))})}:function(an,En,_i){var Ii=this;setTimeout(function(){an(zn(Ii.toDataURL(En,_i)))})})),Ye.exports?Ye.exports=zn:Ee.dataURLtoBlob=zn);var Un=et.exports,ui={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},$i=typeof window<"u"&&typeof window.document<"u"?window:{},Wr=function(Ee){return Ee>0&&Ee<1/0},rr=Array.prototype.slice;function Ui(Ye){return Array.from?Array.from(Ye):rr.call(Ye)}var So=/^image\/.+$/;function ql(Ye){return So.test(Ye)}var $r=String.fromCharCode;var Os=$i.btoa;function co(Ye,Ee){for(var Fe=[],Dt=new Uint8Array(Ye);Dt.length>0;)Fe.push($r.apply(null,Ui(Dt.subarray(0,8192)))),Dt=Dt.subarray(8192);return"data:".concat(Ee,";base64,").concat(Os(Fe.join("")))}function La(Ye){var Fe,Ee=new DataView(Ye);try{var Be,Dt,Rt;if(255===Ee.getUint8(0)&&216===Ee.getUint8(1))for(var Hi=Ee.byteLength,zn=2;zn+1<Hi;){if(255===Ee.getUint8(zn)&&225===Ee.getUint8(zn+1)){Dt=zn;break}zn+=1}if(Dt){var En=Dt+10;if("Exif"===function Tr(Ye,Ee,Fe){var Dt,Be="";for(Fe+=Ee,Dt=Ee;Dt<Fe;Dt+=1)Be+=$r(Ye.getUint8(Dt));return Be}(Ee,Dt+4,4)){var _i=Ee.getUint16(En);if(((Be=18761===_i)||19789===_i)&&42===Ee.getUint16(En+2,Be)){var Ii=Ee.getUint32(En+4,Be);Ii>=8&&(Rt=En+Ii)}}}if(Rt){var oi,Gt,To=Ee.getUint16(Rt,Be);for(Gt=0;Gt<To;Gt+=1)if(274===Ee.getUint16(oi=Rt+12*Gt+2,Be)){Fe=Ee.getUint16(oi+=8,Be),Ee.setUint16(oi,1,Be);break}}}catch{Fe=1}return Fe}var fl=/\.\d*(?:0|9){12}\d*$/;function Xl(Ye){var Ee=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return fl.test(Ye)?Math.round(Ye*Ee)/Ee:Ye}function hl(Ye){var Ee=Ye.aspectRatio,Fe=Ye.height,Be=Ye.width,Dt=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",Rt=Wr(Be),Hi=Wr(Fe);if(Rt&&Hi){var zn=Fe*Ee;("contain"===Dt||"none"===Dt)&&zn>Be||"cover"===Dt&&zn<Be?Fe=Be/Ee:Be=Fe*Ee}else Rt?Fe=Be/Ee:Hi&&(Be=Fe*Ee);return{width:Be,height:Fe}}var qr=$i.ArrayBuffer,Eo=$i.FileReader,Vi=$i.URL||$i.webkitURL,pl=/\.\w+$/,by=$i.Compressor,Bc=function(){function Ye(Ee,Fe){(function lt(Ye,Ee){if(!(Ye instanceof Ee))throw new TypeError("Cannot call a class as a function")})(this,Ye),this.file=Ee,this.exif=[],this.image=new Image,this.options=je(je({},ui),Fe),this.aborted=!1,this.result=null,this.init()}return function dn(Ye,Ee,Fe){return Ee&&N(Ye.prototype,Ee),Fe&&N(Ye,Fe),Object.defineProperty(Ye,"prototype",{writable:!1}),Ye}(Ye,[{key:"init",value:function(){var Fe=this,Be=this.file,Dt=this.options;if(function(Ee){return!(typeof Blob>"u")&&(Ee instanceof Blob||"[object Blob]"===Object.prototype.toString.call(Ee))}(Be)){var Rt=Be.type;if(ql(Rt))if(Vi&&Eo){qr||(Dt.checkOrientation=!1,Dt.retainExif=!1);var Hi="image/jpeg"===Rt,zn=Hi&&Dt.checkOrientation,an=Hi&&Dt.retainExif;if(!Vi||zn||an){var En=new Eo;this.reader=En,En.onload=function(_i){var To=_i.target.result,oi={},Gt=1;zn&&(Gt=La(To))>1&&dt(oi,function Ns(Ye){var Ee=0,Fe=1,Be=1;switch(Ye){case 2:Fe=-1;break;case 3:Ee=-180;break;case 4:Be=-1;break;case 5:Ee=90,Be=-1;break;case 6:Ee=90;break;case 7:Ee=90,Fe=-1;break;case 8:Ee=-90}return{rotate:Ee,scaleX:Fe,scaleY:Be}}(Gt)),an&&(Fe.exif=function qu(Ye){for(var Ee=Ui(new Uint8Array(Ye)),Fe=Ee.length,Be=[],Dt=0;Dt+3<Fe;){var Rt=Ee[Dt],Hi=Ee[Dt+1];if(255===Rt&&218===Hi)break;if(255===Rt&&216===Hi)Dt+=2;else{var an=Dt+(256*Ee[Dt+2]+Ee[Dt+3])+2,En=Ee.slice(Dt,an);Be.push(En),Dt=an}}return Be.reduce(function(_i,Ii){return 255===Ii[0]&&225===Ii[1]?_i.concat(Ii):_i},[])}(To)),oi.url=zn||an?!Vi||Gt>1?co(To,Rt):Vi.createObjectURL(Be):To,Fe.load(oi)},En.onabort=function(){Fe.fail(new Error("Aborted to read the image with FileReader."))},En.onerror=function(){Fe.fail(new Error("Failed to read the image with FileReader."))},En.onloadend=function(){Fe.reader=null},zn||an?En.readAsArrayBuffer(Be):En.readAsDataURL(Be)}else this.load({url:Vi.createObjectURL(Be)})}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(Fe){var Be=this,Dt=this.file,Rt=this.image;Rt.onload=function(){Be.draw(je(je({},Fe),{},{naturalWidth:Rt.naturalWidth,naturalHeight:Rt.naturalHeight}))},Rt.onabort=function(){Be.fail(new Error("Aborted to load the image."))},Rt.onerror=function(){Be.fail(new Error("Failed to load the image."))},$i.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test($i.navigator.userAgent)&&(Rt.crossOrigin="anonymous"),Rt.alt=Dt.name,Rt.src=Fe.url}},{key:"draw",value:function(Fe){var Be=this,Dt=Fe.naturalWidth,Rt=Fe.naturalHeight,Hi=Fe.rotate,zn=void 0===Hi?0:Hi,an=Fe.scaleX,En=void 0===an?1:an,_i=Fe.scaleY,Ii=void 0===_i?1:_i,To=this.file,oi=this.image,Gt=this.options,ko=document.createElement("canvas"),pi=ko.getContext("2d"),la=Math.abs(zn)%180==90,ua=("contain"===Gt.resize||"cover"===Gt.resize)&&Wr(Gt.width)&&Wr(Gt.height),Fs=Math.max(Gt.maxWidth,0)||1/0,fo=Math.max(Gt.maxHeight,0)||1/0,gl=Math.max(Gt.minWidth,0)||0,yn=Math.max(Gt.minHeight,0)||0,ml=Dt/Rt,Xi=Gt.width,xr=Gt.height;if(la){var Yi=[fo,Fs];Fs=Yi[0],fo=Yi[1];var _l=[yn,gl];gl=_l[0],yn=_l[1];var Uc=[xr,Xi];Xi=Uc[0],xr=Uc[1]}ua&&(ml=Xi/xr);var Vc=hl({aspectRatio:ml,width:Fs,height:fo},"contain");Fs=Vc.width,fo=Vc.height;var ca=hl({aspectRatio:ml,width:gl,height:yn},"cover");if(gl=ca.width,yn=ca.height,ua){var Yl=hl({aspectRatio:ml,width:Xi,height:xr},Gt.resize);Xi=Yl.width,xr=Yl.height}else{var Hc=hl({aspectRatio:ml,width:Xi,height:xr}),yl=Hc.width;Xi=void 0===yl?Dt:yl;var tf=Hc.height;xr=void 0===tf?Rt:tf}var Vh=-(Xi=Math.floor(Xl(Math.min(Math.max(Xi,gl),Fs))))/2,Hh=-(xr=Math.floor(Xl(Math.min(Math.max(xr,yn),fo))))/2,zh=Xi,Zl=xr,Xu=[];if(ua){var jh,Gc,fm=hl({aspectRatio:ml,width:Dt,height:Rt},{contain:"cover",cover:"contain"}[Gt.resize]);Xu.push((Dt-(jh=fm.width))/2,(Rt-(Gc=fm.height))/2,jh,Gc)}if(Xu.push(Vh,Hh,zh,Zl),la){var Kl=[xr,Xi];Xi=Kl[0],xr=Kl[1]}ko.width=Xi,ko.height=xr,ql(Gt.mimeType)||(Gt.mimeType=To.type);var Yu="transparent";To.size>Gt.convertSize&&Gt.convertTypes.indexOf(Gt.mimeType)>=0&&(Gt.mimeType="image/jpeg");var hm="image/jpeg"===Gt.mimeType;if(hm&&(Yu="#fff"),pi.fillStyle=Yu,pi.fillRect(0,0,Xi,xr),Gt.beforeDraw&&Gt.beforeDraw.call(this,pi,ko),!this.aborted&&(pi.save(),pi.translate(Xi/2,xr/2),pi.rotate(zn*Math.PI/180),pi.scale(En,Ii),pi.drawImage.apply(pi,[oi].concat(Xu)),pi.restore(),Gt.drew&&Gt.drew.call(this,pi,ko),!this.aborted)){var nf=function(ka){if(!Be.aborted){var da=function(Zu){return Be.done({naturalWidth:Dt,naturalHeight:Rt,result:Zu})};if(ka&&hm&&Gt.retainExif&&Be.exif&&Be.exif.length>0){var jc=function(Zu){return da(Un(co(function qi(Ye,Ee){var Fe=Ui(new Uint8Array(Ye));if(255!==Fe[2]||224!==Fe[3])return Ye;var Dt=[255,216].concat(Ee,Fe.slice(4+(256*Fe[4]+Fe[5])));return new Uint8Array(Dt)}(Zu,Be.exif),Gt.mimeType)))};if(ka.arrayBuffer)ka.arrayBuffer().then(jc).catch(function(){Be.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var Jl=new Eo;Be.reader=Jl,Jl.onload=function(Kn){jc(Kn.target.result)},Jl.onabort=function(){Be.fail(new Error("Aborted to read the compressed image with FileReader."))},Jl.onerror=function(){Be.fail(new Error("Failed to read the compressed image with FileReader."))},Jl.onloadend=function(){Be.reader=null},Jl.readAsArrayBuffer(ka)}}else da(ka)}};ko.toBlob?ko.toBlob(nf,Gt.mimeType,Gt.quality):nf(Un(ko.toDataURL(Gt.mimeType,Gt.quality)))}}},{key:"done",value:function(Fe){var Be=Fe.naturalWidth,Dt=Fe.naturalHeight,Rt=Fe.result,Hi=this.file,zn=this.image,an=this.options;if(Vi&&0===zn.src.indexOf("blob:")&&Vi.revokeObjectURL(zn.src),Rt)if(an.strict&&!an.retainExif&&Rt.size>Hi.size&&an.mimeType===Hi.type&&!(an.width>Be||an.height>Dt||an.minWidth>Be||an.minHeight>Dt||an.maxWidth<Be||an.maxHeight<Dt))Rt=Hi;else{var En=new Date;Rt.lastModified=En.getTime(),Rt.lastModifiedDate=En,Rt.name=Hi.name,Rt.name&&Rt.type!==Hi.type&&(Rt.name=Rt.name.replace(pl,function wr(Ye){var Ee=ql(Ye)?Ye.substr(6):"";return"jpeg"===Ee&&(Ee="jpg"),".".concat(Ee)}(Rt.type)))}else Rt=Hi;this.result=Rt,an.success&&an.success.call(this,Rt)}},{key:"fail",value:function(Fe){var Be=this.options;if(!Be.error)throw Fe;Be.error.call(this,Fe)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=by,Ye}},{key:"setDefaults",value:function(Fe){dt(ui,Fe)}}]),Ye}();return Bc}()},531:(zt,Bn,je)=>{var lt=je(259),N=je(827);zt.exports=function Mt(dt){return"symbol"==typeof dt||N(dt)&&"[object Symbol]"==lt(dt)}},547:(zt,Bn,je)=>{var lt=je(155),N=je(580),dn=je(531),dt=/^[-+]0x[0-9a-f]+$/i,Ut=/^0b[01]+$/i,Ct=/^0o[0-7]+$/i,et=parseInt;zt.exports=function Un(wn){if("number"==typeof wn)return wn;if(dn(wn))return NaN;if(N(wn)){var ui="function"==typeof wn.valueOf?wn.valueOf():wn;wn=N(ui)?ui+"":ui}if("string"!=typeof wn)return 0===wn?wn:+wn;wn=lt(wn);var gr=Ut.test(wn);return gr||Ct.test(wn)?et(wn.slice(2),gr?2:8):dt.test(wn)?NaN:+wn}},580:zt=>{zt.exports=function Bn(je){var lt=typeof je;return null!=je&&("object"==lt||"function"==lt)}},595:(zt,Bn,je)=>{var lt=je(344),N=je(580);zt.exports=function Mt(dt,Ut,Ct){var et=!0,Un=!0;if("function"!=typeof dt)throw new TypeError("Expected a function");return N(Ct)&&(et="leading"in Ct?!!Ct.leading:et,Un="trailing"in Ct?!!Ct.trailing:Un),lt(dt,Ut,{leading:et,maxWait:Ut,trailing:Un})}},704:zt=>{"use strict";function Bn(je,lt){this.text=je=je||"",this.hasWild=~je.indexOf("*"),this.separator=lt,this.parts=je.split(lt)}Bn.prototype.match=function(je){var dn,dt,lt=!0,N=this.parts,Mt=N.length;if("string"==typeof je||je instanceof String)if(this.hasWild||this.text==je){for(dt=(je||"").split(this.separator),dn=0;lt&&dn<Mt;dn++)"*"!==N[dn]&&(lt=dn<dt.length&&N[dn]===dt[dn]);lt=lt&&dt}else lt=!1;else if("function"==typeof je.splice)for(lt=[],dn=je.length;dn--;)this.match(je[dn])&&(lt[lt.length]=je[dn]);else if("object"==typeof je)for(var Ut in lt={},je)this.match(Ut)&&(lt[Ut]=je[Ut]);return lt},zt.exports=function(je,lt,N){var dn=new Bn(je,N||/[\/\.]/);return typeof lt<"u"?dn.match(lt):dn}},754:(zt,Bn,je)=>{var lt=je(886);zt.exports=lt.Symbol},770:function(zt,Bn,je){var lt;zt=je.nmd(zt),function(){var N,Ut="Expected a function",et="__lodash_hash_undefined__",wn="__lodash_placeholder__",Vi=1/0,pl=9007199254740991,Ye=4294967295,Be=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],Dt="[object Arguments]",Rt="[object Array]",zn="[object Boolean]",an="[object Date]",_i="[object Error]",Ii="[object Function]",To="[object GeneratorFunction]",oi="[object Map]",Gt="[object Number]",pi="[object Object]",la="[object Promise]",Fs="[object RegExp]",fo="[object Set]",gl="[object String]",yn="[object Symbol]",Xi="[object WeakMap]",Yi="[object ArrayBuffer]",_l="[object DataView]",Uc="[object Float32Array]",Vc="[object Float64Array]",ca="[object Int8Array]",Yl="[object Int16Array]",Hc="[object Int32Array]",yl="[object Uint8Array]",tf="[object Uint8ClampedArray]",Vh="[object Uint16Array]",Hh="[object Uint32Array]",zh=/\b__p \+= '';/g,Zl=/\b(__p \+=) '' \+/g,Xu=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Gh=/&(?:amp|lt|gt|quot|#39);/g,zc=/[&<>"']/g,jh=RegExp(Gh.source),Gc=RegExp(zc.source),fm=/<%-([\s\S]+?)%>/g,Kl=/<%([\s\S]+?)%>/g,Yu=/<%=([\s\S]+?)%>/g,hm=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,nf=/^\w*$/,zx=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ka=/[\\^$.*+?()[\]{}|]/g,da=RegExp(ka.source),jc=/^\s+/,Jl=/\s/,Kn=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Zu=/\{\n\/\* \[wrapped with (.+)\] \*/,xA=/,? & /,MA=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,CA=/[()=,{}\[\]\/\s]/,Xr=/\\(\\)?/g,Gx=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Lr=/\w*$/,jx=/^[-+]0x[0-9a-f]+$/i,or=/^0b[01]+$/i,Mi=/^\[object .+?Constructor\]$/,SA=/^0o[0-7]+$/i,Nt=/^(?:0|[1-9]\d*)$/,H2=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Wh=/($^)/,ce=/['\n\r\u2028\u2029\\]/g,pm="\\ud800-\\udfff",EA="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",wy="\\u2700-\\u27bf",vl="a-z\\xdf-\\xf6\\xf8-\\xff",mm="A-Z\\xc0-\\xd6\\xd8-\\xde",Wc="\\ufe0e\\ufe0f",TA="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",z2="["+pm+"]",AA="["+TA+"]",ni="["+EA+"]",qx="\\d+",kr="["+wy+"]",_m="["+vl+"]",Xx="[^"+pm+TA+qx+wy+vl+mm+"]",xy="\\ud83c[\\udffb-\\udfff]",Zt="[^"+pm+"]",lf="(?:\\ud83c[\\udde6-\\uddff]){2}",Bo="[\\ud800-\\udbff][\\udc00-\\udfff]",$h="["+mm+"]",DA="(?:"+_m+"|"+Xx+")",$c="(?:"+$h+"|"+Xx+")",IA="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",RA="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",PA="(?:"+ni+"|"+xy+")?",OA="["+Wc+"]?",Uo=OA+PA+"(?:\\u200d(?:"+[Zt,lf,Bo].join("|")+")"+OA+PA+")*",Lt="(?:"+[kr,lf,Bo].join("|")+")"+Uo,j2="(?:"+[Zt+ni+"?",ni,lf,Bo,z2].join("|")+")",W2=RegExp("['\u2019]","g"),$2=RegExp(ni,"g"),Zx=RegExp(xy+"(?="+xy+")|"+j2+Uo,"g"),q2=RegExp([$h+"?"+_m+"+"+IA+"(?="+[AA,$h,"$"].join("|")+")",$c+"+"+RA+"(?="+[AA,$h+DA,"$"].join("|")+")",$h+"?"+DA+"+"+IA,$h+"+"+RA,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",qx,Lt].join("|"),"g"),Ve=RegExp("[\\u200d"+pm+EA+Wc+"]"),X2=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ku=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ym=-1,zi={};zi[Uc]=zi[Vc]=zi[ca]=zi[Yl]=zi[Hc]=zi[yl]=zi[tf]=zi[Vh]=zi[Hh]=!0,zi[Dt]=zi[Rt]=zi[Yi]=zi[zn]=zi[_l]=zi[an]=zi[_i]=zi[Ii]=zi[oi]=zi[Gt]=zi[pi]=zi[Fs]=zi[fo]=zi[gl]=zi[Xi]=!1;var Ci={};Ci[Dt]=Ci[Rt]=Ci[Yi]=Ci[_l]=Ci[zn]=Ci[an]=Ci[Uc]=Ci[Vc]=Ci[ca]=Ci[Yl]=Ci[Hc]=Ci[oi]=Ci[Gt]=Ci[pi]=Ci[Fs]=Ci[fo]=Ci[gl]=Ci[yn]=Ci[yl]=Ci[tf]=Ci[Vh]=Ci[Hh]=!0,Ci[_i]=Ci[Ii]=Ci[Xi]=!1;var My={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Kx=parseFloat,kA=parseInt,be="object"==typeof global&&global&&global.Object===Object&&global,Cy="object"==typeof self&&self&&self.Object===Object&&self,Ar=be||Cy||Function("return this")(),Sy=Bn&&!Bn.nodeType&&Bn,qc=Sy&&zt&&!zt.nodeType&&zt,Jx=qc&&qc.exports===Sy,uf=Jx&&be.process,Ua=function(){try{return qc&&qc.require&&qc.require("util").types||uf&&uf.binding&&uf.binding("util")}catch{}}(),BA=Ua&&Ua.isArrayBuffer,UA=Ua&&Ua.isDate,VA=Ua&&Ua.isMap,HA=Ua&&Ua.isRegExp,wm=Ua&&Ua.isSet,Xc=Ua&&Ua.isTypedArray;function Vo(X,ye,de){switch(de.length){case 0:return X.call(ye);case 1:return X.call(ye,de[0]);case 2:return X.call(ye,de[0],de[1]);case 3:return X.call(ye,de[0],de[1],de[2])}return X.apply(ye,de)}function Ey(X,ye,de,ut){for(var Pt=-1,gt=null==X?0:X.length;++Pt<gt;){var jn=X[Pt];ye(ut,jn,de(jn),X)}return ut}function Ls(X,ye){for(var de=-1,ut=null==X?0:X.length;++de<ut&&!1!==ye(X[de],de,X););return X}function Ql(X,ye){for(var de=null==X?0:X.length;de--&&!1!==ye(X[de],de,X););return X}function cf(X,ye){for(var de=-1,ut=null==X?0:X.length;++de<ut;)if(!ye(X[de],de,X))return!1;return!0}function eu(X,ye){for(var de=-1,ut=null==X?0:X.length,Pt=0,gt=[];++de<ut;){var jn=X[de];ye(jn,de,X)&&(gt[Pt++]=jn)}return gt}function Kt(X,ye){return!(null==X||!X.length)&&Yc(X,ye,0)>-1}function Jn(X,ye,de){for(var ut=-1,Pt=null==X?0:X.length;++ut<Pt;)if(de(ye,X[ut]))return!0;return!1}function sr(X,ye){for(var de=-1,ut=null==X?0:X.length,Pt=Array(ut);++de<ut;)Pt[de]=ye(X[de],de,X);return Pt}function Ju(X,ye){for(var de=-1,ut=ye.length,Pt=X.length;++de<ut;)X[Pt+de]=ye[de];return X}function xm(X,ye,de,ut){var Pt=-1,gt=null==X?0:X.length;for(ut&&gt&&(de=X[++Pt]);++Pt<gt;)de=ye(de,X[Pt],Pt,X);return de}function Y2(X,ye,de,ut){var Pt=null==X?0:X.length;for(ut&&Pt&&(de=X[--Pt]);Pt--;)de=ye(de,X[Pt],Pt,X);return de}function Ty(X,ye){for(var de=-1,ut=null==X?0:X.length;++de<ut;)if(ye(X[de],de,X))return!0;return!1}var Ay=qh("length");function Iy(X,ye,de){var ut;return de(X,function(Pt,gt,jn){if(ye(Pt,gt,jn))return ut=gt,!1}),ut}function ho(X,ye,de,ut){for(var Pt=X.length,gt=de+(ut?1:-1);ut?gt--:++gt<Pt;)if(ye(X[gt],gt,X))return gt;return-1}function Yc(X,ye,de){return ye==ye?function tM(X,ye,de){for(var ut=de-1,Pt=X.length;++ut<Pt;)if(X[ut]===ye)return ut;return-1}(X,ye,de):ho(X,zA,de)}function Z2(X,ye,de,ut){for(var Pt=de-1,gt=X.length;++Pt<gt;)if(ut(X[Pt],ye))return Pt;return-1}function zA(X){return X!=X}function Qu(X,ye){var de=null==X?0:X.length;return de?Ry(X,ye)/de:NaN}function qh(X){return function(ye){return null==ye?N:ye[X]}}function Mm(X){return function(ye){return null==X?N:X[ye]}}function Xh(X,ye,de,ut,Pt){return Pt(X,function(gt,jn,Tn){de=ut?(ut=!1,gt):ye(de,gt,jn,Tn)}),de}function Ry(X,ye){for(var de,ut=-1,Pt=X.length;++ut<Pt;){var gt=ye(X[ut]);gt!==N&&(de=de===N?gt:de+gt)}return de}function Py(X,ye){for(var de=-1,ut=Array(X);++de<X;)ut[de]=ye(de);return ut}function eM(X){return X&&X.slice(0,Fy(X)+1).replace(jc,"")}function Ze(X){return function(ye){return X(ye)}}function Cm(X,ye){return sr(ye,function(de){return X[de]})}function j(X,ye){return X.has(ye)}function Yh(X,ye){for(var de=-1,ut=X.length;++de<ut&&Yc(ye,X[de],0)>-1;);return de}function Sm(X,ye){for(var de=X.length;de--&&Yc(ye,X[de],0)>-1;);return de}var jA=Mm({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),WA=Mm({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function $A(X){return"\\"+My[X]}function ec(X){return Ve.test(X)}function Ny(X){var ye=-1,de=Array(X.size);return X.forEach(function(ut,Pt){de[++ye]=[Pt,ut]}),de}function tc(X,ye){return function(de){return X(ye(de))}}function nc(X,ye){for(var de=-1,ut=X.length,Pt=0,gt=[];++de<ut;){var jn=X[de];(jn===ye||jn===wn)&&(X[de]=wn,gt[Pt++]=de)}return gt}function po(X){var ye=-1,de=Array(X.size);return X.forEach(function(ut){de[++ye]=ut}),de}function tu(X){return ec(X)?function Ly(X){for(var ye=Zx.lastIndex=0;Zx.test(X);)++ye;return ye}(X):Ay(X)}function fa(X){return ec(X)?function Kh(X){return X.match(Zx)||[]}(X):function xn(X){return X.split("")}(X)}function Fy(X){for(var ye=X.length;ye--&&Jl.test(X.charAt(ye)););return ye}var ks=Mm({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Gn=function X(ye){var d,de=(ye=null==ye?Ar:Gn.defaults(Ar.Object(),ye,Gn.pick(Ar,Ku))).Array,ut=ye.Date,Pt=ye.Error,gt=ye.Function,jn=ye.Math,Tn=ye.Object,nu=ye.RegExp,bl=ye.String,Ha=ye.TypeError,Tm=de.prototype,Zc=Tn.prototype,Kc=ye["__core-js_shared__"],By=gt.prototype.toString,si=Zc.hasOwnProperty,ZA=0,Am=(d=/[^.]+$/.exec(Kc&&Kc.keys&&Kc.keys.IE_PROTO||""))?"Symbol(src)_1."+d:"",Jh=Zc.toString,nM=By.call(Tn),Jc=Ar._,KA=nu("^"+By.call(si).replace(ka,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ff=Jx?ye.Buffer:N,za=ye.Symbol,Qh=ye.Uint8Array,Dm=ff?ff.allocUnsafe:N,Qc=tc(Tn.getPrototypeOf,Tn),Ho=Tn.create,ic=Zc.propertyIsEnumerable,hf=Tm.splice,iM=za?za.isConcatSpreadable:N,ep=za?za.iterator:N,rc=za?za.toStringTag:N,oc=function(){try{var d=ud(Tn,"defineProperty");return d({},"",{}),d}catch{}}(),pf=ye.clearTimeout!==Ar.clearTimeout&&ye.clearTimeout,JA=ut&&ut.now!==Ar.Date.now&&ut.now,QA=ye.setTimeout!==Ar.setTimeout&&ye.setTimeout,Im=jn.ceil,gf=jn.floor,Bs=Tn.getOwnPropertySymbols,rM=ff?ff.isBuffer:N,iu=ye.isFinite,mf=Tm.join,eD=tc(Tn.keys,Tn),Br=jn.max,Yn=jn.min,oM=ut.now,tD=ye.parseInt,_f=jn.random,nD=Tm.reverse,Uy=ud(ye,"DataView"),tp=ud(ye,"Map"),Vy=ud(ye,"Promise"),yf=ud(ye,"Set"),np=ud(ye,"WeakMap"),ed=ud(Tn,"create"),td=np&&new np,Zn={},Pe=dd(Uy),kt=dd(tp),ar=dd(Vy),Ao=dd(yf),Yr=dd(np),Zr=za?za.prototype:N,wl=Zr?Zr.valueOf:N,ai=Zr?Zr.toString:N;function O(d){if(Si(d)&&!ln(d)&&!(d instanceof An)){if(d instanceof Kr)return d;if(si.call(d,"__wrapped__"))return xD(d)}return new Kr(d)}var zo=function(){function d(){}return function(p){if(!Gi(p))return{};if(Ho)return Ho(p);d.prototype=p;var b=new d;return d.prototype=N,b}}();function Ft(){}function Kr(d,p){this.__wrapped__=d,this.__actions__=[],this.__chain__=!!p,this.__index__=0,this.__values__=N}function An(d){this.__wrapped__=d,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ye,this.__views__=[]}function ha(d){var p=-1,b=null==d?0:d.length;for(this.clear();++p<b;){var C=d[p];this.set(C[0],C[1])}}function Go(d){var p=-1,b=null==d?0:d.length;for(this.clear();++p<b;){var C=d[p];this.set(C[0],C[1])}}function Jr(d){var p=-1,b=null==d?0:d.length;for(this.clear();++p<b;){var C=d[p];this.set(C[0],C[1])}}function ou(d){var p=-1,b=null==d?0:d.length;for(this.__data__=new Jr;++p<b;)this.add(d[p])}function lr(d){var p=this.__data__=new Go(d);this.size=p.size}function uM(d,p){var b=ln(d),C=!b&&gs(d),A=!b&&!C&&Za(d),F=!b&&!C&&!A&&Cp(d),G=b||C||A||F,$=G?Py(d.length,bl):[],te=$.length;for(var Me in d)(p||si.call(d,Me))&&(!G||!("length"==Me||A&&("offset"==Me||"parent"==Me)||F&&("buffer"==Me||"byteLength"==Me||"byteOffset"==Me)||du(Me,te)))&&$.push(Me);return $}function rp(d){var p=d.length;return p?d[Qy(0,p-1)]:N}function K2(d,p){return _p(cs(d),xf(p,0,d.length))}function J2(d){return _p(cs(d))}function cM(d,p,b){(b!==N&&!zs(d[p],b)||b===N&&!(p in d))&&ac(d,p,b)}function Nm(d,p,b){var C=d[p];(!si.call(d,p)||!zs(C,b)||b===N&&!(p in d))&&ac(d,p,b)}function zy(d,p){for(var b=d.length;b--;)if(zs(d[b][0],p))return b;return-1}function Q2(d,p,b,C){return lc(d,function(A,F,G){p(C,A,b(A),G)}),C}function Gy(d,p){return d&&Pi(p,Dr(p),d)}function ac(d,p,b){"__proto__"==p&&oc?oc(d,p,{configurable:!0,enumerable:!0,value:b,writable:!0}):d[p]=b}function dM(d,p){for(var b=-1,C=p.length,A=de(C),F=null==d;++b<C;)A[b]=F?N:$v(d,p[b]);return A}function xf(d,p,b){return d==d&&(b!==N&&(d=d<=b?d:b),p!==N&&(d=d>=p?d:p)),d}function Vs(d,p,b,C,A,F){var G,$=1&p,te=2&p,Me=4&p;if(b&&(G=A?b(d,C,A,F):b(d)),G!==N)return G;if(!Gi(d))return d;var Se=ln(d);if(Se){if(G=function yD(d){var p=d.length,b=new d.constructor(p);return p&&"string"==typeof d[0]&&si.call(d,"index")&&(b.index=d.index,b.input=d.input),b}(d),!$)return cs(d,G)}else{var Re=eo(d),nt=Re==Ii||Re==To;if(Za(d))return jm(d,$);if(Re==pi||Re==Dt||nt&&!A){if(G=te||nt?{}:pv(d),!$)return te?function yi(d,p){return Pi(d,pp(d),p)}(d,function eL(d,p){return d&&Pi(p,Ro(p),d)}(G,d)):function od(d,p){return Pi(d,hv(d),p)}(d,Gy(G,d))}else{if(!Ci[Re])return A?d:{};G=function RM(d,p,b){var C=d.constructor;switch(p){case Yi:return Df(d);case zn:case an:return new C(+d);case _l:return function pD(d,p){var b=p?Df(d.buffer):d.buffer;return new d.constructor(b,d.byteOffset,d.byteLength)}(d,b);case Uc:case Vc:case ca:case Yl:case Hc:case yl:case tf:case Vh:case Hh:return ov(d,b);case oi:return new C;case Gt:case gl:return new C(d);case Fs:return function xM(d){var p=new d.constructor(d.source,Lr.exec(d));return p.lastIndex=d.lastIndex,p}(d);case fo:return new C;case yn:return function rv(d){return wl?Tn(wl.call(d)):{}}(d)}}(d,Re,$)}}F||(F=new lr);var St=F.get(d);if(St)return St;F.set(d,G),jv(d)?d.forEach(function(Wt){G.add(Vs(Wt,p,b,Wt,d,F))}):Hv(d)&&d.forEach(function(Wt,On){G.set(On,Vs(Wt,p,b,On,d,F))});var Dn=Se?N:(Me?te?fv:ad:te?Ro:Dr)(d);return Ls(Dn||d,function(Wt,On){Dn&&(Wt=d[On=Wt]),Nm(G,On,Vs(Wt,p,b,On,d,F))}),G}function rD(d,p,b){var C=b.length;if(null==d)return!C;for(d=Tn(d);C--;){var A=b[C],G=d[A];if(G===N&&!(A in d)||!(0,p[A])(G))return!1}return!0}function oD(d,p,b){if("function"!=typeof d)throw new Ha(Ut);return kf(function(){d.apply(N,b)},p)}function Fm(d,p,b,C){var A=-1,F=Kt,G=!0,$=d.length,te=[],Me=p.length;if(!$)return te;b&&(p=sr(p,Ze(b))),C?(F=Jn,G=!1):p.length>=200&&(F=j,G=!1,p=new ou(p));e:for(;++A<$;){var Se=d[A],Re=null==b?Se:b(Se);if(Se=C||0!==Se?Se:0,G&&Re==Re){for(var nt=Me;nt--;)if(p[nt]===Re)continue e;te.push(Se)}else F(p,Re,C)||te.push(Se)}return te}O.templateSettings={escape:fm,evaluate:Kl,interpolate:Yu,variable:"",imports:{_:O}},(O.prototype=Ft.prototype).constructor=O,(Kr.prototype=zo(Ft.prototype)).constructor=Kr,(An.prototype=zo(Ft.prototype)).constructor=An,ha.prototype.clear=function ru(){this.__data__=ed?ed(null):{},this.size=0},ha.prototype.delete=function ip(d){var p=this.has(d)&&delete this.__data__[d];return this.size-=p?1:0,p},ha.prototype.get=function sM(d){var p=this.__data__;if(ed){var b=p[d];return b===et?N:b}return si.call(p,d)?p[d]:N},ha.prototype.has=function sc(d){var p=this.__data__;return ed?p[d]!==N:si.call(p,d)},ha.prototype.set=function Rm(d,p){var b=this.__data__;return this.size+=this.has(d)?0:1,b[d]=ed&&p===N?et:p,this},Go.prototype.clear=function Us(){this.__data__=[],this.size=0},Go.prototype.delete=function bf(d){var p=this.__data__,b=zy(p,d);return!(b<0||(b==p.length-1?p.pop():hf.call(p,b,1),--this.size,0))},Go.prototype.get=function mt(d){var p=this.__data__,b=zy(p,d);return b<0?N:p[b][1]},Go.prototype.has=function Hy(d){return zy(this.__data__,d)>-1},Go.prototype.set=function Ga(d,p){var b=this.__data__,C=zy(b,d);return C<0?(++this.size,b.push([d,p])):b[C][1]=p,this},Jr.prototype.clear=function Pm(){this.size=0,this.__data__={hash:new ha,map:new(tp||Go),string:new ha}},Jr.prototype.delete=function wf(d){var p=hp(this,d).delete(d);return this.size-=p?1:0,p},Jr.prototype.get=function Ji(d){return hp(this,d).get(d)},Jr.prototype.has=function mr(d){return hp(this,d).has(d)},Jr.prototype.set=function Ur(d,p){var b=hp(this,d),C=b.size;return b.set(d,p),this.size+=b.size==C?0:1,this},ou.prototype.add=ou.prototype.push=function ja(d){return this.__data__.set(d,et),this},ou.prototype.has=function Om(d){return this.__data__.has(d)},lr.prototype.clear=function su(){this.__data__=new Go,this.size=0},lr.prototype.delete=function aM(d){var p=this.__data__,b=p.delete(d);return this.size=p.size,b},lr.prototype.get=function iD(d){return this.__data__.get(d)},lr.prototype.has=function au(d){return this.__data__.has(d)},lr.prototype.set=function lM(d,p){var b=this.__data__;if(b instanceof Go){var C=b.__data__;if(!tp||C.length<199)return C.push([d,p]),this.size=++b.size,this;b=this.__data__=new Jr(C)}return b.set(d,p),this.size=b.size,this};var lc=lv(pa),jy=lv(Wy,!0);function as(d,p){var b=!0;return lc(d,function(C,A,F){return b=!!p(C,A,F)}),b}function op(d,p,b){for(var C=-1,A=d.length;++C<A;){var F=d[C],G=p(F);if(null!=G&&($===N?G==G&&!ms(G):b(G,$)))var $=G,te=F}return te}function hM(d,p){var b=[];return lc(d,function(C,A,F){p(C,A,F)&&b.push(C)}),b}function Qr(d,p,b,C,A){var F=-1,G=d.length;for(b||(b=OM),A||(A=[]);++F<G;){var $=d[F];p>0&&b($)?p>1?Qr($,p-1,b,C,A):Ju(A,$):C||(A[A.length]=$)}return A}var Lm=CM(),pM=CM(!0);function pa(d,p){return d&&Lm(d,p,Dr)}function Wy(d,p){return d&&pM(d,p,Dr)}function Qn(d,p){return eu(p,function(b){return Tl(d[b])})}function uc(d,p){for(var b=0,C=(p=cc(p,d)).length;null!=d&&b<C;)d=d[Xa(p[b++])];return b&&b==C?d:N}function $y(d,p,b){var C=p(d);return ln(d)?C:Ju(C,b(d))}function Jt(d){return null==d?d===N?"[object Undefined]":"[object Null]":rc&&rc in Tn(d)?function Sl(d){var p=si.call(d,rc),b=d[rc];try{d[rc]=N;var C=!0}catch{}var A=Jh.call(d);return C&&(p?d[rc]=b:delete d[rc]),A}(d):function LM(d){return Jh.call(d)}(d)}function sp(d,p){return d>p}function Mf(d,p){return null!=d&&si.call(d,p)}function jo(d,p){return null!=d&&p in Tn(d)}function lu(d,p,b){for(var C=b?Jn:Kt,A=d[0].length,F=d.length,G=F,$=de(F),te=1/0,Me=[];G--;){var Se=d[G];G&&p&&(Se=sr(Se,Ze(p))),te=Yn(Se.length,te),$[G]=!b&&(p||A>=120&&Se.length>=120)?new ou(G&&Se):N}Se=d[0];var Re=-1,nt=$[0];e:for(;++Re<A&&Me.length<te;){var St=Se[Re],Bt=p?p(St):St;if(St=b||0!==St?St:0,!(nt?j(nt,Bt):C(Me,Bt,b))){for(G=F;--G;){var Dn=$[G];if(!(Dn?j(Dn,Bt):C(d[G],Bt,b)))continue e}nt&&nt.push(Bt),Me.push(St)}}return Me}function Vr(d,p,b){var C=null==(d=kM(d,p=cc(p,d)))?d:d[Xa(Wo(p))];return null==C?N:Vo(C,d,b)}function gM(d){return Si(d)&&Jt(d)==Dt}function Do(d,p,b,C,A){return d===p||(null==d||null==p||!Si(d)&&!Si(p)?d!=d&&p!=p:function mM(d,p,b,C,A,F){var G=ln(d),$=ln(p),te=G?Rt:eo(d),Me=$?Rt:eo(p),Se=(te=te==Dt?pi:te)==pi,Re=(Me=Me==Dt?pi:Me)==pi,nt=te==Me;if(nt&&Za(d)){if(!Za(p))return!1;G=!0,Se=!1}if(nt&&!Se)return F||(F=new lr),G||Cp(d)?dv(d,p,b,C,A,F):function Nf(d,p,b,C,A,F,G){switch(b){case _l:if(d.byteLength!=p.byteLength||d.byteOffset!=p.byteOffset)return!1;d=d.buffer,p=p.buffer;case Yi:return!(d.byteLength!=p.byteLength||!F(new Qh(d),new Qh(p)));case zn:case an:case Gt:return zs(+d,+p);case _i:return d.name==p.name&&d.message==p.message;case Fs:case gl:return d==p+"";case oi:var $=Ny;case fo:if($||($=po),d.size!=p.size&&!(1&C))return!1;var Me=G.get(d);if(Me)return Me==p;C|=2,G.set(d,p);var Se=dv($(d),$(p),C,A,F,G);return G.delete(d),Se;case yn:if(wl)return wl.call(d)==wl.call(p)}return!1}(d,p,te,b,C,A,F);if(!(1&b)){var St=Se&&si.call(d,"__wrapped__"),Bt=Re&&si.call(p,"__wrapped__");if(St||Bt){var Dn=St?d.value():d,Wt=Bt?p.value():p;return F||(F=new lr),A(Dn,Wt,b,C,F)}}return!!nt&&(F||(F=new lr),function DM(d,p,b,C,A,F){var G=1&b,$=ad(d),te=$.length;if(te!=ad(p).length&&!G)return!1;for(var Re=te;Re--;){var nt=$[Re];if(!(G?nt in p:si.call(p,nt)))return!1}var St=F.get(d),Bt=F.get(p);if(St&&Bt)return St==p&&Bt==d;var Dn=!0;F.set(d,p),F.set(p,d);for(var Wt=G;++Re<te;){var On=d[nt=$[Re]],Wn=p[nt];if(C)var Gs=G?C(Wn,On,nt,p,d,F):C(On,Wn,nt,d,p,F);if(!(Gs===N?On===Wn||A(On,Wn,b,C,F):Gs)){Dn=!1;break}Wt||(Wt="constructor"==nt)}if(Dn&&!Wt){var Yo=d.constructor,js=p.constructor;Yo!=js&&"constructor"in d&&"constructor"in p&&!("function"==typeof Yo&&Yo instanceof Yo&&"function"==typeof js&&js instanceof js)&&(Dn=!1)}return F.delete(d),F.delete(p),Dn}(d,p,b,C,A,F))}(d,p,b,C,Do,A))}function km(d,p,b,C){var A=b.length,F=A,G=!C;if(null==d)return!F;for(d=Tn(d);A--;){var $=b[A];if(G&&$[2]?$[1]!==d[$[0]]:!($[0]in d))return!1}for(;++A<F;){var te=($=b[A])[0],Me=d[te],Se=$[1];if(G&&$[2]){if(Me===N&&!(te in d))return!1}else{var Re=new lr;if(C)var nt=C(Me,Se,te,d,p,Re);if(!(nt===N?Do(Se,Me,3,C,Re):nt))return!1}}return!0}function Cf(d){return!(!Gi(d)||function NM(d){return!!Am&&Am in d}(d))&&(Tl(d)?KA:Mi).test(dd(d))}function Um(d){return"function"==typeof d?d:null==d?Xo:"object"==typeof d?ln(d)?lp(d[0],d[1]):Qt(d):T0(d)}function Wa(d){if(!qa(d))return eD(d);var p=[];for(var b in Tn(d))si.call(d,b)&&"constructor"!=b&&p.push(b);return p}function ap(d,p){return d<p}function _M(d,p){var b=-1,C=io(d)?de(d.length):[];return lc(d,function(A,F,G){C[++b]=p(A,F,G)}),C}function Qt(d){var p=Km(d);return 1==p.length&&p[0][2]?FM(p[0][0],p[0][1]):function(b){return b===d||km(b,d,p)}}function lp(d,p){return cd(d)&&ur(p)?FM(Xa(d),p):function(b){var C=$v(b,d);return C===N&&C===p?v0(b,d):Do(p,C,3)}}function Ef(d,p,b,C,A){d!==p&&Lm(p,function(F,G){if(A||(A=new lr),Gi(F))!function Ky(d,p,b,C,A,F,G){var $=gp(d,b),te=gp(p,b),Me=G.get(te);if(Me)cM(d,b,Me);else{var Se=F?F($,te,b+"",d,p,G):N,Re=Se===N;if(Re){var nt=ln(te),St=!nt&&Za(te),Bt=!nt&&!St&&Cp(te);Se=te,nt||St||Bt?ln($)?Se=$:cr($)?Se=cs($):St?(Re=!1,Se=jm(te,!0)):Bt?(Re=!1,Se=ov(te,!0)):Se=[]:jf(te)||gs(te)?(Se=$,gs($)?Se=IC($):(!Gi($)||Tl($))&&(Se=pv(te))):Re=!1}Re&&(G.set(te,Se),A(Se,te,C,F,G),G.delete(te)),cM(d,b,Se)}}(d,p,G,b,Ef,C,A);else{var $=C?C(gp(d,G),F,G+"",d,p,A):N;$===N&&($=F),cM(d,G,$)}},Ro)}function yM(d,p){var b=d.length;if(b)return du(p+=p<0?b:0,b)?d[p]:N}function vM(d,p,b){p=p.length?sr(p,function(F){return ln(F)?function(G){return uc(G,1===F.length?F[0]:F)}:F}):[Xo];var C=-1;return p=sr(p,Ze(Vt())),function GA(X,ye){var de=X.length;for(X.sort(ye);de--;)X[de]=X[de].value;return X}(_M(d,function(F,G,$){return{criteria:sr(p,function(Me){return Me(F)}),index:++C,value:F}}),function(F,G){return function MM(d,p,b){for(var C=-1,A=d.criteria,F=p.criteria,G=A.length,$=b.length;++C<G;){var te=sv(A[C],F[C]);if(te)return C>=$?te:te*("desc"==b[C]?-1:1)}return d.index-p.index}(F,G,b)})}function Vm(d,p,b){for(var C=-1,A=p.length,F={};++C<A;){var G=p[C],$=uc(d,G);b($,G)&&He(F,cc(G,d),$)}return F}function Jy(d,p,b,C){var A=C?Z2:Yc,F=-1,G=p.length,$=d;for(d===p&&(p=cs(p)),b&&($=sr(d,Ze(b)));++F<G;)for(var te=0,Me=p[F],Se=b?b(Me):Me;(te=A($,Se,te,C))>-1;)$!==d&&hf.call($,te,1),hf.call(d,te,1);return d}function bM(d,p){for(var b=d?p.length:0,C=b-1;b--;){var A=p[b];if(b==C||A!==F){var F=A;du(A)?hf.call(d,A,1):Af(d,A)}}return d}function Qy(d,p){return d+gf(_f()*(p-d+1))}function ev(d,p){var b="";if(!d||p<1||p>pl)return b;do{p%2&&(b+=d),(p=gf(p/2))&&(d+=d)}while(p);return b}function K(d,p){return mv(Lf(d,p,Xo),d+"")}function jt(d){return rp(_d(d))}function qe(d,p){var b=_d(d);return _p(b,xf(p,0,b.length))}function He(d,p,b,C){if(!Gi(d))return d;for(var A=-1,F=(p=cc(p,d)).length,G=F-1,$=d;null!=$&&++A<F;){var te=Xa(p[A]),Me=b;if("__proto__"===te||"constructor"===te||"prototype"===te)return d;if(A!=G){var Se=$[te];(Me=C?C(Se,te,$):N)===N&&(Me=Gi(Se)?Se:du(p[A+1])?[]:{})}Nm($,te,Me),$=$[te]}return d}var Mn=td?function(d,p){return td.set(d,p),d}:Xo,wM=oc?function(d,p){return oc(d,"toString",{configurable:!0,enumerable:!1,value:tb(p),writable:!0})}:Xo;function up(d){return _p(_d(d))}function _r(d,p,b){var C=-1,A=d.length;p<0&&(p=-p>A?0:A+p),(b=b>A?A:b)<0&&(b+=A),A=p>b?0:b-p>>>0,p>>>=0;for(var F=de(A);++C<A;)F[C]=d[C+p];return F}function tv(d,p){var b;return lc(d,function(C,A,F){return!(b=p(C,A,F))}),!!b}function Tf(d,p,b){var C=0,A=null==d?C:d.length;if("number"==typeof p&&p==p&&A<=2147483647){for(;C<A;){var F=C+A>>>1,G=d[F];null!==G&&!ms(G)&&(b?G<=p:G<p)?C=F+1:A=F}return A}return Hm(d,p,Xo,b)}function Hm(d,p,b,C){var A=0,F=null==d?0:d.length;if(0===F)return 0;for(var G=(p=b(p))!=p,$=null===p,te=ms(p),Me=p===N;A<F;){var Se=gf((A+F)/2),Re=b(d[Se]),nt=Re!==N,St=null===Re,Bt=Re==Re,Dn=ms(Re);if(G)var Wt=C||Bt;else Wt=Me?Bt&&(C||nt):$?Bt&&nt&&(C||!St):te?Bt&&nt&&!St&&(C||!Dn):!St&&!Dn&&(C?Re<=p:Re<p);Wt?A=Se+1:F=Se}return Yn(F,4294967294)}function dD(d,p){for(var b=-1,C=d.length,A=0,F=[];++b<C;){var G=d[b],$=p?p(G):G;if(!b||!zs($,te)){var te=$;F[A++]=0===G?0:G}}return F}function fD(d){return"number"==typeof d?d:ms(d)?NaN:+d}function ls(d){if("string"==typeof d)return d;if(ln(d))return sr(d,ls)+"";if(ms(d))return ai?ai.call(d):"";var p=d+"";return"0"==p&&1/d==-Vi?"-0":p}function uu(d,p,b){var C=-1,A=Kt,F=d.length,G=!0,$=[],te=$;if(b)G=!1,A=Jn;else if(F>=200){var Me=p?null:mD(d);if(Me)return po(Me);G=!1,A=j,te=new ou}else te=p?[]:$;e:for(;++C<F;){var Se=d[C],Re=p?p(Se):Se;if(Se=b||0!==Se?Se:0,G&&Re==Re){for(var nt=te.length;nt--;)if(te[nt]===Re)continue e;p&&te.push(Re),$.push(Se)}else A(te,Re,b)||(te!==$&&te.push(Re),$.push(Se))}return $}function Af(d,p){return null==(d=kM(d,p=cc(p,d)))||delete d[Xa(Wo(p))]}function Io(d,p,b,C){return He(d,p,b(uc(d,p)),C)}function ga(d,p,b,C){for(var A=d.length,F=C?A:-1;(C?F--:++F<A)&&p(d[F],F,d););return b?_r(d,C?0:F,C?F+1:A):_r(d,C?F+1:0,C?A:F)}function nv(d,p){var b=d;return b instanceof An&&(b=b.value()),xm(p,function(C,A){return A.func.apply(A.thisArg,Ju([C],A.args))},b)}function us(d,p,b){var C=d.length;if(C<2)return C?uu(d[0]):[];for(var A=-1,F=de(C);++A<C;)for(var G=d[A],$=-1;++$<C;)$!=A&&(F[A]=Fm(F[A]||G,d[$],p,b));return uu(Qr(F,1),p,b)}function xl(d,p,b){for(var C=-1,A=d.length,F=p.length,G={};++C<A;)b(G,d[C],C<F?p[C]:N);return G}function iv(d){return cr(d)?d:[]}function zm(d){return"function"==typeof d?d:Xo}function cc(d,p){return ln(d)?d:cd(d,p)?[d]:HM(ci(d))}var hD=K;function Ml(d,p,b){var C=d.length;return b=b===N?C:b,!p&&b>=C?d:_r(d,p,b)}var Gm=pf||function(d){return Ar.clearTimeout(d)};function jm(d,p){if(p)return d.slice();var b=d.length,C=Dm?Dm(b):new d.constructor(b);return d.copy(C),C}function Df(d){var p=new d.constructor(d.byteLength);return new Qh(p).set(new Qh(d)),p}function ov(d,p){var b=p?Df(d.buffer):d.buffer;return new d.constructor(b,d.byteOffset,d.length)}function sv(d,p){if(d!==p){var b=d!==N,C=null===d,A=d==d,F=ms(d),G=p!==N,$=null===p,te=p==p,Me=ms(p);if(!$&&!Me&&!F&&d>p||F&&G&&te&&!$&&!Me||C&&G&&te||!b&&te||!A)return 1;if(!C&&!F&&!Me&&d<p||Me&&b&&A&&!C&&!F||$&&b&&A||!G&&A||!te)return-1}return 0}function av(d,p,b,C){for(var A=-1,F=d.length,G=b.length,$=-1,te=p.length,Me=Br(F-G,0),Se=de(te+Me),Re=!C;++$<te;)Se[$]=p[$];for(;++A<G;)(Re||A<F)&&(Se[b[A]]=d[A]);for(;Me--;)Se[$++]=d[A++];return Se}function Wm(d,p,b,C){for(var A=-1,F=d.length,G=-1,$=b.length,te=-1,Me=p.length,Se=Br(F-$,0),Re=de(Se+Me),nt=!C;++A<Se;)Re[A]=d[A];for(var St=A;++te<Me;)Re[St+te]=p[te];for(;++G<$;)(nt||A<F)&&(Re[St+b[G]]=d[A++]);return Re}function cs(d,p){var b=-1,C=d.length;for(p||(p=de(C));++b<C;)p[b]=d[b];return p}function Pi(d,p,b,C){var A=!b;b||(b={});for(var F=-1,G=p.length;++F<G;){var $=p[F],te=C?C(b[$],d[$],$,b,d):N;te===N&&(te=d[$]),A?ac(b,$,te):Nm(b,$,te)}return b}function cp(d,p){return function(b,C){var A=ln(b)?Ey:Q2,F=p?p():{};return A(b,d,Vt(C,2),F)}}function If(d){return K(function(p,b){var C=-1,A=b.length,F=A>1?b[A-1]:N,G=A>2?b[2]:N;for(F=d.length>3&&"function"==typeof F?(A--,F):N,G&&to(b[0],b[1],G)&&(F=A<3?N:F,A=1),p=Tn(p);++C<A;){var $=b[C];$&&d(p,$,C,F)}return p})}function lv(d,p){return function(b,C){if(null==b)return b;if(!io(b))return d(b,C);for(var A=b.length,F=p?A:-1,G=Tn(b);(p?F--:++F<A)&&!1!==C(G[F],F,G););return b}}function CM(d){return function(p,b,C){for(var A=-1,F=Tn(p),G=C(p),$=G.length;$--;){var te=G[d?$:++A];if(!1===b(F[te],te,F))break}return p}}function uv(d){return function(p){var b=ec(p=ci(p))?fa(p):N,C=b?b[0]:p.charAt(0),A=b?Ml(b,1).join(""):p.slice(1);return C[d]()+A}}function Cl(d){return function(p){return xm(eb(fI(p).replace(W2,"")),d,"")}}function ds(d){return function(){var p=arguments;switch(p.length){case 0:return new d;case 1:return new d(p[0]);case 2:return new d(p[0],p[1]);case 3:return new d(p[0],p[1],p[2]);case 4:return new d(p[0],p[1],p[2],p[3]);case 5:return new d(p[0],p[1],p[2],p[3],p[4]);case 6:return new d(p[0],p[1],p[2],p[3],p[4],p[5]);case 7:return new d(p[0],p[1],p[2],p[3],p[4],p[5],p[6])}var b=zo(d.prototype),C=d.apply(b,p);return Gi(C)?C:b}}function $m(d){return function(p,b,C){var A=Tn(p);if(!io(p)){var F=Vt(b,3);p=Dr(p),b=function($){return F(A[$],$,A)}}var G=d(p,b,C);return G>-1?A[F?p[G]:G]:N}}function dp(d){return $a(function(p){var b=p.length,C=b,A=Kr.prototype.thru;for(d&&p.reverse();C--;){var F=p[C];if("function"!=typeof F)throw new Ha(Ut);if(A&&!G&&"wrapper"==Ff(F))var G=new Kr([],!0)}for(C=G?C:b;++C<b;){var $=Ff(F=p[C]),te="wrapper"==$?ld(F):N;G=te&&e0(te[0])&&424==te[1]&&!te[4].length&&1==te[9]?G[Ff(te[0])].apply(G,te[3]):1==F.length&&e0(F)?G[$]():G.thru(F)}return function(){var Me=arguments,Se=Me[0];if(G&&1==Me.length&&ln(Se))return G.plant(Se).value();for(var Re=0,nt=b?p[Re].apply(this,Me):Se;++Re<b;)nt=p[Re].call(this,nt);return nt}})}function sd(d,p,b,C,A,F,G,$,te,Me){var Se=128&p,Re=1&p,nt=2&p,St=24&p,Bt=512&p,Dn=nt?N:ds(d);return function Wt(){for(var On=arguments.length,Wn=de(On),Gs=On;Gs--;)Wn[Gs]=arguments[Gs];if(St)var Yo=cu(Wt),js=function Zh(X,ye){for(var de=X.length,ut=0;de--;)X[de]===ye&&++ut;return ut}(Wn,Yo);if(C&&(Wn=av(Wn,C,A,St)),F&&(Wn=Wm(Wn,F,G,St)),On-=js,St&&On<Me){var Cr=nc(Wn,Yo);return Zm(d,p,sd,Wt.placeholder,b,Wn,Cr,$,te,Me-On)}var va=Re?b:this,Al=nt?va[d]:d;return On=Wn.length,$?Wn=function BM(d,p){for(var b=d.length,C=Yn(p.length,b),A=cs(d);C--;){var F=p[C];d[C]=du(F,b)?A[F]:N}return d}(Wn,$):Bt&&On>1&&Wn.reverse(),Se&&te<On&&(Wn.length=te),this&&this!==Ar&&this instanceof Wt&&(Al=Dn||ds(Al)),Al.apply(va,Wn)}}function qm(d,p){return function(b,C){return function id(d,p,b,C){return pa(d,function(A,F,G){p(C,b(A),F,G)}),C}(b,d,p(C),{})}}function fp(d,p){return function(b,C){var A;if(b===N&&C===N)return p;if(b!==N&&(A=b),C!==N){if(A===N)return C;"string"==typeof b||"string"==typeof C?(b=ls(b),C=ls(C)):(b=fD(b),C=fD(C)),A=d(b,C)}return A}}function Xm(d){return $a(function(p){return p=sr(p,Ze(Vt())),K(function(b){var C=this;return d(p,function(A){return Vo(A,C,b)})})})}function Ym(d,p){var b=(p=p===N?" ":ls(p)).length;if(b<2)return b?ev(p,d):p;var C=ev(p,Im(d/tu(p)));return ec(p)?Ml(fa(C),0,d).join(""):C.slice(0,d)}function Pf(d){return function(p,b,C){return C&&"number"!=typeof C&&to(p,b,C)&&(b=C=N),p=go(p),b===N?(b=p,p=0):b=go(b),function cD(d,p,b,C){for(var A=-1,F=Br(Im((p-d)/(b||1)),0),G=de(F);F--;)G[C?F:++A]=d,d+=b;return G}(p,b,C=C===N?p<b?1:-1:go(C),d)}}function Of(d){return function(p,b){return"string"==typeof p&&"string"==typeof b||(p=_a(p),b=_a(b)),d(p,b)}}function Zm(d,p,b,C,A,F,G,$,te,Me){var Se=8&p;p|=Se?32:64,4&(p&=~(Se?64:32))||(p&=-4);var Dn=[d,p,A,Se?F:N,Se?G:N,Se?N:F,Se?N:G,$,te,Me],Wt=b.apply(N,Dn);return e0(d)&&mp(Wt,Dn),Wt.placeholder=C,UM(Wt,d,p)}function cv(d){var p=jn[d];return function(b,C){if(b=_a(b),(C=null==C?0:Yn(un(C),292))&&iu(b)){var A=(ci(b)+"e").split("e");return+((A=(ci(p(A[0]+"e"+(+A[1]+C)))+"e").split("e"))[0]+"e"+(+A[1]-C))}return p(b)}}var mD=yf&&1/po(new yf([,-0]))[1]==Vi?function(d){return new yf(d)}:ib;function EM(d){return function(p){var b=eo(p);return b==oi?Ny(p):b==fo?function df(X){var ye=-1,de=Array(X.size);return X.forEach(function(ut){de[++ye]=[ut,ut]}),de}(p):function Qx(X,ye){return sr(ye,function(de){return[de,X[de]]})}(p,d(p))}}function dc(d,p,b,C,A,F,G,$){var te=2&p;if(!te&&"function"!=typeof d)throw new Ha(Ut);var Me=C?C.length:0;if(Me||(p&=-97,C=A=N),G=G===N?G:Br(un(G),0),$=$===N?$:un($),Me-=A?A.length:0,64&p){var Se=C,Re=A;C=A=N}var nt=te?N:ld(d),St=[d,p,b,C,A,Se,Re,F,G,$];if(nt&&function gv(d,p){var b=d[1],C=p[1],A=b|C;if(!(A<131)&&!(128==C&&8==b||128==C&&256==b&&d[7].length<=p[8]||384==C&&p[7].length<=p[8]&&8==b))return d;1&C&&(d[2]=p[2],A|=1&b?0:4);var $=p[3];if($){var te=d[3];d[3]=te?av(te,$,p[4]):$,d[4]=te?nc(d[3],wn):p[4]}($=p[5])&&(d[5]=(te=d[5])?Wm(te,$,p[6]):$,d[6]=te?nc(d[5],wn):p[6]),($=p[7])&&(d[7]=$),128&C&&(d[8]=null==d[8]?p[8]:Yn(d[8],p[8])),null==d[9]&&(d[9]=p[9]),d[0]=p[0],d[1]=A}(St,nt),d=St[0],p=St[1],b=St[2],C=St[3],A=St[4],!($=St[9]=St[9]===N?te?0:d.length:Br(St[9]-Me,0))&&24&p&&(p&=-25),p&&1!=p)Bt=8==p||16==p?function gD(d,p,b){var C=ds(d);return function A(){for(var F=arguments.length,G=de(F),$=F,te=cu(A);$--;)G[$]=arguments[$];var Me=F<3&&G[0]!==te&&G[F-1]!==te?[]:nc(G,te);return(F-=Me.length)<b?Zm(d,p,sd,A.placeholder,N,G,Me,N,N,b-F):Vo(this&&this!==Ar&&this instanceof A?C:d,this,G)}}(d,p,$):32!=p&&33!=p||A.length?sd.apply(N,St):function Rf(d,p,b,C){var A=1&p,F=ds(d);return function G(){for(var $=-1,te=arguments.length,Me=-1,Se=C.length,Re=de(Se+te),nt=this&&this!==Ar&&this instanceof G?F:d;++Me<Se;)Re[Me]=C[Me];for(;te--;)Re[Me++]=arguments[++$];return Vo(nt,A?b:this,Re)}}(d,p,b,C);else var Bt=function SM(d,p,b){var C=1&p,A=ds(d);return function F(){return(this&&this!==Ar&&this instanceof F?A:d).apply(C?b:this,arguments)}}(d,p,b);return UM((nt?Mn:mp)(Bt,St),d,p)}function _D(d,p,b,C){return d===N||zs(d,Zc[b])&&!si.call(C,b)?p:d}function TM(d,p,b,C,A,F){return Gi(d)&&Gi(p)&&(F.set(p,d),Ef(d,p,N,TM,F),F.delete(p)),d}function AM(d){return jf(d)?N:d}function dv(d,p,b,C,A,F){var G=1&b,$=d.length,te=p.length;if($!=te&&!(G&&te>$))return!1;var Me=F.get(d),Se=F.get(p);if(Me&&Se)return Me==p&&Se==d;var Re=-1,nt=!0,St=2&b?new ou:N;for(F.set(d,p),F.set(p,d);++Re<$;){var Bt=d[Re],Dn=p[Re];if(C)var Wt=G?C(Dn,Bt,Re,p,d,F):C(Bt,Dn,Re,d,p,F);if(Wt!==N){if(Wt)continue;nt=!1;break}if(St){if(!Ty(p,function(On,Wn){if(!j(St,Wn)&&(Bt===On||A(Bt,On,b,C,F)))return St.push(Wn)})){nt=!1;break}}else if(Bt!==Dn&&!A(Bt,Dn,b,C,F)){nt=!1;break}}return F.delete(d),F.delete(p),nt}function $a(d){return mv(Lf(d,N,_v),d+"")}function ad(d){return $y(d,Dr,hv)}function fv(d){return $y(d,Ro,pp)}var ld=td?function(d){return td.get(d)}:ib;function Ff(d){for(var p=d.name+"",b=Zn[p],C=si.call(Zn,p)?b.length:0;C--;){var A=b[C],F=A.func;if(null==F||F==d)return A.name}return p}function cu(d){return(si.call(O,"placeholder")?O:d).placeholder}function Vt(){var d=O.iteratee||nb;return d=d===nb?Um:d,arguments.length?d(arguments[0],arguments[1]):d}function hp(d,p){var b=d.__data__;return function vD(d){var p=typeof d;return"string"==p||"number"==p||"symbol"==p||"boolean"==p?"__proto__"!==d:null===d}(p)?b["string"==typeof p?"string":"hash"]:b.map}function Km(d){for(var p=Dr(d),b=p.length;b--;){var C=p[b],A=d[C];p[b]=[C,A,ur(A)]}return p}function ud(d,p){var b=function qA(X,ye){return null==X?N:X[ye]}(d,p);return Cf(b)?b:N}var hv=Bs?function(d){return null==d?[]:(d=Tn(d),eu(Bs(d),function(p){return ic.call(d,p)}))}:D0,pp=Bs?function(d){for(var p=[];d;)Ju(p,hv(d)),d=Qc(d);return p}:D0,eo=Jt;function Qm(d,p,b){for(var C=-1,A=(p=cc(p,d)).length,F=!1;++C<A;){var G=Xa(p[C]);if(!(F=null!=d&&b(d,G)))break;d=d[G]}return F||++C!=A?F:!!(A=null==d?0:d.length)&&zf(A)&&du(G,A)&&(ln(d)||gs(d))}function pv(d){return"function"!=typeof d.constructor||qa(d)?{}:zo(Qc(d))}function OM(d){return ln(d)||gs(d)||!!(iM&&d&&d[iM])}function du(d,p){var b=typeof d;return!!(p=p??pl)&&("number"==b||"symbol"!=b&&Nt.test(d))&&d>-1&&d%1==0&&d<p}function to(d,p,b){if(!Gi(b))return!1;var C=typeof p;return!!("number"==C?io(b)&&du(p,b.length):"string"==C&&p in b)&&zs(b[p],d)}function cd(d,p){if(ln(d))return!1;var b=typeof d;return!("number"!=b&&"symbol"!=b&&"boolean"!=b&&null!=d&&!ms(d))||nf.test(d)||!hm.test(d)||null!=p&&d in Tn(p)}function e0(d){var p=Ff(d),b=O[p];if("function"!=typeof b||!(p in An.prototype))return!1;if(d===b)return!0;var C=ld(b);return!!C&&d===C[0]}(Uy&&eo(new Uy(new ArrayBuffer(1)))!=_l||tp&&eo(new tp)!=oi||Vy&&eo(Vy.resolve())!=la||yf&&eo(new yf)!=fo||np&&eo(new np)!=Xi)&&(eo=function(d){var p=Jt(d),b=p==pi?d.constructor:N,C=b?dd(b):"";if(C)switch(C){case Pe:return _l;case kt:return oi;case ar:return la;case Ao:return fo;case Yr:return Xi}return p});var fc=Kc?Tl:pc;function qa(d){var p=d&&d.constructor;return d===("function"==typeof p&&p.prototype||Zc)}function ur(d){return d==d&&!Gi(d)}function FM(d,p){return function(b){return null!=b&&b[d]===p&&(p!==N||d in Tn(b))}}function Lf(d,p,b){return p=Br(p===N?d.length-1:p,0),function(){for(var C=arguments,A=-1,F=Br(C.length-p,0),G=de(F);++A<F;)G[A]=C[p+A];A=-1;for(var $=de(p+1);++A<p;)$[A]=C[A];return $[p]=b(G),Vo(d,this,$)}}function kM(d,p){return p.length<2?d:uc(d,_r(p,0,-1))}function gp(d,p){if(("constructor"!==p||"function"!=typeof d[p])&&"__proto__"!=p)return d[p]}var mp=VM(Mn),kf=QA||function(d,p){return Ar.setTimeout(d,p)},mv=VM(wM);function UM(d,p,b){var C=p+"";return mv(d,function PM(d,p){var b=p.length;if(!b)return d;var C=b-1;return p[C]=(b>1?"& ":"")+p[C],p=p.join(b>2?", ":" "),d.replace(Kn,"{\n/* [wrapped with "+p+"] */\n")}(C,function wD(d,p){return Ls(Be,function(b){var C="_."+b[0];p&b[1]&&!Kt(d,C)&&d.push(C)}),d.sort()}(function Jm(d){var p=d.match(Zu);return p?p[1].split(xA):[]}(C),b)))}function VM(d){var p=0,b=0;return function(){var C=oM(),A=16-(C-b);if(b=C,A>0){if(++p>=800)return arguments[0]}else p=0;return d.apply(N,arguments)}}function _p(d,p){var b=-1,C=d.length,A=C-1;for(p=p===N?C:p;++b<p;){var F=Qy(b,A),G=d[F];d[F]=d[b],d[b]=G}return d.length=p,d}var HM=function Vn(d){var p=ma(d,function(C){return 500===b.size&&b.clear(),C}),b=p.cache;return p}(function(d){var p=[];return 46===d.charCodeAt(0)&&p.push(""),d.replace(zx,function(b,C,A,F){p.push(A?F.replace(Xr,"$1"):C||b)}),p});function Xa(d){if("string"==typeof d||ms(d))return d;var p=d+"";return"0"==p&&1/d==-Vi?"-0":p}function dd(d){if(null!=d){try{return By.call(d)}catch{}try{return d+""}catch{}}return""}function xD(d){if(d instanceof An)return d.clone();var p=new Kr(d.__wrapped__,d.__chain__);return p.__actions__=cs(d.__actions__),p.__index__=d.__index__,p.__values__=d.__values__,p}var tL=K(function(d,p){return cr(d)?Fm(d,Qr(p,1,cr,!0)):[]}),MD=K(function(d,p){var b=Wo(p);return cr(b)&&(b=N),cr(d)?Fm(d,Qr(p,1,cr,!0),Vt(b,2)):[]}),nL=K(function(d,p){var b=Wo(p);return cr(b)&&(b=N),cr(d)?Fm(d,Qr(p,1,cr,!0),N,b):[]});function fd(d,p,b){var C=null==d?0:d.length;if(!C)return-1;var A=null==b?0:un(b);return A<0&&(A=Br(C+A,0)),ho(d,Vt(p,3),A)}function SD(d,p,b){var C=null==d?0:d.length;if(!C)return-1;var A=C-1;return b!==N&&(A=un(b),A=b<0?Br(C+A,0):Yn(A,C-1)),ho(d,Vt(p,3),A,!0)}function _v(d){return null!=d&&d.length?Qr(d,1):[]}function qM(d){return d&&d.length?d[0]:N}var XM=K(function(d){var p=sr(d,iv);return p.length&&p[0]===d[0]?lu(p):[]}),YM=K(function(d){var p=Wo(d),b=sr(d,iv);return p===Wo(b)?p=N:b.pop(),b.length&&b[0]===d[0]?lu(b,Vt(p,2)):[]}),iL=K(function(d){var p=Wo(d),b=sr(d,iv);return(p="function"==typeof p?p:N)&&b.pop(),b.length&&b[0]===d[0]?lu(b,N,p):[]});function Wo(d){var p=null==d?0:d.length;return p?d[p-1]:N}var TD=K(t0);function t0(d,p){return d&&d.length&&p&&p.length?Jy(d,p):d}var bv=$a(function(d,p){var b=null==d?0:d.length,C=dM(d,p);return bM(d,sr(p,function(A){return du(A,b)?+A:A}).sort(sv)),C});function n0(d){return null==d?d:nD.call(d)}var Bf=K(function(d){return uu(Qr(d,1,cr,!0))}),gi=K(function(d){var p=Wo(d);return cr(p)&&(p=N),uu(Qr(d,1,cr,!0),Vt(p,2))}),eC=K(function(d){var p=Wo(d);return p="function"==typeof p?p:N,uu(Qr(d,1,cr,!0),N,p)});function Uf(d){if(!d||!d.length)return[];var p=0;return d=eu(d,function(b){if(cr(b))return p=Br(b.length,p),!0}),Py(p,function(b){return sr(d,qh(b))})}function xv(d,p){if(!d||!d.length)return[];var b=Uf(d);return null==p?b:sr(b,function(C){return Vo(p,N,C)})}var kD=K(function(d,p){return cr(d)?Fm(d,p):[]}),nC=K(function(d){return us(eu(d,cr))}),vp=K(function(d){var p=Wo(d);return cr(p)&&(p=N),us(eu(d,cr),Vt(p,2))}),BD=K(function(d){var p=Wo(d);return p="function"==typeof p?p:N,us(eu(d,cr),N,p)}),Mv=K(Uf),wp=K(function(d){var p=d.length,b=p>1?d[p-1]:N;return b="function"==typeof b?(d.pop(),b):N,xv(d,b)});function Cv(d){var p=O(d);return p.__chain__=!0,p}function hd(d,p){return p(d)}var UD=$a(function(d){var p=d.length,b=p?d[0]:0,C=this.__wrapped__,A=function(F){return dM(F,d)};return!(p>1||this.__actions__.length)&&C instanceof An&&du(b)?((C=C.slice(b,+b+(p?1:0))).__actions__.push({func:hd,args:[A],thisArg:N}),new Kr(C,this.__chain__).thru(function(F){return p&&!F.length&&F.push(N),F})):this.thru(A)}),Ev=cp(function(d,p,b){si.call(d,b)?++d[b]:ac(d,b,1)}),ps=$m(fd),xp=$m(SD);function Dv(d,p){return(ln(d)?Ls:lc)(d,Vt(p,3))}function aC(d,p){return(ln(d)?Ql:jy)(d,Vt(p,3))}var lC=cp(function(d,p,b){si.call(d,b)?d[b].push(p):ac(d,b,[p])}),uC=K(function(d,p,b){var C=-1,A="function"==typeof p,F=io(d)?de(d.length):[];return lc(d,function(G){F[++C]=A?Vo(p,G,b):Vr(G,p,b)}),F}),$D=cp(function(d,p,b){ac(d,b,p)});function o0(d,p){return(ln(d)?sr:_M)(d,Vt(p,3))}var XD=cp(function(d,p,b){d[b?0:1].push(p)},function(){return[[],[]]}),YD=K(function(d,p){if(null==d)return[];var b=p.length;return b>1&&to(d,p[0],p[1])?p=[]:b>2&&to(p[0],p[1],p[2])&&(p=[p[0]]),vM(d,Qr(p,1),[])}),a0=JA||function(){return Ar.Date.now()};function _C(d,p,b){return p=b?N:p,dc(d,128,N,N,N,N,p=d&&null==p?d.length:p)}function yC(d,p){var b;if("function"!=typeof p)throw new Ha(Ut);return d=un(d),function(){return--d>0&&(b=p.apply(this,arguments)),d<=1&&(p=N),b}}var l0=K(function(d,p,b){var C=1;if(b.length){var A=nc(b,cu(l0));C|=32}return dc(d,C,p,b,A)}),vC=K(function(d,p,b){var C=3;if(b.length){var A=nc(b,cu(vC));C|=32}return dc(p,C,d,b,A)});function Iv(d,p,b){var C,A,F,G,$,te,Me=0,Se=!1,Re=!1,nt=!0;if("function"!=typeof d)throw new Ha(Ut);function St(Cr){var va=C,Al=A;return C=A=N,Me=Cr,G=d.apply(Al,va)}function Wt(Cr){var va=Cr-te;return te===N||va>=p||va<0||Re&&Cr-Me>=F}function On(){var Cr=a0();if(Wt(Cr))return Wn(Cr);$=kf(On,function Dn(Cr){var eS=p-(Cr-te);return Re?Yn(eS,F-(Cr-Me)):eS}(Cr))}function Wn(Cr){return $=N,nt&&C?St(Cr):(C=A=N,G)}function js(){var Cr=a0(),va=Wt(Cr);if(C=arguments,A=this,te=Cr,va){if($===N)return function Bt(Cr){return Me=Cr,$=kf(On,p),Se?St(Cr):G}(te);if(Re)return Gm($),$=kf(On,p),St(te)}return $===N&&($=kf(On,p)),G}return p=_a(p)||0,Gi(b)&&(Se=!!b.leading,F=(Re="maxWait"in b)?Br(_a(b.maxWait)||0,p):F,nt="trailing"in b?!!b.trailing:nt),js.cancel=function Gs(){$!==N&&Gm($),Me=0,C=te=A=$=N},js.flush=function Yo(){return $===N?G:Wn(a0())},js}var Rv=K(function(d,p){return oD(d,1,p)}),KD=K(function(d,p,b){return oD(d,_a(p)||0,b)});function ma(d,p){if("function"!=typeof d||null!=p&&"function"!=typeof p)throw new Ha(Ut);var b=function(){var C=arguments,A=p?p.apply(this,C):C[0],F=b.cache;if(F.has(A))return F.get(A);var G=d.apply(this,C);return b.cache=F.set(A,G)||F,G};return b.cache=new(ma.Cache||Jr),b}function u0(d){if("function"!=typeof d)throw new Ha(Ut);return function(){var p=arguments;switch(p.length){case 0:return!d.call(this);case 1:return!d.call(this,p[0]);case 2:return!d.call(this,p[0],p[1]);case 3:return!d.call(this,p[0],p[1],p[2])}return!d.apply(this,p)}}ma.Cache=Jr;var Vf=hD(function(d,p){var b=(p=1==p.length&&ln(p[0])?sr(p[0],Ze(Vt())):sr(Qr(p,1),Ze(Vt()))).length;return K(function(C){for(var A=-1,F=Yn(C.length,b);++A<F;)C[A]=p[A].call(this,C[A]);return Vo(d,this,C)})}),xC=K(function(d,p){var b=nc(p,cu(xC));return dc(d,32,N,p,b)}),Ov=K(function(d,p){var b=nc(p,cu(Ov));return dc(d,64,N,p,b)}),MC=$a(function(d,p){return dc(d,256,N,N,N,p)});function zs(d,p){return d===p||d!=d&&p!=p}var Mp=Of(sp),d0=Of(function(d,p){return d>=p}),gs=gM(function(){return arguments}())?gM:function(d){return Si(d)&&si.call(d,"callee")&&!ic.call(d,"callee")},ln=de.isArray,f0=BA?Ze(BA):function qy(d){return Si(d)&&Jt(d)==Yi};function io(d){return null!=d&&zf(d.length)&&!Tl(d)}function cr(d){return Si(d)&&io(d)}var Za=rM||pc,SC=UA?Ze(UA):function lD(d){return Si(d)&&Jt(d)==an};function h0(d){if(!Si(d))return!1;var p=Jt(d);return p==_i||"[object DOMException]"==p||"string"==typeof d.message&&"string"==typeof d.name&&!jf(d)}function Tl(d){if(!Gi(d))return!1;var p=Jt(d);return p==Ii||p==To||"[object AsyncFunction]"==p||"[object Proxy]"==p}function Vv(d){return"number"==typeof d&&d==un(d)}function zf(d){return"number"==typeof d&&d>-1&&d%1==0&&d<=pl}function Gi(d){var p=typeof d;return null!=d&&("object"==p||"function"==p)}function Si(d){return null!=d&&"object"==typeof d}var Hv=VA?Ze(VA):function Xy(d){return Si(d)&&eo(d)==oi};function Gv(d){return"number"==typeof d||Si(d)&&Jt(d)==Gt}function jf(d){if(!Si(d)||Jt(d)!=pi)return!1;var p=Qc(d);if(null===p)return!0;var b=si.call(p,"constructor")&&p.constructor;return"function"==typeof b&&b instanceof b&&By.call(b)==nM}var g0=HA?Ze(HA):function Yy(d){return Si(d)&&Jt(d)==Fs},jv=wm?Ze(wm):function Sf(d){return Si(d)&&eo(d)==fo};function m0(d){return"string"==typeof d||!ln(d)&&Si(d)&&Jt(d)==gl}function ms(d){return"symbol"==typeof d||Si(d)&&Jt(d)==yn}var Cp=Xc?Ze(Xc):function Bm(d){return Si(d)&&zf(d.length)&&!!zi[Jt(d)]},vi=Of(ap),Wf=Of(function(d,p){return d<=p});function pd(d){if(!d)return[];if(io(d))return m0(d)?fa(d):cs(d);if(ep&&d[ep])return function Oy(X){for(var ye,de=[];!(ye=X.next()).done;)de.push(ye.value);return de}(d[ep]());var p=eo(d);return(p==oi?Ny:p==fo?po:_d)(d)}function go(d){return d?(d=_a(d))===Vi||d===-Vi?17976931348623157e292*(d<0?-1:1):d==d?d:0:0===d?d:0}function un(d){var p=go(d),b=p%1;return p==p?b?p-b:p:0}function Sp(d){return d?xf(un(d),0,Ye):0}function _a(d){if("number"==typeof d)return d;if(ms(d))return NaN;if(Gi(d)){var p="function"==typeof d.valueOf?d.valueOf():d;d=Gi(p)?p+"":p}if("string"!=typeof d)return 0===d?d:+d;d=eM(d);var b=or.test(d);return b||SA.test(d)?kA(d.slice(2),b?2:8):jx.test(d)?NaN:+d}function IC(d){return Pi(d,Ro(d))}function ci(d){return null==d?"":ls(d)}var qf=If(function(d,p){if(qa(p)||io(p))Pi(p,Dr(p),d);else for(var b in p)si.call(p,b)&&Nm(d,b,p[b])}),RC=If(function(d,p){Pi(p,Ro(p),d)}),Ep=If(function(d,p,b,C){Pi(p,Ro(p),d,C)}),Tp=If(function(d,p,b,C){Pi(p,Dr(p),d,C)}),y0=$a(dM),OC=K(function(d,p){d=Tn(d);var b=-1,C=p.length,A=C>2?p[2]:N;for(A&&to(p[0],p[1],A)&&(C=1);++b<C;)for(var F=p[b],G=Ro(F),$=-1,te=G.length;++$<te;){var Me=G[$],Se=d[Me];(Se===N||zs(Se,Zc[Me])&&!si.call(d,Me))&&(d[Me]=F[Me])}return d}),Ap=K(function(d){return d.push(N,TM),Vo(gd,N,d)});function $v(d,p,b){var C=null==d?N:uc(d,p);return C===N?b:C}function v0(d,p){return null!=d&&Qm(d,p,jo)}var sI=qm(function(d,p,b){null!=p&&"function"!=typeof p.toString&&(p=Jh.call(p)),d[p]=b},tb(Xo)),cL=qm(function(d,p,b){null!=p&&"function"!=typeof p.toString&&(p=Jh.call(p)),si.call(d,p)?d[p].push(b):d[p]=[b]},Vt),b0=K(Vr);function Dr(d){return io(d)?uM(d):Wa(d)}function Ro(d){return io(d)?uM(d,!0):function Zy(d){if(!Gi(d))return function bD(d){var p=[];if(null!=d)for(var b in Tn(d))p.push(b);return p}(d);var p=qa(d),b=[];for(var C in d)"constructor"==C&&(p||!si.call(d,C))||b.push(C);return b}(d)}var x0=If(function(d,p,b){Ef(d,p,b)}),gd=If(function(d,p,b,C){Ef(d,p,b,C)}),qv=$a(function(d,p){var b={};if(null==d)return b;var C=!1;p=sr(p,function(F){return F=cc(F,d),C||(C=F.length>1),F}),Pi(d,fv(d),b),C&&(b=Vs(b,7,AM));for(var A=p.length;A--;)Af(b,p[A]);return b}),LC=$a(function(d,p){return null==d?{}:function uD(d,p){return Vm(d,p,function(b,C){return v0(d,C)})}(d,p)});function Yv(d,p){if(null==d)return{};var b=sr(fv(d),function(C){return[C]});return p=Vt(p),Vm(d,b,function(C,A){return p(C,A[0])})}var md=EM(Dr),Yf=EM(Ro);function _d(d){return null==d?[]:Cm(d,Dr(d))}var fL=Cl(function(d,p,b){return p=p.toLowerCase(),d+(b?M0(p):p)});function M0(d){return Qv(ci(d).toLowerCase())}function fI(d){return(d=ci(d))&&d.replace(H2,jA).replace($2,"")}var VC=Cl(function(d,p,b){return d+(b?"-":"")+p.toLowerCase()}),pI=Cl(function(d,p,b){return d+(b?" ":"")+p.toLowerCase()}),gI=uv("toLowerCase"),Kv=Cl(function(d,p,b){return d+(b?"_":"")+p.toLowerCase()}),hL=Cl(function(d,p,b){return d+(b?" ":"")+Qv(p)}),jC=Cl(function(d,p,b){return d+(b?" ":"")+p.toUpperCase()}),Qv=uv("toUpperCase");function eb(d,p,b){return d=ci(d),(p=b?N:p)===N?function XA(X){return X2.test(X)}(d)?function YA(X){return X.match(q2)||[]}(d):function Dy(X){return X.match(MA)||[]}(d):d.match(p)||[]}var E0=K(function(d,p){try{return Vo(d,N,p)}catch(b){return h0(b)?b:new Pt(b)}}),WC=$a(function(d,p){return Ls(p,function(b){b=Xa(b),ac(d,b,l0(d[b],d))}),d});function tb(d){return function(){return d}}var wI=dp(),xI=dp(!0);function Xo(d){return d}function nb(d){return Um("function"==typeof d?d:Vs(d,1))}var SI=K(function(d,p){return function(b){return Vr(b,d,p)}}),EI=K(function(d,p){return function(b){return Vr(d,b,p)}});function Op(d,p,b){var C=Dr(p),A=Qn(p,C);null==b&&(!Gi(p)||!A.length&&C.length)&&(b=p,p=d,d=this,A=Qn(p,Dr(p)));var F=!(Gi(b)&&"chain"in b&&!b.chain),G=Tl(d);return Ls(A,function($){var te=p[$];d[$]=te,G&&(d.prototype[$]=function(){var Me=this.__chain__;if(F||Me){var Se=d(this.__wrapped__);return(Se.__actions__=cs(this.__actions__)).push({func:te,args:arguments,thisArg:d}),Se.__chain__=Me,Se}return te.apply(d,Ju([this.value()],arguments))})}),d}function ib(){}var qC=Xm(sr),AI=Xm(cf),XC=Xm(Ty);function T0(d){return cd(d)?qh(Xa(d)):function rd(d){return function(p){return uc(p,d)}}(d)}var ya=Pf(),A0=Pf(!0);function D0(){return[]}function pc(){return!1}var JC=fp(function(d,p){return d+p},0),II=cv("ceil"),RI=fp(function(d,p){return d/p},1),PI=cv("floor"),vL=fp(function(d,p){return d*p},1),bL=cv("round"),wL=fp(function(d,p){return d-p},0);return O.after=function ZD(d,p){if("function"!=typeof p)throw new Ha(Ut);return d=un(d),function(){if(--d<1)return p.apply(this,arguments)}},O.ary=_C,O.assign=qf,O.assignIn=RC,O.assignInWith=Ep,O.assignWith=Tp,O.at=y0,O.before=yC,O.bind=l0,O.bindAll=WC,O.bindKey=vC,O.castArray=function tI(){if(!arguments.length)return[];var d=arguments[0];return ln(d)?d:[d]},O.chain=Cv,O.chunk=function zM(d,p,b){p=(b?to(d,p,b):p===N)?1:Br(un(p),0);var C=null==d?0:d.length;if(!C||p<1)return[];for(var A=0,F=0,G=de(Im(C/p));A<C;)G[F++]=_r(d,A,A+=p);return G},O.compact=function GM(d){for(var p=-1,b=null==d?0:d.length,C=0,A=[];++p<b;){var F=d[p];F&&(A[C++]=F)}return A},O.concat=function no(){var d=arguments.length;if(!d)return[];for(var p=de(d-1),b=arguments[0],C=d;C--;)p[C-1]=arguments[C];return Ju(ln(b)?cs(b):[b],Qr(p,1))},O.cond=function yd(d){var p=null==d?0:d.length,b=Vt();return d=p?sr(d,function(C){if("function"!=typeof C[1])throw new Ha(Ut);return[b(C[0]),C[1]]}):[],K(function(C){for(var A=-1;++A<p;){var F=d[A];if(Vo(F[0],this,C))return Vo(F[1],this,C)}})},O.conforms=function $C(d){return function fM(d){var p=Dr(d);return function(b){return rD(b,d,p)}}(Vs(d,1))},O.constant=tb,O.countBy=Ev,O.create=function PC(d,p){var b=zo(d);return null==p?b:Gy(b,p)},O.curry=function bC(d,p,b){var C=dc(d,8,N,N,N,N,N,p=b?N:p);return C.placeholder=bC.placeholder,C},O.curryRight=function wC(d,p,b){var C=dc(d,16,N,N,N,N,N,p=b?N:p);return C.placeholder=wC.placeholder,C},O.debounce=Iv,O.defaults=OC,O.defaultsDeep=Ap,O.defer=Rv,O.delay=KD,O.difference=tL,O.differenceBy=MD,O.differenceWith=nL,O.drop=function jM(d,p,b){var C=null==d?0:d.length;return C?_r(d,(p=b||p===N?1:un(p))<0?0:p,C):[]},O.dropRight=function Hs(d,p,b){var C=null==d?0:d.length;return C?_r(d,0,(p=C-(p=b||p===N?1:un(p)))<0?0:p):[]},O.dropRightWhile=function WM(d,p){return d&&d.length?ga(d,Vt(p,3),!0,!0):[]},O.dropWhile=function CD(d,p){return d&&d.length?ga(d,Vt(p,3),!0):[]},O.fill=function fu(d,p,b,C){var A=null==d?0:d.length;return A?(b&&"number"!=typeof b&&to(d,p,b)&&(b=0,C=A),function sD(d,p,b,C){var A=d.length;for((b=un(b))<0&&(b=-b>A?0:A+b),(C=C===N||C>A?A:un(C))<0&&(C+=A),C=b>C?0:Sp(C);b<C;)d[b++]=p;return d}(d,p,b,C)):[]},O.filter=function Tv(d,p){return(ln(d)?eu:hM)(d,Vt(p,3))},O.flatMap=function Av(d,p){return Qr(o0(d,p),1)},O.flatMapDeep=function sC(d,p){return Qr(o0(d,p),Vi)},O.flatMapDepth=function jD(d,p,b){return b=b===N?1:un(b),Qr(o0(d,p),b)},O.flatten=_v,O.flattenDeep=function yv(d){return null!=d&&d.length?Qr(d,Vi):[]},O.flattenDepth=function hu(d,p){return null!=d&&d.length?Qr(d,p=p===N?1:un(p)):[]},O.flip=function El(d){return dc(d,512)},O.flow=wI,O.flowRight=xI,O.fromPairs=function $M(d){for(var p=-1,b=null==d?0:d.length,C={};++p<b;){var A=d[p];C[A[0]]=A[1]}return C},O.functions=function NC(d){return null==d?[]:Qn(d,Dr(d))},O.functionsIn=function FC(d){return null==d?[]:Qn(d,Ro(d))},O.groupBy=lC,O.initial=function yp(d){return null!=d&&d.length?_r(d,0,-1):[]},O.intersection=XM,O.intersectionBy=YM,O.intersectionWith=iL,O.invert=sI,O.invertBy=cL,O.invokeMap=uC,O.iteratee=nb,O.keyBy=$D,O.keys=Dr,O.keysIn=Ro,O.map=o0,O.mapKeys=function Xf(d,p){var b={};return p=Vt(p,3),pa(d,function(C,A,F){ac(b,p(C,A,F),C)}),b},O.mapValues=function w0(d,p){var b={};return p=Vt(p,3),pa(d,function(C,A,F){ac(b,A,p(C,A,F))}),b},O.matches=function MI(d){return Qt(Vs(d,1))},O.matchesProperty=function CI(d,p){return lp(d,Vs(p,1))},O.memoize=ma,O.merge=x0,O.mergeWith=gd,O.method=SI,O.methodOf=EI,O.mixin=Op,O.negate=u0,O.nthArg=function rb(d){return d=un(d),K(function(p){return yM(p,d)})},O.omit=qv,O.omitBy=function Xv(d,p){return Yv(d,u0(Vt(p)))},O.once=function Pv(d){return yC(2,d)},O.orderBy=function qD(d,p,b,C){return null==d?[]:(ln(p)||(p=null==p?[]:[p]),ln(b=C?N:b)||(b=null==b?[]:[b]),vM(d,p,b))},O.over=qC,O.overArgs=Vf,O.overEvery=AI,O.overSome=XC,O.partial=xC,O.partialRight=Ov,O.partition=XD,O.pick=LC,O.pickBy=Yv,O.property=T0,O.propertyOf=function ob(d){return function(p){return null==d?N:uc(d,p)}},O.pull=TD,O.pullAll=t0,O.pullAllBy=function AD(d,p,b){return d&&d.length&&p&&p.length?Jy(d,p,Vt(b,2)):d},O.pullAllWith=function DD(d,p,b){return d&&d.length&&p&&p.length?Jy(d,p,N,b):d},O.pullAt=bv,O.range=ya,O.rangeRight=A0,O.rearg=MC,O.reject=function fC(d,p){return(ln(d)?eu:hM)(d,u0(Vt(p,3)))},O.remove=function ZM(d,p){var b=[];if(!d||!d.length)return b;var C=-1,A=[],F=d.length;for(p=Vt(p,3);++C<F;){var G=d[C];p(G,C,d)&&(b.push(G),A.push(C))}return bM(d,A),b},O.rest=function JD(d,p){if("function"!=typeof d)throw new Ha(Ut);return K(d,p=p===N?p:un(p))},O.reverse=n0,O.sampleSize=function hC(d,p,b){return p=(b?to(d,p,b):p===N)?1:un(p),(ln(d)?K2:qe)(d,p)},O.set=function aI(d,p,b){return null==d?d:He(d,p,b)},O.setWith=function lI(d,p,b,C){return C="function"==typeof C?C:N,null==d?d:He(d,p,b,C)},O.shuffle=function pC(d){return(ln(d)?J2:up)(d)},O.slice=function wv(d,p,b){var C=null==d?0:d.length;return C?(b&&"number"!=typeof b&&to(d,p,b)?(p=0,b=C):(p=null==p?0:un(p),b=b===N?C:un(b)),_r(d,p,b)):[]},O.sortBy=YD,O.sortedUniq=function JM(d){return d&&d.length?dD(d):[]},O.sortedUniqBy=function rL(d,p){return d&&d.length?dD(d,Vt(p,2)):[]},O.split=function yI(d,p,b){return b&&"number"!=typeof b&&to(d,p,b)&&(p=b=N),(b=b===N?Ye:b>>>0)?(d=ci(d))&&("string"==typeof p||null!=p&&!g0(p))&&!(p=ls(p))&&ec(d)?Ml(fa(d),0,b):d.split(p,b):[]},O.spread=function QD(d,p){if("function"!=typeof d)throw new Ha(Ut);return p=null==p?0:Br(un(p),0),K(function(b){var C=b[p],A=Ml(b,0,p);return C&&Ju(A,C),Vo(d,this,A)})},O.tail=function oL(d){var p=null==d?0:d.length;return p?_r(d,1,p):[]},O.take=function QM(d,p,b){return d&&d.length?_r(d,0,(p=b||p===N?1:un(p))<0?0:p):[]},O.takeRight=function ND(d,p,b){var C=null==d?0:d.length;return C?_r(d,(p=C-(p=b||p===N?1:un(p)))<0?0:p,C):[]},O.takeRightWhile=function FD(d,p){return d&&d.length?ga(d,Vt(p,3),!1,!0):[]},O.takeWhile=function LD(d,p){return d&&d.length?ga(d,Vt(p,3)):[]},O.tap=function r0(d,p){return p(d),d},O.throttle=function aL(d,p,b){var C=!0,A=!0;if("function"!=typeof d)throw new Ha(Ut);return Gi(b)&&(C="leading"in b?!!b.leading:C,A="trailing"in b?!!b.trailing:A),Iv(d,p,{leading:C,maxWait:p,trailing:A})},O.thru=hd,O.toArray=pd,O.toPairs=md,O.toPairsIn=Yf,O.toPath=function ZC(d){return ln(d)?sr(d,Xa):ms(d)?[d]:cs(HM(ci(d)))},O.toPlainObject=IC,O.transform=function kC(d,p,b){var C=ln(d),A=C||Za(d)||Cp(d);if(p=Vt(p,4),null==b){var F=d&&d.constructor;b=A?C?new F:[]:Gi(d)&&Tl(F)?zo(Qc(d)):{}}return(A?Ls:pa)(d,function(G,$,te){return p(b,G,$,te)}),b},O.unary=function eI(d){return _C(d,1)},O.union=Bf,O.unionBy=gi,O.unionWith=eC,O.uniq=function tC(d){return d&&d.length?uu(d):[]},O.uniqBy=function sL(d,p){return d&&d.length?uu(d,Vt(p,2)):[]},O.uniqWith=function fs(d,p){return p="function"==typeof p?p:N,d&&d.length?uu(d,N,p):[]},O.unset=function uI(d,p){return null==d||Af(d,p)},O.unzip=Uf,O.unzipWith=xv,O.update=function BC(d,p,b){return null==d?d:Io(d,p,zm(b))},O.updateWith=function dL(d,p,b,C){return C="function"==typeof C?C:N,null==d?d:Io(d,p,zm(b),C)},O.values=_d,O.valuesIn=function cI(d){return null==d?[]:Cm(d,Ro(d))},O.without=kD,O.words=eb,O.wrap=function hc(d,p){return xC(zm(p),d)},O.xor=nC,O.xorBy=vp,O.xorWith=BD,O.zip=Mv,O.zipObject=function iC(d,p){return xl(d||[],p||[],Nm)},O.zipObjectDeep=function bp(d,p){return xl(d||[],p||[],He)},O.zipWith=wp,O.entries=md,O.entriesIn=Yf,O.extend=RC,O.extendWith=Ep,Op(O,O),O.add=JC,O.attempt=E0,O.camelCase=fL,O.capitalize=M0,O.ceil=II,O.clamp=function UC(d,p,b){return b===N&&(b=p,p=N),b!==N&&(b=(b=_a(b))==b?b:0),p!==N&&(p=(p=_a(p))==p?p:0),xf(_a(d),p,b)},O.clone=function Nv(d){return Vs(d,4)},O.cloneDeep=function Lv(d){return Vs(d,5)},O.cloneDeepWith=function CC(d,p){return Vs(d,5,p="function"==typeof p?p:N)},O.cloneWith=function Fv(d,p){return Vs(d,4,p="function"==typeof p?p:N)},O.conformsTo=function c0(d,p){return null==p||rD(d,p,Dr(p))},O.deburr=fI,O.defaultTo=function bI(d,p){return null==d||d!=d?p:d},O.divide=RI,O.endsWith=function C0(d,p,b){d=ci(d),p=ls(p);var C=d.length,A=b=b===N?C:xf(un(b),0,C);return(b-=p.length)>=0&&d.slice(b,A)==p},O.eq=zs,O.escape=function Dp(d){return(d=ci(d))&&Gc.test(d)?d.replace(zc,WA):d},O.escapeRegExp=function hI(d){return(d=ci(d))&&da.test(d)?d.replace(ka,"\\$&"):d},O.every=function oC(d,p,b){var C=ln(d)?cf:as;return b&&to(d,p,b)&&(p=N),C(d,Vt(p,3))},O.find=ps,O.findIndex=fd,O.findKey=function qo(d,p){return Iy(d,Vt(p,3),pa)},O.findLast=xp,O.findLastIndex=SD,O.findLastKey=function iI(d,p){return Iy(d,Vt(p,3),Wy)},O.floor=PI,O.forEach=Dv,O.forEachRight=aC,O.forIn=function ro(d,p){return null==d?d:Lm(d,Vt(p,3),Ro)},O.forInRight=function rI(d,p){return null==d?d:pM(d,Vt(p,3),Ro)},O.forOwn=function oI(d,p){return d&&pa(d,Vt(p,3))},O.forOwnRight=function Wv(d,p){return d&&Wy(d,Vt(p,3))},O.get=$v,O.gt=Mp,O.gte=d0,O.has=function uL(d,p){return null!=d&&Qm(d,p,Mf)},O.hasIn=v0,O.head=qM,O.identity=Xo,O.includes=function WD(d,p,b,C){d=io(d)?d:_d(d),b=b&&!C?un(b):0;var A=d.length;return b<0&&(b=Br(A+b,0)),m0(d)?b<=A&&d.indexOf(p,b)>-1:!!A&&Yc(d,p,b)>-1},O.indexOf=function Oi(d,p,b){var C=null==d?0:d.length;if(!C)return-1;var A=null==b?0:un(b);return A<0&&(A=Br(C+A,0)),Yc(d,p,A)},O.inRange=function pu(d,p,b){return p=go(p),b===N?(b=p,p=0):b=go(b),function aD(d,p,b){return d>=Yn(p,b)&&d<Br(p,b)}(d=_a(d),p,b)},O.invoke=b0,O.isArguments=gs,O.isArray=ln,O.isArrayBuffer=f0,O.isArrayLike=io,O.isArrayLikeObject=cr,O.isBoolean=function kv(d){return!0===d||!1===d||Si(d)&&Jt(d)==zn},O.isBuffer=Za,O.isDate=SC,O.isElement=function Bv(d){return Si(d)&&1===d.nodeType&&!jf(d)},O.isEmpty=function Hf(d){if(null==d)return!0;if(io(d)&&(ln(d)||"string"==typeof d||"function"==typeof d.splice||Za(d)||Cp(d)||gs(d)))return!d.length;var p=eo(d);if(p==oi||p==fo)return!d.size;if(qa(d))return!Wa(d).length;for(var b in d)if(si.call(d,b))return!1;return!0},O.isEqual=function EC(d,p){return Do(d,p)},O.isEqualWith=function TC(d,p,b){var C=(b="function"==typeof b?b:N)?b(d,p):N;return C===N?Do(d,p,N,b):!!C},O.isError=h0,O.isFinite=function Uv(d){return"number"==typeof d&&iu(d)},O.isFunction=Tl,O.isInteger=Vv,O.isLength=zf,O.isMap=Hv,O.isMatch=function $o(d,p){return d===p||km(d,p,Km(p))},O.isMatchWith=function lL(d,p,b){return b="function"==typeof b?b:N,km(d,p,Km(p),b)},O.isNaN=function p0(d){return Gv(d)&&d!=+d},O.isNative=function nI(d){if(fc(d))throw new Pt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Cf(d)},O.isNil=function zv(d){return null==d},O.isNull=function Gf(d){return null===d},O.isNumber=Gv,O.isObject=Gi,O.isObjectLike=Si,O.isPlainObject=jf,O.isRegExp=g0,O.isSafeInteger=function AC(d){return Vv(d)&&d>=-pl&&d<=pl},O.isSet=jv,O.isString=m0,O.isSymbol=ms,O.isTypedArray=Cp,O.isUndefined=function Mr(d){return d===N},O.isWeakMap=function _0(d){return Si(d)&&eo(d)==Xi},O.isWeakSet=function DC(d){return Si(d)&&"[object WeakSet]"==Jt(d)},O.join=function vv(d,p){return null==d?"":mf.call(d,p)},O.kebabCase=VC,O.last=Wo,O.lastIndexOf=function ED(d,p,b){var C=null==d?0:d.length;if(!C)return-1;var A=C;return b!==N&&(A=(A=un(b))<0?Br(C+A,0):Yn(A,C-1)),p==p?function Em(X,ye,de){for(var ut=de+1;ut--;)if(X[ut]===ye)return ut;return ut}(d,p,A):ho(d,zA,A,!0)},O.lowerCase=pI,O.lowerFirst=gI,O.lt=vi,O.lte=Wf,O.max=function OI(d){return d&&d.length?op(d,Xo,sp):N},O.maxBy=function NI(d,p){return d&&d.length?op(d,Vt(p,2),sp):N},O.mean=function gc(d){return Qu(d,Xo)},O.meanBy=function Np(d,p){return Qu(d,Vt(p,2))},O.min=function FI(d){return d&&d.length?op(d,Xo,ap):N},O.minBy=function yL(d,p){return d&&d.length?op(d,Vt(p,2),ap):N},O.stubArray=D0,O.stubFalse=pc,O.stubObject=function DI(){return{}},O.stubString=function I0(){return""},O.stubTrue=function sb(){return!0},O.multiply=vL,O.nth=function Hn(d,p){return d&&d.length?yM(d,un(p)):N},O.noConflict=function TI(){return Ar._===this&&(Ar._=Jc),this},O.noop=ib,O.now=a0,O.pad=function HC(d,p,b){d=ci(d);var C=(p=un(p))?tu(d):0;if(!p||C>=p)return d;var A=(p-C)/2;return Ym(gf(A),b)+d+Ym(Im(A),b)},O.padEnd=function zC(d,p,b){d=ci(d);var C=(p=un(p))?tu(d):0;return p&&C<p?d+Ym(p-C,b):d},O.padStart=function mI(d,p,b){d=ci(d);var C=(p=un(p))?tu(d):0;return p&&C<p?Ym(p-C,b)+d:d},O.parseInt=function _I(d,p,b){return b||null==p?p=0:p&&(p=+p),tD(ci(d).replace(jc,""),p||0)},O.random=function dI(d,p,b){if(b&&"boolean"!=typeof b&&to(d,p,b)&&(p=b=N),b===N&&("boolean"==typeof p?(b=p,p=N):"boolean"==typeof d&&(b=d,d=N)),d===N&&p===N?(d=0,p=1):(d=go(d),p===N?(p=d,d=0):p=go(p)),d>p){var C=d;d=p,p=C}if(b||d%1||p%1){var A=_f();return Yn(d+A*(p-d+Kx("1e-"+((A+"").length-1))),p)}return Qy(d,p)},O.reduce=function cC(d,p,b){var C=ln(d)?xm:Xh,A=arguments.length<3;return C(d,Vt(p,4),b,A,lc)},O.reduceRight=function dC(d,p,b){var C=ln(d)?Y2:Xh,A=arguments.length<3;return C(d,Vt(p,4),b,A,jy)},O.repeat=function Ip(d,p,b){return p=(b?to(d,p,b):p===N)?1:un(p),ev(ci(d),p)},O.replace=function GC(){var d=arguments,p=ci(d[0]);return d.length<3?p:p.replace(d[1],d[2])},O.result=function Zv(d,p,b){var C=-1,A=(p=cc(p,d)).length;for(A||(A=1,d=N);++C<A;){var F=null==d?N:d[Xa(p[C])];F===N&&(C=A,F=b),d=Tl(F)?F.call(d):F}return d},O.round=bL,O.runInContext=X,O.sample=function s0(d){return(ln(d)?rp:jt)(d)},O.size=function gC(d){if(null==d)return 0;if(io(d))return m0(d)?tu(d):d.length;var p=eo(d);return p==oi||p==fo?d.size:Wa(d).length},O.snakeCase=Kv,O.some=function mC(d,p,b){var C=ln(d)?Ty:tv;return b&&to(d,p,b)&&(p=N),C(d,Vt(p,3))},O.sortedIndex=function ID(d,p){return Tf(d,p)},O.sortedIndexBy=function RD(d,p,b){return Hm(d,p,Vt(b,2))},O.sortedIndexOf=function KM(d,p){var b=null==d?0:d.length;if(b){var C=Tf(d,p);if(C<b&&zs(d[C],p))return C}return-1},O.sortedLastIndex=function PD(d,p){return Tf(d,p,!0)},O.sortedLastIndexBy=function Ya(d,p,b){return Hm(d,p,Vt(b,2),!0)},O.sortedLastIndexOf=function OD(d,p){if(null!=d&&d.length){var C=Tf(d,p,!0)-1;if(zs(d[C],p))return C}return-1},O.startCase=hL,O.startsWith=function pL(d,p,b){return d=ci(d),b=null==b?0:xf(un(b),0,d.length),p=ls(p),d.slice(b,b+p.length)==p},O.subtract=wL,O.sum=function xL(d){return d&&d.length?Ry(d,Xo):0},O.sumBy=function QC(d,p){return d&&d.length?Ry(d,Vt(p,2)):0},O.template=function gL(d,p,b){var C=O.templateSettings;b&&to(d,p,b)&&(p=N),d=ci(d),p=Ep({},p,C,_D);var $,te,A=Ep({},p.imports,C.imports,_D),F=Dr(A),G=Cm(A,F),Me=0,Se=p.interpolate||Wh,Re="__p += '",nt=nu((p.escape||Wh).source+"|"+Se.source+"|"+(Se===Yu?Gx:Wh).source+"|"+(p.evaluate||Wh).source+"|$","g"),St="//# sourceURL="+(si.call(p,"sourceURL")?(p.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ym+"]")+"\n";d.replace(nt,function(Wt,On,Wn,Gs,Yo,js){return Wn||(Wn=Gs),Re+=d.slice(Me,js).replace(ce,$A),On&&($=!0,Re+="' +\n__e("+On+") +\n'"),Yo&&(te=!0,Re+="';\n"+Yo+";\n__p += '"),Wn&&(Re+="' +\n((__t = ("+Wn+")) == null ? '' : __t) +\n'"),Me=js+Wt.length,Wt}),Re+="';\n";var Bt=si.call(p,"variable")&&p.variable;if(Bt){if(CA.test(Bt))throw new Pt("Invalid `variable` option passed into `_.template`")}else Re="with (obj) {\n"+Re+"\n}\n";Re=(te?Re.replace(zh,""):Re).replace(Zl,"$1").replace(Xu,"$1;"),Re="function("+(Bt||"obj")+") {\n"+(Bt?"":"obj || (obj = {});\n")+"var __t, __p = ''"+($?", __e = _.escape":"")+(te?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+Re+"return __p\n}";var Dn=E0(function(){return gt(F,St+"return "+Re).apply(N,G)});if(Dn.source=Re,h0(Dn))throw Dn;return Dn},O.times=function YC(d,p){if((d=un(d))<1||d>pl)return[];var b=Ye,C=Yn(d,Ye);p=Vt(p),d-=Ye;for(var A=Py(C,p);++b<d;)p(b);return A},O.toFinite=go,O.toInteger=un,O.toLength=Sp,O.toLower=function Rp(d){return ci(d).toLowerCase()},O.toNumber=_a,O.toSafeInteger=function $f(d){return d?xf(un(d),-pl,pl):0===d?d:0},O.toString=ci,O.toUpper=function vI(d){return ci(d).toUpperCase()},O.trim=function S0(d,p,b){if((d=ci(d))&&(b||p===N))return eM(d);if(!d||!(p=ls(p)))return d;var C=fa(d),A=fa(p);return Ml(C,Yh(C,A),Sm(C,A)+1).join("")},O.trimEnd=function Jv(d,p,b){if((d=ci(d))&&(b||p===N))return d.slice(0,Fy(d)+1);if(!d||!(p=ls(p)))return d;var C=fa(d);return Ml(C,0,Sm(C,fa(p))+1).join("")},O.trimStart=function Pp(d,p,b){if((d=ci(d))&&(b||p===N))return d.replace(jc,"");if(!d||!(p=ls(p)))return d;var C=fa(d);return Ml(C,Yh(C,fa(p))).join("")},O.truncate=function mL(d,p){var b=30,C="...";if(Gi(p)){var A="separator"in p?p.separator:A;b="length"in p?un(p.length):b,C="omission"in p?ls(p.omission):C}var F=(d=ci(d)).length;if(ec(d)){var G=fa(d);F=G.length}if(b>=F)return d;var $=b-tu(C);if($<1)return C;var te=G?Ml(G,0,$).join(""):d.slice(0,$);if(A===N)return te+C;if(G&&($+=te.length-$),g0(A)){if(d.slice($).search(A)){var Me,Se=te;for(A.global||(A=nu(A.source,ci(Lr.exec(A))+"g")),A.lastIndex=0;Me=A.exec(Se);)var Re=Me.index;te=te.slice(0,Re===N?$:Re)}}else if(d.indexOf(ls(A),$)!=$){var nt=te.lastIndexOf(A);nt>-1&&(te=te.slice(0,nt))}return te+C},O.unescape=function _L(d){return(d=ci(d))&&jh.test(d)?d.replace(Gh,ks):d},O.uniqueId=function KC(d){var p=++ZA;return ci(d)+p},O.upperCase=jC,O.upperFirst=Qv,O.each=Dv,O.eachRight=aC,O.first=qM,Op(O,function(){var d={};return pa(O,function(p,b){si.call(O.prototype,b)||(d[b]=p)}),d}(),{chain:!1}),O.VERSION="4.17.21",Ls(["bind","bindKey","curry","curryRight","partial","partialRight"],function(d){O[d].placeholder=O}),Ls(["drop","take"],function(d,p){An.prototype[d]=function(b){b=b===N?1:Br(un(b),0);var C=this.__filtered__&&!p?new An(this):this.clone();return C.__filtered__?C.__takeCount__=Yn(b,C.__takeCount__):C.__views__.push({size:Yn(b,Ye),type:d+(C.__dir__<0?"Right":"")}),C},An.prototype[d+"Right"]=function(b){return this.reverse()[d](b).reverse()}}),Ls(["filter","map","takeWhile"],function(d,p){var b=p+1,C=1==b||3==b;An.prototype[d]=function(A){var F=this.clone();return F.__iteratees__.push({iteratee:Vt(A,3),type:b}),F.__filtered__=F.__filtered__||C,F}}),Ls(["head","last"],function(d,p){var b="take"+(p?"Right":"");An.prototype[d]=function(){return this[b](1).value()[0]}}),Ls(["initial","tail"],function(d,p){var b="drop"+(p?"":"Right");An.prototype[d]=function(){return this.__filtered__?new An(this):this[b](1)}}),An.prototype.compact=function(){return this.filter(Xo)},An.prototype.find=function(d){return this.filter(d).head()},An.prototype.findLast=function(d){return this.reverse().find(d)},An.prototype.invokeMap=K(function(d,p){return"function"==typeof d?new An(this):this.map(function(b){return Vr(b,d,p)})}),An.prototype.reject=function(d){return this.filter(u0(Vt(d)))},An.prototype.slice=function(d,p){d=un(d);var b=this;return b.__filtered__&&(d>0||p<0)?new An(b):(d<0?b=b.takeRight(-d):d&&(b=b.drop(d)),p!==N&&(b=(p=un(p))<0?b.dropRight(-p):b.take(p-d)),b)},An.prototype.takeRightWhile=function(d){return this.reverse().takeWhile(d).reverse()},An.prototype.toArray=function(){return this.take(Ye)},pa(An.prototype,function(d,p){var b=/^(?:filter|find|map|reject)|While$/.test(p),C=/^(?:head|last)$/.test(p),A=O[C?"take"+("last"==p?"Right":""):p],F=C||/^find/.test(p);A&&(O.prototype[p]=function(){var G=this.__wrapped__,$=C?[1]:arguments,te=G instanceof An,Me=$[0],Se=te||ln(G),Re=function(On){var Wn=A.apply(O,Ju([On],$));return C&&nt?Wn[0]:Wn};Se&&b&&"function"==typeof Me&&1!=Me.length&&(te=Se=!1);var nt=this.__chain__,Bt=F&&!nt,Dn=te&&!this.__actions__.length;if(!F&&Se){G=Dn?G:new An(this);var Wt=d.apply(G,$);return Wt.__actions__.push({func:hd,args:[Re],thisArg:N}),new Kr(Wt,nt)}return Bt&&Dn?d.apply(this,$):(Wt=this.thru(Re),Bt?C?Wt.value()[0]:Wt.value():Wt)})}),Ls(["pop","push","shift","sort","splice","unshift"],function(d){var p=Tm[d],b=/^(?:push|sort|unshift)$/.test(d)?"tap":"thru",C=/^(?:pop|shift)$/.test(d);O.prototype[d]=function(){var A=arguments;if(C&&!this.__chain__){var F=this.value();return p.apply(ln(F)?F:[],A)}return this[b](function(G){return p.apply(ln(G)?G:[],A)})}}),pa(An.prototype,function(d,p){var b=O[p];if(b){var C=b.name+"";si.call(Zn,C)||(Zn[C]=[]),Zn[C].push({name:p,func:b})}}),Zn[sd(N,2).name]=[{name:"wrapper",func:N}],An.prototype.clone=function vf(){var d=new An(this.__wrapped__);return d.__actions__=cs(this.__actions__),d.__dir__=this.__dir__,d.__filtered__=this.__filtered__,d.__iteratees__=cs(this.__iteratees__),d.__takeCount__=this.__takeCount__,d.__views__=cs(this.__views__),d},An.prototype.reverse=function Ki(){if(this.__filtered__){var d=new An(this);d.__dir__=-1,d.__filtered__=!0}else(d=this.clone()).__dir__*=-1;return d},An.prototype.value=function nd(){var d=this.__wrapped__.value(),p=this.__dir__,b=ln(d),C=p<0,A=b?d.length:0,F=function IM(d,p,b){for(var C=-1,A=b.length;++C<A;){var F=b[C],G=F.size;switch(F.type){case"drop":d+=G;break;case"dropRight":p-=G;break;case"take":p=Yn(p,d+G);break;case"takeRight":d=Br(d,p-G)}}return{start:d,end:p}}(0,A,this.__views__),G=F.start,$=F.end,te=$-G,Me=C?$:G-1,Se=this.__iteratees__,Re=Se.length,nt=0,St=Yn(te,this.__takeCount__);if(!b||!C&&A==te&&St==te)return nv(d,this.__actions__);var Bt=[];e:for(;te--&&nt<St;){for(var Dn=-1,Wt=d[Me+=p];++Dn<Re;){var On=Se[Dn],Gs=On.type,Yo=(0,On.iteratee)(Wt);if(2==Gs)Wt=Yo;else if(!Yo){if(1==Gs)continue e;break e}}Bt[nt++]=Wt}return Bt},O.prototype.at=UD,O.prototype.chain=function VD(){return Cv(this)},O.prototype.commit=function HD(){return new Kr(this.value(),this.__chain__)},O.prototype.next=function rC(){this.__values__===N&&(this.__values__=pd(this.value()));var d=this.__index__>=this.__values__.length;return{done:d,value:d?N:this.__values__[this.__index__++]}},O.prototype.plant=function zD(d){for(var p,b=this;b instanceof Ft;){var C=xD(b);C.__index__=0,C.__values__=N,p?A.__wrapped__=C:p=C;var A=C;b=b.__wrapped__}return A.__wrapped__=d,p},O.prototype.reverse=function GD(){var d=this.__wrapped__;if(d instanceof An){var p=d;return this.__actions__.length&&(p=new An(this)),(p=p.reverse()).__actions__.push({func:hd,args:[n0],thisArg:N}),new Kr(p,this.__chain__)}return this.thru(n0)},O.prototype.toJSON=O.prototype.valueOf=O.prototype.value=function hs(){return nv(this.__wrapped__,this.__actions__)},O.prototype.first=O.prototype.head,ep&&(O.prototype[ep]=function Sv(){return this}),O}();Ar._=Gn,(lt=function(){return Gn}.call(Bn,je,Bn,zt))!==N&&(zt.exports=lt)}.call(this)},794:zt=>{"use strict";zt.exports=function(je){if("number"!=typeof je||Number.isNaN(je))throw new TypeError("Expected a number, got "+typeof je);const lt=je<0;let N=Math.abs(je);if(lt&&(N=-N),0===N)return"0 B";const dn=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],Mt=Math.min(Math.floor(Math.log(N)/Math.log(1024)),dn.length-1),dt=Number(N/1024**Mt),Ut=dn[Mt];return`${dt>=10||dt%1==0?Math.round(dt):dt.toFixed(1)} ${Ut}`}},827:zt=>{zt.exports=function Bn(je){return null!=je&&"object"==typeof je}},870:(zt,Bn,je)=>{var lt=je(754),N=Object.prototype,dn=N.hasOwnProperty,Mt=N.toString,dt=lt?lt.toStringTag:void 0;zt.exports=function Ut(Ct){var et=dn.call(Ct,dt),Un=Ct[dt];try{Ct[dt]=void 0;var wn=!0}catch{}var ui=Mt.call(Ct);return wn&&(et?Ct[dt]=Un:delete Ct[dt]),ui}},878:(zt,Bn,je)=>{"use strict";function lt(n,e,t,i,r,o,s){try{var a=n[o](s),l=a.value}catch(u){return void t(u)}a.done?e(l):Promise.resolve(l).then(i,r)}function N(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var o=n.apply(e,t);function s(l){lt(o,i,r,s,a,"next",l)}function a(l){lt(o,i,r,s,a,"throw",l)}s(void 0)})}}function dn(n,e){return Object.is(n,e)}let Mt=null,dt=!1,Ut=1;const Ct=Symbol("SIGNAL");function et(n){const e=Mt;return Mt=n,e}const gr={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function $i(n){if(dt)throw new Error("");if(null===Mt)return;Mt.consumerOnSignalRead(n);const e=Mt.nextProducerIndex++;Xl(Mt),e<Mt.producerNode.length&&Mt.producerNode[e]!==n&&fl(Mt)&&Ns(Mt.producerNode[e],Mt.producerIndexOfThis[e]),Mt.producerNode[e]!==n&&(Mt.producerNode[e]=n,Mt.producerIndexOfThis[e]=fl(Mt)?La(n,Mt,e):0),Mt.producerLastReadVersion[e]=n.version}function rr(n){if((!fl(n)||n.dirty)&&(n.dirty||n.lastCleanEpoch!==Ut)){if(!n.producerMustRecompute(n)&&!Os(n))return void wr(n);n.producerRecomputeValue(n),wr(n)}}function Ui(n){if(void 0===n.liveConsumerNode)return;const e=dt;dt=!0;try{for(const t of n.liveConsumerNode)t.dirty||ql(t)}finally{dt=e}}function So(){return!1!==Mt?.consumerAllowSignalWrites}function ql(n){n.dirty=!0,Ui(n),n.consumerMarkedDirty?.(n)}function wr(n){n.dirty=!1,n.lastCleanEpoch=Ut}function $r(n){return n&&(n.nextProducerIndex=0),et(n)}function Tr(n,e){if(et(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(fl(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Ns(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Os(n){Xl(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(rr(t),i!==t.version))return!0}return!1}function co(n){if(Xl(n),fl(n))for(let e=0;e<n.producerNode.length;e++)Ns(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function La(n,e,t){if(hl(n),0===n.liveConsumerNode.length&&qu(n))for(let i=0;i<n.producerNode.length;i++)n.producerIndexOfThis[i]=La(n.producerNode[i],n,i);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function Ns(n,e){if(hl(n),1===n.liveConsumerNode.length&&qu(n))for(let i=0;i<n.producerNode.length;i++)Ns(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];Xl(r),r.producerIndexOfThis[i]=e}}function fl(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Xl(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function hl(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function qu(n){return void 0!==n.producerNode}const qr=Symbol("UNSET"),Eo=Symbol("COMPUTING"),Vi=Symbol("ERRORED"),pl={...gr,value:qr,dirty:!0,error:null,equal:dn,kind:"computed",producerMustRecompute:n=>n.value===qr||n.value===Eo,producerRecomputeValue(n){if(n.value===Eo)throw new Error("Detected cycle in computations.");const e=n.value;n.value=Eo;const t=$r(n);let i,r=!1;try{i=n.computation(),et(null),r=e!==qr&&e!==Vi&&i!==Vi&&n.equal(e,i)}catch(o){i=Vi,n.error=o}finally{Tr(n,t)}r?n.value=e:(n.value=i,n.version++)}};let Bc=function by(){throw new Error};function Ye(n){Bc(n)}function Rt(n,e){So()||Ye(n),n.equal(n.value,e)||(n.value=e,function En(n){n.version++,function Wr(){Ut++}(),Ui(n)}(n))}const an={...gr,equal:dn,value:void 0,kind:"signal"};let pi;function la(){return pi}function ua(n){const e=pi;return pi=n,e}const Fs=Symbol("NotFound");function yn(n){return"function"==typeof n}function ml(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}Error;const Xi=ml(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function xr(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Yi{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const o of t)o.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(yn(i))try{i()}catch(o){e=o instanceof Xi?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{Vc(o)}catch(s){e=e??[],s instanceof Xi?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Xi(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Vc(e);else{if(e instanceof Yi){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&xr(t,e)}remove(e){const{_finalizers:t}=this;t&&xr(t,e),e instanceof Yi&&e._removeParent(this)}}Yi.EMPTY=(()=>{const n=new Yi;return n.closed=!0,n})();const _l=Yi.EMPTY;function Uc(n){return n instanceof Yi||n&&"closed"in n&&yn(n.remove)&&yn(n.add)&&yn(n.unsubscribe)}function Vc(n){yn(n)?n():n.unsubscribe()}const ca={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Yl={setTimeout(n,e,...t){const{delegate:i}=Yl;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=Yl;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Hc(n){Yl.setTimeout(()=>{const{onUnhandledError:e}=ca;if(!e)throw n;e(n)})}function yl(){}const tf=zh("C",void 0,void 0);function zh(n,e,t){return{kind:n,value:e,error:t}}let Zl=null;function Xu(n){if(ca.useDeprecatedSynchronousErrorHandling){const e=!Zl;if(e&&(Zl={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Zl;if(Zl=null,t)throw i}}else n()}class zc extends Yi{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Uc(e)&&e.add(this)):this.destination=zx}static create(e,t,i){return new Kl(e,t,i)}next(e){this.isStopped?nf(function Hh(n){return zh("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?nf(function Vh(n){return zh("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?nf(tf,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const jh=Function.prototype.bind;function Gc(n,e){return jh.call(n,e)}class fm{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Yu(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Yu(i)}else Yu(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Yu(t)}}}class Kl extends zc{constructor(e,t,i){let r;if(super(),yn(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let o;this&&ca.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Gc(e.next,o),error:e.error&&Gc(e.error,o),complete:e.complete&&Gc(e.complete,o)}):r=e}this.destination=new fm(r)}}function Yu(n){ca.useDeprecatedSynchronousErrorHandling?function Gh(n){ca.useDeprecatedSynchronousErrorHandling&&Zl&&(Zl.errorThrown=!0,Zl.error=n)}(n):Hc(n)}function nf(n,e){const{onStoppedNotification:t}=ca;t&&Yl.setTimeout(()=>t(n,e))}const zx={closed:!0,next:yl,error:function hm(n){throw n},complete:yl},ka="function"==typeof Symbol&&Symbol.observable||"@@observable";function da(n){return n}function jc(...n){return Jl(n)}function Jl(n){return 0===n.length?da:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let Kn=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const o=function MA(n){return n&&n instanceof zc||function xA(n){return n&&yn(n.next)&&yn(n.error)&&yn(n.complete)}(n)&&Uc(n)}(t)?t:new Kl(t,i,r);return Xu(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=Zu(i))((r,o)=>{const s=new Kl({next:a=>{try{t(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[ka](){return this}pipe(...t){return Jl(t)(this)}toPromise(t){return new(t=Zu(t))((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return n.create=e=>new n(e),n})();function Zu(n){var e;return null!==(e=n??ca.Promise)&&void 0!==e?e:Promise}const CA=ml(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Xr=(()=>{class n extends Kn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Gx(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new CA}next(t){Xu(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Xu(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Xu(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:o}=this;return i||r?_l:(this.currentObservers=null,o.push(t),new Yi(()=>{this.currentObservers=null,xr(o,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:o}=this;i?t.error(r):o&&t.complete()}asObservable(){const t=new Kn;return t.source=this,t}}return n.create=(e,t)=>new Gx(e,t),n})();class Gx extends Xr{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:_l}}class Lr extends Xr{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function jx(n){return yn(n?.lift)}function or(n){return e=>{if(jx(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Mi(n,e,t,i,r){return new SA(n,e,t,i,r)}class SA extends zc{constructor(e,t,i,r,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Nt(n,e){return or((t,i)=>{let r=0;t.subscribe(Mi(i,o=>{i.next(n.call(e,o,r++))}))})}const Wh="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss";class ce extends Error{code;constructor(e,t){super(function Ba(n,e){return`${function pm(n){return`NG0${Math.abs(n)}`}(n)}${e?": "+e:""}`}(e,t)),this.code=e}}const gm=Symbol("InputSignalNode#UNSET"),Wx={...an,transformFn:void 0,applyValueToInputSignal(n,e){Rt(n,e)}};function wy(n,e){const t=Object.create(Wx);function i(){if($i(t),t.value===gm)throw new ce(-950,null);return t.value}return t.value=n,t.transformFn=e?.transform,i[Ct]=t,i}function vl(n){return{toString:n}.toString()}const sf="__parameters__";function Wc(n,e,t){return vl(()=>{const i=function mm(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...o){if(this instanceof r)return i.apply(this,o),this;const s=new r(...o);return a.annotation=s,a;function a(l,u,c){const f=l.hasOwnProperty(sf)?l[sf]:Object.defineProperty(l,sf,{value:[]})[sf];for(;f.length<=c;)f.push(null);return(f[c]=f[c]||[]).push(s),l}}return r.prototype.ngMetadataName=n,r.annotationCls=r,r})}const Zi=globalThis;function ni(n){for(let e in n)if(n[e]===ni)return e;throw Error("Could not find renamed property on target object.")}function qx(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function kr(n){if("string"==typeof n)return n;if(Array.isArray(n))return`[${n.map(kr).join(", ")}]`;if(null==n)return""+n;const e=n.overriddenName||n.name;if(e)return`${e}`;const t=n.toString();if(null==t)return""+t;const i=t.indexOf("\n");return i>=0?t.slice(0,i):t}function _m(n,e){return n?e?`${n} ${e}`:n:e||""}const xy=ni({__forward_ref__:ni});function Ri(n){return n.__forward_ref__=Ri,n.toString=function(){return kr(this())},n}function Zt(n){return lf(n)?n():n}function lf(n){return"function"==typeof n&&n.hasOwnProperty(xy)&&n.__forward_ref__===Ri}function Ve(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Ku(n){return{providers:n.providers||[],imports:n.imports||[]}}function ym(n){return Ci(n,bm)||Ci(n,Kx)}function Ci(n,e){return n.hasOwnProperty(e)?n[e]:null}function vm(n){return n&&(n.hasOwnProperty(My)||n.hasOwnProperty(kA))?n[My]:null}const bm=ni({\u0275prov:ni}),My=ni({\u0275inj:ni}),Kx=ni({ngInjectableDef:ni}),kA=ni({ngInjectorDef:ni});class be{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Ve({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function wm(n){return n&&!!n.\u0275providers}const Xc=ni({\u0275cmp:ni}),Vo=ni({\u0275dir:ni}),Ey=ni({\u0275pipe:ni}),Ls=ni({\u0275mod:ni}),Ql=ni({\u0275fac:ni}),cf=ni({__NG_ELEMENT_ID__:ni}),eu=ni({__NG_ENV_ID__:ni});function Kt(n){return"string"==typeof n?n:null==n?"":String(n)}function xm(n,e){throw new ce(-200,n)}function Ay(n,e){throw new ce(-201,!1)}var xn=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(xn||{});let Dy;function Iy(){return Dy}function ho(n){const e=Dy;return Dy=n,e}function Yc(n,e,t){const i=ym(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&xn.Optional?null:void 0!==e?e:void Ay()}const Qu={},qh="__NG_DI_FLAG__";class Mm{injector;constructor(e){this.injector=e}retrieve(e,t){return this.injector.get(e,t.optional?Fs:Qu,t)}}const Xh="ngTempTokenPath",Ry=/\n/gm,Qx="__source";function eM(n,e=xn.Default){if(void 0===la())throw new ce(-203,!1);if(null===la())return Yc(n,void 0,e);{const t=la();let i;return i=t instanceof Mm?t.injector:t,i.get(n,e&xn.Optional?null:void 0,e)}}function Ze(n,e=xn.Default){return(Iy()||eM)(Zt(n),e)}function j(n,e=xn.Default){return Ze(n,Yh(e))}function Yh(n){return typeof n>"u"||"number"==typeof n?n:(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Sm(n){const e=[];for(let t=0;t<n.length;t++){const i=Zt(n[t]);if(Array.isArray(i)){if(0===i.length)throw new ce(900,!1);let r,o=xn.Default;for(let s=0;s<i.length;s++){const a=i[s],l=jA(a);"number"==typeof l?-1===l?r=a.token:o|=l:r=a}e.push(Ze(r,o))}else e.push(Ze(i))}return e}function Zh(n,e){return n[qh]=e,n.prototype[qh]=e,n}function jA(n){return n[qh]}const ec=Zh(Wc("Optional"),8),Oy=Zh(Wc("SkipSelf"),4);function tc(n,e){return n.hasOwnProperty(Ql)?n[Ql]:null}function df(n,e){n.forEach(t=>Array.isArray(t)?df(t,e):e(t))}function tM(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Em(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function ks(n,e,t){let i=Kh(n,e);return i>=0?n[1|i]=t:(i=~i,function Fy(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function Ly(n,e){const t=Kh(n,e);if(t>=0)return n[1|t]}function Kh(n,e){return function YA(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const o=i+(r-i>>1),s=n[o<<t];if(e===s)return o<<t;s>e?r=o:i=o+1}return~(r<<t)}(n,e,1)}const Va={},Gn=[],X=new be(""),ye=new be("",-1),de=new be("");class ut{get(e,t=Qu){if(t===Qu){const i=new Error(`NullInjectorError: No provider for ${kr(e)}!`);throw i.name="NullInjectorError",i}return t}}function Pt(n,e){const t=n[Ls]||null;if(!t&&!0===e)throw new Error(`Type ${kr(n)} does not have '\u0275mod' property.`);return t}function gt(n){return n[Xc]||null}function jn(n){return n[Vo]||null}function Tn(n){return n[Ey]||null}function bl(n){return{\u0275providers:n}}function Tm(...n){return{\u0275providers:ky(0,n),\u0275fromNgModule:!0}}function ky(n,...e){const t=[],i=new Set;let r;const o=s=>{t.push(s)};return df(e,s=>{const a=s;Kc(a,o,[],i)&&(r||=[],r.push(a))}),void 0!==r&&Zc(r,o),t}function Zc(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];si(r,o=>{e(o,i)})}}function Kc(n,e,t,i){if(!(n=Zt(n)))return!1;let r=null,o=vm(n);const s=!o&&gt(n);if(o||s){if(s&&!s.standalone)return!1;r=n}else{const l=n.ngModule;if(o=vm(l),!o)return!1;r=l}const a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){const l="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const u of l)Kc(u,e,t,i)}}else{if(!o)return!1;{if(null!=o.imports&&!a){let u;i.add(r);try{df(o.imports,c=>{Kc(c,e,t,i)&&(u||=[],u.push(c))})}finally{}void 0!==u&&Zc(u,e)}if(!a){const u=tc(r)||(()=>new r);e({provide:r,useFactory:u,deps:Gn},r),e({provide:de,useValue:r,multi:!0},r),e({provide:X,useValue:()=>Ze(r),multi:!0},r)}const l=o.providers;if(null!=l&&!a){const u=n;si(l,c=>{e(c,u)})}}}return r!==n&&void 0!==n.providers}function si(n,e){for(let t of n)wm(t)&&(t=t.\u0275providers),Array.isArray(t)?si(t,e):e(t)}const ZA=ni({provide:String,useValue:ni});function Am(n){return null!==n&&"object"==typeof n&&ZA in n}function Jc(n){return"function"==typeof n}const ff=new be(""),za={},Qh={};let Dm;function Qc(){return void 0===Dm&&(Dm=new ut),Dm}class Ho{}class ic extends Ho{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,gf(e,s=>this.processProvider(s)),this.records.set(ye,pf(void 0,this)),r.has("environment")&&this.records.set(Ho,pf(void 0,this));const o=this.records.get(ff);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(de,Gn,xn.Self))}retrieve(e,t){return this.get(e,t.optional?Fs:Qu,t)}destroy(){oc(this),this._destroyed=!0;const e=et(null);try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),et(e)}}onDestroy(e){return oc(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){oc(this);const t=ua(this),i=ho(void 0);try{return e()}finally{ua(t),ho(i)}}get(e,t=Qu,i=xn.Default){if(oc(this),e.hasOwnProperty(eu))return e[eu](this);i=Yh(i);const o=ua(this),s=ho(void 0);try{if(!(i&xn.SkipSelf)){let l=this.records.get(e);if(void 0===l){const u=function Im(n){return"function"==typeof n||"object"==typeof n&&n instanceof be}(e)&&ym(e);l=u&&this.injectableDefInScope(u)?pf(hf(e),za):null,this.records.set(e,l)}if(null!=l)return this.hydrate(e,l,i)}return(i&xn.Self?Qc():this.parent).get(e,t=i&xn.Optional&&t===Qu?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[Xh]=a[Xh]||[]).unshift(kr(e)),o)throw a;return function WA(n,e,t,i){const r=n[Xh];throw e[Qx]&&r.unshift(e[Qx]),n.message=function $A(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=kr(e);if(Array.isArray(e))r=e.map(kr).join(" -> ");else if("object"==typeof e){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):kr(a)))}r=`{${o.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(Ry,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Xh]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{ho(s),ua(o)}}resolveInjectorInitializers(){const e=et(null),t=ua(this),i=ho(void 0);try{const o=this.get(X,Gn,xn.Self);for(const s of o)s()}finally{ua(t),ho(i),et(e)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(kr(i));return`R3Injector[${e.join(", ")}]`}processProvider(e){let t=Jc(e=Zt(e))?e:Zt(e&&e.provide);const i=function ep(n){return Am(n)?pf(void 0,n.useValue):pf(rc(n),za)}(e);if(!Jc(e)&&!0===e.multi){let r=this.records.get(t);r||(r=pf(void 0,za,!0),r.factory=()=>Sm(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t,i){const r=et(null);try{return t.value===Qh?xm(kr(e)):t.value===za&&(t.value=Qh,t.value=t.factory(void 0,i)),"object"==typeof t.value&&t.value&&function QA(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{et(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Zt(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function hf(n){const e=ym(n),t=null!==e?e.factory:tc(n);if(null!==t)return t;if(n instanceof be)throw new ce(204,!1);if(n instanceof Function)return function iM(n){if(n.length>0)throw new ce(204,!1);const t=function LA(n){return n&&(n[bm]||n[Kx])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new ce(204,!1)}function rc(n,e,t){let i;if(Jc(n)){const r=Zt(n);return tc(r)||hf(r)}if(Am(n))i=()=>Zt(n.useValue);else if(function nM(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Sm(n.deps||[]));else if(function Jh(n){return!(!n||!n.useExisting)}(n))i=(r,o)=>Ze(Zt(n.useExisting),void 0!==o&&o&xn.Optional?xn.Optional:void 0);else{const r=Zt(n&&(n.useClass||n.provide));if(!function JA(n){return!!n.deps}(n))return tc(r)||hf(r);i=()=>new r(...Sm(n.deps))}return i}function oc(n){if(n.destroyed)throw new ce(205,!1)}function pf(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function gf(n,e){for(const t of n)Array.isArray(t)?gf(t,e):t&&wm(t)?gf(t.\u0275providers,e):e(t)}function Bs(n,e){let t;n instanceof ic?(oc(n),t=n):t=new Mm(n);const r=ua(t),o=ho(void 0);try{return e()}finally{ua(r),ho(o)}}function rM(){return void 0!==Iy()||null!=la()}function iu(n){if(!rM())throw new ce(-203,!1)}function mr(n){return Array.isArray(n)&&"object"==typeof n[1]}function Ur(n){return Array.isArray(n)&&!0===n[1]}function ou(n){return!!(4&n.flags)}function ja(n){return n.componentOffset>-1}function Om(n){return!(1&~n.flags)}function lr(n){return!!n.template}function su(n){return!!(512&n[2])}function au(n){return!(256&~n[2])}class lc{previousValue;currentValue;firstChange;constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function jy(n,e,t,i){null!==e?e.applyValueToInputSignal(e,i):n[t]=i}const as=(()=>{const n=()=>op;return n.ngInherit=!0,n})();function op(n){return n.type.prototype.ngOnChanges&&(n.setInput=hM),sD}function sD(){const n=Lm(this),e=n?.current;if(e){const t=n.previous;if(t===Va)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function hM(n,e,t,i,r){const o=this.declaredInputs[i],s=Lm(n)||function pM(n,e){return n[Qr]=e}(n,{previous:Va,current:null}),a=s.current||(s.current={}),l=s.previous,u=l[o];a[o]=new lc(u&&u.currentValue,t,l===Va),jy(n,e,r,t)}const Qr="__ngSimpleChanges__";function Lm(n){return n[Qr]||null}function Jt(n){for(;Array.isArray(n);)n=n[0];return n}function Mf(n,e){return Jt(e[n])}function jo(n,e){return Jt(e[n.index])}function lu(n,e){return n.data[e]}function id(n,e){return n[e]}function Vr(n,e){const t=e[n];return mr(t)?t:t[0]}function qy(n){return!(128&~n[2])}function Do(n,e){return null==e?null:n[e]}function mM(n){n[17]=0}function Xy(n){1024&n[2]||(n[2]|=1024,qy(n)&&Sf(n))}function Cf(n){return!!(9216&n[2]||n[24]?.dirty)}function Yy(n){n[10].changeDetectionScheduler?.notify(8),64&n[2]&&(n[2]|=1024),Cf(n)&&Sf(n)}function Sf(n){n[10].changeDetectionScheduler?.notify(0);let e=Wa(n);for(;null!==e&&!(8192&e[2])&&(e[2]|=8192,qy(e));)e=Wa(e)}function Bm(n,e){if(au(n))throw new ce(911,!1);null===n[21]&&(n[21]=[]),n[21].push(e)}function Wa(n){const e=n[3];return Ur(e)?e[3]:e}function Zy(n){return n[7]??=[]}function ap(n){return n.cleanup??=[]}const Qt={lFrame:sv(null),bindingsEnabled:!0,skipHydrationRootTNode:null};let Ky=!1;function Vm(){return Qt.bindingsEnabled}function rd(){return null!==Qt.skipHydrationRootTNode}function K(){return Qt.lFrame.lView}function jt(){return Qt.lFrame.tView}function qe(n){return Qt.lFrame.contextLView=n,n[8]}function He(n){return Qt.lFrame.contextLView=null,n}function Mn(){let n=wM();for(;null!==n&&64===n.type;)n=n.parent;return n}function wM(){return Qt.lFrame.currentTNode}function _r(n,e){const t=Qt.lFrame;t.currentTNode=n,t.isParent=e}function tv(){return Qt.lFrame.isParent}function Tf(){Qt.lFrame.isParent=!1}function uu(){return Ky}function Af(n){const e=Ky;return Ky=n,e}function Io(){const n=Qt.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function us(){return Qt.lFrame.bindingIndex++}function xl(n){const e=Qt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function cc(n,e){const t=Qt.lFrame;t.bindingIndex=t.bindingRootIndex=n,Ml(e)}function Ml(n){Qt.lFrame.currentDirectiveIndex=n}function jm(){return Qt.lFrame.currentQueryIndex}function Df(n){Qt.lFrame.currentQueryIndex=n}function pD(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[5]:null}function xM(n,e,t){if(t&xn.SkipSelf){let r=e,o=n;for(;!(r=r.parent,null!==r||t&xn.Host||(r=pD(o),null===r||(o=o[14],10&r.type))););if(null===r)return!1;e=r,n=o}const i=Qt.lFrame=ov();return i.currentTNode=e,i.lView=n,!0}function rv(n){const e=ov(),t=n[1];Qt.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function ov(){const n=Qt.lFrame,e=null===n?null:n.child;return null===e?sv(n):e}function sv(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function MM(){const n=Qt.lFrame;return Qt.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const av=MM;function Wm(){const n=MM();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Pi(){return Qt.lFrame.selectedIndex}function od(n){Qt.lFrame.selectedIndex=n}function yi(){const n=Qt.lFrame;return lu(n.tView,n.selectedIndex)}function SM(){return Qt.lFrame.currentNamespace}let uv=!0;function Cl(){return uv}function ds(n){uv=n}function $m(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:u,ngOnDestroy:c}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),null!=c&&(n.destroyHooks??=[]).push(t,c)}}function dp(n,e,t){fp(n,e,3,t)}function sd(n,e,t,i){(3&n[2])===t&&fp(n,e,t,i)}function qm(n,e){let t=n[2];(3&t)===e&&(t&=16383,t+=1,n[2]=t)}function fp(n,e,t,i){const o=i??-1,s=e.length-1;let a=0;for(let l=void 0!==i?65535&n[17]:0;l<s;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[17]+=65536),(a<o||-1==o)&&(Ym(n,t,e,l),n[17]=(4294901760&n[17])+l+2),l++}function Xm(n,e){const t=et(null);try{e.call(n)}finally{et(t)}}function Ym(n,e,t,i){const r=t[i]<0,o=t[i+1],a=n[r?-t[i]:t[i]];r?n[2]>>14<n[17]>>16&&(3&n[2])===e&&(n[2]+=16384,Xm(a,o)):Xm(a,o)}class Pf{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,i){this.factory=e,this.canSeeViewProviders=t,this.injectImpl=i}}function AM(n){return 3===n||4===n||6===n}function dv(n){return 64===n.charCodeAt(0)}function Nf(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||DM(n,t,r,0,-1===t||2===t?e[++i]:null)}}return n}function DM(n,e,t,i,r){let o=0,s=n.length;if(-1===e)s=-1;else for(;o<n.length;){const a=n[o++];if("number"==typeof a){if(a===e){s=-1;break}if(a>e){s=o-1;break}}}for(;o<n.length;){const a=n[o];if("number"==typeof a)break;if(a===t)return void(null!==r&&(n[o+1]=r));o++,null!==r&&o++}-1!==s&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),null!==r&&n.splice(o++,0,r)}function $a(n){return-1!==n}function ad(n){return 32767&n}function ld(n,e){let t=function fv(n){return n>>16}(n),i=e;for(;t>0;)i=i[14],t--;return i}let Ff=!0;function cu(n){const e=Ff;return Ff=n,e}let ud=0;const Sl={};function pp(n,e){const t=IM(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,eo(i.data,n),eo(e,null),eo(i.blueprint,null));const r=Jm(n,e),o=n.injectorIndex;if($a(r)){const s=ad(r),a=ld(r,e),l=a[1].data;for(let u=0;u<8;u++)e[o+u]=a[s+u]|l[s+u]}return e[o+8]=r,o}function eo(n,e){n.push(0,0,0,0,0,0,0,0,e)}function IM(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Jm(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=LM(r),null===i)return-1;if(t++,r=r[14],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function Qm(n,e,t){!function hv(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(cf)&&(i=t[cf]),null==i&&(i=t[cf]=ud++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function pv(n,e,t){if(t&xn.Optional||void 0!==n)return n;Ay()}function RM(n,e,t,i){if(t&xn.Optional&&void 0===i&&(i=null),!(t&(xn.Self|xn.Host))){const r=n[9],o=ho(void 0);try{return r?r.get(e,i,t&xn.Optional):Yc(e,i,t&xn.Optional)}finally{ho(o)}}return pv(i,0,t)}function PM(n,e,t,i=xn.Default,r){if(null!==n){if(2048&e[2]&&!(i&xn.Self)){const s=function bD(n,e,t,i,r){let o=n,s=e;for(;null!==o&&null!==s&&2048&s[2]&&!su(s);){const a=OM(o,s,t,i|xn.Self,Sl);if(a!==Sl)return a;let l=o.parent;if(!l){const u=s[20];if(u){const c=u.get(t,Sl,i);if(c!==Sl)return c}l=LM(s),s=s[14]}o=l}return r}(n,e,t,i,Sl);if(s!==Sl)return s}const o=OM(n,e,t,i,Sl);if(o!==Sl)return o}return RM(e,t,i,r)}function OM(n,e,t,i,r){const o=function vD(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(cf)?n[cf]:void 0;return"number"==typeof e?e>=0?255&e:FM:e}(t);if("function"==typeof o){if(!xM(e,n,i))return i&xn.Host?pv(r,0,i):RM(e,t,i,r);try{let s;if(s=o(i),null!=s||i&xn.Optional)return s;Ay()}finally{av()}}else if("number"==typeof o){let s=null,a=IM(n,e),l=-1,u=i&xn.Host?e[15][5]:null;for((-1===a||i&xn.SkipSelf)&&(l=-1===a?Jm(n,e):e[a+8],-1!==l&&NM(i,!1)?(s=e[1],a=ad(l),e=ld(l,e)):a=-1);-1!==a;){const c=e[1];if(e0(o,a,c.data)){const f=du(a,e,t,s,i,u);if(f!==Sl)return f}l=e[a+8],-1!==l&&NM(i,e[1].data[a+8]===u)&&e0(o,a,e)?(s=c,a=ad(l),e=ld(l,e)):a=-1}}return r}function du(n,e,t,i,r,o){const s=e[1],a=s.data[n+8],c=to(a,s,t,null==i?ja(a)&&Ff:i!=s&&!!(3&a.type),r&xn.Host&&o===a);return null!==c?cd(e,s,c,a,r):Sl}function to(n,e,t,i,r){const o=n.providerIndexes,s=e.data,a=1048575&o,l=n.directiveStart,c=o>>20,h=r?a+c:n.directiveEnd;for(let g=i?a:a+c;g<h;g++){const m=s[g];if(g<l&&t===m||g>=l&&m.type===t)return g}if(r){const g=s[l];if(g&&lr(g)&&g.type===t)return l}return null}function cd(n,e,t,i,r){let o=n[t];const s=e.data;if(o instanceof Pf){const a=o;a.resolving&&xm(function Jn(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Kt(n)}(s[t]));const l=cu(a.canSeeViewProviders);a.resolving=!0;const c=a.injectImpl?ho(a.injectImpl):null;xM(n,i,xn.Default);try{o=n[t]=a.factory(void 0,r,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function gD(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(i){const s=op(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}r&&(t.preOrderHooks??=[]).push(0-n,r),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}(t,s[t],e)}finally{null!==c&&ho(c),cu(l),a.resolving=!1,av()}}return o}function e0(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function NM(n,e){return!(n&xn.Self||n&xn.Host&&e)}class ur{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return PM(this._tNode,this._lView,e,Yh(i),t)}}function FM(){return new ur(Mn(),K())}function Vn(n){return vl(()=>{const e=n.prototype.constructor,t=e[Ql]||gv(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const o=r[Ql]||gv(r);if(o&&o!==t)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function gv(n){return lf(n)?()=>{const e=gv(Zt(n));return e&&e()}:tc(n)}function LM(n){const e=n[1],t=e.type;return 2===t?e.declTNode:1===t?n[5]:null}function zM(n,e=null,t=null,i){const r=GM(n,e,t,i);return r.resolveInjectorInitializers(),r}function GM(n,e=null,t=null,i,r=new Set){const o=[t||Gn,Tm(n)];return i=i||("object"==typeof n?void 0:kr(n)),new ic(o,e||Qc(),i||null,r)}class no{static THROW_IF_NOT_FOUND=Qu;static NULL=new ut;static create(e,t){if(Array.isArray(e))return zM({name:""},t,e,"");{const i=e.name??"";return zM({name:i},e.parent,e.providers,i)}}static \u0275prov=Ve({token:no,providedIn:"any",factory:()=>Ze(ye)});static __NG_ELEMENT_ID__=-1}new be("").__NG_ELEMENT_ID__=n=>{const e=Mn();if(null===e)throw new ce(204,!1);if(2&e.type)return e.value;if(n&xn.Optional)return null;throw new ce(204,!1)};const jM=!1;let Hs=(()=>class n{static __NG_ELEMENT_ID__=CD;static __NG_ENV_ID__=t=>t})();class WM extends Hs{_lView;constructor(e){super(),this._lView=e}onDestroy(e){const t=this._lView;return au(t)?(e(),()=>{}):(Bm(t,e),()=>function Um(n,e){if(null===n[21])return;const t=n[21].indexOf(e);-1!==t&&n[21].splice(t,1)}(t,e))}}function CD(){return new WM(K())}class fu{}const fd=new be("",{providedIn:"root",factory:()=>!1}),_v=new be(""),yv=new be("");let hu=(()=>{class n{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new Lr(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=Ve({token:n,providedIn:"root",factory:()=>new n})}return n})();const Oi=class qM extends Xr{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,rM()&&(this.destroyRef=j(Hs,{optional:!0})??void 0,this.pendingTasks=j(hu,{optional:!0})??void 0)}emit(e){const t=et(null);try{super.next(e)}finally{et(t)}}subscribe(e,t,i){let r=e,o=t||(()=>null),s=i;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=this.wrapInTimeout(o),r&&(r=this.wrapInTimeout(r)),s&&(s=this.wrapInTimeout(s)));const a=super.subscribe({next:r,error:o,complete:s});return e instanceof Yi&&e.add(a),a}wrapInTimeout(e){return t=>{const i=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{void 0!==i&&this.pendingTasks?.remove(i)}})}}};function yp(...n){}function XM(n){let e,t;function i(){n=yp;try{void 0!==t&&"function"==typeof cancelAnimationFrame&&cancelAnimationFrame(t),void 0!==e&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),"function"==typeof requestAnimationFrame&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function YM(n){return queueMicrotask(()=>n()),()=>{n=yp}}const vv="isAngularZone",Wo=vv+"_ID";let ED=0;class Hn{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Oi(!1);onMicrotaskEmpty=new Oi(!1);onStable=new Oi(!1);onError=new Oi(!1);constructor(e){const{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:o=jM}=e;if(typeof Zone>"u")throw new ce(908,!1);Zone.assertZonePatched();const s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&i,s.shouldCoalesceRunChangeDetection=r,s.callbackScheduled=!1,s.scheduleInRootZone=o,function DD(n){const e=()=>{!function AD(n){function e(){XM(()=>{n.callbackScheduled=!1,bv(n),n.isCheckStableRunning=!0,t0(n),n.isCheckStableRunning=!1})}n.isCheckStableRunning||n.callbackScheduled||(n.callbackScheduled=!0,n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),bv(n))}(n)},t=ED++;n._inner=n._inner.fork({name:"angular",properties:{[vv]:!0,[Wo]:t,[Wo+t]:!0},onInvokeTask:(i,r,o,s,a,l)=>{if(function ID(n){return KM(n,"__ignore_ng_zone__")}(l))return i.invokeTask(o,s,a,l);try{return ZM(n),i.invokeTask(o,s,a,l)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),n0(n)}},onInvoke:(i,r,o,s,a,l,u)=>{try{return ZM(n),i.invoke(o,s,a,l,u)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!function RD(n){return KM(n,"__scheduler_tick__")}(l)&&e(),n0(n)}},onHasTask:(i,r,o,s)=>{i.hasTask(o,s),r===o&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,bv(n),t0(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(i,r,o,s)=>(i.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get(vv)}static assertInAngularZone(){if(!Hn.isInAngularZone())throw new ce(909,!1)}static assertNotInAngularZone(){if(Hn.isInAngularZone())throw new ce(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,e,TD,yp,yp);try{return o.runTask(s,t,i)}finally{o.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const TD={};function t0(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function bv(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&!0===n.callbackScheduled)}function ZM(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function n0(n){n._nesting--,t0(n)}class wv{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Oi;onMicrotaskEmpty=new Oi;onStable=new Oi;onError=new Oi;run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}function KM(n,e){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0]?.data?.[e]}class Ya{_console=console;handleError(e){this._console.error("ERROR",e)}}const OD=new be("",{providedIn:"root",factory:()=>{const n=j(Hn),e=j(Ya);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function QM(n,e){return wy(n,e)}const FD=(QM.required=function ND(n){return wy(gm,n)},QM);function LD(){return Bf(Mn(),K())}function Bf(n,e){return new gi(jo(n,e))}let gi=(()=>class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=LD})();function eC(n){return n instanceof gi?n.nativeElement:n}function fs(n,e){const t=function Be(n,e){const t=Object.create(an);t.value=n,void 0!==e&&(t.equal=e);const i=()=>($i(t),t.value);return i[Ct]=t,i}(n,e?.equal),i=t[Ct];return t.set=r=>Rt(i,r),t.update=r=>function Hi(n,e){So()||Ye(n),Rt(n,e(n.value))}(i,r),t.asReadonly=Uf.bind(t),t}function Uf(){const n=this[Ct];if(void 0===n.readonlyFn){const e=()=>this();e[Ct]=n,n.readonlyFn=e}return n.readonlyFn}function xv(n){return function tC(n){return"function"==typeof n&&void 0!==n[Ct]}(n)&&"function"==typeof n.set}function kD(){return this._results[Symbol.iterator]()}class nC{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new Xr}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;const i=function po(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function nc(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(t&&(r=t(r),o=t(o)),o!==r)return!1}return!0}(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=kD}function Mv(n){const e=n.mergedAttrs;if(null===e)return!1;for(let t=0;t<e.length;t+=2){const i=e[t];if("number"==typeof i)return!1;if("string"==typeof i&&"ngskiphydration"===i.toLowerCase())return!0}return!1}function iC(n){return n.hasAttribute("ngSkipHydration")}function bp(n){return!(128&~n.flags)}var r0=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(r0||{});const hd=new Map;let UD=0;function Sv(n){hd.delete(n[19])}const Tv="__ngContext__";function ps(n,e){mr(e)?(n[Tv]=e[19],function HD(n){hd.set(n[19],n)}(e)):n[Tv]=e}function cC(n){return fC(n[12])}function dC(n){return fC(n[4])}function fC(n){for(;null!==n&&!Ur(n);)n=n[4];return n}let Rv;function El(){if(void 0!==Rv)return Rv;if(typeof document<"u")return document;throw new ce(210,!1)}const ma=new be("",{providedIn:"root",factory:()=>u0}),u0="ng",Pv=new be(""),Vf=new be("",{providedIn:"platform",factory:()=>"unknown"}),Ov=new be(""),MC=new be("",{providedIn:"root",factory:()=>El().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function eI(){const n=new hc;return n.store=function tI(n,e){const t=n.getElementById(e+"-state");if(t?.textContent)try{return JSON.parse(t.textContent)}catch(i){console.warn("Exception while restoring TransferState for app "+e,i)}return{}}(El(),j(ma)),n}let hc=(()=>{class n{static \u0275prov=Ve({token:n,providedIn:"root",factory:eI});store={};onSerializeCallbacks={};get(t,i){return void 0!==this.store[t]?this.store[t]:i}set(t,i){this.store[t]=i}remove(t){delete this.store[t]}hasKey(t){return this.store.hasOwnProperty(t)}get isEmpty(){return 0===Object.keys(this.store).length}onSerialize(t,i){this.onSerializeCallbacks[t]=i}toJson(){for(const t in this.onSerializeCallbacks)if(this.onSerializeCallbacks.hasOwnProperty(t))try{this.store[t]=this.onSerializeCallbacks[t]()}catch(i){console.warn("Exception in onSerialize callback: ",i)}return JSON.stringify(this.store).replace(/</g,"\\u003C")}}return n})();const Hf=new be(""),TC=new be("",{providedIn:"root",factory:()=>!1});var Gi=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(Gi||{});const Si=new be(""),Hv=new Set;function $o(n){Hv.has(n)||(Hv.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}let p0=(()=>class n{view;node;constructor(t,i){this.view=t,this.node=i}static __NG_ELEMENT_ID__=nI})();function nI(){return new p0(K(),Mn())}let zv=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=Ve({token:n,providedIn:"root",factory:()=>new n})}return n})();const M0="__nghData__";let VC=()=>null;function pI(n,e,t=!1){let i=n.getAttribute("ngh");if(null==i)return null;const[r,o]=i.split("|");if(i=t?o:r,!i)return null;const a=t?r:o?`|${o}`:"";let l={};if(""!==i){const c=e.get(hc,null,{optional:!0});null!==c&&(l=c.get(M0,[])[Number(i)])}const u={data:l,firstChild:n.firstChild??null};return t&&(u.firstChild=n,S0(u,0,n.nextSibling)),a?n.setAttribute("ngh",a):n.removeAttribute("ngh"),u}function HC(n,e,t=!1){return VC(n,e,t)}function zC(n){let e=n._lView;return 2===e[1].type?null:(su(e)&&(e=e[26]),e)}function S0(n,e,t){n.segmentHeads??={},n.segmentHeads[e]=t}function Jv(n,e){return n.segmentHeads?.[e]??null}function eb(n,e){return n.data.c?.[e]??null}function E0(n,e){const t=eb(n,e)??[];let i=0;for(let r of t)i+=r.r*(r.x??1);return i}function yd(n,e){if(typeof n.disconnectedNodes>"u"){const t=n.data.d;n.disconnectedNodes=t?new Set(t):null}return!!function WC(n){if(typeof n.disconnectedNodes>"u"){const e=n.data.d;n.disconnectedNodes=e?new Set(e):null}return n.disconnectedNodes}(n)?.has(e)}function rb(n){return!!n&&n.nodeType===Node.COMMENT_NODE&&"nghm"===n.textContent?.trim()}function qC(n){for(;n&&n.nodeType===Node.TEXT_NODE;)n=n.previousSibling;return n}function XC(n,e){const t=n.contentQueries;if(null!==t){const i=et(null);try{for(let r=0;r<t.length;r+=2){const s=t[r+1];if(-1!==s){const a=n.data[s];Df(t[r]),a.contentQueries(2,e[s],s)}}}finally{et(i)}}}function T0(n,e,t){Df(0);const i=et(null);try{e(n,t)}finally{et(i)}}function ob(n,e,t){if(ou(e)){const i=et(null);try{const o=e.directiveEnd;for(let s=e.directiveStart;s<o;s++){const a=n.data[s];a.contentQueries&&a.contentQueries(1,t[s],s)}}finally{et(i)}}}var ya=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(ya||{});let I0;function KC(n){return function sb(){if(void 0===I0&&(I0=null,Zi.trustedTypes))try{I0=Zi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return I0}()?.createScriptURL(n)||n}class JC{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Wh})`}}function gc(n){return n instanceof JC?n.changingThisBreaksApplicationSecurity:n}function Np(n,e){const t=function FI(n){return n instanceof JC&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${Wh})`)}return t===e}const C=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var R0=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(R0||{});function mc(n){const e=ab();return e?e.sanitize(R0.URL,n)||"":Np(n,"URL")?gc(n):function A(n){return(n=String(n)).match(C)?n:"unsafe:"+n}(Kt(n))}function CL(n){const e=ab();if(e)return KC(e.sanitize(R0.RESOURCE_URL,n)||"");if(Np(n,"ResourceURL"))return KC(gc(n));throw new ce(904,!1)}function ab(){const n=K();return n&&n[10].sanitizer}const d9=/^>|^->|<!--|-->|--!>|<!-$/g,f9=/(<|>)/g;function Zf(n){return n.ownerDocument.defaultView}function ba(n){return n.ownerDocument}function _c(n){return n instanceof Function?n():n}function x9(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const o=e.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}t=r+1}}const NL="ng-template";function M9(n,e,t,i){let r=0;if(i){for(;r<e.length&&"string"==typeof e[r];r+=2)if("class"===e[r]&&-1!==x9(e[r+1].toLowerCase(),t,0))return!0}else if(UI(n))return!1;if(r=e.indexOf(1,r),r>-1){let o;for(;++r<e.length&&"string"==typeof(o=e[r]);)if(o.toLowerCase()===t)return!0}return!1}function UI(n){return 4===n.type&&n.value!==NL}function C9(n,e,t){return e===(4!==n.type||t?n.value:NL)}function S9(n,e,t){let i=4;const r=n.attrs,o=null!==r?function A9(n){for(let e=0;e<n.length;e++)if(AM(n[e]))return e;return n.length}(r):0;let s=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!s)if(4&i){if(i=2|1&i,""!==l&&!C9(n,l,t)||""===l&&1===e.length){if(gu(i))return!1;s=!0}}else if(8&i){if(null===r||!M9(n,r,l,t)){if(gu(i))return!1;s=!0}}else{const u=e[++a],c=E9(l,r,UI(n),t);if(-1===c){if(gu(i))return!1;s=!0;continue}if(""!==u){let f;if(f=c>o?"":r[c+1].toLowerCase(),2&i&&u!==f){if(gu(i))return!1;s=!0}}}}else{if(!s&&!gu(i)&&!gu(l))return!1;if(s&&gu(l))continue;s=!1,i=l|1&i}}return gu(i)||s}function gu(n){return!(1&n)}function E9(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let o=!1;for(;r<e.length;){const s=e[r];if(s===n)return r;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===s)break;if(0===s){r+=4;continue}}r+=o?1:2}return-1}return function D9(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function FL(n,e,t=!1){for(let i=0;i<e.length;i++)if(S9(n,e[i],t))return!0;return!1}function LL(n,e){return n?":not("+e.trim()+")":e}function R9(n){let e=n[0],t=1,i=2,r="",o=!1;for(;t<n.length;){let s=n[t];if("string"==typeof s)if(2&i){const a=n[++t];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+s:4&i&&(r+=" "+s);else""!==r&&!gu(s)&&(e+=LL(o,r),r=""),i=s,o=o||!gu(i);t++}return""!==r&&(e+=LL(o,r)),e}const hn={};function VI(n,e){return n.createText(e)}function HI(n,e){return n.createComment(function EL(n){return n.replace(d9,e=>e.replace(f9,"\u200b$1\u200b"))}(e))}function rS(n,e,t){return n.createElement(e,t)}function Fp(n,e,t,i,r){n.insertBefore(e,t,i,r)}function BL(n,e,t){n.appendChild(e,t)}function UL(n,e,t,i,r){null!==i?Fp(n,e,t,i,r):BL(n,e,t)}function lb(n,e,t){n.removeChild(null,e,t)}function VL(n){n.textContent=""}function HL(n,e,t){const{mergedAttrs:i,classes:r,styles:o}=t;null!==i&&function TM(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const o=t[i++],s=t[i++],a=t[i++];n.setAttribute(e,s,a,o)}else{const o=r,s=t[++i];dv(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),i++}}}(n,e,i),null!==r&&function F9(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}(n,e,r),null!==o&&function N9(n,e,t){n.setAttribute(e,"style",t)}(n,e,o)}function zI(n,e,t,i,r,o,s,a,l,u,c){const f=26+i,h=f+r,g=function L9(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:hn);return t}(f,h),m="function"==typeof u?u():u;return g[1]={type:n,blueprint:g,template:t,queries:null,viewQuery:a,declTNode:e,data:g.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:l,consts:m,incompleteFirstPass:!1,ssrId:c}}function oS(n,e,t,i,r,o,s,a,l,u,c){const f=e.blueprint.slice();return f[0]=r,f[2]=1228|i,(null!==u||n&&2048&n[2])&&(f[2]|=2048),mM(f),f[3]=f[14]=n,f[8]=t,f[10]=s||n&&n[10],f[11]=a||n&&n[11],f[9]=l||n&&n[9]||null,f[5]=o,f[19]=function VD(){return UD++}(),f[6]=c,f[20]=u,f[15]=2==e.type?n[15]:f,f}function GI(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function ub(n,e,t,i){if(0===t)return-1;const r=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function jI(n,e){return n[12]?n[13][4]=e:n[12]=e,n[13]=e,e}function q(n=1){GL(jt(),K(),Pi()+n,!1)}function GL(n,e,t,i){if(!i)if(3&~e[2]){const o=n.preOrderHooks;null!==o&&sd(e,o,0,t)}else{const o=n.preOrderCheckHooks;null!==o&&dp(e,o,t)}od(t)}var sS=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(sS||{});function WI(n,e,t,i){const r=et(null);try{const[o,s,a]=n.inputs[t];let l=null;!!(s&sS.SignalBased)&&(l=e[o][Ct]),null!==l&&void 0!==l.transformFn?i=l.transformFn(i):null!==a&&(i=a.call(e,i)),null!==n.setInput?n.setInput(e,l,i,t,o):jy(e,l,o,i)}finally{et(r)}}function jL(n,e,t,i,r){const o=Pi(),s=2&i;try{od(-1),s&&e.length>26&&GL(n,e,26,!1),t(i,r)}finally{od(o)}}function aS(n,e,t){(function j9(n,e,t){const i=t.directiveStart,r=t.directiveEnd;ja(t)&&function k9(n,e,t){const i=jo(e,n),r=function zL(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=zI(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}(t),o=n[10].rendererFactory,s=jI(n,oS(n,r,null,GI(t),i,e,null,o.createRenderer(i,t),null,null,null));n[e.index]=s}(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||pp(t,e);const o=t.initialInputs;for(let s=i;s<r;s++){const a=n.data[s],l=cd(e,n,s,t);ps(l,e),null!==o&&q9(0,s-i,l,a,0,o),lr(a)&&(Vr(t.index,e)[8]=cd(e,n,s,t))}})(n,e,t),!(64&~t.flags)&&function W9(n,e,t){const i=t.directiveStart,r=t.directiveEnd,o=t.index,s=function hD(){return Qt.lFrame.currentDirectiveIndex}();try{od(o);for(let a=i;a<r;a++){const l=n.data[a],u=e[a];Ml(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&$9(l,u)}}finally{od(-1),Ml(s)}}(n,e,t)}function $I(n,e,t=jo){const i=e.localNames;if(null!==i){let r=e.index+1;for(let o=0;o<i.length;o+=2){const s=i[o+1],a=-1===s?t(e,n):n[s];n[r++]=a}}}let WL=()=>null;function V9(n){iC(n)?VL(n):function _I(n){const e=El(),t=e.createNodeIterator(n,NodeFilter.SHOW_COMMENT,{acceptNode(o){const s=function mI(n){return n.textContent?.replace(/\s/gm,"")}(o);return"ngetn"===s||"ngtns"===s?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}});let i;const r=[];for(;i=t.nextNode();)r.push(i);for(const o of r)"ngetn"===o.textContent?o.replaceWith(e.createTextNode("")):o.remove()}(n)}function wa(n,e,t,i,r,o,s,a){if(a||!ZI(e,n,t,i,r)){if(3&e.type){const l=jo(e,t);i=function z9(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=s?s(r,e.value||"",i):r,o.setProperty(l,i,r)}}else ja(e)&&function G9(n,e){const t=Vr(e,n);16&t[2]||(t[2]|=64)}(t,e.index)}function $9(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function qI(n,e){const t=n.directiveRegistry;let i=null;if(t)for(let r=0;r<t.length;r++){const o=t[r];FL(e,o.selectors,!1)&&(i??=[],lr(o)?i.unshift(o):i.push(o))}return i}function yc(n,e,t,i,r,o){const s=jo(n,e);!function XI(n,e,t,i,r,o,s){if(null==o)n.removeAttribute(e,r,t);else{const a=null==s?Kt(o):s(o,i||"",r);n.setAttribute(e,r,a,t)}}(e[11],s,o,n.value,t,i,r)}function q9(n,e,t,i,r,o){const s=o[e];if(null!==s)for(let a=0;a<s.length;a+=2)WI(i,t,s[a],s[a+1])}function ZI(n,e,t,i,r){const o=n.inputs?.[i],s=n.hostDirectiveInputs?.[i];let a=!1;if(s)for(let l=0;l<s.length;l+=2){const u=s[l];WI(e.data[u],t[u],s[l+1],r),a=!0}if(o)for(const l of o)WI(e.data[l],t[l],i,r),a=!0;return a}function X9(n,e){const t=Vr(e,n),i=t[1];!function Y9(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[0];null!==r&&null===t[6]&&(t[6]=HC(r,t[9])),lS(i,t,t[8])}function lS(n,e,t){rv(e);try{const i=n.viewQuery;null!==i&&T0(1,i,t);const r=n.template;null!==r&&jL(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[18]?.finishViewCreation(n),n.staticContentQueries&&XC(n,e),n.staticViewQueries&&T0(2,n.viewQuery,t);const o=n.components;null!==o&&function Z9(n,e){for(let t=0;t<e.length;t++)X9(n,e[t])}(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,Wm()}}function Lp(n,e){return!e||null===e.firstChild||bp(n)}function JI(n,e){return undefined(n,e)}var Kf=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Kf||{});function Jf(n){return!(32&~n.flags)}function N0(n,e,t,i,r){if(null!=i){let o,s=!1;Ur(i)?o=i:mr(i)&&(s=!0,i=i[0]);const a=Jt(i);0===n&&null!==t?null==r?BL(e,t,a):Fp(e,t,a,r||null,!0):1===n&&null!==t?Fp(e,t,a,r||null,!0):2===n?lb(e,a,s):3===n&&e.destroyNode(a),null!=o&&function iq(n,e,t,i,r){const o=t[7];o!==Jt(t)&&N0(e,n,i,o,r);for(let a=10;a<t.length;a++){const l=t[a];cS(l[1],l,n,e,i,o)}}(e,n,o,t,r)}}function YL(n,e){e[10].changeDetectionScheduler?.notify(9),cS(n,e,e[11],2,null,null)}function QI(n,e){const t=n[9],i=t.indexOf(e);t.splice(i,1)}function cb(n,e){if(au(e))return;const t=e[11];t.destroyNode&&cS(n,e,t,3,null,null),function Q9(n){let e=n[12];if(!e)return eR(n[1],n);for(;e;){let t=null;if(mr(e))t=e[12];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)mr(e)&&eR(e[1],e),e=e[3];null===e&&(e=n),mr(e)&&eR(e[1],e),t=e&&e[4]}e=t}}(e)}function eR(n,e){if(au(e))return;const t=et(null);try{e[2]&=-129,e[2]|=256,e[24]&&co(e[24]),function tq(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Pf)){const o=t[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=r[o[s]],l=o[s+1];try{l.call(a)}finally{}}else try{o.call(r)}finally{}}}}(n,e),function eq(n,e){const t=n.cleanup,i=e[7];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const a=t[s+3];a>=0?i[a]():i[-a].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[7]=null);const r=e[21];if(null!==r){e[21]=null;for(let s=0;s<r.length;s++)(0,r[s])()}const o=e[23];if(null!==o){e[23]=null;for(const s of o)s.destroy()}}(n,e),1===e[1].type&&e[11].destroy();const i=e[16];if(null!==i&&Ur(e[3])){i!==e[3]&&QI(i,e);const r=e[18];null!==r&&r.detachView(n)}Sv(e)}finally{et(t)}}function tR(n,e,t){return function ZL(n,e,t){let i=e;for(;null!==i&&168&i.type;)i=(e=i).parent;if(null===i)return t[0];if(ja(i)){const{encapsulation:r}=n.data[i.directiveStart+i.componentOffset];if(r===ya.None||r===ya.Emulated)return null}return jo(i,t)}(n,e.parent,t)}let QL=function JL(n,e,t){return 40&n.type?jo(n,t):null};function uS(n,e,t,i){const r=tR(n,i,e),o=e[11],a=function KL(n,e,t){return QL(n,e,t)}(i.parent||e[5],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)UL(o,r,t[l],a,!1);else UL(o,r,t,a,!1)}function kp(n,e){if(null!==e){const t=e.type;if(3&t)return jo(e,n);if(4&t)return iR(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return kp(n,i);{const r=n[e.index];return Ur(r)?iR(-1,r):Jt(r)}}if(128&t)return kp(n,e.next);if(32&t)return JI(e,n)()||Jt(n[e.index]);{const i=tk(n,e);return null!==i?Array.isArray(i)?i[0]:kp(Wa(n[15]),i):kp(n,e.next)}}return null}function tk(n,e){return null!==e?n[15][5].projection[e.projection]:null}function iR(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return kp(i,r)}return e[7]}function rR(n,e,t,i,r,o,s){for(;null!=t;){if(128===t.type){t=t.next;continue}const a=i[t.index],l=t.type;if(s&&0===e&&(a&&ps(Jt(a),i),t.flags|=2),!Jf(t))if(8&l)rR(n,e,t.child,i,r,o,!1),N0(e,n,r,a,o);else if(32&l){const u=JI(t,i);let c;for(;c=u();)N0(e,n,r,c,o);N0(e,n,r,a,o)}else 16&l?nk(n,e,i,t,r,o):N0(e,n,r,a,o);t=s?t.projectionNext:t.next}}function cS(n,e,t,i,r,o){rR(t,i,n.firstChild,e,r,o,!1)}function nk(n,e,t,i,r,o){const s=t[15],l=s[5].projection[i.projection];if(Array.isArray(l))for(let u=0;u<l.length;u++)N0(e,n,r,l[u],o);else{let u=l;const c=s[3];bp(i)&&(u.flags|=128),rR(n,e,u,c,r,o,!0)}}function F0(n,e,t,i,r=!1){for(;null!==t;){if(128===t.type){t=r?t.projectionNext:t.next;continue}const o=e[t.index];null!==o&&i.push(Jt(o)),Ur(o)&&oR(o,i);const s=t.type;if(8&s)F0(n,e,t.child,i);else if(32&s){const a=JI(t,e);let l;for(;l=a();)i.push(l)}else if(16&s){const a=tk(e,t);if(Array.isArray(a))i.push(...a);else{const l=Wa(e[15]);F0(l[1],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function oR(n,e){for(let t=10;t<n.length;t++){const i=n[t],r=i[1].firstChild;null!==r&&F0(i[1],i,r,e)}n[7]!==n[0]&&e.push(n[7])}function ik(n){if(null!==n[25]){for(const e of n[25])e.impl.addSequence(e);n[25].length=0}}let rk=[];const lq={...gr,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{Sf(n.lView)},consumerOnSignalRead(){this.lView[24]=this}},cq={...gr,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=Wa(n.lView);for(;e&&!ok(e[1]);)e=Wa(e);e&&Xy(e)},consumerOnSignalRead(){this.lView[24]=this}};function ok(n){return 2!==n.type}function sk(n){if(null===n[23])return;let e=!0;for(;e;){let t=!1;for(const i of n[23])i.dirty&&(t=!0,null===i.zone||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));e=t&&!!(8192&n[2])}}function dS(n,e=!0,t=0){const r=n[10].rendererFactory;r.begin?.();try{!function fq(n,e){const t=uu();try{Af(!0),sR(n,e);let i=0;for(;Cf(n);){if(100===i)throw new ce(103,!1);i++,sR(n,1)}}finally{Af(t)}}(n,t)}catch(s){throw e&&function YI(n,e){const t=n[9],i=t?t.get(Ya,null):null;i&&i.handleError(e)}(n,s),s}finally{r.end?.()}}function lk(n,e,t,i){if(au(e))return;const r=e[2];rv(e);let a=!0,l=null,u=null;ok(n)?(u=function oq(n){return n[24]??function sq(n){const e=rk.pop()??Object.create(lq);return e.lView=n,e}(n)}(e),l=$r(u)):null===function Un(){return Mt}()?(a=!1,u=function uq(n){const e=n[24]??Object.create(cq);return e.lView=n,e}(e),l=$r(u)):e[24]&&(co(e[24]),e[24]=null);try{mM(e),function nv(n){return Qt.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&jL(n,e,t,2,i);const c=!(3&~r);if(c){const g=n.preOrderCheckHooks;null!==g&&dp(e,g,null)}else{const g=n.preOrderHooks;null!==g&&sd(e,g,0,null),qm(e,0)}if(function hq(n){for(let e=cC(n);null!==e;e=dC(e)){if(!(2&e[2]))continue;const t=e[9];for(let i=0;i<t.length;i++)Xy(t[i])}}(e),sk(e),uk(e,0),null!==n.contentQueries&&XC(n,e),c){const g=n.contentCheckHooks;null!==g&&dp(e,g)}else{const g=n.contentHooks;null!==g&&sd(e,g,1),qm(e,1)}!function gq(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)od(~r);else{const o=r,s=t[++i],a=t[++i];cc(s,o);const l=e[o];a(2,l)}}}finally{od(-1)}}(n,e);const f=n.components;null!==f&&dk(e,f,0);const h=n.viewQuery;if(null!==h&&T0(2,h,i),c){const g=n.viewCheckHooks;null!==g&&dp(e,g)}else{const g=n.viewHooks;null!==g&&sd(e,g,2),qm(e,2)}if(!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[22]){for(const g of e[22])g();e[22]=null}ik(e),e[2]&=-73}catch(c){throw Sf(e),c}finally{null!==u&&(Tr(u,l),a&&function aq(n){n.lView[24]!==n&&(n.lView=null,rk.push(n))}(u)),Wm()}}function uk(n,e){for(let t=cC(n);null!==t;t=dC(t))for(let i=10;i<t.length;i++)ck(t[i],e)}function pq(n,e,t){const i=Vr(e,n);ck(i,t)}function ck(n,e){qy(n)&&sR(n,e)}function sR(n,e){const i=n[1],r=n[2],o=n[24];let s=!!(0===e&&16&r);if(s||=!!(64&r&&0===e),s||=!!(1024&r),s||=!(!o?.dirty||!Os(o)),s||=!1,o&&(o.dirty=!1),n[2]&=-9217,s)lk(i,n,i.template,n[8]);else if(8192&r){sk(n),uk(n,1);const a=i.components;null!==a&&dk(n,a,1),ik(n)}}function dk(n,e,t){for(let i=0;i<e.length;i++)pq(n,e[i],t)}function db(n,e){const t=uu()?64:1088;for(n[10].changeDetectionScheduler?.notify(e);n;){n[2]|=t;const i=Wa(n);if(su(n)&&!i)return n;n=i}return null}function fk(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function fb(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[16];null!==r&&r!==n&&QI(r,i),e>0&&(n[t-1][4]=i[4]);const o=Em(n,10+e);!function XL(n,e){YL(n,e),e[0]=null,e[5]=null}(i[1],i);const s=o[18];null!==s&&s.detachView(o[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function pk(n,e){const t=n[9],i=e[3];(mr(i)||e[15]!==i[3][15])&&(n[2]|=2),null===t?n[9]=[e]:t.push(e)}let hb=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){const e=this._lView,t=e[1];return F0(t,e,t.firstChild,[])}constructor(e,t,i=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=i}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return au(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(Ur(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(fb(e,i),Em(t,i))}this._attachedToViewContainer=!1}cb(this._lView[1],this._lView)}onDestroy(e){Bm(this._lView,e)}markForCheck(){db(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[2]&=-129}reattach(){Yy(this._lView),this._lView[2]|=128}detectChanges(){this._lView[2]|=1024,dS(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ce(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;const e=su(this._lView),t=this._lView[16];null!==t&&!e&&QI(t,this._lView),YL(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ce(902,!1);this._appRef=e;const t=su(this._lView),i=this._lView[16];null!==i&&!t&&pk(i,this._lView),Yy(this._lView)}},Ws=(()=>class n{static __NG_ELEMENT_ID__=vq})();const _q=Ws,yq=class extends _q{_declarationLView;_declarationTContainer;elementRef;constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=function O0(n,e,t,i){const r=et(null);try{const o=e.tView,l=oS(n,o,t,4096&n[2]?4096:16,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null);l[16]=n[e.index];const c=n[18];return null!==c&&(l[18]=c.createEmbeddedView(o)),lS(o,l,t),l}finally{et(r)}}(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:i});return new hb(r)}};function vq(){return fS(Mn(),K())}function fS(n,e){return 4&n.type?new yq(e,n,Bf(n,e)):null}function k0(n,e,t,i,r){let o=n.data[e];if(null===o)o=function dR(n,e,t,i,r){const o=wM(),s=tv(),l=n.data[e]=function Dq(n,e,t,i,r,o){let s=e?e.injectorIndex:-1,a=0;return rd()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,t,e,i,r);return function Aq(n,e,t,i){null===n.firstChild&&(n.firstChild=e),null!==t&&(i?null==t.child&&null!==e.parent&&(t.child=e):null===t.next&&(t.next=e,e.prev=t))}(n,l,o,s),l}(n,e,t,i,r),function iv(){return Qt.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=t,o.value=i,o.attrs=r;const s=function up(){const n=Qt.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return _r(o,!0),o}const Uq=new RegExp("^(\\d+)*(b|h)*(.*)");function hR(n){return n.index-26}function vb(n,e,t,i){const r=hR(i);let o=function Ek(n,e){const t=n.i18nNodes;if(t)return t.get(e)}(n,r);if(void 0===o){const s=n.data.n;if(s?.[r])o=function Tk(n,e){const[t,...i]=function Hq(n){const e=n.match(Uq),[t,i,r,o]=e,s=i?parseInt(i,10):r,a=[];for(const[l,u,c]of o.matchAll(/(f|n)(\d*)/g)){const f=parseInt(c,10)||1;a.push(u,f)}return[s,...a]}(n);let r;r="h"===t?e[15][0]:"b"===t?function IL(n){return n.ownerDocument.body}(e[15][0]):Jt(e[Number(t)+26]);return function jq(n,e){let t=n;for(let i=0;i<e.length;i+=2){const r=e[i],o=e[i+1];for(let s=0;s<o;s++)switch(r){case"f":t=t.firstChild;break;case"n":t=t.nextSibling}}return t}(r,i)}(s[r],t);else if(e.firstChild===i)o=n.firstChild;else{const a=null===i.prev,l=i.prev??i.parent;if(function zq(n){return!n.prev&&8===n.parent?.type}(i))o=Jv(n,hR(i.parent));else{let u=jo(l,t);if(a)o=u.firstChild;else{const c=hR(l),f=Jv(n,c);o=2===l.type&&f?mS(E0(n,c)+1,f):u.nextSibling}}}}return o}function mS(n,e){let t=e;for(let i=0;i<n;i++)t=t.nextSibling;return t}let Dk=!1;function uX(n,e,t){for(const i of t.node.cases[t.case]){const r=e.get(i.index-26);r&&lb(n,r,!1)}}function Ok(n){const e=n[6]??[],i=n[3][11],r=[];for(const o of e)void 0!==o.data.di?r.push(o):Nk(o,i);n[6]=r}function Nk(n,e){let t=0,i=n.firstChild;if(i){const r=n.data.r;for(;t<r;){const o=i.nextSibling;lb(e,i,!1),i=o,t++}}}function _S(n){Ok(n);const e=n[0];mr(e)&&yS(e);for(let t=10;t<n.length;t++)yS(n[t])}function yS(n){!function lX(n){const e=n[6];if(e){const{i18nNodes:t,dehydratedIcuData:i}=e;if(t&&i){const r=n[11];for(const o of i.values())uX(r,t,o)}e.i18nNodes=void 0,e.dehydratedIcuData=void 0}}(n);const e=n[1];for(let t=26;t<e.bindingStartIndex;t++)Ur(n[t])?_S(n[t]):mr(n[t])&&yS(n[t])}let Lk=()=>null;function hX(n,e){const t=n[6];return e&&null!==t&&0!==t.length?t[0].data.i===e?t.shift():(Ok(n),null):null}function U0(n,e){return Lk(n,e)}let gX=class{},kk=class{};class mX{resolveComponentFactory(e){throw Error(`No component factory found for ${kr(e)}.`)}}let vS=class{static NULL=new mX};class bS{}let Dl=(()=>class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>function _X(){const n=K(),t=Vr(Mn().index,n);return(mr(t)?t:n)[11]}()})(),yX=(()=>{class n{static \u0275prov=Ve({token:n,providedIn:"root",factory:()=>null})}return n})();const bR={};class V0{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=Yh(i);const r=this.injector.get(e,bR,i);return r!==bR||t===bR?r:this.parentInjector.get(e,t,i)}}function wR(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,o=0;if(null!==e)for(let s=0;s<e.length;s++){const a=e[s];"number"==typeof a?o=a:1==o?r=_m(r,a):2==o&&(i=_m(i,a+": "+e[++s]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function se(n,e=xn.Default){const t=K();return null===t?Ze(n,e):PM(Mn(),t,Zt(n),e)}function xR(n,e,t,i,r){const o=null===i?null:{"":-1},s=r(n,t);if(null!==s){let a,l=null,u=null;const c=function CX(n){let e=null,t=!1;for(let s=0;s<n.length;s++){const a=n[s];if(0===s&&lr(a)&&(e=a),null!==a.findHostDirectiveDefs){t=!0;break}}if(!t)return null;let i=null,r=null,o=null;for(const s of n)null!==s.findHostDirectiveDefs&&(i??=[],r??=new Map,o??=new Map,SX(s,i,o,r)),s===e&&(i??=[],i.push(s));return null!==i?(i.push(...null===e?n:n.slice(1)),[i,r,o]):null}(s);null===c?a=s:[a,l,u]=c,function TX(n,e,t,i,r,o,s){const a=i.length;let l=!1;for(let h=0;h<a;h++){const g=i[h];!l&&lr(g)&&(l=!0,EX(n,t,h)),Qm(pp(t,e),n,g.type)}!function OX(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,a);for(let h=0;h<a;h++){const g=i[h];g.providersResolver&&g.providersResolver(g)}let u=!1,c=!1,f=ub(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let h=0;h<a;h++){const g=i[h];if(t.mergedAttrs=Nf(t.mergedAttrs,g.hostAttrs),DX(n,t,e,f,g),PX(f,g,r),null!==s&&s.has(g)){const[v,_]=s.get(g);t.directiveToIndex.set(g.type,[f,v+t.directiveStart,_+t.directiveStart])}else(null===o||!o.has(g))&&t.directiveToIndex.set(g.type,f);null!==g.contentQueries&&(t.flags|=4),(null!==g.hostBindings||null!==g.hostAttrs||0!==g.hostVars)&&(t.flags|=64);const m=g.type.prototype;!u&&(m.ngOnChanges||m.ngOnInit||m.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),u=!0),!c&&(m.ngOnChanges||m.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),c=!0),f++}!function AX(n,e,t){for(let i=e.directiveStart;i<e.directiveEnd;i++){const r=n.data[i];if(null!==t&&t.has(r)){const o=t.get(r);Vk(0,e,o,i),Vk(1,e,o,i),zk(e,i,!0)}else Uk(0,e,r,i),Uk(1,e,r,i),zk(e,i,!1)}}(n,t,o)}(n,e,t,a,o,l,u)}null!==o&&null!==i&&function MX(n,e,t){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const o=t[e[r+1]];if(null==o)throw new ce(-301,!1);i.push(e[r],o)}}(t,i,o)}function SX(n,e,t,i){const r=e.length;n.findHostDirectiveDefs(n,e,i),t.set(n,[r,e.length-1])}function EX(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function Uk(n,e,t,i){const r=0===n?t.inputs:t.outputs;for(const o in r)if(r.hasOwnProperty(o)){let s;s=0===n?e.inputs??={}:e.outputs??={},s[o]??=[],s[o].push(i),Hk(e,o)}}function Vk(n,e,t,i){const r=0===n?t.inputs:t.outputs;for(const o in r)if(r.hasOwnProperty(o)){const s=r[o];let a;a=0===n?e.hostDirectiveInputs??={}:e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(i,o),Hk(e,s)}}function Hk(n,e){"class"===e?n.flags|=8:"style"===e&&(n.flags|=16)}function zk(n,e,t){const{attrs:i,inputs:r,hostDirectiveInputs:o}=n;if(null===i||!t&&null===r||t&&null===o||UI(n))return n.initialInputs??=[],void n.initialInputs.push(null);let s=null,a=0;for(;a<i.length;){const l=i[a];if(0!==l)if(5!==l){if("number"==typeof l)break;if(!t&&r.hasOwnProperty(l)){const u=r[l];for(const c of u)if(c===e){s??=[],s.push(l,i[a+1]);break}}else if(t&&o.hasOwnProperty(l)){const u=o[l];for(let c=0;c<u.length;c+=2)if(u[c]===e){s??=[],s.push(u[c+1],i[a+1]);break}}a+=2}else a+=2;else a+=4}n.initialInputs??=[],n.initialInputs.push(s)}function DX(n,e,t,i,r){n.data[i]=r;const o=r.factory||(r.factory=tc(r.type)),s=new Pf(o,lr(r),se);n.blueprint[i]=s,t[i]=s,function IX(n,e,t,i,r){const o=r.hostBindings;if(o){let s=n.hostBindingOpCodes;null===s&&(s=n.hostBindingOpCodes=[]);const a=~e.index;(function RX(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(s)!=a&&s.push(a),s.push(t,i,o)}}(n,e,i,ub(n,t,r.hostVars,hn),r)}function PX(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;lr(e)&&(t[""]=n)}}function Gk(n,e,t,i,r,o,s,a){const l=e.consts,c=k0(e,n,2,i,Do(l,s));return o&&xR(e,t,c,Do(l,a),r),c.mergedAttrs=Nf(c.mergedAttrs,c.attrs),null!==c.attrs&&wR(c,c.attrs,!1),null!==c.mergedAttrs&&wR(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}function jk(n,e){$m(n,e),ou(e)&&n.queries.elementEnd(e)}class Wk extends vS{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=gt(e);return new Mb(t,this.ngModule)}}class Mb extends kk{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=function NX(n){return Object.keys(n).map(e=>{const[t,i,r]=n[e],o={propName:t,templateName:e,isSignal:!!(i&sS.SignalBased)};return r&&(o.transform=r),o})}(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=function FX(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function P9(n){return n.map(R9).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,i,r){const o=et(null);try{const s=this.componentDef,a=i?["ng-version","19.2.10"]:function O9(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let o=n[i];if("string"==typeof o)2===r?""!==o&&e.push(o,n[++i]):8===r&&t.push(o);else{if(!gu(r))break;r=o}i++}return t.length&&e.push(1,...t),e}(this.componentDef.selectors[0]),l=zI(0,null,null,1,0,null,null,null,null,[a],null),u=function LX(n,e,t){let i=e instanceof Ho?e:e?.injector;return i&&null!==n.getStandaloneInjector&&(i=n.getStandaloneInjector(i)||i),i?new V0(t,i):t}(s,r||this.ngModule,e),c=function kX(n){const e=n.get(bS,null);if(null===e)throw new ce(407,!1);return{rendererFactory:e,sanitizer:n.get(yX,null),changeDetectionScheduler:n.get(fu,null)}}(u),f=c.rendererFactory.createRenderer(null,s),h=i?function B9(n,e,t,i){const o=i.get(TC,!1)||t===ya.ShadowDom,s=n.selectRootElement(e,o);return function U9(n){WL(n)}(s),s}(f,i,s.encapsulation,u):function BX(n,e){const t=(n.selectors[0][0]||"div").toLowerCase();return rS(e,t,"svg"===t?"svg":"math"===t?"math":null)}(s,f),g=oS(null,l,null,512|GI(s),null,null,c,f,u,null,HC(h,u,!0));g[26]=h,rv(g);let m=null;try{const v=Gk(26,l,g,"#host",()=>[this.componentDef],!0,0);h&&(HL(f,h,v),ps(h,g)),aS(l,g,v),ob(l,v,g),jk(l,v),void 0!==t&&function VX(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const o=t[r];i.push(null!=o&&o.length?Array.from(o):null)}}(v,this.ngContentSelectors,t),m=Vr(v.index,g),g[8]=m[8],lS(l,g,null)}catch(v){throw null!==m&&Sv(m),Sv(g),v}finally{Wm()}return new UX(this.componentType,g)}finally{et(o)}}}class UX extends gX{_rootLView;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t){super(),this._rootLView=t,this._tNode=lu(t[1],26),this.location=Bf(this._tNode,t),this.instance=Vr(this._tNode.index,t)[8],this.hostView=this.changeDetectorRef=new hb(t,void 0,!1),this.componentType=e}setInput(e,t){const i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const r=this._rootLView;ZI(i,r[1],r,e,t),this.previousInputValues.set(e,t),db(Vr(i.index,r),1)}get injector(){return new ur(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}let mu=(()=>class n{static __NG_ELEMENT_ID__=HX})();function HX(){return Xk(Mn(),K())}const zX=mu,$k=class extends zX{_lContainer;_hostTNode;_hostLView;constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Bf(this._hostTNode,this._hostLView)}get injector(){return new ur(this._hostTNode,this._hostLView)}get parentInjector(){const e=Jm(this._hostTNode,this._hostLView);if($a(e)){const t=ld(e,this._hostLView),i=ad(e);return new ur(t[1].data[i+8],t)}return new ur(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=qk(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){let r,o;"number"==typeof i?r=i:null!=i&&(r=i.index,o=i.injector);const s=U0(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,r,Lp(this._hostTNode,s)),a}createComponent(e,t,i,r,o){const s=e&&!function _f(n){return"function"==typeof n}(e);let a;if(s)a=t;else{const m=t||{};a=m.index,i=m.injector,r=m.projectableNodes,o=m.environmentInjector||m.ngModuleRef}const l=s?e:new Mb(gt(e)),u=i||this.parentInjector;if(!o&&null==l.ngModule){const v=(s?u:this.parentInjector).get(Ho,null);v&&(o=v)}const c=gt(l.componentType??{}),f=U0(this._lContainer,c?.id??null),g=l.create(u,r,f?.firstChild??null,o);return this.insertImpl(g.hostView,a,Lp(this._hostTNode,f)),g}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){const r=e._lView;if(function lD(n){return Ur(n[3])}(r)){const a=this.indexOf(e);if(-1!==a)this.detach(a);else{const l=r[3],u=new $k(l,l[5],l[3]);u.detach(u.indexOf(e))}}const o=this._adjustIndex(t),s=this._lContainer;return function L0(n,e,t,i=!0){const r=e[1];if(function mq(n,e,t,i){const r=10+i,o=t.length;i>0&&(t[r-1][4]=e),i<o-10?(e[4]=t[r],tM(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const s=e[16];null!==s&&t!==s&&pk(s,e);const a=e[18];null!==a&&a.insertView(n),Yy(e),e[2]|=128}(r,e,n,t),i){const s=iR(t,n),a=e[11],l=a.parentNode(n[7]);null!==l&&function J9(n,e,t,i,r,o){i[0]=r,i[5]=e,cS(n,i,t,1,r,o)}(r,n[5],a,e,l,s)}const o=e[6];null!==o&&null!==o.firstChild&&(o.firstChild=null)}(s,r,o,i),e.attachToViewContainerRef(),tM(MR(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=qk(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=fb(this._lContainer,t);i&&(Em(MR(this._lContainer),t),cb(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=fb(this._lContainer,t);return i&&null!=Em(MR(this._lContainer),t)?new hb(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function qk(n){return n[8]}function MR(n){return n[8]||(n[8]=[])}function Xk(n,e){let t;const i=e[n.index];return Ur(i)?t=i:(t=fk(i,e,null,n),e[n.index]=t,jI(e,t)),Yk(t,e,n,i),new $k(t,n,e)}let Yk=Kk,CR=()=>!1;function Kk(n,e,t,i){if(n[7])return;let r;r=8&t.type?Jt(i):function GX(n,e){const t=n[11],i=t.createComment(""),r=jo(e,n),o=t.parentNode(r);return Fp(t,o,i,t.nextSibling(r),!1),i}(e,t),n[7]=r}function jX(n,e,t){if(n[7]&&n[6])return!0;const i=t[6],r=e.index-26;if(!i||function wp(n){if(bp(n))return!0;let e=n.parent;for(;e;){if(bp(n)||Mv(e))return!0;e=e.parent}return!1}(e)||yd(i,r))return!1;const s=Jv(i,r),a=i.data.c?.[r],[l,u]=function fX(n,e){const t=[];for(const i of e)for(let r=0;r<(i.x??1);r++){const o={data:i,firstChild:null};i.r>0&&(o.firstChild=n,n=mS(i.r,n)),t.push(o)}return[n,t]}(s,a);return n[7]=l,n[6]=u,!0}function WX(n,e,t,i){CR(n,t,e)||Kk(n,e,t,i)}class SR{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new SR(this.queryList)}setDirty(){this.queryList.setDirty()}}class ER{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let o=0;o<i;o++){const s=t.getByIndex(o);r.push(this.queries[s.indexInDeclarationView].clone())}return new ER(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==RR(e,t).matches&&this.queries[t].setDirty()}}class Jk{flags;read;predicate;constructor(e,t,i=null){this.flags=t,this.read=i,this.predicate="string"==typeof e?function KX(n){return n.split(",").map(e=>e.trim())}(e):e}}class TR{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,o=this.getByIndex(i).embeddedTView(e,r);o&&(o.indexInDeclarationView=i,null!==t?t.push(o):t=[o])}return null!==t?new TR(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class AR{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new AR(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1&~this.metadata.flags){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(e,t,qX(t,o)),this.matchTNodeWithReadOption(e,t,to(t,e,o,!1,!1))}else i===Ws?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,to(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===gi||r===mu||r===Ws&&4&t.type)this.addMatch(t.index,-2);else{const o=to(t,e,r,!1,!1);null!==o&&this.addMatch(t.index,o)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function qX(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function YX(n,e,t,i){return-1===t?function XX(n,e){return 11&n.type?Bf(n,e):4&n.type?fS(n,e):null}(e,n):-2===t?function ZX(n,e,t){return t===gi?Bf(e,n):t===Ws?fS(e,n):t===mu?Xk(e,n):void 0}(n,e,i):cd(n,n[1],t,e)}function Qk(n,e,t,i){const r=e[18].queries[i];if(null===r.matches){const o=n.data,s=t.matches,a=[];for(let l=0;null!==s&&l<s.length;l+=2){const u=s[l];a.push(u<0?null:YX(e,o[u],s[l+1],t.metadata.read))}r.matches=a}return r.matches}function DR(n,e,t,i){const r=n.queries.getByIndex(t),o=r.matches;if(null!==o){const s=Qk(n,e,r,t);for(let a=0;a<o.length;a+=2){const l=o[a];if(l>0)i.push(s[a/2]);else{const u=o[a+1],c=e[-l];for(let f=10;f<c.length;f++){const h=c[f];h[16]===h[3]&&DR(h[1],h,u,i)}if(null!==c[9]){const f=c[9];for(let h=0;h<f.length;h++){const g=f[h];DR(g[1],g,u,i)}}}}}return i}function eB(n,e,t){const i=new nC(!(4&~t));return function _M(n,e,t,i){const r=Zy(e);r.push(t),n.firstCreatePass&&ap(n).push(i,r.length-1)}(n,e,i,i.destroy),(e[18]??=new ER).queries.push(new SR(i))-1}function iB(n,e,t){null===n.queries&&(n.queries=new TR),n.queries.track(new AR(e,t))}function RR(n,e){return n.queries.getByIndex(e)}function rB(n,e){const t=n[1],i=RR(t,e);return i.crossesNgTemplate?DR(t,n,e,[]):Qk(t,n,i,e)}let Vp=class{},gB=class{};class NR extends Vp{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Wk(this);constructor(e,t,i,r=!0){super(),this.ngModuleType=e,this._parent=t;const o=Pt(e);this._bootstrapComponents=_c(o.bootstrap),this._r3Injector=GM(e,t,[{provide:Vp,useValue:this},{provide:vS,useValue:this.componentFactoryResolver},...i],kr(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class FR extends gB{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new NR(this.moduleType,e,[])}}class mB extends Vp{injector;componentFactoryResolver=new Wk(this);instance=null;constructor(e){super();const t=new ic([...e.providers,{provide:Vp,useValue:this},{provide:vS,useValue:this.componentFactoryResolver}],e.parent||Qc(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function LR(n,e,t=null){return new mB({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let cY=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=ky(0,t.type),r=i.length>0?LR([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Ve({token:n,providedIn:"environment",factory:()=>new n(Ze(Ho))})}return n})();function mo(n){return vl(()=>{const e=_B(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===r0.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?r=>r.get(cY).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||ya.Emulated,styles:n.styles||Gn,_:null,schemas:n.schemas||null,tView:null,id:""};e.standalone&&$o("NgStandalone"),yB(t);const i=n.dependencies;return t.directiveDefs=xS(i,!1),t.pipeDefs=xS(i,!0),t.id=function mY(n){let e=0;const i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,"function"==typeof n.consts?"":n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(const o of i.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)|0;return e+=2147483648,"c"+e}(t),t})}function dY(n){return gt(n)||jn(n)}function fY(n){return null!==n}function Hp(n){return vl(()=>({type:n.type,bootstrap:n.bootstrap||Gn,declarations:n.declarations||Gn,imports:n.imports||Gn,exports:n.exports||Gn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function hY(n,e){if(null==n)return Va;const t={};for(const i in n)if(n.hasOwnProperty(i)){const r=n[i];let o,s,a,l;Array.isArray(r)?(a=r[0],o=r[1],s=r[2]??o,l=r[3]||null):(o=r,s=r,a=sS.None,l=null),t[o]=[i,a,l],e[o]=s}return t}function pY(n){if(null==n)return Va;const e={};for(const t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function _t(n){return vl(()=>{const e=_B(n);return yB(e),e})}function _s(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function _B(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Va,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:!0===n.signals,selectors:n.selectors||Gn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:hY(n.inputs,e),outputs:pY(n.outputs),debugInfo:null}}function yB(n){n.features?.forEach(e=>e(n))}function xS(n,e){if(!n)return null;const t=e?Tn:dY;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(fY)}function In(n){let e=function vB(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(lr(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ce(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const s=n;s.inputs=kR(n.inputs),s.declaredInputs=kR(n.declaredInputs),s.outputs=kR(n.outputs);const a=r.hostBindings;a&&wY(n,a);const l=r.viewQuery,u=r.contentQueries;if(l&&vY(n,l),u&&bY(n,u),_Y(n,r),qx(n.outputs,r.outputs),lr(r)&&r.data.animation){const c=n.data;c.animation=(c.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(n),a===In&&(t=!1)}}e=Object.getPrototypeOf(e)}!function yY(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Nf(r.hostAttrs,t=Nf(t,r.hostAttrs))}}(i)}function _Y(n,e){for(const t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;const i=e.inputs[t];void 0!==i&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t])}}function kR(n){return n===Va?{}:n===Gn?[]:n}function vY(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function bY(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,o)=>{e(i,r,o),t(i,r,o)}:e}function wY(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function bB(n){const e=t=>{const i=Array.isArray(n);null===t.hostDirectives?(t.findHostDirectiveDefs=wB,t.hostDirectives=i?n.map(BR):[n]):i?t.hostDirectives.unshift(...n.map(BR)):t.hostDirectives.unshift(n)};return e.ngInherit=!0,e}function wB(n,e,t){if(null!==n.hostDirectives)for(const i of n.hostDirectives)if("function"==typeof i){const r=i();for(const o of r)xB(BR(o),e,t)}else xB(i,e,t)}function xB(n,e,t){const i=jn(n.directive);(function SY(n,e){for(const t in e)e.hasOwnProperty(t)&&(n[e[t]]=n[t])})(i.declaredInputs,n.inputs),wB(i,e,t),t.set(i,n),e.push(i)}function BR(n){return"function"==typeof n?{directive:Zt(n),inputs:Va,outputs:Va}:{directive:Zt(n.directive),inputs:MB(n.inputs),outputs:MB(n.outputs)}}function MB(n){if(void 0===n||0===n.length)return Va;const e={};for(let t=0;t<n.length;t+=2)e[n[t]]=n[t+1];return e}function MS(n){return!!function UR(n){return null!==n&&("function"==typeof n||"object"==typeof n)}(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function vc(n,e,t){return n[e]=t}function Ir(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Eb(n,e,t,i,r,o,s,a,l,u){const c=t+26,f=e.firstCreatePass?function DY(n,e,t,i,r,o,s,a,l){const u=e.consts,c=k0(e,n,4,s||null,a||null);Vm()&&xR(e,t,c,Do(u,l),qI),c.mergedAttrs=Nf(c.mergedAttrs,c.attrs),$m(e,c);const f=c.tView=zI(2,c,i,r,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return null!==e.queries&&(e.queries.template(e,c),f.queries=e.queries.embeddedTView(c)),c}(c,e,n,i,r,o,s,a,l):e.data[c];_r(f,!1);const h=SB(e,n,f,t);Cl()&&uS(e,n,h,f),ps(h,n);const g=fk(h,n,h,f);return n[c]=g,jI(n,g),function Zk(n,e,t){return CR(n,e,t)}(g,f,n),Om(f)&&aS(e,n,f),null!=l&&$I(n,f,u),f}function ze(n,e,t,i,r,o,s,a){const l=K(),u=jt();return Eb(l,u,n,e,t,i,r,Do(u.consts,o),s,a),ze}let SB=EB;function EB(n,e,t,i){return ds(!0),e[11].createComment("")}function IY(n,e,t,i){const r=e[6],o=!r||rd()||Jf(t)||yd(r,i);if(ds(o),o)return EB(0,e);const s=r.data.t?.[i]??null;null!==s&&null!==t.tView&&null===t.tView.ssrId&&(t.tView.ssrId=s);const a=vb(r,n,e,t);return S0(r,i,a),mS(E0(r,i),a)}let AS=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const UB=new be("");let VB=(()=>{class n{static \u0275prov=Ve({token:n,providedIn:"root",factory:()=>new AZ})}return n})();class AZ{queuedEffectCount=0;queues=new Map;schedule(e){this.enqueue(e)}remove(e){const i=this.queues.get(e.zone);i.has(e)&&(i.delete(e),this.queuedEffectCount--)}enqueue(e){const t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);const i=this.queues.get(t);i.has(e)||(this.queuedEffectCount++,i.add(e))}flush(){for(;this.queuedEffectCount>0;)for(const[e,t]of this.queues)null===e?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(const t of e)e.delete(t),this.queuedEffectCount--,t.run()}}function Ab(n){return!!n&&"function"==typeof n.then}function HB(n){return!!n&&"function"==typeof n.subscribe}const zB=new be("");let GB=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=j(zB,{optional:!0})??[];injector=j(no);constructor(){}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const o=Bs(this.injector,r);if(Ab(o))t.push(o);else if(HB(o)){const s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});t.push(s)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const j0=new be("");let xa=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=j(OD);afterRenderManager=j(zv);zonelessEnabled=j(fd);rootEffectScheduler=j(VB);dirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new Xr;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=j(hu).hasPendingTasks.pipe(Nt(t=>!t));constructor(){j(Si,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=j(Ho);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){return this.bootstrapImpl(t,i)}bootstrapImpl(t,i,r=no.NULL){const o=t instanceof kk;if(!this._injector.get(GB).done)throw new ce(405,"");let a;a=o?t:this._injector.get(vS).resolveComponentFactory(t),this.componentTypes.push(a.componentType);const l=function DZ(n){return n.isBoundToModule}(a)?void 0:this._injector.get(Vp),c=a.create(r,[],i||a.selector,l),f=c.location.nativeElement,h=c.injector.get(UB,null);return h?.registerApplication(f),c.onDestroy(()=>{this.detachView(c.hostView),IS(this.components,c),h?.unregisterApplication(f)}),this._loadComponent(c),c}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){null!==this.tracingSnapshot?this.tracingSnapshot.run(Gi.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new ce(101,!1);const t=et(null);try{this._runningTick=!0,this.synchronize()}catch(i){this.internalErrorHandler(i)}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,et(t),this.afterTick.next()}};synchronize(){null===this._rendererFactory&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(bS,null,{optional:!0}));let t=0;for(;0!==this.dirtyFlags&&t++<10;)this.synchronizeOnce()}synchronizeOnce(){if(16&this.dirtyFlags&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),7&this.dirtyFlags){const t=!!(1&this.dirtyFlags);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i,notifyErrorHandler:r}of this.allViews)RZ(i,r,t,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),23&this.dirtyFlags)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();8&this.dirtyFlags&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){this.allViews.some(({_lView:t})=>Cf(t))?this.dirtyFlags|=2:this.dirtyFlags&=-8}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;IS(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(j0,[]).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>IS(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ce(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function IS(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function RZ(n,e,t,i){(t||Cf(n))&&dS(n,e,t&&!i?0:1)}function $s(n,e,t,i){const r=K();return Ir(r,us(),e)&&(jt(),yc(yi(),r,n,e,t,i)),$s}function RS(n,e){return n<<17|e<<2}function jp(n){return n>>17&32767}function JR(n){return 2|n}function e_(n){return(131068&n)>>2}function QR(n,e){return-131069&n|e<<2}function e4(n){return 1|n}function uU(n,e,t,i){const r=n[t+1],o=null===e;let s=i?jp(r):e_(r),a=!1;for(;0!==s&&(!1===a||o);){const u=n[s+1];_K(n[s],e)&&(a=!0,n[s+1]=i?e4(u):JR(u)),s=i?jp(u):e_(u)}a&&(n[t+1]=i?JR(r):e4(r))}function _K(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Kh(n,e)>=0}const _o={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function cU(n){return n.substring(_o.key,_o.keyEnd)}function yK(n){return n.substring(_o.value,_o.valueEnd)}function fU(n,e){const t=_o.textEnd;let i=_o.key=t_(n,e,t);return t===i?-1:(i=_o.keyEnd=function xK(n,e,t){let i;for(;e<t&&(45===(i=n.charCodeAt(e))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)e++;return e}(n,i,t),i=pU(n,i,t),i=_o.value=t_(n,i,t),i=_o.valueEnd=function MK(n,e,t){let i=-1,r=-1,o=-1,s=e,a=s;for(;s<t;){const l=n.charCodeAt(s++);if(59===l)return a;34===l||39===l?a=s=gU(n,l,s,t):e===s-4&&85===o&&82===r&&76===i&&40===l?a=s=gU(n,41,s,t):l>32&&(a=s),o=r,r=i,i=-33&l}return a}(n,i,t),pU(n,i,t))}function t_(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function pU(n,e,t,i){return(e=t_(n,e,t))<t&&e++,e}function gU(n,e,t,i){let r=-1,o=t;for(;o<i;){const s=n.charCodeAt(o++);if(s==e&&92!==r)return o;r=92==s&&92===r?0:s}throw new Error}function ee(n,e,t){const i=K();return Ir(i,us(),e)&&wa(jt(),yi(),i,n,e,i[11],t,!1),ee}function t4(n,e,t,i,r){ZI(e,n,t,r?"class":"style",i)}function oo(n,e,t){return yu(n,e,t,!1),oo}function dr(n,e){return yu(n,e,null,!0),dr}function _u(n){!function vu(n,e,t,i){const r=jt(),o=xl(2);r.firstUpdatePass&&_U(r,null,o,i);const s=K();if(t!==hn&&Ir(s,o,t)){const a=r.data[Pi()];if(wU(a,i)&&!mU(r,o)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=_m(l,t||"")),t4(r,a,s,t,i)}else!function PK(n,e,t,i,r,o,s,a){r===hn&&(r=Gn);let l=0,u=0,c=0<r.length?r[0]:null,f=0<o.length?o[0]:null;for(;null!==c||null!==f;){const h=l<r.length?r[l+1]:void 0,g=u<o.length?o[u+1]:void 0;let v,m=null;c===f?(l+=2,u+=2,h!==g&&(m=f,v=g)):null===f||null!==c&&c<f?(l+=2,m=c):(u+=2,m=f,v=g),null!==m&&vU(n,e,t,i,m,v,s,a),c=l<r.length?r[l]:null,f=u<o.length?o[u]:null}}(r,a,s,s[11],s[o+1],s[o+1]=function IK(n,e,t){if(null==t||""===t)return Gn;const i=[],r=gc(t);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,o)}}(yU,CK,n,!1)}function CK(n,e){for(let t=function bK(n){return function hU(n){_o.key=0,_o.keyEnd=0,_o.value=0,_o.valueEnd=0,_o.textEnd=n.length}(n),fU(n,t_(n,0,_o.textEnd))}(e);t>=0;t=fU(e,t))yU(n,cU(e),yK(e))}function yu(n,e,t,i){const r=K(),o=jt(),s=xl(2);o.firstUpdatePass&&_U(o,n,s,i),e!==hn&&Ir(r,s,e)&&vU(o,o.data[Pi()],r,r[11],n,r[s+1]=function OK(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=kr(gc(n)))),n}(e,t),i,s)}function mU(n,e){return e>=n.expandoStartIndex}function _U(n,e,t,i){const r=n.data;if(null===r[t+1]){const o=r[Pi()],s=mU(n,t);wU(o,i)&&null===e&&!s&&(e=!1),e=function EK(n,e,t,i){const r=function Gm(n){const e=Qt.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let o=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=Ib(t=n4(null,n,e,t,i),e.attrs,i),o=null);else{const s=e.directiveStylingLast;if(-1===s||n[s]!==r)if(t=n4(r,n,e,t,i),null===o){let l=function TK(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==e_(i))return n[jp(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=n4(null,n,e,l[1],i),l=Ib(l,e.attrs,i),function AK(n,e,t,i){n[jp(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else o=function DK(n,e,t){let i;const r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++)i=Ib(i,n[o].hostAttrs,t);return Ib(i,e.attrs,t)}(n,e,i)}return void 0!==o&&(i?e.residualClasses=o:e.residualStyles=o),t}(r,o,e,i),function gK(n,e,t,i,r,o){let s=o?e.classBindings:e.styleBindings,a=jp(s),l=e_(s);n[i]=t;let c,u=!1;if(Array.isArray(t)?(c=t[1],(null===c||Kh(t,c)>0)&&(u=!0)):c=t,r)if(0!==l){const h=jp(n[a+1]);n[i+1]=RS(h,a),0!==h&&(n[h+1]=QR(n[h+1],i)),n[a+1]=function hK(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=RS(a,0),0!==a&&(n[a+1]=QR(n[a+1],i)),a=i;else n[i+1]=RS(l,0),0===a?a=i:n[l+1]=QR(n[l+1],i),l=i;u&&(n[i+1]=JR(n[i+1])),uU(n,c,i,!0),uU(n,c,i,!1),function mK(n,e,t,i,r){const o=r?n.residualClasses:n.residualStyles;null!=o&&"string"==typeof e&&Kh(o,e)>=0&&(t[i+1]=e4(t[i+1]))}(e,c,n,i,o),s=RS(a,l),o?e.classBindings=s:e.styleBindings=s}(r,o,e,t,s,i)}}function n4(n,e,t,i,r){let o=null;const s=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<s&&(o=e[a],i=Ib(i,o.hostAttrs,r),o!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function Ib(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let o=0;o<e.length;o++){const s=e[o];"number"==typeof s?r=s:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),ks(n,s,!!t||e[++o]))}return void 0===n?null:n}function yU(n,e,t){ks(n,e,gc(t))}function vU(n,e,t,i,r,o,s,a){if(!(3&e.type))return;const l=n.data,u=l[a+1],c=function pK(n){return!(1&~n)}(u)?bU(l,e,t,r,e_(u),s):void 0;PS(c)||(PS(o)||function fK(n){return!(2&~n)}(u)&&(o=bU(l,null,t,r,a,s)),function rq(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let o=-1===i.indexOf("-")?void 0:Kf.DashCase;null==r?n.removeStyle(t,i,o):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Kf.Important),n.setStyle(t,i,r,o))}}(i,s,Mf(Pi(),t),r,o))}function bU(n,e,t,i,r,o){const s=null===e;let a;for(;r>0;){const l=n[r],u=Array.isArray(l),c=u?l[1]:l,f=null===c;let h=t[r+1];h===hn&&(h=f?Gn:void 0);let g=f?Ly(h,i):c===i?h:void 0;if(u&&!PS(g)&&(g=Ly(l,i)),PS(g)&&(a=g,s))return a;const m=n[r+1];r=s?jp(m):e_(m)}if(null!==e){let l=o?e.residualClasses:e.residualStyles;null!=l&&(a=Ly(l,i))}return a}function PS(n){return void 0!==n}function wU(n,e){return!!(n.flags&(e?8:16))}function L(n,e,t,i){const r=K(),o=jt(),s=26+n,a=r[11],l=o.firstCreatePass?Gk(s,o,r,e,qI,Vm(),t,i):o.data[s],u=SU(o,r,l,a,e,n);r[s]=u;const c=Om(l);return _r(l,!0),HL(a,u,l),!Jf(l)&&Cl()&&uS(o,r,u,l),(0===function yM(){return Qt.lFrame.elementDepthCount}()||c)&&ps(u,r),function vM(){Qt.lFrame.elementDepthCount++}(),c&&(aS(o,r,l),ob(o,l,r)),null!==i&&$I(r,l),L}function k(){let n=Mn();tv()?Tf():(n=n.parent,_r(n,!1));const e=n;(function Jy(n){return Qt.skipHydrationRootTNode===n})(e)&&function ev(){Qt.skipHydrationRootTNode=null}(),function uD(){Qt.lFrame.elementDepthCount--}();const t=jt();return t.firstCreatePass&&jk(t,e),null!=e.classesWithoutHost&&function mD(n){return!!(8&n.flags)}(e)&&t4(t,e,K(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function EM(n){return!!(16&n.flags)}(e)&&t4(t,e,K(),e.stylesWithoutHost,!1),k}function Te(n,e,t,i){return L(n,e,t,i),k(),Te}let SU=(n,e,t,i,r,o)=>(ds(!0),rS(i,r,SM()));function nJ(n,e,t,i,r,o){const s=e[6],a=!s||rd()||Jf(t)||yd(s,o);if(ds(a),a)return rS(i,r,SM());const l=vb(s,n,e,t);return eb(s,o)&&S0(s,o,l.nextSibling),s&&(Mv(t)||iC(l))&&ja(t)&&(function Qy(n){Qt.skipHydrationRootTNode=n}(t),VL(l)),l}function ih(n,e,t){const i=K(),r=jt(),o=n+26,s=r.firstCreatePass?function rJ(n,e,t,i,r){const o=e.consts,s=Do(o,i),a=k0(e,n,8,"ng-container",s);null!==s&&wR(a,s,!0);const l=Do(o,r);return Vm()&&xR(e,t,a,l,qI),a.mergedAttrs=Nf(a.mergedAttrs,a.attrs),null!==e.queries&&e.queries.elementStart(e,a),a}(o,r,i,e,t):r.data[o];_r(s,!0);const a=EU(r,i,s,n);return i[o]=a,Cl()&&uS(r,i,a,s),ps(a,i),Om(s)&&(aS(r,i,s),ob(r,s,i)),null!=t&&$I(i,s),ih}function rh(){let n=Mn();const e=jt();return tv()?Tf():(n=n.parent,_r(n,!1)),e.firstCreatePass&&($m(e,n),ou(n)&&e.queries.elementEnd(n)),rh}function oh(n,e,t){return ih(n,e,t),rh(),oh}let EU=(n,e,t,i)=>(ds(!0),HI(e[11],""));function oJ(n,e,t,i){let r;const o=e[6],s=!o||rd()||yd(o,i)||Jf(t);if(ds(s),s)return HI(e[11],"");const a=vb(o,n,e,t),l=function jC(n,e){const t=n.data;let i=t.e?.[e]??null;return null===i&&t.c?.[e]&&(i=E0(n,e)),i}(o,i);return S0(o,i,a),r=mS(l,a),r}function rn(){return K()}const NS="en-US";let RU=NS;function YU(n,e,t){return function i(r){if(r===Function)return t;db(ja(n)?Vr(n.index,e):e,5);const s=e[8];let a=ZU(e,s,t,r),l=i.__ngNextListenerFn__;for(;l;)a=ZU(e,s,l,r)&&a,l=l.__ngNextListenerFn__;return a}}function ZU(n,e,t,i){const r=et(null);try{return!1!==t(i)}catch(o){return function KJ(n,e){const t=n[9],i=t?t.get(Ya,null):null;i&&i.handleError(e)}(n,o),!1}finally{et(r)}}function KU(n,e,t,i,r,o){const a=e[1],c=e[t][a.data[t].outputs[i]],f=a.firstCreatePass?ap(a):null,h=Zy(e),g=c.subscribe(o),m=h.length;h.push(o,g),f&&f.push(r,n.index,m,-(m+1))}const l4=new Map;function Oe(n,e,t,i){const r=K(),o=jt(),s=Mn();return u4(o,r,r[11],s,n,e,i),Oe}function u4(n,e,t,i,r,o,s){const a=Om(i),u=n.firstCreatePass?ap(n):null,c=Zy(e);let f=!0;if(3&i.type||s){const h=jo(i,e),g=s?s(h):h,m=c.length,v=s?y=>s(Jt(y[i.index])):i.index;let _=null;if(!s&&a&&(_=function eQ(n,e,t,i){const r=n.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const s=r[o];if(s===t&&r[o+1]===i){const a=e[7],l=r[o+2];return a.length>l?a[l]:null}"string"==typeof s&&(o+=2)}return null}(n,e,r,i.index)),null!==_)(_.__ngLastListenerFn__||_).__ngNextListenerFn__=o,_.__ngLastListenerFn__=o,f=!1;else{o=YU(i,e,o);const y=e[9].get(ma);l4.get(y)?.(g,r,o);const x=t.listen(g,r,o);c.push(o,x),u&&u.push(r,v,m,m+1)}}else o=YU(i,e,o);if(f){const h=i.outputs?.[r],g=i.hostDirectiveOutputs?.[r];if(g&&g.length)for(let m=0;m<g.length;m+=2)KU(i,e,g[m],g[m+1],r,o);if(h&&h.length)for(const m of h)KU(i,e,m,r,r,o)}}function me(n=1){return function cs(n){return(Qt.lFrame.contextLView=function km(n,e){for(;n>0;)e=e[14],n--;return e}(n,Qt.lFrame.contextLView))[8]}(n)}function d4(n,e,t,i){!function nB(n,e,t,i){const r=jt();if(r.firstCreatePass){const o=Mn();iB(r,new Jk(e,t,i),o.index),function JX(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),!(2&~t)&&(r.staticContentQueries=!0)}return eB(r,K(),t)}(n,e,t,i)}function ys(n,e,t){!function tB(n,e,t){const i=jt();return i.firstCreatePass&&(iB(i,new Jk(n,e,t),-1),!(2&~e)&&(i.staticViewQueries=!0)),eB(i,K(),e)}(n,e,t)}function Po(n){const e=K(),t=jt(),i=jm();Df(i+1);const r=RR(t,i);if(n.dirty&&function gM(n){return!(4&~n[2])}(e)===!(2&~r.metadata.flags)){if(null===r.matches)n.reset([]);else{const o=rB(e,i);n.reset(o,eC),n.notifyOnChanges()}return!0}return!1}function Oo(){return function IR(n,e){return n[18].queries[e].queryList}(K(),jm())}function yo(n){return id(function Hm(){return Qt.lFrame.contextLView}(),26+n)}function re(n,e=""){const t=K(),i=jt(),r=n+26,o=i.firstCreatePass?k0(i,r,1,e,null):i.data[r],s=_V(i,t,o,e,n);t[r]=s,Cl()&&uS(i,t,s,o),_r(o,!1)}let _V=(n,e,t,i,r)=>(ds(!0),VI(e[11],i));function _Q(n,e,t,i,r){const o=e[6],s=!o||rd()||Jf(t)||yd(o,r);return ds(s),s?VI(e[11],i):vb(o,n,e,t)}function Ei(n){return Ca("",n,""),Ei}function Ca(n,e,t){const i=K(),r=function $0(n,e,t,i){return Ir(n,us(),t)?e+Kt(t)+i:hn}(i,n,e,t);return r!==hn&&function vd(n,e,t){const i=Mf(e,n);!function kL(n,e,t){n.setValue(e,t)}(n[11],i,t)}(i,Pi(),r),Ca}function Rl(n,e,t){xv(e)&&(e=e());const i=K();return Ir(i,us(),e)&&wa(jt(),yi(),i,n,e,i[11],t,!1),Rl}function bu(n,e){const t=xv(n);return t&&n.set(e),t}function Pl(n,e){const t=K(),i=jt(),r=Mn();return u4(i,t,t[11],r,n,e),Pl}function h4(n,e,t,i,r){if(n=Zt(n),Array.isArray(n))for(let o=0;o<n.length;o++)h4(n[o],e,t,i,r);else{const o=jt(),s=K(),a=Mn();let l=Jc(n)?n:Zt(n.provide);const u=rc(n),c=1048575&a.providerIndexes,f=a.directiveStart,h=a.providerIndexes>>20;if(Jc(n)||!n.multi){const g=new Pf(u,r,se),m=g4(l,e,r?c:c+h,f);-1===m?(Qm(pp(a,s),o,l),p4(o,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(g),s.push(g)):(t[m]=g,s[m]=g)}else{const g=g4(l,e,c+h,f),m=g4(l,e,c,c+h),_=m>=0&&t[m];if(r&&!_||!r&&!(g>=0&&t[g])){Qm(pp(a,s),o,l);const y=function SQ(n,e,t,i,r){const o=new Pf(n,t,se);return o.multi=[],o.index=e,o.componentProviders=0,AV(o,r,i&&!t),o}(r?CQ:MQ,t.length,r,i,u);!r&&_&&(t[m].providerFactory=y),p4(o,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(y),s.push(y)}else p4(o,n,g>-1?g:m,AV(t[r?m:g],u,!r&&i));!r&&i&&_&&t[m].componentProviders++}}}function p4(n,e,t,i){const r=Jc(e),o=function KA(n){return!!n.useClass}(e);if(r||o){const l=(o?Zt(e.useClass):e).prototype.ngOnDestroy;if(l){const u=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const c=u.indexOf(t);-1===c?u.push(t,[i,l]):u[c+1].push(i,l)}else u.push(t,l)}}}function AV(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function g4(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function MQ(n,e,t,i,r){return m4(this.multi,[])}function CQ(n,e,t,i,r){const o=this.multi;let s;if(this.providerFactory){const a=this.providerFactory.componentProviders,l=cd(i,i[1],this.providerFactory.index,r);s=l.slice(0,a),m4(o,s);for(let u=a;u<l.length;u++)s.push(l[u])}else s=[],m4(o,s);return s}function m4(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Cn(n,e=[]){return t=>{t.providersResolver=(i,r)=>function xQ(n,e,t){const i=jt();if(i.firstCreatePass){const r=lr(n);h4(t,i.data,i.blueprint,r,!0),h4(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}function i_(n,e,t){const i=Io()+n,r=K();return r[i]===hn?vc(r,i,t?e.call(t):e()):function Sb(n,e){return n[e]}(r,i)}function Sa(n,e,t,i){return IV(K(),Io(),n,e,t,i)}function _4(n,e,t,i,r){return function RV(n,e,t,i,r,o,s){const a=e+t;return function zp(n,e,t,i){const r=Ir(n,e,t);return Ir(n,e+1,i)||r}(n,a,r,o)?vc(n,a+2,s?i.call(s,r,o):i(r,o)):Lb(n,a+2)}(K(),Io(),n,e,t,i,r)}function Lb(n,e){const t=n[e];return t===hn?void 0:t}function IV(n,e,t,i,r,o){const s=e+t;return Ir(n,s,r)?vc(n,s+1,o?i.call(o,r):i(r)):Lb(n,s+1)}function r_(n,e){const t=jt();let i;const r=n+26;t.firstCreatePass?(i=function LQ(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];const o=i.factory||(i.factory=tc(i.type)),a=ho(se);try{const l=cu(!1),u=o();return cu(l),function f4(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,K(),r,u),u}finally{ho(a)}}function o_(n,e,t){const i=n+26,r=K(),o=id(r,i);return function kb(n,e){return n[1].data[e].pure}(r,i)?IV(r,Io(),e,o.transform,t,o):o.transform(t)}function vs(n,e){return fS(n,e)}class x4{full;major;minor;patch;constructor(e){this.full=e;const t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}}const hee=new x4("19.2.10");class pee{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let gee=(()=>{class n{compileModuleSync(t){return new FR(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),o=_c(Pt(t).declarations).reduce((s,a)=>{const l=gt(a);return l&&s.push(new Mb(l)),s},[]);return new pee(i,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),yee=(()=>{class n{zone=j(Hn);changeDetectionScheduler=j(fu);applicationRef=j(xa);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function M4({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new Hn({...C4(),scheduleInRootZone:t}),[{provide:Hn,useFactory:n},{provide:X,multi:!0,useFactory:()=>{const i=j(yee,{optional:!0});return()=>i.initialize()}},{provide:X,multi:!0,useFactory:()=>{const i=j(bee);return()=>{i.initialize()}}},!0===e?{provide:_v,useValue:!0}:[],{provide:yv,useValue:t??jM}]}function C4(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}let bee=(()=>{class n{subscription=new Yi;initialized=!1;zone=j(Hn);pendingTasks=j(hu);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Hn.assertNotInAngularZone(),queueMicrotask(()=>{null!==t&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Hn.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Ub=(()=>{class n{appRef=j(xa);taskService=j(hu);ngZone=j(Hn);zonelessEnabled=j(fd);tracing=j(Si,{optional:!0});disableScheduling=j(_v,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Yi;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Wo):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(j(yv,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof wv||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&5===t)return;let i=!1;switch(t){case 0:this.appRef.dirtyFlags|=2;break;case 3:case 2:case 4:case 5:case 1:this.appRef.dirtyFlags|=4;break;case 6:case 13:this.appRef.dirtyFlags|=2,i=!0;break;case 12:this.appRef.dirtyFlags|=16,i=!0;break;case 11:i=!0;break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(i))return;const r=this.useMicrotaskScheduler?YM:XM;this.pendingRenderTaskId=this.taskService.add(),this.cancelScheduledCallback=this.scheduleInRootZone?Zone.root.run(()=>r(()=>this.tick())):this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||null!==this.pendingRenderTaskId||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Wo+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(0===this.appRef.dirtyFlags)return void this.cleanup();!this.zonelessEnabled&&7&this.appRef.dirtyFlags&&(this.appRef.dirtyFlags|=1);const t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){throw this.taskService.remove(t),i}finally{this.cleanup()}this.useMicrotaskScheduler=!0,YM(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,null!==this.pendingRenderTaskId){const t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const sh=new be("",{providedIn:"root",factory:()=>j(sh,xn.Optional|xn.SkipSelf)||function wee(){return typeof $localize<"u"&&$localize.locale||NS}()}),HS=new be(""),Tee=new be("");function Vb(n){return!n.moduleRef}let ah=null;let wu=(()=>class n{static __NG_ELEMENT_ID__=Oee})();function Oee(n){return function Nee(n,e,t){if(ja(n)&&!t){const i=Vr(n.index,e);return new hb(i,i)}return 175&n.type?new hb(e[15],e):null}(Mn(),K(),!(16&~n))}class dH{constructor(){}supports(e){return MS(e)}create(e){return new Uee(e)}}const Bee=(n,e)=>e;class Uee{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||Bee}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,o=null;for(;t||i;){const s=!i||t&&t.currentIndex<hH(i,r,o)?t:i,a=hH(s,r,o),l=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(t=t._next,null==s.previousIndex)r++;else{o||(o=[]);const u=a-r,c=l-r;if(u!=c){for(let h=0;h<u;h++){const g=h<o.length?o[h]:o[h]=0,m=g+h;c<=m&&m<u&&(o[h]=g+1)}o[s.previousIndex]=c-u}}a!==l&&e(s,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!MS(e))throw new ce(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,o,s,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),null!==t&&Object.is(t.trackById,s)?(i&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)):(t=this._mismatch(t,o,s,a),i=!0),t=t._next}else r=0,function TY(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{s=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,s)?(i&&(t=this._verifyReinsertion(t,a,s,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,s,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let o;return null===e?o=this._itTail:(o=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,r)):e=this._addAfter(new Vee(t,i),o,r),e}_verifyReinsertion(e,t,i,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==o?e=this._reinsertAfter(o,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,o=e._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new fH),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new fH),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class Vee{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}}class Hee{_head=null;_tail=null;add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class fH{map=new Map;put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new Hee,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function hH(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}function gH(){return new I4([new dH])}let I4=(()=>{class n{factories;static \u0275prov=Ve({token:n,providedIn:"root",factory:gH});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||gH()),deps:[[n,new Oy,new ec]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new ce(901,!1)}}return n})();function $ee(n){try{const{rootComponent:e,appProviders:t,platformProviders:i}=n,r=function Pee(n=[]){if(ah)return ah;const e=function oH(n=[],e){return no.create({name:e,providers:[{provide:ff,useValue:"platform"},{provide:HS,useValue:new Set([()=>ah=null])},...n]})}(n);return ah=e,function jB(){!function Ee(n){Bc=n}(()=>{throw new ce(600,!1)})}(),function sH(n){const e=n.get(Pv,null);Bs(n,()=>{e?.forEach(t=>t())})}(e),e}(i),o=[M4({}),{provide:fu,useExisting:Ub},...t||[]];return function nH(n){const e=Vb(n)?n.r3Injector:n.moduleRef.injector,t=e.get(Hn);return t.run(()=>{Vb(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();const i=e.get(Ya,null);let r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:o=>{i.handleError(o)}})}),Vb(n)){const o=()=>e.destroy(),s=n.platformInjector.get(HS);s.add(o),e.onDestroy(()=>{r.unsubscribe(),s.delete(o)})}else{const o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(HS);s.add(o),n.moduleRef.onDestroy(()=>{IS(n.allPlatformModules,n.moduleRef),r.unsubscribe(),s.delete(o)})}return function Dee(n,e,t){try{const i=t();return Ab(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(i,t,()=>{const o=e.get(GB);return o.runInitializers(),o.donePromise.then(()=>{if(function hJ(n){"string"==typeof n&&(RU=n.toLowerCase().replace(/_/g,"-"))}(e.get(sh,NS)||NS),!e.get(Tee,!0))return Vb(n)?e.get(xa):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Vb(n)){const l=e.get(xa);return void 0!==n.rootComponent&&l.bootstrap(n.rootComponent),l}return function Aee(n,e){const t=n.injector.get(xa);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>t.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new ce(-403,!1);n.instance.ngDoBootstrap(t)}e.push(n)}(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}({r3Injector:new mB({providers:o,parent:r,debugName:"",runEnvironmentInitializers:!1}).injector,platformInjector:r,rootComponent:e})}catch(e){return Promise.reject(e)}}let SH=!1;function pte(){const n=[{provide:Hf,useFactory:()=>{let e=!0;return e=!!j(hc,{optional:!0})?.get(M0,null),e&&$o("NgHydration"),e}},{provide:X,useValue:()=>{(function Rk(n){Dk=n})(!1),j(Hf)&&(function AI(n){for(const i of n.body.childNodes)if(rb(i))return;if(!rb(qC(n.body.previousSibling))&&!rb(qC(n.head.lastChild)))throw new ce(-507,!1)}(El()),function ute(){SH||(SH=!0,function gI(){VC=pI}(),function iJ(){SU=nJ}(),function yQ(){_V=_Q}(),function sJ(){EU=oJ}(),function RY(){SB=IY}(),function $X(){Yk=WX,CR=jX}(),function pX(){Lk=hX}(),function H9(){WL=V9}())}())},multi:!0}];return n.push({provide:TC,useFactory:()=>j(Hf)},{provide:j0,useFactory:()=>{if(j(Hf)){const e=j(xa);return()=>{(function fte(n){return n.whenStable()})(e).then(()=>{e.destroyed||function Fk(n){const e=n._views;for(const t of e){const i=zC(t);null!==i&&null!==i[0]&&(mr(i)?yS(i):_S(i))}}(e)})}}return()=>{}},multi:!0}),bl(n)}function a_(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function Hr(n){return function ko(n){const e=et(null);try{return n()}finally{et(e)}}(n)}function xu(n,e){return function qi(n,e){const t=Object.create(pl);t.computation=n,void 0!==e&&(t.equal=e);const i=()=>{if(rr(t),$i(t),t.value===Vi)throw t.error;return t.value};return i[Ct]=t,i}(n,e?.equal)}class vte{[Ct];constructor(e){this[Ct]=e}destroy(){this[Ct].destroy()}}const IH={...gr,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,hasRun:!1,cleanupFns:void 0,zone:null,kind:"effect",onDestroyFn:yp,run(){if(this.dirty=!1,this.hasRun&&!Os(this))return;this.hasRun=!0;const n=i=>(this.cleanupFns??=[]).push(i),e=$r(this),t=Af(!1);try{this.maybeCleanup(),this.fn(n)}finally{Af(t),Tr(this,e)}},maybeCleanup(){if(this.cleanupFns?.length)try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[]}}},bte={...IH,consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){co(this),this.onDestroyFn(),this.maybeCleanup(),this.scheduler.remove(this)}},wte={...IH,consumerMarkedDirty(){this.view[2]|=8192,Sf(this.view),this.notifier.notify(13)},destroy(){co(this),this.onDestroyFn(),this.maybeCleanup(),this.view[23]?.delete(this)}},fr=new be("");let FH=null;function lh(){return FH}class Fte{}let LH=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:()=>j(Lte),providedIn:"platform"})}return n})(),Lte=(()=>{class n extends LH{_location;_history;_doc=j(fr);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return lh().getBaseHref(this._doc)}onPopState(t){const i=lh().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=lh().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function kH(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function BH(n){const e=n.search(/#|\?|$/);return"/"===n[e-1]?n.slice(0,e-1)+n.slice(e):n}function qp(n){return n&&"?"!==n[0]?`?${n}`:n}let YS=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:()=>j(Bte),providedIn:"root"})}return n})();const kte=new be("");let Bte=(()=>{class n extends YS{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??j(fr).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return kH(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+qp(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,o){const s=this.prepareExternalUrl(r+qp(o));this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){const s=this.prepareExternalUrl(r+qp(o));this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(Ze(LH),Ze(kte,8))};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),bd=(()=>{class n{_subject=new Xr;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function Hte(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(BH(UH(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+qp(i))}normalize(t){return n.stripTrailingSlash(function Vte(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,UH(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+qp(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+qp(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=qp;static joinWithSlash=kH;static stripTrailingSlash=BH;static \u0275fac=function(i){return new(i||n)(Ze(YS))};static \u0275prov=Ve({token:n,factory:()=>function Ute(){return new bd(Ze(YS))}(),providedIn:"root"})}return n})();function UH(n){return n.replace(/\/index.html$/,"")}function VH(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,o]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}const HH="browser";function zH(n){return n===HH}function F4(n){return"server"===n}class GH{}const ZS=new be("");let jH=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r,o){return this._findPluginFor(i).addEventListener(t,i,r,o)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(o=>o.supports(t)),!i)throw new ce(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||n)(Ze(ZS),Ze(Hn))};static \u0275prov=Ve({token:n,factory:n.\u0275fac})}return n})();class WH{_doc;constructor(e){this._doc=e}manager}const KS="ng-app-id";function $H(n){for(const e of n)e.remove()}function qH(n,e){const t=e.createElement("style");return t.textContent=n,t}function L4(n,e){const t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}let XH=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,i,r,o={}){this.doc=t,this.appId=i,this.nonce=r,this.isServer=F4(o),function Gte(n,e,t,i){const r=n.head?.querySelectorAll(`style[${KS}="${e}"],link[${KS}="${e}"]`);if(r)for(const o of r)o.removeAttribute(KS),o instanceof HTMLLinkElement?i.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(const r of t)this.addUsage(r,this.inline,qH);i?.forEach(r=>this.addUsage(r,this.external,L4))}removeStyles(t,i){for(const r of t)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,i,r){const o=i.get(t);o?o.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,r(t,this.doc)))})}removeUsage(t,i){const r=i.get(t);r&&(r.usage--,r.usage<=0&&($H(r.elements),i.delete(t)))}ngOnDestroy(){for(const[,{elements:t}]of[...this.inline,...this.external])$H(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(const[i,{elements:r}]of this.inline)r.push(this.addElement(t,qH(i,this.doc)));for(const[i,{elements:r}]of this.external)r.push(this.addElement(t,L4(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),this.isServer&&i.setAttribute(KS,this.appId),t.appendChild(i)}static \u0275fac=function(i){return new(i||n)(Ze(fr),Ze(ma),Ze(MC,8),Ze(Vf))};static \u0275prov=Ve({token:n,factory:n.\u0275fac})}return n})();const k4={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},B4=/%COMP%/g,Yte=new be("",{providedIn:"root",factory:()=>!0});function ZH(n,e){return e.map(t=>t.replace(B4,n))}let U4=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,i,r,o,s,a,l,u=null,c=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=l,this.nonce=u,this.tracingService=c,this.platformIsServer=F4(a),this.defaultRenderer=new V4(t,s,l,this.platformIsServer,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===ya.ShadowDom&&(i={...i,encapsulation:ya.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof JH?r.applyToHost(t):r instanceof H4&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let o=r.get(i.id);if(!o){const s=this.doc,a=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,c=this.removeStylesOnCompDestroy,f=this.platformIsServer,h=this.tracingService;switch(i.encapsulation){case ya.Emulated:o=new JH(l,u,i,this.appId,c,s,a,f,h);break;case ya.ShadowDom:return new Qte(l,u,t,i,s,a,this.nonce,f,h);default:o=new H4(l,u,i,c,s,a,f,h)}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||n)(Ze(jH),Ze(XH),Ze(ma),Ze(Yte),Ze(fr),Ze(Vf),Ze(Hn),Ze(MC),Ze(Si,8))};static \u0275prov=Ve({token:n,factory:n.\u0275fac})}return n})();class V4{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,r,o){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(k4[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(KH(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(KH(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new ce(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const o=k4[r];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=k4[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Kf.DashCase|Kf.Important)?e.style.setProperty(t,i,r&Kf.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Kf.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){null!=e&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,r){if("string"==typeof e&&!(e=lh().getGlobalEventTarget(this.doc,e)))throw new ce(5102,!1);let o=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,r)}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function KH(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class Qte extends V4{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,i,r,o,s,a,l,u){super(e,o,s,l,u),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=r.styles;c=ZH(r.id,c);for(const h of c){const g=document.createElement("style");a&&g.setAttribute("nonce",a),g.textContent=h,this.shadowRoot.appendChild(g)}const f=r.getExternalStyles?.();if(f)for(const h of f){const g=L4(h,o);a&&g.setAttribute("nonce",a),this.shadowRoot.appendChild(g)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class H4 extends V4{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,r,o,s,a,l,u){super(e,o,s,a,l),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r;let c=i.styles;this.styles=u?ZH(u,c):c,this.styleUrls=i.getExternalStyles?.(u)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}}class JH extends H4{contentAttr;hostAttr;constructor(e,t,i,r,o,s,a,l,u){const c=r+"-"+i.id;super(e,t,i,o,s,a,l,u,c),this.contentAttr=function Zte(n){return"_ngcontent-%COMP%".replace(B4,n)}(c),this.hostAttr=function Kte(n){return"_nghost-%COMP%".replace(B4,n)}(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class z4 extends Fte{supportsDOMEvents=!0;static makeCurrent(){!function Nte(n){FH??=n}(new z4)}onAndCancel(e,t,i,r){return e.addEventListener(t,i,r),()=>{e.removeEventListener(t,i,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function ene(){return Gb=Gb||document.querySelector("base"),Gb?Gb.getAttribute("href"):null}();return null==t?null:function tne(n){return new URL(n,document.baseURI).pathname}(t)}resetBaseElement(){Gb=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return VH(document.cookie,e)}}let Gb=null,ine=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac})}return n})();const QH=["alt","control","meta","shift"],one={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},sne={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};function ez(n,e){return $ee({rootComponent:n,...tz(e)})}function tz(n){return{appProviders:[...hne,...n?.providers??[]],platformProviders:dne}}const dne=[{provide:Vf,useValue:HH},{provide:Pv,useValue:function lne(){z4.makeCurrent()},multi:!0},{provide:fr,useFactory:function cne(){return function KD(n){Rv=n}(document),document}}],hne=[{provide:ff,useValue:"root"},{provide:Ya,useFactory:function une(){return new Ya}},{provide:ZS,useClass:(()=>{class n extends WH{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r,o){return t.addEventListener(i,r,o),()=>this.removeEventListener(t,i,r,o)}removeEventListener(t,i,r,o){return t.removeEventListener(i,r,o)}static \u0275fac=function(i){return new(i||n)(Ze(fr))};static \u0275prov=Ve({token:n,factory:n.\u0275fac})}return n})(),multi:!0,deps:[fr]},{provide:ZS,useClass:(()=>{class n extends WH{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r,o){const s=n.parseEventName(i),a=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>lh().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const o=n._normalizeKey(i.pop());let s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),QH.forEach(u=>{const c=i.indexOf(u);c>-1&&(i.splice(c,1),s+=u+".")}),s+=o,0!=i.length||0===o.length)return null;const l={};return l.domEventName=r,l.fullKey=s,l}static matchEventFullKeyCode(t,i){let r=one[t.key]||t.key,o="";return i.indexOf("code.")>-1&&(r=t.code,o="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),QH.forEach(s=>{s!==r&&(0,sne[s])(t)&&(o+=s+".")}),o+=r,o===i)}static eventCallback(t,i,r){return o=>{n.matchEventFullKeyCode(o,t)&&r.runGuarded(()=>i(o))}}static _normalizeKey(t){return"esc"===t?"escape":t}static \u0275fac=function(i){return new(i||n)(Ze(fr))};static \u0275prov=Ve({token:n,factory:n.\u0275fac})}return n})(),multi:!0,deps:[fr]},U4,XH,jH,{provide:bS,useExisting:U4},{provide:GH,useClass:ine},[]];class pne extends CustomEvent{constructor(e,{clientX:t,clientY:i,...r}){super(e,{...r,detail:{clientX:t,clientY:i}})}}const nz=typeof navigator>"u"?null:navigator;class iz{supports(e){return this.regExp.test(e)}getDelay(e){const t=this.regExp.exec(e);if(!t?.groups)throw new Error(`Invalid event: ${e}`);const{time:i,units:r}=t.groups;switch(r){case"ms":return Number(i);case"s":return 1e3*Number(i);default:throw new Error(`Invalid event: ${e}`)}}unwrap(e){return e.replace(this.regExp,"")}}class Xp{supports(e){return e.includes(this.modifier)}unwrap(e){return e.split(".").filter(t=>!this.modifier.includes(t)).join(".")}}const bne=new be("",{factory:()=>{const n=j(fr);return e=>"body"===e?n.body:n.defaultView[e]||n.createElement("div")}});let wne=(()=>{class n extends Xp{constructor(){super(...arguments),this.handler=j(bne),this.modifier=">"}addEventListener(t,i,r){return this.manager.addEventListener(this.handler(i.split(">")[0]),i.split(">")?.[1]??"",r)}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275prov=Ve({token:n,factory:n.\u0275fac})}}return n})(),xne=(()=>{class n extends Xp{constructor(){super(...arguments),this.modifier="capture.once.passive"}supports(t){return t.includes(".")&&!this.unwrap(t).includes(".")}addEventListener(t,i,r){const o=this.unwrap(i),s=i.includes(".capture");return t.addEventListener(o,r,{capture:s,once:i.includes(".once"),passive:i.includes(".passive")}),()=>t.removeEventListener(o,r,{capture:s})}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275prov=Ve({token:n,factory:n.\u0275fac})}}return n})(),Mne=(()=>{class n extends Xp{constructor(){super(...arguments),this.modifier=".prevent"}addEventListener(t,i,r){return this.manager.addEventListener(t,this.unwrap(i),o=>{o.preventDefault(),r(o)})}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275prov=Ve({token:n,factory:n.\u0275fac})}}return n})(),Cne=(()=>{class n extends Xp{constructor(){super(...arguments),this.modifier="resize"}supports(t){return"resize"===t}addEventListener(t,i,r){if(typeof ResizeObserver>"u"||!(t instanceof Element))return t.addEventListener(i,r),()=>t.removeEventListener(i,r);const o=new ResizeObserver(r);return o.observe(t),()=>o.disconnect()}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275prov=Ve({token:n,factory:n.\u0275fac})}}return n})(),Sne=(()=>{class n extends Xp{constructor(){super(...arguments),this.modifier=".self"}addEventListener(t,i,r){return this.manager.addEventListener(t,this.unwrap(i),o=>{o.target===o.currentTarget&&r(o)})}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275prov=Ve({token:n,factory:n.\u0275fac})}}return n})(),JS=(()=>{class n extends Xp{constructor(){super(...arguments),this.modifier=".silent"}addEventListener(t,i,r){return n.ngZone=this.manager.getZone(),n.ngZone.runOutsideAngular(()=>this.manager.addEventListener(t,this.unwrap(i),r))}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275prov=Ve({token:n,factory:n.\u0275fac})}}return n})(),Ene=(()=>{class n extends Xp{constructor(){super(...arguments),this.modifier=".stop"}addEventListener(t,i,r){return this.manager.addEventListener(t,this.unwrap(i),o=>{o.stopPropagation(),r(o)})}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275prov=Ve({token:n,factory:n.\u0275fac})}}return n})();const Ane=[JS,(()=>{class n extends JS{constructor(){super(...arguments),this.modifier=".zoneless"}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275prov=Ve({token:n,factory:n.\u0275fac})}}return n})(),wne,xne,Mne,Cne,Sne,Ene,class yne{constructor(){this.isIOS=!!nz&&(({userAgent:n,maxTouchPoints:e})=>/ipad|iphone|ipod/i.test(n)||/^((?!chrome|android).)*safari/i.test(n)&&e>1)(nz)}addEventListener(e,t,i){const r=this.isIOS?this.listenTouchEvents(e):this.listenContextmenuEvent(e);return e.addEventListener("longtap",i),()=>{r(),e.removeEventListener("longtap",i)}}supports(e){return"longtap"===e}listenContextmenuEvent(e){return this.manager.addEventListener(e,"contextmenu.prevent.stop",({clientX:t,clientY:i})=>{this.dispatchLongtapEvent(e,t,i)})}listenTouchEvents(e){let t=null,i=null;const r=()=>{clearTimeout(t),i=null,t=null},o=this.manager.addEventListener(e,"touchstart.zoneless.passive",({touches:u})=>{const c=u[0];if(!c)return;const{clientX:f,clientY:h}=c;i={clientX:f,clientY:h},t=setTimeout(()=>{this.dispatchLongtapEvent(e,f,h),r()},700)}),s=this.manager.addEventListener(e,"touchmove.zoneless.passive",({touches:u})=>{const c=u[0];if(!c||!i)return;const{clientX:f,clientY:h}=c;Math.hypot(f-i.clientX,h-i.clientY)<=15||r()}),a=this.manager.addEventListener(e,"touchcancel.zoneless.passive",r),l=this.manager.addEventListener(e,"touchend.zoneless.passive",r);return()=>{o(),s(),a(),l()}}dispatchLongtapEvent(e,t,i){e.dispatchEvent(new pne("longtap",{clientX:t,clientY:i,bubbles:!1,cancelable:!1,composed:!1}))}},class vne extends iz{constructor(){super(...arguments),this.regExp=/\.debounce~(?<time>\d+)(?<units>ms|s)/}addEventListener(e,t,i){let r;const o=this.manager.addEventListener(e,this.unwrap(t),s=>{clearTimeout(r),r=setTimeout(()=>{i(s)},this.getDelay(t))});return()=>{clearTimeout(r),o()}}},class Tne extends iz{constructor(){super(...arguments),this.regExp=/\.throttle~(?<time>\d+)(?<units>ms|s)/}addEventListener(e,t,i){let r;const o=this.manager.addEventListener(e,this.unwrap(t),s=>{void 0===r&&(i(s),r=setTimeout(()=>{r=void 0},this.getDelay(t)))});return()=>{clearTimeout(r),o()}}}].map(n=>({provide:ZS,multi:!0,useClass:n}));function uh(n){return this instanceof uh?(this.v=n,this):new uh(n)}function lz(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function $4(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){!function r(o,s,a,l){Promise.resolve(l).then(function(u){o({value:u,done:a})},s)}(a,l,(s=n[o](s)).done,s.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const X4=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function uz(n){return yn(n?.then)}function cz(n){return yn(n[ka])}function dz(n){return Symbol.asyncIterator&&yn(n?.[Symbol.asyncIterator])}function fz(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const hz=function nie(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function pz(n){return yn(n?.[hz])}function gz(n){return function az(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),o=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function s(g){return function(m){return Promise.resolve(m).then(g,f)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(g,m){i[g]&&(r[g]=function(v){return new Promise(function(_,y){o.push([g,v,_,y])>1||l(g,v)})},m&&(r[g]=m(r[g])))}function l(g,m){try{!function u(g){g.value instanceof uh?Promise.resolve(g.value.v).then(c,f):h(o[0][2],g)}(i[g](m))}catch(v){h(o[0][3],v)}}function c(g){l("next",g)}function f(g){l("throw",g)}function h(g,m){g(m),o.shift(),o.length&&l(o[0][0],o[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield uh(t.read());if(r)return yield uh(void 0);yield yield uh(i)}}finally{t.releaseLock()}})}function mz(n){return yn(n?.getReader)}function Zo(n){if(n instanceof Kn)return n;if(null!=n){if(cz(n))return function iie(n){return new Kn(e=>{const t=n[ka]();if(yn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(X4(n))return function rie(n){return new Kn(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(uz(n))return function oie(n){return new Kn(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Hc)})}(n);if(dz(n))return _z(n);if(pz(n))return function sie(n){return new Kn(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(mz(n))return function aie(n){return _z(gz(n))}(n)}throw fz(n)}function _z(n){return new Kn(e=>{(function lie(n,e){var t,i,r,o;return function oz(n,e,t,i){return new(t||(t=Promise))(function(o,s){function a(c){try{u(i.next(c))}catch(f){s(f)}}function l(c){try{u(i.throw(c))}catch(f){s(f)}}function u(c){c.done?o(c.value):function r(o){return o instanceof t?o:new t(function(s){s(o)})}(c.value).then(a,l)}u((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=lz(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function wd(n,e,t,i=0,r=!1){const o=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function yz(n,e=0){return or((t,i)=>{t.subscribe(Mi(i,r=>wd(i,n,()=>i.next(r),e),()=>wd(i,n,()=>i.complete(),e),r=>wd(i,n,()=>i.error(r),e)))})}function vz(n,e=0){return or((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function bz(n,e){if(!n)throw new Error("Iterable cannot be null");return new Kn(t=>{wd(t,e,()=>{const i=n[Symbol.asyncIterator]();wd(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function vo(n,e){return e?function pie(n,e){if(null!=n){if(cz(n))return function uie(n,e){return Zo(n).pipe(vz(e),yz(e))}(n,e);if(X4(n))return function die(n,e){return new Kn(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(uz(n))return function cie(n,e){return Zo(n).pipe(vz(e),yz(e))}(n,e);if(dz(n))return bz(n,e);if(pz(n))return function fie(n,e){return new Kn(t=>{let i;return wd(t,e,()=>{i=n[hz](),wd(t,e,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){return void t.error(s)}o?t.complete():t.next(r)},0,!0)}),()=>yn(i?.return)&&i.return()})}(n,e);if(mz(n))return function hie(n,e){return bz(gz(n),e)}(n,e)}throw fz(n)}(n,e):Zo(n)}function wz(n){return n&&yn(n.schedule)}function Y4(n){return n[n.length-1]}function Z4(n){return yn(Y4(n))?n.pop():void 0}function jb(n){return wz(Y4(n))?n.pop():void 0}function $t(...n){return vo(n,jb(n))}const Wb=ml(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:mie}=Array,{getPrototypeOf:_ie,prototype:yie,keys:vie}=Object;function xz(n){if(1===n.length){const e=n[0];if(mie(e))return{args:e,keys:null};if(function bie(n){return n&&"object"==typeof n&&_ie(n)===yie}(e)){const t=vie(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:wie}=Array;function K4(n){return Nt(e=>function xie(n,e){return wie(e)?n(...e):n(e)}(n,e))}function Mz(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function J4(...n){const e=jb(n),t=Z4(n),{args:i,keys:r}=xz(n);if(0===i.length)return vo([],e);const o=new Kn(function Mie(n,e,t=da){return i=>{Cz(e,()=>{const{length:r}=n,o=new Array(r);let s=r,a=r;for(let l=0;l<r;l++)Cz(e,()=>{const u=vo(n[l],e);let c=!1;u.subscribe(Mi(i,f=>{o[l]=f,c||(c=!0,a--),a||i.next(t(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}(i,e,r?s=>Mz(r,s):da));return t?o.pipe(K4(t)):o}function Cz(n,e,t){n?wd(t,n,e):e()}function bs(n,e,t=1/0){return yn(e)?bs((i,r)=>Nt((o,s)=>e(i,o,r,s))(Zo(n(i,r))),t):("number"==typeof e&&(t=e),or((i,r)=>function Cie(n,e,t,i,r,o,s,a){const l=[];let u=0,c=0,f=!1;const h=()=>{f&&!l.length&&!u&&e.complete()},g=v=>u<i?m(v):l.push(v),m=v=>{o&&e.next(v),u++;let _=!1;Zo(t(v,c++)).subscribe(Mi(e,y=>{r?.(y),o?g(y):e.next(y)},()=>{_=!0},void 0,()=>{if(_)try{for(u--;l.length&&u<i;){const y=l.shift();s?wd(e,s,()=>m(y)):m(y)}h()}catch(y){e.error(y)}}))};return n.subscribe(Mi(e,g,()=>{f=!0,h()})),()=>{a?.()}}(i,r,n,t)))}function QS(n=1/0){return bs(da,n)}function Q4(...n){return function Sie(){return QS(1)}()(vo(n,jb(n)))}function Sz(n){return new Kn(e=>{Zo(n()).subscribe(e)})}function $b(n,e){const t=yn(n)?n:()=>n,i=r=>r.error(t());return new Kn(e?r=>e.schedule(i,0,r):i)}const ws=new Kn(n=>n.complete());function eP(){return or((n,e)=>{let t=null;n._refCount++;const i=Mi(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,o=t;t=null,r&&(!o||r===o)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class Ez extends Kn{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,jx(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Yi;const t=this.getSubject();e.add(this.source.subscribe(Mi(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Yi.EMPTY)}return e}refCount(){return eP()(this)}}function xs(n,e){return or((t,i)=>{let r=null,o=0,s=!1;const a=()=>s&&!r&&i.complete();t.subscribe(Mi(i,l=>{r?.unsubscribe();let u=0;const c=o++;Zo(n(l,c)).subscribe(r=Mi(i,f=>i.next(e?e(l,f,c,u++):f),()=>{r=null,a()}))},()=>{s=!0,a()}))})}function Yp(n){return n<=0?()=>ws:or((e,t)=>{let i=0;e.subscribe(Mi(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function qb(...n){const e=jb(n);return or((t,i)=>{(e?Q4(n,t,e):Q4(n,t)).subscribe(i)})}function Ms(n,e){return or((t,i)=>{let r=0;t.subscribe(Mi(i,o=>n.call(e,o,r++)&&i.next(o)))})}function eE(n){return or((e,t)=>{let i=!1;e.subscribe(Mi(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function Tz(n=Tie){return or((e,t)=>{let i=!1;e.subscribe(Mi(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function Tie(){return new Wb}function Zp(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Ms((r,o)=>n(r,o,i)):da,Yp(1),t?eE(e):Tz(()=>new Wb))}function Xb(n,e){return yn(e)?bs(n,e,1):bs(n,1)}function No(n,e,t){const i=yn(n)||e||t?{next:n,error:e,complete:t}:n;return i?or((r,o)=>{var s;null===(s=i.subscribe)||void 0===s||s.call(i);let a=!0;r.subscribe(Mi(o,l=>{var u;null===(u=i.next)||void 0===u||u.call(i,l),o.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),o.complete()},l=>{var u;a=!1,null===(u=i.error)||void 0===u||u.call(i,l),o.error(l)},()=>{var l,u;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(u=i.finalize)||void 0===u||u.call(i)}))}):da}function Kp(n){return or((e,t)=>{let o,i=null,r=!1;i=e.subscribe(Mi(t,void 0,void 0,s=>{o=Zo(n(s,Kp(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(t))})}function tP(n){return n<=0?()=>ws:or((e,t)=>{let i=[];e.subscribe(Mi(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function Yb(n){return or((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function l_(n){return or((e,t)=>{Zo(n).subscribe(Mi(t,()=>t.complete(),yl)),!t.closed&&e.subscribe(t)})}class tE{}class nE{}class Ol{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),o=t.slice(i+1).trim();this.addHeaderEntry(r,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.addHeaderEntry(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Ol?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Ol;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Ol?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const o=e.value;if(o){let s=this.headers.get(t);if(!s)return;s=s.filter(a=>-1===o.indexOf(a)),0===s.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}else this.headers.delete(t),this.normalizedNames.delete(t)}}addHeaderEntry(e,t){const i=e.toLowerCase();this.maybeSetNormalizedName(e,i),this.headers.has(i)?this.headers.get(i).push(t):this.headers.set(i,[t])}setHeaderEntries(e,t){const i=(Array.isArray(t)?t:[t]).map(o=>o.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Rie{encodeKey(e){return Az(e)}encodeValue(e){return Az(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Oie=/%(\d[a-f0-9])/gi,Nie={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Az(n){return encodeURIComponent(n).replace(Oie,(e,t)=>Nie[t]??e)}function iE(n){return`${n}`}class di{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new Rie,e.fromString){if(e.fromObject)throw new ce(2805,!1);this.map=function Pie(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const o=r.indexOf("="),[s,a]=-1==o?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,o)),e.decodeValue(r.slice(o+1))],l=t.get(s)||[];l.push(a),t.set(s,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(iE):[iE(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(o=>{t.push({param:i,value:o,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new di({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(iE(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(iE(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Fie{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function Dz(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function Iz(n){return typeof Blob<"u"&&n instanceof Blob}function Rz(n){return typeof FormData<"u"&&n instanceof FormData}const Zb="Content-Type",nP="X-Request-URL",Pz="text/plain",Oz="application/json",Nz=`${Oz}, ${Pz}, */*`;class Kb{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(e,t,i,r){let o;if(this.url=t,this.method=e.toUpperCase(),function Lie(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,o=r):o=i,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),this.transferCache=o.transferCache),this.headers??=new Ol,this.context??=new Fie,this.params){const s=this.params.toString();if(0===s.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+s}}else this.params=new di,this.urlWithParams=t}serializeBody(){return null===this.body?null:"string"==typeof this.body||Dz(this.body)||Iz(this.body)||Rz(this.body)||function kie(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)?this.body:this.body instanceof di?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Rz(this.body)?null:Iz(this.body)?this.body.type||null:Dz(this.body)?null:"string"==typeof this.body?Pz:this.body instanceof di?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?Oz:null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,o=e.transferCache??this.transferCache,s=void 0!==e.body?e.body:this.body,a=e.withCredentials??this.withCredentials,l=e.reportProgress??this.reportProgress;let u=e.headers||this.headers,c=e.params||this.params;const f=e.context??this.context;return void 0!==e.setHeaders&&(u=Object.keys(e.setHeaders).reduce((h,g)=>h.set(g,e.setHeaders[g]),u)),e.setParams&&(c=Object.keys(e.setParams).reduce((h,g)=>h.set(g,e.setParams[g]),c)),new Kb(t,i,s,{params:c,headers:u,context:f,reportProgress:l,responseType:r,withCredentials:a,transferCache:o})}}var wc=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(wc||{});class iP{headers;status;statusText;url;ok;type;constructor(e,t=200,i="OK"){this.headers=e.headers||new Ol,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class oE extends iP{constructor(e={}){super(e)}type=wc.ResponseHeader;clone(e={}){return new oE({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Jp extends iP{body;constructor(e={}){super(e),this.body=void 0!==e.body?e.body:null}type=wc.Response;clone(e={}){return new Jp({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Qp extends iP{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function rP(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}let Mu=(()=>{class n{handler;constructor(t){this.handler=t}request(t,i,r={}){let o;if(t instanceof Kb)o=t;else{let l,u;l=r.headers instanceof Ol?r.headers:new Ol(r.headers),r.params&&(u=r.params instanceof di?r.params:new di({fromObject:r.params})),o=new Kb(t,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:u,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}const s=$t(o).pipe(Xb(l=>this.handler.handle(l)));if(t instanceof Kb||"events"===r.observe)return s;const a=s.pipe(Ms(l=>l instanceof Jp));switch(r.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return a.pipe(Nt(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new ce(2806,!1);return l.body}));case"blob":return a.pipe(Nt(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new ce(2807,!1);return l.body}));case"text":return a.pipe(Nt(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new ce(2808,!1);return l.body}));default:return a.pipe(Nt(l=>l.body))}case"response":return a;default:throw new ce(2809,!1)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new di).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,rP(r,i))}post(t,i,r={}){return this.request("POST",t,rP(r,i))}put(t,i,r={}){return this.request("PUT",t,rP(r,i))}static \u0275fac=function(i){return new(i||n)(Ze(tE))};static \u0275prov=Ve({token:n,factory:n.\u0275fac})}return n})();const kz=new be("");function Bz(n,e){return e(n)}function Gie(n,e){return(t,i)=>e.intercept(t,{handle:r=>n(r,i)})}const Uz=new be(""),Jb=new be(""),Vz=new be(""),Hz=new be("",{providedIn:"root",factory:()=>!0});function Wie(){let n=null;return(e,t)=>{null===n&&(n=(j(Uz,{optional:!0})??[]).reduceRight(Gie,Bz));const i=j(hu);if(j(Hz)){const o=i.add();return n(e,t).pipe(Yb(()=>i.remove(o)))}return n(e,t)}}let zz=(()=>{class n extends tE{backend;injector;chain=null;pendingTasks=j(hu);contributeToStability=j(Hz);constructor(t,i){super(),this.backend=t,this.injector=i}handle(t){if(null===this.chain){const i=Array.from(new Set([...this.injector.get(Jb),...this.injector.get(Vz,[])]));this.chain=i.reduceRight((r,o)=>function jie(n,e,t){return(i,r)=>Bs(t,()=>e(i,o=>n(o,r)))}(r,o,this.injector),Bz)}if(this.contributeToStability){const i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(Yb(()=>this.pendingTasks.remove(i)))}return this.chain(t,i=>this.backend.handle(i))}static \u0275fac=function(i){return new(i||n)(Ze(nE),Ze(Ho))};static \u0275prov=Ve({token:n,factory:n.\u0275fac})}return n})();const Yie=/^\)\]\}',?\n/,Zie=RegExp(`^${nP}:`,"m");let jz=(()=>{class n{xhrFactory;constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new ce(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?vo(i.\u0275loadImpl()):$t(null)).pipe(xs(()=>new Kn(o=>{const s=i.build();if(s.open(t.method,t.urlWithParams),t.withCredentials&&(s.withCredentials=!0),t.headers.forEach((v,_)=>s.setRequestHeader(v,_.join(","))),t.headers.has("Accept")||s.setRequestHeader("Accept",Nz),!t.headers.has(Zb)){const v=t.detectContentTypeHeader();null!==v&&s.setRequestHeader(Zb,v)}if(t.responseType){const v=t.responseType.toLowerCase();s.responseType="json"!==v?v:"text"}const a=t.serializeBody();let l=null;const u=()=>{if(null!==l)return l;const v=s.statusText||"OK",_=new Ol(s.getAllResponseHeaders()),y=function Kie(n){return"responseURL"in n&&n.responseURL?n.responseURL:Zie.test(n.getAllResponseHeaders())?n.getResponseHeader(nP):null}(s)||t.url;return l=new oE({headers:_,status:s.status,statusText:v,url:y}),l},c=()=>{let{headers:v,status:_,statusText:y,url:w}=u(),x=null;204!==_&&(x=typeof s.response>"u"?s.responseText:s.response),0===_&&(_=x?200:0);let M=_>=200&&_<300;if("json"===t.responseType&&"string"==typeof x){const D=x;x=x.replace(Yie,"");try{x=""!==x?JSON.parse(x):null}catch(E){x=D,M&&(M=!1,x={error:E,text:x})}}M?(o.next(new Jp({body:x,headers:v,status:_,statusText:y,url:w||void 0})),o.complete()):o.error(new Qp({error:x,headers:v,status:_,statusText:y,url:w||void 0}))},f=v=>{const{url:_}=u(),y=new Qp({error:v,status:s.status||0,statusText:s.statusText||"Unknown Error",url:_||void 0});o.error(y)};let h=!1;const g=v=>{h||(o.next(u()),h=!0);let _={type:wc.DownloadProgress,loaded:v.loaded};v.lengthComputable&&(_.total=v.total),"text"===t.responseType&&s.responseText&&(_.partialText=s.responseText),o.next(_)},m=v=>{let _={type:wc.UploadProgress,loaded:v.loaded};v.lengthComputable&&(_.total=v.total),o.next(_)};return s.addEventListener("load",c),s.addEventListener("error",f),s.addEventListener("timeout",f),s.addEventListener("abort",f),t.reportProgress&&(s.addEventListener("progress",g),null!==a&&s.upload&&s.upload.addEventListener("progress",m)),s.send(a),o.next({type:wc.Sent}),()=>{s.removeEventListener("error",f),s.removeEventListener("abort",f),s.removeEventListener("load",c),s.removeEventListener("timeout",f),t.reportProgress&&(s.removeEventListener("progress",g),null!==a&&s.upload&&s.upload.removeEventListener("progress",m)),s.readyState!==s.DONE&&s.abort()}})))}static \u0275fac=function(i){return new(i||n)(Ze(GH))};static \u0275prov=Ve({token:n,factory:n.\u0275fac})}return n})();const aP=new be(""),Wz=new be("",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),$z=new be("",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class qz{}let ere=(()=>{class n{doc;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(t,i){this.doc=t,this.cookieName=i}getToken(){const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=VH(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(i){return new(i||n)(Ze(fr),Ze(Wz))};static \u0275prov=Ve({token:n,factory:n.\u0275fac})}return n})();function tre(n,e){const t=n.url.toLowerCase();if(!j(aP)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const i=j(qz).getToken(),r=j($z);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}var ch=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(ch||{});const Xz=new be(""),are=new be(""),lre="b",ure="h",cre="s",dre="st",fre="u",hre="rt",lP=new be(""),pre=["GET","HEAD"];function gre(n,e){const{isCacheActive:t,...i}=j(lP),{transferCache:r,method:o}=n;if(!t||!1===r||"POST"===o&&!i.includePostRequests&&!r||"POST"!==o&&!pre.includes(o)||!i.includeRequestsWithAuthHeaders&&function mre(n){return n.headers.has("authorization")||n.headers.has("proxy-authorization")}(n)||!1===i.filter?.(n))return e(n);const s=j(hc);if(j(are,{optional:!0}))throw new ce(2803,!1);const u=function _re(n,e){const{params:t,method:i,responseType:r}=n,o=Yz(t);let s=n.serializeBody();s instanceof URLSearchParams?s=Yz(s):"string"!=typeof s&&(s="");const l=function yre(n){let e=0;for(const t of n)e=Math.imul(31,e)+t.charCodeAt(0)|0;return e+=2147483648,e.toString()}([i,r,e,s,o].join("|"));return l}(n,n.url),c=s.get(u,null);let f=i.includeHeaders;if("object"==typeof r&&r.includeHeaders&&(f=r.includeHeaders),c){const{[lre]:h,[hre]:g,[ure]:m,[cre]:v,[dre]:_,[fre]:y}=c;let w=h;switch(g){case"arraybuffer":w=(new TextEncoder).encode(h).buffer;break;case"blob":w=new Blob([h])}let x=new Ol(m);return $t(new Jp({body:w,headers:x,status:v,statusText:_,url:y}))}return e(n).pipe(No(h=>{}))}function Yz(n){return[...n.keys()].sort().map(e=>`${e}=${n.getAll(e)}`).join("&")}function vre(n){return[{provide:lP,useFactory:()=>($o("NgHttpTransferCache"),{isCacheActive:!0,...n})},{provide:Vz,useValue:gre,multi:!0},{provide:j0,multi:!0,useFactory:()=>{const e=j(xa),t=j(lP);return()=>{e.whenStable().then(()=>{t.isCacheActive=!1})}}}]}let bre=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||n)(Ze(fr))};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var dh=function(n){return n[n.NoHttpTransferCache=0]="NoHttpTransferCache",n[n.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",n[n.I18nSupport=2]="I18nSupport",n[n.EventReplay=3]="EventReplay",n[n.IncrementalHydration=4]="IncrementalHydration",n}(dh||{});const Rn="primary",ew=Symbol("RouteTitle");class Sre{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function u_(n){return new Sre(n)}function Ere(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let o=0;o<i.length;o++){const s=i[o],a=n[o];if(":"===s[0])r[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function xc(n,e){const t=n?uP(n):void 0,i=e?uP(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!Jz(n[r],e[r]))return!1;return!0}function uP(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Jz(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,o)=>i[o]===r)}return n===e}function Qz(n){return n.length>0?n[n.length-1]:null}function fh(n){return function Ine(n){return!!n&&(n instanceof Kn||yn(n.lift)&&yn(n.subscribe))}(n)?n:Ab(n)?vo(Promise.resolve(n)):$t(n)}const Are={exact:function n5(n,e,t){if(!ng(n.segments,e.segments)||!sE(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!n5(n.children[i],e.children[i],t))return!1;return!0},subset:i5},e5={exact:function Dre(n,e){return xc(n,e)},subset:function Ire(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Jz(n[t],e[t]))},ignored:()=>!0};function t5(n,e,t){return Are[t.paths](n.root,e.root,t.matrixParams)&&e5[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function i5(n,e,t){return r5(n,e,e.segments,t)}function r5(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!ng(r,t)||e.hasChildren()||!sE(r,t,i))}if(n.segments.length===t.length){if(!ng(n.segments,t)||!sE(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!i5(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!!(ng(n.segments,r)&&sE(n.segments,r,i)&&n.children[Rn])&&r5(n.children[Rn],e,o,i)}}function sE(n,e,t){return e.every((i,r)=>e5[t](n[r].parameters,i.parameters))}class tg{root;queryParams;fragment;_queryParamMap;constructor(e=new Ni([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=u_(this.queryParams),this._queryParamMap}toString(){return Ore.serialize(this)}}class Ni{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return uE(this)}}class tw{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=u_(this.parameters),this._parameterMap}toString(){return a5(this)}}function ng(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let aE=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:()=>new lE,providedIn:"root"})}return n})();class lE{parse(e){const t=new jre(e);return new tg(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${nw(e.root,!0)}`,i=function Lre(n){const e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${cE(t)}=${cE(r)}`).join("&"):`${cE(t)}=${cE(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function Nre(n){return encodeURI(n)}(e.fragment)}`:""}`}}const Ore=new lE;function uE(n){return n.segments.map(e=>a5(e)).join("/")}function nw(n,e){if(!n.hasChildren())return uE(n);if(e){const t=n.children[Rn]?nw(n.children[Rn],!1):"",i=[];return Object.entries(n.children).forEach(([r,o])=>{r!==Rn&&i.push(`${r}:${nw(o,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function Pre(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===Rn&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==Rn&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===Rn?[nw(n.children[Rn],!1)]:[`${r}:${nw(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Rn]?`${uE(n)}/${t[0]}`:`${uE(n)}/(${t.join("//")})`}}function o5(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function cE(n){return o5(n).replace(/%3B/gi,";")}function cP(n){return o5(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function dE(n){return decodeURIComponent(n)}function s5(n){return dE(n.replace(/\+/g,"%20"))}function a5(n){return`${cP(n.path)}${function Fre(n){return Object.entries(n).map(([e,t])=>`;${cP(e)}=${cP(t)}`).join("")}(n.parameters)}`}const kre=/^[^\/()?;#]+/;function dP(n){const e=n.match(kre);return e?e[0]:""}const Bre=/^[^\/()?;=#]+/,Vre=/^[^=?&#]+/,zre=/^[^&#]+/;class jre{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ni([],{}):new Ni([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Rn]=new Ni(e,t)),i}parseSegment(){const e=dP(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new ce(4009,!1);return this.capture(e),new tw(dE(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function Ure(n){const e=n.match(Bre);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=dP(this.remaining);r&&(i=r,this.capture(i))}e[dE(t)]=dE(i)}parseQueryParam(e){const t=function Hre(n){const e=n.match(Vre);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const s=function Gre(n){const e=n.match(zre);return e?e[0]:""}(this.remaining);s&&(i=s,this.capture(i))}const r=s5(t),o=s5(i);if(e.hasOwnProperty(r)){let s=e[r];Array.isArray(s)||(s=[s],e[r]=s),s.push(o)}else e[r]=o}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=dP(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new ce(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=Rn);const s=this.parseChildren();t[o]=1===Object.keys(s).length?s[Rn]:new Ni([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new ce(4011,!1)}}function l5(n){return n.segments.length>0?new Ni([],{[Rn]:n}):n}function u5(n){const e={};for(const[i,r]of Object.entries(n.children)){const o=u5(r);if(i===Rn&&0===o.segments.length&&o.hasChildren())for(const[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[i]=o)}return function Wre(n){if(1===n.numberOfChildren&&n.children[Rn]){const e=n.children[Rn];return new Ni(n.segments.concat(e.segments),e.children)}return n}(new Ni(n.segments,e))}function ig(n){return n instanceof tg}function c5(n){let e;const r=l5(function t(o){const s={};for(const l of o.children){const u=t(l);s[l.outlet]=u}const a=new Ni(o.url,s);return o===n&&(e=a),a}(n.root));return e??r}function d5(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return fP(r,r,r,t,i);const o=function qre(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new h5(!0,0,n);let e=0,t=!1;const i=n.reduce((r,o,s)=>{if("object"==typeof o&&null!=o){if(o.outlets){const a={};return Object.entries(o.outlets).forEach(([l,u])=>{a[l]="string"==typeof u?u.split("/"):u}),[...r,{outlets:a}]}if(o.segmentPath)return[...r,o.segmentPath]}return"string"!=typeof o?[...r,o]:0===s?(o.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,o]},[]);return new h5(t,e,i)}(e);if(o.toRoot())return fP(r,r,new Ni([],{}),t,i);const s=function Xre(n,e,t){if(n.isAbsolute)return new hE(e,!0,0);if(!t)return new hE(e,!1,NaN);if(null===t.parent)return new hE(t,!0,0);const i=fE(n.commands[0])?0:1;return function Yre(n,e,t){let i=n,r=e,o=t;for(;o>r;){if(o-=r,i=i.parent,!i)throw new ce(4005,!1);r=i.segments.length}return new hE(i,!1,r-o)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(o,r,n),a=s.processChildren?rw(s.segmentGroup,s.index,o.commands):p5(s.segmentGroup,s.index,o.commands);return fP(r,s.segmentGroup,a,t,i)}function fE(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function iw(n){return"object"==typeof n&&null!=n&&n.outlets}function fP(n,e,t,i,r){let s,o={};i&&Object.entries(i).forEach(([l,u])=>{o[l]=Array.isArray(u)?u.map(c=>`${c}`):`${u}`}),s=n===e?t:f5(n,e,t);const a=l5(u5(s));return new tg(a,o,r)}function f5(n,e,t){const i={};return Object.entries(n.children).forEach(([r,o])=>{i[r]=o===e?t:f5(o,e,t)}),new Ni(n.segments,i)}class h5{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&fE(i[0]))throw new ce(4003,!1);const r=i.find(iw);if(r&&r!==Qz(i))throw new ce(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class hE{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function p5(n,e,t){if(n??=new Ni([],{}),0===n.segments.length&&n.hasChildren())return rw(n,e,t);const i=function Kre(n,e,t){let i=0,r=e;const o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return o;const s=n.segments[r],a=t[i];if(iw(a))break;const l=`${a}`,u=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&u&&"object"==typeof u&&void 0===u.outlets){if(!m5(l,u,s))return o;i+=2}else{if(!m5(l,{},s))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const o=new Ni(n.segments.slice(0,i.pathIndex),{});return o.children[Rn]=new Ni(n.segments.slice(i.pathIndex),n.children),rw(o,0,r)}return i.match&&0===r.length?new Ni(n.segments,{}):i.match&&!n.hasChildren()?hP(n,e,t):i.match?rw(n,0,r):hP(n,e,t)}function rw(n,e,t){if(0===t.length)return new Ni(n.segments,{});{const i=function Zre(n){return iw(n[0])?n[0].outlets:{[Rn]:n}}(t),r={};if(Object.keys(i).some(o=>o!==Rn)&&n.children[Rn]&&1===n.numberOfChildren&&0===n.children[Rn].segments.length){const o=rw(n.children[Rn],e,t);return new Ni(n.segments,o.children)}return Object.entries(i).forEach(([o,s])=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=p5(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{void 0===i[o]&&(r[o]=s)}),new Ni(n.segments,r)}}function hP(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const o=t[r];if(iw(o)){const l=Jre(o.outlets);return new Ni(i,l)}if(0===r&&fE(t[0])){i.push(new tw(n.segments[e].path,g5(t[0]))),r++;continue}const s=iw(o)?o.outlets[Rn]:`${o}`,a=r<t.length-1?t[r+1]:null;s&&a&&fE(a)?(i.push(new tw(s,g5(a))),r+=2):(i.push(new tw(s,{})),r++)}return new Ni(i,{})}function Jre(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=hP(new Ni([],{}),0,i))}),e}function g5(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function m5(n,e,t){return n==t.path&&xc(e,t.parameters)}const pE="imperative";var ei=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(ei||{});class Mc{id;url;constructor(e,t){this.id=e,this.url=t}}class pP extends Mc{type=ei.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class rg extends Mc{urlAfterRedirects;type=ei.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var Ka=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Ka||{}),gP=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(gP||{});class og extends Mc{reason;code;type=ei.NavigationCancel;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class ow extends Mc{reason;code;type=ei.NavigationSkipped;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}}class mP extends Mc{error;target;type=ei.NavigationError;constructor(e,t,i,r){super(e,t),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class _5 extends Mc{urlAfterRedirects;state;type=ei.RoutesRecognized;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Qre extends Mc{urlAfterRedirects;state;type=ei.GuardsCheckStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class eoe extends Mc{urlAfterRedirects;state;shouldActivate;type=ei.GuardsCheckEnd;constructor(e,t,i,r,o){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class toe extends Mc{urlAfterRedirects;state;type=ei.ResolveStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class noe extends Mc{urlAfterRedirects;state;type=ei.ResolveEnd;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ioe{route;type=ei.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class roe{route;type=ei.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class ooe{snapshot;type=ei.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class soe{snapshot;type=ei.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class aoe{snapshot;type=ei.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class loe{snapshot;type=ei.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class _P{}class gE{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}}function Cu(n){return n.outlet||Rn}function sw(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class poe{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return sw(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new aw(this.rootInjector)}}let aw=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new poe(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||n)(Ze(Ho))};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class y5{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=yP(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=yP(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=vP(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return vP(e,this._root).map(t=>t.value)}}function yP(n,e){if(n===e.value)return e;for(const t of e.children){const i=yP(n,t);if(i)return i}return null}function vP(n,e){if(n===e.value)return[e];for(const t of e.children){const i=vP(n,t);if(i.length)return i.unshift(e),i}return[]}class Su{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function c_(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class v5 extends y5{snapshot;constructor(e,t){super(e),this.snapshot=t,bP(this,e)}toString(){return this.snapshot.toString()}}function b5(n){const e=function goe(n){const o=new _E([],{},{},"",{},Rn,n,null,{});return new w5("",new Su(o,[]))}(n),t=new Lr([new tw("",{})]),i=new Lr({}),r=new Lr({}),o=new Lr({}),s=new Lr(""),a=new Eu(t,i,o,s,r,Rn,n,e.root);return a.snapshot=e.root,new v5(new Su(a,[]),e)}class Eu{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,r,o,s,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(Nt(u=>u[ew]))??$t(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Nt(e=>u_(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Nt(e=>u_(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function mE(n,e,t="emptyOnly"){let i;const{routeConfig:r}=n;return i=null===e||"always"!==t&&""!==r?.path&&(e.component||e.routeConfig?.loadComponent)?{params:{...n.params},data:{...n.data},resolve:{...n.data,...n._resolvedData??{}}}:{params:{...e.params,...n.params},data:{...e.data,...n.data},resolve:{...n.data,...e.data,...r?.data,...n._resolvedData}},r&&M5(r)&&(i.resolve[ew]=r.title),i}class _E{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[ew]}constructor(e,t,i,r,o,s,a,l,u){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this.routeConfig=l,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=u_(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=u_(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class w5 extends y5{url;constructor(e,t){super(t),this.url=e,bP(this,t)}toString(){return x5(this._root)}}function bP(n,e){e.value._routerState=n,e.children.forEach(t=>bP(n,t))}function x5(n){const e=n.children.length>0?` { ${n.children.map(x5).join(", ")} } `:"";return`${n.value}${e}`}function wP(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,xc(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),xc(e.params,t.params)||n.paramsSubject.next(t.params),function Tre(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!xc(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),xc(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function xP(n,e){const t=xc(n.params,e.params)&&function Rre(n,e){return ng(n,e)&&n.every((t,i)=>xc(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||xP(n.parent,e.parent))}function M5(n){return"string"==typeof n.title||null===n.title}const moe=new be("");let MP=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Rn;activateEvents=new Oi;deactivateEvents=new Oi;attachEvents=new Oi;detachEvents=new Oi;routerOutletData=FD(void 0);parentContexts=j(aw);location=j(mu);changeDetector=j(wu);inputBinder=j(CP,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ce(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ce(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ce(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new ce(4013,!1);this._activatedRoute=t;const r=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new _oe(t,a,r.injector,this.routerOutletData);this.activated=r.createComponent(s,{index:r.length,injector:l,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=_t({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[as]})}return n})();class _oe{route;childContexts;parent;outletData;constructor(e,t,i,r){this.route=e,this.childContexts=t,this.parent=i,this.outletData=r}get(e,t){return e===Eu?this.route:e===aw?this.childContexts:e===moe?this.outletData:this.parent.get(e,t)}}const CP=new be("");function lw(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function voe(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return lw(n,i,r);return lw(n,i)})}(n,e,t);return new Su(i,r)}{if(n.shouldAttach(e.value)){const o=n.retrieve(e.value);if(null!==o){const s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>lw(n,a)),s}}const i=function boe(n){return new Eu(new Lr(n.url),new Lr(n.params),new Lr(n.queryParams),new Lr(n.fragment),new Lr(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(o=>lw(n,o));return new Su(i,r)}}class SP{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}}const C5="ngNavigationCancelingError";function yE(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=ig(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=S5(!1,Ka.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function S5(n,e){const t=new Error(`NavigationCancelingError: ${n||""}`);return t[C5]=!0,t.cancellationCode=e,t}function E5(n){return!!n&&n[C5]}class Moe{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,r,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),wP(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=c_(t);e.children.forEach(o=>{const s=o.value.outlet;this.deactivateRoutes(o,r[s],i),delete r[s]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){const r=e.value,o=t?t.value:null;if(r===o)if(r.component){const s=i.getContext(r.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=c_(e);for(const s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);if(i&&i.outlet){const s=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=c_(e);for(const s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=c_(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new loe(o.value.snapshot))}),e.children.length&&this.forwardEvent(new soe(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,o=t?t.value:null;if(wP(r),r===o)if(r.component){const s=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const s=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),wP(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=r,s.outlet&&s.outlet.activateWith(r,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,i)}}class T5{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class vE{component;route;constructor(e,t){this.component=e,this.route=t}}function Coe(n,e,t){const i=n._root;return uw(i,e?e._root:null,t,[i.value])}function d_(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function zi(n){return null!==ym(n)}(n)?e.get(n):n:i}function uw(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=c_(e);return n.children.forEach(s=>{(function Eoe(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){const l=function Toe(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!ng(n.url,e.url);case"pathParamsOrQueryParamsChange":return!ng(n.url,e.url)||!xc(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!xP(n,e)||!xc(n.queryParams,e.queryParams);default:return!xP(n,e)}}(s,o,o.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new T5(i)):(o.data=s.data,o._resolvedData=s._resolvedData),uw(n,e,o.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new vE(a.outlet.component,s))}else s&&cw(e,a,r),r.canActivateChecks.push(new T5(i)),uw(n,null,o.component?a?a.children:null:t,i,r)})(s,o[s.value.outlet],t,i.concat([s.value]),r),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>cw(a,t.getContext(s),r)),r}function cw(n,e,t){const i=c_(n),r=n.value;Object.entries(i).forEach(([o,s])=>{cw(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new vE(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function dw(n){return"function"==typeof n}function A5(n){return n instanceof Wb||"EmptyError"===n?.name}const bE=Symbol("INITIAL_VALUE");function f_(){return xs(n=>J4(n.map(e=>e.pipe(Yp(1),qb(bE)))).pipe(Nt(e=>{for(const t of e)if(!0!==t){if(t===bE)return bE;if(!1===t||Noe(t))return t}return!0}),Ms(e=>e!==bE),Yp(1)))}function Noe(n){return ig(n)||n instanceof SP}function D5(n){return jc(No(e=>{if("boolean"!=typeof e)throw yE(0,e)}),Nt(e=>!0===e))}class EP{segmentGroup;constructor(e){this.segmentGroup=e||null}}class TP extends Error{urlTree;constructor(e){super(),this.urlTree=e}}function h_(n){return $b(new EP(n))}class qoe{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return $t(i);if(r.numberOfChildren>1||!r.children[Rn])return $b(new ce(4e3,!1));r=r.children[Rn]}}applyRedirectCommands(e,t,i,r,o){if("string"!=typeof t){const a=t,{queryParams:l,fragment:u,routeConfig:c,url:f,outlet:h,params:g,data:m,title:v}=r,_=Bs(o,()=>a({params:g,data:m,queryParams:l,fragment:u,routeConfig:c,url:f,outlet:h,title:v}));if(_ instanceof tg)throw new TP(_);t=_}const s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i);if("/"===t[0])throw new TP(s);return s}applyRedirectCreateUrlTree(e,t,i,r){const o=this.createSegmentGroup(e,t.root,i,r);return new tg(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,o])=>{if("string"==typeof o&&":"===o[0]){const a=o.substring(1);i[r]=t[a]}else i[r]=o}),i}createSegmentGroup(e,t,i,r){const o=this.createSegments(e,t.segments,i,r);let s={};return Object.entries(t.children).forEach(([a,l])=>{s[a]=this.createSegmentGroup(e,l,i,r)}),new Ni(o,s)}createSegments(e,t,i,r){return t.map(o=>":"===o.path[0]?this.findPosParam(e,o,r):this.findOrReturn(o,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new ce(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const AP={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Xoe(n,e,t,i,r){const o=I5(n,e,t);return o.matched?(i=function uoe(n,e){return n.providers&&!n._injector&&(n._injector=LR(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function joe(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?$t(r.map(s=>{const a=d_(s,n);return fh(function Ooe(n){return n&&dw(n.canMatch)}(a)?a.canMatch(e,t):Bs(n,()=>a(e,t)))})).pipe(f_(),D5()):$t(!0)}(i,e,t).pipe(Nt(s=>!0===s?o:{...AP}))):$t(o)}function I5(n,e,t){if("**"===e.path)return function Yoe(n){return{matched:!0,parameters:n.length>0?Qz(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}(t);if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...AP}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||Ere)(t,n,e);if(!r)return{...AP};const o={};Object.entries(r.posParams??{}).forEach(([a,l])=>{o[a]=l.path});const s=r.consumed.length>0?{...o,...r.consumed[r.consumed.length-1].parameters}:o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:s,positionalParamSegments:r.posParams??{}}}function R5(n,e,t,i){return t.length>0&&function Joe(n,e,t){return t.some(i=>wE(n,e,i)&&Cu(i)!==Rn)}(n,t,i)?{segmentGroup:new Ni(e,Koe(i,new Ni(t,n.children))),slicedSegments:[]}:0===t.length&&function Qoe(n,e,t){return t.some(i=>wE(n,e,i))}(n,t,i)?{segmentGroup:new Ni(n.segments,Zoe(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new Ni(n.segments,n.children),slicedSegments:t}}function Zoe(n,e,t,i){const r={};for(const o of t)if(wE(n,e,o)&&!i[Cu(o)]){const s=new Ni([],{});r[Cu(o)]=s}return{...i,...r}}function Koe(n,e){const t={};t[Rn]=e;for(const i of n)if(""===i.path&&Cu(i)!==Rn){const r=new Ni([],{});t[Cu(i)]=r}return t}function wE(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class tse{}class rse{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,r,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new qoe(this.urlSerializer,this.urlTree)}noMatchError(e){return new ce(4002,`'${e.segmentGroup}'`)}recognize(){const e=R5(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Nt(({children:t,rootSnapshot:i})=>{const r=new Su(i,t),o=new w5("",r),s=function $re(n,e,t=null,i=null){return d5(c5(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){const t=new _E([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Object.freeze({}),Rn,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,Rn,t).pipe(Nt(i=>({children:i,rootSnapshot:t})),Kp(i=>{if(i instanceof TP)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof EP?this.noMatchError(i):i}))}processSegmentGroup(e,t,i,r,o){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i,o):this.processSegment(e,t,i,i.segments,r,!0,o).pipe(Nt(s=>s instanceof Su?[s]:[]))}processChildren(e,t,i,r){const o=[];for(const s of Object.keys(i.children))"primary"===s?o.unshift(s):o.push(s);return vo(o).pipe(Xb(s=>{const a=i.children[s],l=function hoe(n,e){const t=n.filter(i=>Cu(i)===e);return t.push(...n.filter(i=>Cu(i)!==e)),t}(t,s);return this.processSegmentGroup(e,l,a,s,r)}),function Die(n,e){return or(function Aie(n,e,t,i,r){return(o,s)=>{let a=t,l=e,u=0;o.subscribe(Mi(s,c=>{const f=u++;l=a?n(l,c,f):(a=!0,c),i&&s.next(l)},r&&(()=>{a&&s.next(l),s.complete()})))}}(n,e,arguments.length>=2,!0))}((s,a)=>(s.push(...a),s)),eE(null),function Iie(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Ms((r,o)=>n(r,o,i)):da,tP(1),t?eE(e):Tz(()=>new Wb))}(),bs(s=>{if(null===s)return h_(i);const a=P5(s);return function ose(n){n.sort((e,t)=>e.value.outlet===Rn?-1:t.value.outlet===Rn?1:e.value.outlet.localeCompare(t.value.outlet))}(a),$t(a)}))}processSegment(e,t,i,r,o,s,a){return vo(t).pipe(Xb(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,i,r,o,s,a).pipe(Kp(u=>{if(u instanceof EP)return $t(null);throw u}))),Zp(l=>!!l),Kp(l=>{if(A5(l))return function ese(n,e,t){return 0===e.length&&!n.children[t]}(i,r,o)?$t(new tse):h_(i);throw l}))}processSegmentAgainstRoute(e,t,i,r,o,s,a,l){return Cu(i)===s||s!==Rn&&wE(r,o,i)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,o,s,l):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,o,s,l):h_(r):h_(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s,a){const{matched:l,parameters:u,consumedSegments:c,positionalParamSegments:f,remainingSegments:h}=I5(t,r,o);if(!l)return h_(t);"string"==typeof r.redirectTo&&"/"===r.redirectTo[0]&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const g=new _E(o,u,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,O5(r),Cu(r),r.component??r._loadedComponent??null,r,N5(r)),m=mE(g,a,this.paramsInheritanceStrategy);g.params=Object.freeze(m.params),g.data=Object.freeze(m.data);const v=this.applyRedirects.applyRedirectCommands(c,r.redirectTo,f,g,e);return this.applyRedirects.lineralizeSegments(r,v).pipe(bs(_=>this.processSegment(e,i,t,_.concat(h),s,!1,a)))}matchSegmentAgainstRoute(e,t,i,r,o,s){const a=Xoe(t,i,r,e);return"**"===i.path&&(t.children={}),a.pipe(xs(l=>l.matched?this.getChildConfig(e=i._injector??e,i,r).pipe(xs(({routes:u})=>{const c=i._loadedInjector??e,{parameters:f,consumedSegments:h,remainingSegments:g}=l,m=new _E(h,f,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,O5(i),Cu(i),i.component??i._loadedComponent??null,i,N5(i)),v=mE(m,s,this.paramsInheritanceStrategy);m.params=Object.freeze(v.params),m.data=Object.freeze(v.data);const{segmentGroup:_,slicedSegments:y}=R5(t,h,g,u);if(0===y.length&&_.hasChildren())return this.processChildren(c,u,_,m).pipe(Nt(x=>new Su(m,x)));if(0===u.length&&0===y.length)return $t(new Su(m,[]));const w=Cu(i)===o;return this.processSegment(c,u,_,y,w?Rn:o,!0,m).pipe(Nt(x=>new Su(m,x instanceof Su?[x]:[])))})):h_(t)))}getChildConfig(e,t,i){return t.children?$t({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?$t({routes:t._loadedRoutes,injector:t._loadedInjector}):function Goe(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?$t(!0):$t(r.map(s=>{const a=d_(s,n);return fh(function Doe(n){return n&&dw(n.canLoad)}(a)?a.canLoad(e,t):Bs(n,()=>a(e,t)))})).pipe(f_(),D5())}(e,t,i).pipe(bs(r=>r?this.configLoader.loadChildren(e,t).pipe(No(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):function $oe(){return $b(S5(!1,Ka.GuardRejected))}())):$t({routes:[],injector:e})}}function sse(n){const e=n.value.routeConfig;return e&&""===e.path}function P5(n){const e=[],t=new Set;for(const i of n){if(!sse(i)){e.push(i);continue}const r=e.find(o=>i.value.routeConfig===o.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=P5(i.children);e.push(new Su(i.value,r))}return e.filter(i=>!t.has(i))}function O5(n){return n.data||{}}function N5(n){return n.resolve||{}}function F5(n){const e=n.children.map(t=>F5(t)).flat();return[n,...e]}function DP(n){return xs(e=>{const t=n(e);return t?vo(t).pipe(Nt(()=>e)):$t(e)})}let L5=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===Rn);return i}getResolvedTitleForRoute(t){return t.data[ew]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:()=>j(fse),providedIn:"root"})}return n})(),fse=(()=>{class n extends L5{title;constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(Ze(bre))};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const IP=new be("",{providedIn:"root",factory:()=>({})});let k5=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=mo({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){1&i&&Te(0,"router-outlet")},dependencies:[MP],encapsulation:2})}return n})();function RP(n){const e=n.children&&n.children.map(RP),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Rn&&(t.component=k5),t}const PP=new be("");let B5=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=j(gee);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return $t(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=fh(t.loadComponent()).pipe(Nt(U5),No(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),Yb(()=>{this.componentLoaders.delete(t)})),r=new Ez(i,()=>new Xr).pipe(eP());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return $t({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const o=function hse(n,e,t,i){return fh(n.loadChildren()).pipe(Nt(U5),bs(r=>r instanceof gB||Array.isArray(r)?$t(r):vo(e.compileModuleAsync(r))),Nt(r=>{i&&i(n);let o,s,a=!1;return Array.isArray(r)?(s=r,!0):(o=r.create(t).injector,s=o.get(PP,[],{optional:!0,self:!0}).flat()),{routes:s.map(RP),injector:o}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(Yb(()=>{this.childrenLoaders.delete(i)})),s=new Ez(o,()=>new Xr).pipe(eP());return this.childrenLoaders.set(i,s),s}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function U5(n){return function pse(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let OP=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:()=>j(gse),providedIn:"root"})}return n})(),gse=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const mse=new be(""),vse=new be("");let bse=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new Xr;transitionAbortSubject=new Xr;configLoader=j(B5);environmentInjector=j(Ho);destroyRef=j(Hs);urlSerializer=j(aE);rootContexts=j(aw);location=j(bd);inputBindingEnabled=null!==j(CP,{optional:!0});titleStrategy=j(L5);options=j(IP,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=j(OP);createViewTransition=j(mse,{optional:!0});navigationErrorHandler=j(vse,{optional:!0});navigationId=0;get hasRequestedNavigation(){return 0!==this.navigationId}transitions;afterPreactivation=()=>$t(void 0);rootComponentType=null;destroyed=!1;constructor(){this.configLoader.onLoadEndListener=r=>this.events.next(new roe(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new ioe(r)),this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...t,extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:i})}setupNavigations(t){return this.transitions=new Lr(null),this.transitions.pipe(Ms(i=>null!==i),xs(i=>{let r=!1,o=!1;return $t(i).pipe(xs(s=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",Ka.SupersededByNewNavigation),ws;this.currentTransition=i,this.currentNavigation={id:s.id,initialUrl:s.rawUrl,extractedUrl:s.extractedUrl,targetBrowserUrl:"string"==typeof s.extras.browserUrl?this.urlSerializer.parse(s.extras.browserUrl):s.extras.browserUrl,trigger:s.source,extras:s.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null};const a=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!a&&"reload"!==(s.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const u="";return this.events.next(new ow(s.id,this.urlSerializer.serialize(s.rawUrl),u,gP.IgnoredSameUrlNavigation)),s.resolve(!1),ws}if(this.urlHandlingStrategy.shouldProcessUrl(s.rawUrl))return $t(s).pipe(xs(u=>(this.events.next(new pP(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),u.id!==this.navigationId?ws:Promise.resolve(u))),function ase(n,e,t,i,r,o){return bs(s=>function nse(n,e,t,i,r,o,s="emptyOnly"){return new rse(n,e,t,i,r,s,o).recognize()}(n,e,t,i,s.extractedUrl,r,o).pipe(Nt(({state:a,tree:l})=>({...s,targetSnapshot:a,urlAfterRedirects:l}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),No(u=>{i.targetSnapshot=u.targetSnapshot,i.urlAfterRedirects=u.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:u.urlAfterRedirects};const c=new _5(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(c)}));if(a&&this.urlHandlingStrategy.shouldProcessUrl(s.currentRawUrl)){const{id:u,extractedUrl:c,source:f,restoredState:h,extras:g}=s,m=new pP(u,this.urlSerializer.serialize(c),f,h);this.events.next(m);const v=b5(this.rootComponentType).snapshot;return this.currentTransition=i={...s,targetSnapshot:v,urlAfterRedirects:c,extras:{...g,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=c,$t(i)}{const u="";return this.events.next(new ow(s.id,this.urlSerializer.serialize(s.extractedUrl),u,gP.IgnoredByUrlHandlingStrategy)),s.resolve(!1),ws}}),No(s=>{const a=new Qre(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(a)}),Nt(s=>(this.currentTransition=i={...s,guards:Coe(s.targetSnapshot,s.currentSnapshot,this.rootContexts)},i)),function Foe(n,e){return bs(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return 0===s.length&&0===o.length?$t({...t,guardsResult:!0}):function Loe(n,e,t,i){return vo(n).pipe(bs(r=>function zoe(n,e,t,i,r){const o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return o&&0!==o.length?$t(o.map(a=>{const l=sw(e)??r,u=d_(a,l);return fh(function Poe(n){return n&&dw(n.canDeactivate)}(u)?u.canDeactivate(n,e,t,i):Bs(l,()=>u(n,e,t,i))).pipe(Zp())})).pipe(f_()):$t(!0)}(r.component,r.route,t,e,i)),Zp(r=>!0!==r,!0))}(s,i,r,n).pipe(bs(a=>a&&function Aoe(n){return"boolean"==typeof n}(a)?function koe(n,e,t,i){return vo(e).pipe(Xb(r=>Q4(function Uoe(n,e){return null!==n&&e&&e(new ooe(n)),$t(!0)}(r.route.parent,i),function Boe(n,e){return null!==n&&e&&e(new aoe(n)),$t(!0)}(r.route,i),function Hoe(n,e,t){const i=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>function Soe(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(s)).filter(s=>null!==s).map(s=>Sz(()=>$t(s.guards.map(l=>{const u=sw(s.node)??t,c=d_(l,u);return fh(function Roe(n){return n&&dw(n.canActivateChild)}(c)?c.canActivateChild(i,n):Bs(u,()=>c(i,n))).pipe(Zp())})).pipe(f_())));return $t(o).pipe(f_())}(n,r.path,t),function Voe(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return $t(!0);const r=i.map(o=>Sz(()=>{const s=sw(e)??t,a=d_(o,s);return fh(function Ioe(n){return n&&dw(n.canActivate)}(a)?a.canActivate(e,n):Bs(s,()=>a(e,n))).pipe(Zp())}));return $t(r).pipe(f_())}(n,r.route,t))),Zp(r=>!0!==r,!0))}(i,o,n,e):$t(a)),Nt(a=>({...t,guardsResult:a})))})}(this.environmentInjector,s=>this.events.next(s)),No(s=>{if(i.guardsResult=s.guardsResult,s.guardsResult&&"boolean"!=typeof s.guardsResult)throw yE(0,s.guardsResult);const a=new eoe(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot,!!s.guardsResult);this.events.next(a)}),Ms(s=>!!s.guardsResult||(this.cancelNavigationTransition(s,"",Ka.GuardRejected),!1)),DP(s=>{if(0!==s.guards.canActivateChecks.length)return $t(s).pipe(No(a=>{const l=new toe(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}),xs(a=>{let l=!1;return $t(a).pipe(function lse(n,e){return bs(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return $t(t);const o=new Set(r.map(l=>l.route)),s=new Set;for(const l of o)if(!s.has(l))for(const u of F5(l))s.add(u);let a=0;return vo(s).pipe(Xb(l=>o.has(l)?function use(n,e,t,i){const r=n.routeConfig,o=n._resolve;return void 0!==r?.title&&!M5(r)&&(o[ew]=r.title),function cse(n,e,t,i){const r=uP(n);if(0===r.length)return $t({});const o={};return vo(r).pipe(bs(s=>function dse(n,e,t,i){const r=sw(e)??i,o=d_(n,r);return fh(o.resolve?o.resolve(e,t):Bs(r,()=>o(e,t)))}(n[s],e,t,i).pipe(Zp(),No(a=>{if(a instanceof SP)throw yE(new lE,a);o[s]=a}))),tP(1),Nt(()=>o),Kp(s=>A5(s)?ws:$b(s)))}(o,n,e,i).pipe(Nt(s=>(n._resolvedData=s,n.data=mE(n,n.parent,t).resolve,null)))}(l,i,n,e):(l.data=mE(l,l.parent,n).resolve,$t(void 0))),No(()=>a++),tP(1),bs(l=>a===s.size?$t(t):ws))})}(this.paramsInheritanceStrategy,this.environmentInjector),No({next:()=>l=!0,complete:()=>{l||this.cancelNavigationTransition(a,"",Ka.NoDataFromResolver)}}))}),No(a=>{const l=new noe(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}))}),DP(s=>{const a=l=>{const u=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&u.push(this.configLoader.loadComponent(l.routeConfig).pipe(No(c=>{l.component=c}),Nt(()=>{})));for(const c of l.children)u.push(...a(c));return u};return J4(a(s.targetSnapshot.root)).pipe(eE(null),Yp(1))}),DP(()=>this.afterPreactivation()),xs(()=>{const{currentSnapshot:s,targetSnapshot:a}=i,l=this.createViewTransition?.(this.environmentInjector,s.root,a.root);return l?vo(l).pipe(Nt(()=>i)):$t(i)}),Nt(s=>{const a=function yoe(n,e,t){const i=lw(n,e._root,t?t._root:void 0);return new v5(i,e)}(t.routeReuseStrategy,s.targetSnapshot,s.currentRouterState);return this.currentTransition=i={...s,targetRouterState:a},this.currentNavigation.targetRouterState=a,i}),No(()=>{this.events.next(new _P)}),((n,e,t,i)=>Nt(r=>(new Moe(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,s=>this.events.next(s),this.inputBindingEnabled),Yp(1),No({next:s=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new rg(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects))),this.titleStrategy?.updateTitle(s.targetRouterState.snapshot),s.resolve(!0)},complete:()=>{r=!0}}),l_(this.transitionAbortSubject.pipe(No(s=>{throw s}))),Yb(()=>{!r&&!o&&this.cancelNavigationTransition(i,"",Ka.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation=null,this.currentTransition=null)}),Kp(s=>{if(this.destroyed)return i.resolve(!1),ws;if(o=!0,E5(s))this.events.next(new og(i.id,this.urlSerializer.serialize(i.extractedUrl),s.message,s.cancellationCode)),function woe(n){return E5(n)&&ig(n.url)}(s)?this.events.next(new gE(s.url,s.navigationBehaviorOptions)):i.resolve(!1);else{const a=new mP(i.id,this.urlSerializer.serialize(i.extractedUrl),s,i.targetSnapshot??void 0);try{const l=Bs(this.environmentInjector,()=>this.navigationErrorHandler?.(a));if(!(l instanceof SP))throw this.events.next(a),s;{const{message:u,cancellationCode:c}=yE(0,l);this.events.next(new og(i.id,this.urlSerializer.serialize(i.extractedUrl),u,c)),this.events.next(new gE(l.redirectTo,l.navigationBehaviorOptions))}}catch(l){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(l)}}return ws}))}))}cancelNavigationTransition(t,i,r){const o=new og(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){const t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function wse(n){return n!==pE}let xse=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:()=>j(Cse),providedIn:"root"})}return n})();class Mse{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let Cse=(()=>{class n extends Mse{static \u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})();static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),V5=(()=>{class n{urlSerializer=j(aE);options=j(IP,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=j(bd);urlHandlingStrategy=j(OP);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new tg;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:i,targetBrowserUrl:r}){const o=void 0!==t?this.urlHandlingStrategy.merge(t,i):i,s=r??o;return s instanceof tg?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:i,initialUrl:r}){i&&t?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,r),this.routerState=t):this.rawUrlTree=r}routerState=b5(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:()=>j(Sse),providedIn:"root"})}return n})(),Sse=(()=>{class n extends V5{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{"popstate"===i.type&&setTimeout(()=>{t(i.url,i.state,"popstate")})})}handleRouterEvent(t,i){t instanceof pP?this.updateStateMemento():t instanceof ow?this.commitTransition(i):t instanceof _5?"eager"===this.urlUpdateStrategy&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof _P?(this.commitTransition(i),"deferred"===this.urlUpdateStrategy&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof og&&(t.code===Ka.GuardRejected||t.code===Ka.NoDataFromResolver)?this.restoreHistory(i):t instanceof mP?this.restoreHistory(i,!0):t instanceof rg&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:i,id:r}){const{replaceUrl:o,state:s}=i;if(this.location.isCurrentPathEqualTo(t)||o){const a=this.browserPageId,l={...s,...this.generateNgRouterState(r,a)};this.location.replaceState(t,"",l)}else{const a={...s,...this.generateNgRouterState(r,this.browserPageId+1)};this.location.go(t,"",a)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-this.browserPageId;0!==o?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&0===o&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})();static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Tse={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Ase={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ea=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=j(AS);stateManager=j(V5);options=j(IP,{optional:!0})||{};pendingTasks=j(hu);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=j(bse);urlSerializer=j(aE);location=j(bd);urlHandlingStrategy=j(OP);_events=new Xr;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=j(xse);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=j(PP,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!j(CP,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Yi;subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const r=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(null!==r&&null!==o)if(this.stateManager.handleRouterEvent(i,o),i instanceof og&&i.code!==Ka.Redirect&&i.code!==Ka.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof rg)this.navigated=!0;else if(i instanceof gE){const s=i.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),l={browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||"eager"===this.urlUpdateStrategy||wse(r.source),...s};this.scheduleNavigation(a,pE,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}(function Ise(n){return!(n instanceof _P||n instanceof gE)})(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),pE,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i,r)=>{this.navigateToSyncWithBrowser(t,r,i)})}navigateToSyncWithBrowser(t,i,r){const o={replaceUrl:!0},s=r?.navigationId?r:null;if(r){const l={...r};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(o.state=l)}const a=this.parseUrl(t);this.scheduleNavigation(a,i,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(RP),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:l}=i,u=l?this.currentUrlTree.fragment:s;let f,c=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":c={...this.currentUrlTree.queryParams,...o};break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=o||null}null!==c&&(c=this.removeEmptyProps(c));try{f=c5(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||"/"!==t[0][0])&&(t=[]),f=this.currentUrlTree.root}return d5(f,t,c,u??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=ig(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,pE,null,i)}navigate(t,i={skipLocationChange:!1}){return function Dse(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new ce(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,i){let r;if(r=!0===i?{...Tse}:!1===i?{...Ase}:i,ig(t))return t5(this.currentUrlTree,t,r);const o=this.parseUrl(t);return t5(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,o])=>(null!=o&&(i[r]=o),i),{})}scheduleNavigation(t,i,r,o,s){if(this.disposed)return Promise.resolve(!1);let a,l,u;s?(a=s.resolve,l=s.reject,u=s.promise):u=new Promise((f,h)=>{a=f,l=h});const c=this.pendingTasks.add();return function Ese(n,e){n.events.pipe(Ms(t=>t instanceof rg||t instanceof og||t instanceof mP||t instanceof ow),Nt(t=>t instanceof rg||t instanceof ow?0:t instanceof og&&(t.code===Ka.Redirect||t.code===Ka.SupersededByNewNavigation)?2:1),Ms(t=>2!==t),Yp(1)).subscribe(()=>{e()})}(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(c))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(f=>Promise.reject(f))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),hh=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;href=null;target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new Xr;constructor(t,i,r,o,s,a){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=o,this.el=s,this.locationStrategy=a;const l=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===l||"area"===l,this.isAnchorElement?this.subscription=t.events.subscribe(u=>{u instanceof rg&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){null==t?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(this.routerLinkInput=ig(t)||Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,i,r,o,s){const a=this.urlTree;return!!(null===a||this.isAnchorElement&&(0!==t||i||r||o||s||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(a,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){const t=this.urlTree;this.href=null!==t&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;const i=null===this.href?null:function SL(n,e,t){return function c9(n,e){return"src"===e&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===e&&("base"===n||"link"===n)?CL:mc}(e,t)(n)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(t,i){const r=this.renderer,o=this.el.nativeElement;null!==i?r.setAttribute(o,t,i):r.removeAttribute(o,t)}get urlTree(){return null===this.routerLinkInput?null:ig(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(i){return new(i||n)(se(Ea),se(Eu),function Lf(n){return function yD(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const o=t[r];if(AM(o))break;if(0===o)r+=2;else if("number"==typeof o)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(o===e)return t[r+1];r+=2}}}return null}(Mn(),n)}("tabindex"),se(Dl),se(gi),se(YS))};static \u0275dir=_t({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,r){1&i&&Oe("click",function(s){return r.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&i&&$s("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",a_],skipLocationChange:[2,"skipLocationChange","skipLocationChange",a_],replaceUrl:[2,"replaceUrl","replaceUrl",a_],routerLink:"routerLink"},features:[as]})}return n})();const NP=new be("");function z5(n){return n.routerState.root}function G5(){const n=j(no);return e=>{const t=n.get(xa);if(e!==t.components[0])return;const i=n.get(Ea),r=n.get(j5);1===n.get(FP)&&i.initialNavigation(),n.get(W5,null,xn.Optional)?.setUpPreloading(),n.get(NP,null,xn.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const j5=new be("",{factory:()=>new Xr}),FP=new be("",{providedIn:"root",factory:()=>1}),W5=new be(""),WP=/\s+/,t8=[];let sg=(()=>{class n{_ngEl;_renderer;initialClasses=t8;rawClass;stateMap=new Map;constructor(t,i){this._ngEl=t,this._renderer=i}set klass(t){this.initialClasses=null!=t?t.trim().split(WP):t8}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(WP):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(WP).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static \u0275fac=function(i){return new(i||n)(se(gi),se(Dl))};static \u0275dir=_t({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();class Mae{$implicit;ngForOf;index;count;constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Au=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,o,s)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new Mae(r.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)i.remove(null===o?void 0:o);else if(null!==o){const a=i.get(o);i.move(a,s),i8(a,r)}});for(let r=0,o=i.length;r<o;r++){const a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{i8(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(se(mu),se(Ws),se(I4))};static \u0275dir=_t({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function i8(n,e){n.context.$implicit=e.item}let Cs=(()=>{class n{_viewContainer;_context=new Cae;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,i){this._viewContainer=t,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){r8(t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){r8(t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(se(mu),se(Ws))};static \u0275dir=_t({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})();class Cae{$implicit=null;ngIf=null}function r8(n,e){if(n&&!n.createEmbeddedView)throw new ce(2020,!1)}let g_=(()=>{class n{_viewContainerRef;_viewRef=null;ngTemplateOutletContext=null;ngTemplateOutlet=null;ngTemplateOutletInjector=null;constructor(t){this._viewContainerRef=t}ngOnChanges(t){if(this._shouldRecreateView(t)){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),!this.ngTemplateOutlet)return void(this._viewRef=null);const r=this._createContextForwardProxy();this._viewRef=i.createEmbeddedView(this.ngTemplateOutlet,r,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(t){return!!t.ngTemplateOutlet||!!t.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(t,i,r)=>!!this.ngTemplateOutletContext&&Reflect.set(this.ngTemplateOutletContext,i,r),get:(t,i,r)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,i,r)}})}static \u0275fac=function(i){return new(i||n)(se(mu))};static \u0275dir=_t({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},features:[as]})}return n})();class Dae{createSubscription(e,t){return Hr(()=>e.subscribe({next:t,error:i=>{throw i}}))}dispose(e){Hr(()=>e.unsubscribe())}}class Iae{createSubscription(e,t){return e.then(i=>t?.(i),i=>{throw i}),{unsubscribe:()=>{t=null}}}dispose(e){e.unsubscribe()}}const Rae=new Iae,Pae=new Dae;let s8=(()=>{class n{_ref;_latestValue=null;markForCheckOnValueUpdate=!0;_subscription=null;_obj=null;_strategy=null;constructor(t){this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){if(!this._obj){if(t)try{this.markForCheckOnValueUpdate=!1,this._subscribe(t)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,i=>this._updateLatestValue(t,i))}_selectStrategy(t){if(Ab(t))return Rae;if(HB(t))return Pae;throw function Du(n,e){return new ce(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,i){t===this._obj&&(this._latestValue=i,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static \u0275fac=function(i){return new(i||n)(se(wu,16))};static \u0275pipe=_s({name:"async",type:n,pure:!1})}return n})(),Zae=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Hp({type:n});static \u0275inj=Ku({})}return n})(),ZP=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=_t({type:n,selectors:[["","tuiItem",""]]})}}return n})();function m_(n={}){const{connector:e=()=>new Xr,resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return o=>{let s,a,l,u=0,c=!1,f=!1;const h=()=>{a?.unsubscribe(),a=void 0},g=()=>{h(),s=l=void 0,c=f=!1},m=()=>{const v=s;g(),v?.unsubscribe()};return or((v,_)=>{u++,!f&&!c&&h();const y=l=l??e();_.add(()=>{u--,0===u&&!f&&!c&&(a=KP(m,r))}),y.subscribe(_),!s&&u>0&&(s=new Kl({next:w=>y.next(w),error:w=>{f=!0,h(),a=KP(g,t,w),y.error(w)},complete:()=>{c=!0,h(),a=KP(g,i),y.complete()}}),Zo(v).subscribe(s))})(o)}}function KP(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new Kl({next:()=>{i.unsubscribe(),n()}});return Zo(e(...t)).subscribe(i)}const Kae=["addListener","removeListener"],Jae=["addEventListener","removeEventListener"],Qae=["on","off"];function ag(n,e,t,i){if(yn(t)&&(i=t,t=void 0),i)return ag(n,e,t).pipe(K4(i));const[r,o]=function nle(n){return yn(n.addEventListener)&&yn(n.removeEventListener)}(n)?Jae.map(s=>a=>n[s](e,a,t)):function ele(n){return yn(n.addListener)&&yn(n.removeListener)}(n)?Kae.map(l8(n,e)):function tle(n){return yn(n.on)&&yn(n.off)}(n)?Qae.map(l8(n,e)):[];if(!r&&X4(n))return bs(s=>ag(s,e,t))(Zo(n));if(!r)throw new TypeError("Invalid event target");return new Kn(s=>{const a=(...l)=>s.next(1<l.length?l:l[0]);return r(a),()=>o(a)})}function l8(n,e){return t=>i=>n[t](e,i)}function u8(n,e=da){return n=n??ile,or((t,i)=>{let r,o=!0;t.subscribe(Mi(i,s=>{const a=e(s);(o||!n(r,a))&&(o=!1,r=a,i.next(s))}))})}function ile(n,e){return n===e}const JP={now:()=>(JP.delegate||Date).now(),delegate:void 0};class rle extends Xr{constructor(e=1/0,t=1/0,i=JP){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:o,_windowTime:s}=this;t||(i.push(e),!r&&i.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:i,_buffer:r}=this,o=r.slice();for(let s=0;s<o.length&&!e.closed;s+=i?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:i,_infiniteTimeWindow:r}=this,o=(r?1:2)*e;if(e<1/0&&o<i.length&&i.splice(0,i.length-o),!r){const s=t.now();let a=0;for(let l=1;l<i.length&&i[l]<=s;l+=2)a=l;a&&i.splice(0,a+1)}}}function QP(n,e,t){let i,r=!1;return n&&"object"==typeof n?({bufferSize:i=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=n):i=n??1/0,m_({connector:()=>new rle(i,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}const Zs=new be("[WA_WINDOW]",{factory:()=>{const{defaultView:n}=j(fr);if(!n)throw new Error("Window is not available");return n}}),Qa=Zs,ole=(new be("[WA_ANIMATION_FRAME]",{factory:()=>{const{requestAnimationFrame:n,cancelAnimationFrame:e}=j(Qa);return new Kn(i=>{let r=NaN;const o=s=>{i.next(s),r=n(o)};return r=n(o),()=>{e(r)}}).pipe(m_())}}),new be("[WA_CACHES]",{factory:()=>j(Qa).caches}),new be("[WA_CRYPTO]",{factory:()=>j(Qa).crypto}),new be("[WA_CSS]",{factory:()=>j(Qa).CSS??{escape:n=>n,supports:()=>!1}}),new be("[WA_HISTORY]",{factory:()=>j(Qa).history}),new be("[WA_LOCAL_STORAGE]",{factory:()=>j(Qa).localStorage})),hw=(new be("[WA_LOCATION]",{factory:()=>j(Qa).location}),new be("[WA_NAVIGATOR]",{factory:()=>j(Qa).navigator})),c8=hw,sle=(new be("[WA_MEDIA_DEVICES]",{factory:()=>j(c8).mediaDevices}),new be("[WA_NETWORK_INFORMATION]",{factory:()=>j(hw).connection||null}),new be("[WA_PAGE_VISIBILITY]",{factory:()=>{const n=j(fr);return ag(n,"visibilitychange").pipe(qb(0),Nt(()=>"hidden"!==n.visibilityState),u8(),QP({refCount:!1,bufferSize:1}))}})),OE=(new be("[WA_PERFORMANCE]",{factory:()=>j(Qa).performance}),new be("[WA_SCREEN]",{factory:()=>j(Qa).screen}),new be("[WA_SESSION_STORAGE]",{factory:()=>j(Qa).sessionStorage}),new be("[WA_SPEECH_RECOGNITION]: [SPEECH_RECOGNITION]",{factory:()=>{const n=j(Qa);return n.speechRecognition||n.webkitSpeechRecognition||null}}),new be("[WA_SPEECH_SYNTHESIS]",{factory:()=>j(Qa).speechSynthesis}),new be("[WA_USER_AGENT]",{factory:()=>j(c8).userAgent})),ale=typeof IntersectionObserver<"u"?IntersectionObserver:class{root=null;rootMargin="";thresholds=[];observe(){}unobserve(){}disconnect(){}takeRecords(){return[]}},d8=new be("[WA_INTERSECTION_ROOT]"),f8="0px 0px 0px 0px";new be("[WA_INTERSECTION_ROOT_MARGIN]",{providedIn:"root",factory:()=>f8}),new be("[WA_INTERSECTION_THRESHOLD]",{providedIn:"root",factory:()=>0});let e3=(()=>{class n extends ale{callbacks=new Map;margin="";threshold="";constructor(){const t=j(d8,{optional:!0});super(i=>{this.callbacks.forEach((r,o)=>{const s=i.filter(({target:a})=>a===o);return s.length&&r(s,this)})},{root:t?.nativeElement,rootMargin:j(gi).nativeElement.getAttribute("waIntersectionRootMargin")||f8,threshold:j(gi).nativeElement.getAttribute("waIntersectionThreshold")?.split(",").map(parseFloat)||0})}observe(t,i=()=>{}){super.observe(t),this.callbacks.set(t,i)}unobserve(t){super.unobserve(t),this.callbacks.delete(t)}ngOnDestroy(){this.disconnect()}static \u0275fac=function(i){return new(i||n)};static \u0275dir=_t({type:n,selectors:[["","waIntersectionObserver",""]],inputs:{margin:[0,"waIntersectionRootMargin","margin"],threshold:[0,"waIntersectionThreshold","threshold"]},exportAs:["IntersectionObserver"],features:[In]})}return n})(),p8=(()=>{class n extends Kn{constructor(){const t=j(gi).nativeElement,i=j(e3);return super(r=>(i.observe(t,o=>{r.next(o)}),()=>{i.unobserve(t)})),this.pipe(m_())}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac})}return n})(),g8=(()=>{class n{waIntersectionObservee=j(p8);static \u0275fac=function(i){return new(i||n)};static \u0275dir=_t({type:n,selectors:[["","waIntersectionObservee",""]],outputs:{waIntersectionObservee:"waIntersectionObservee"},features:[Cn([p8])]})}return n})();new be("[WA_INTERSECTION_OBSERVER_SUPPORT]: [INTERSECTION_OBSERVER_SUPPORT]",{providedIn:"root",factory:()=>!!j(Zs).IntersectionObserver}),parseInt(hee.major,10);const dle=new nC,t3=()=>!1,_8=()=>!0;class ple extends Yi{constructor(e,t){super()}schedule(e,t=0){return this}}const FE={setInterval(n,e,...t){const{delegate:i}=FE;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=FE;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class y8 extends ple{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,i=0){return FE.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&FE.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,xr(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}class pw{constructor(e,t=pw.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}pw.now=JP.now;class v8 extends pw{constructor(e,t=pw.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const n3=new class mle extends v8{}(class gle extends y8{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!=i&&i>0||null==i&&this.delay>0?super.requestAsyncId(e,t,i):(e.flush(this),0)}}),gw=new v8(y8),_le=gw;function li(n,e,t={}){return ag(n,e,t)}Error,n3.now.bind(n3);class w8{constructor(e,t=gw){this.zoneConditionFn=e,this.scheduler=t}now(){return this.scheduler.now()}schedule(...e){return this.zoneConditionFn(()=>this.scheduler.schedule(...e))}}function x8(n=j(Hn),e=gw){return new w8(n.runOutsideAngular.bind(n),e)}function r3(n){return n.composedPath()[0]}function o3(n){return"getRootNode"in n&&n.isConnected?n.getRootNode():n.ownerDocument}function lg(){return j(gi).nativeElement}function Md(...n){const e=jb(n),t=function gie(n,e){return"number"==typeof Y4(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Zo(i[0]):QS(t)(vo(i,e)):ws}function E8(){return or((n,e)=>{let t,i=!1;n.subscribe(Mi(e,r=>{const o=t;t=r,i&&e.next([o,r]),i=!0}))})}function mw(n=0,e,t=_le){let i=-1;return null!=e&&(wz(e)?t=e:i=e),new Kn(r=>{let o=function Tle(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;o<0&&(o=0);let s=0;return t.schedule(function(){r.closed||(r.next(s++),0<=i?this.schedule(void 0,i):r.complete())},o)})}function T8(n){let t,e=1/0;return null!=n&&("object"==typeof n?({count:e=1/0,delay:t}=n):e=n),e<=0?()=>ws:or((i,r)=>{let s,o=0;const a=()=>{if(s?.unsubscribe(),s=null,null!=t){const u="number"==typeof t?mw(t):Zo(t(o)),c=Mi(r,()=>{c.unsubscribe(),l()});u.subscribe(c)}else l()},l=()=>{let u=!1;s=i.subscribe(Mi(r,void 0,()=>{++o<e?s?a():u=!0:r.complete()})),u&&a()};l()})}let A8=(()=>{class n extends Kn{constructor(){const t=lg(),i=j(fr);super(r=>Md(li(t,"touchstart",{passive:!0}),li(t,"mousedown")).pipe(xs(()=>Md(li(i,"touchmove",{passive:!0}).pipe(Ms(({touches:o})=>o.length<2),Nt(({touches:o})=>o[0])),li(i,"mousemove"))),E8(),Nt(([o,s])=>[(s?.clientX??0)-(o?.clientX??0),(s?.clientY??0)-(o?.clientY??0)]),l_(Md(li(i,"touchend"),li(i,"mouseup"))),T8()).subscribe(r))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=Ve({token:n,factory:n.\u0275fac})}}return n})(),Ale=(()=>{class n{constructor(){this.tuiPan=j(A8)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=_t({type:n,selectors:[["","tuiPan",""]],outputs:{tuiPan:"tuiPan"},features:[Cn([A8])]})}}return n})();function Fi(n){return void 0===n?new be(""):on(()=>n)}function on(n){return n?new be("",{factory:n}):new be("")}function Ole(n){return null!=n}function Sc(n,e,t=!1){return{provide:n,useExisting:e,multi:t}}function O8(n,e,t=!0){return function(){const r=n.call(this);return Object.defineProperty(this,e,{enumerable:t,value:r}),r}}function Lle(n,e,t){if("function"==typeof n){const l=e;if("getter"===l.kind)return O8(n,l.name);if("method"===l.kind)return function Fle(n){let i,e=[],t=!1;return function(...o){return t&&e.length===o.length&&o.every((a,l)=>a===e[l])||(e=o,i=n.apply(this,o),t=!0),i}}(n);throw new N8}const{get:i,enumerable:r,value:o}=t,s=e;if(i)return{configurable:!0,enumerable:r,get:O8(i,s,r)};if("function"!=typeof o)throw new N8;const a=o;return{configurable:!0,enumerable:r,get(){let c,l=[],u=!1;const f=(...h)=>(u&&l.length===h.length&&h.every((m,v)=>m===l[v])||(l=h,c=a.apply(this,h),u=!0),c);return Object.defineProperty(this,s,{configurable:!0,value:f}),f}}}class N8 extends Error{constructor(){super("")}}on(()=>{const n=new Map;return j(Hs).onDestroy(()=>n.forEach(e=>e.destroy())),n});const F8=Fi({timeout:500,threshold:30});let L8=(()=>{class n extends Kn{constructor(){const t=j(fr),i=lg(),{timeout:r,threshold:o}=j(F8);super(s=>Md(li(i,"touchstart",{passive:!0}),li(t,"touchend")).pipe(E8(),Ms(([a,l])=>!!a.touches.length&&a.touches[0]?.identifier===l.changedTouches[0]?.identifier),Nt(([a,l])=>{const u=a.touches[0]?.clientX??0,c=a.touches[0]?.clientY??0,g=u-(l.changedTouches[0]?.clientX??0),m=c-(l.changedTouches[0]?.clientY??0),v=l.timeStamp-a.timeStamp;return(Math.abs(g)>o||Math.abs(m)>o)&&v<r?{direction:Ble(g,m),events:[a,l]}:null}),Ms(Ole)).subscribe(s))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=Ve({token:n,factory:n.\u0275fac})}}return n})();function Ble(n,e){return Math.abs(e)>Math.abs(n)?e>0?"top":"bottom":n>0?"left":"right"}let Ule=(()=>{class n{constructor(){this.tuiSwipe=j(L8)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=_t({type:n,selectors:[["","tuiSwipe",""]],outputs:{tuiSwipe:"tuiSwipe"},features:[Cn([L8])]})}}return n})();var sn=function(n){return n[n.State=0]="State",n[n.Transition=1]="Transition",n[n.Sequence=2]="Sequence",n[n.Group=3]="Group",n[n.Animate=4]="Animate",n[n.Keyframes=5]="Keyframes",n[n.Style=6]="Style",n[n.Trigger=7]="Trigger",n[n.Reference=8]="Reference",n[n.AnimateChild=9]="AnimateChild",n[n.AnimateRef=10]="AnimateRef",n[n.Query=11]="Query",n[n.Stagger=12]="Stagger",n}(sn||{});const Cd="*";function U8(n){return{type:sn.Style,styles:n,offset:null}}class _w{_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_originalOnDoneFns=[];_originalOnStartFns=[];_started=!1;_destroyed=!1;_finished=!1;_position=0;parentPlayer=null;totalTime;constructor(e=0,t=0){this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class V8{_onDoneFns=[];_onStartFns=[];_finished=!1;_started=!1;_destroyed=!1;_onDestroyFns=[];parentPlayer=null;totalTime=0;players;constructor(e){this.players=e;let t=0,i=0,r=0;const o=this.players.length;0==o?queueMicrotask(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++t==o&&this._onFinish()}),s.onDestroy(()=>{++i==o&&this._onDestroy()}),s.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function H8(n){return new ce(3e3,!1)}function ph(n){switch(n.length){case 0:return new _w;case 1:return n[0];default:return new V8(n)}}function z8(n,e,t=new Map,i=new Map){const r=[],o=[];let s=-1,a=null;if(e.forEach(l=>{const u=l.get("offset"),c=u==s,f=c&&a||new Map;l.forEach((h,g)=>{let m=g,v=h;if("offset"!==g)switch(m=n.normalizePropertyName(m,r),v){case"!":v=t.get(g);break;case Cd:v=i.get(g);break;default:v=n.normalizeStyleValue(g,m,v,r)}f.set(m,v)}),c||o.push(f),a=f,s=u}),r.length)throw function uue(){return new ce(3502,!1)}();return o}function l3(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&u3(t,"start",n)));break;case"done":n.onDone(()=>i(t&&u3(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&u3(t,"destroy",n)))}}function u3(n,e,t){const o=c3(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),s=n._data;return null!=s&&(o._data=s),o}function c3(n,e,t,i,r="",o=0,s){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:o,disabled:!!s}}function el(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function G8(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}const wue=typeof document>"u"?null:document.documentElement;function d3(n){const e=n.parentNode||n.host||null;return e===wue?null:e}let ug=null,j8=!1;function W8(n,e){for(;e;){if(e===n)return!0;e=d3(e)}return!1}function $8(n,e,t){if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]}const X8="ng-enter",f3="ng-leave",LE="ng-trigger",kE=".ng-trigger",Y8="ng-animating",h3=".ng-animating";function Sd(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:p3(parseFloat(e[1]),e[2])}function p3(n,e){return"s"===e?1e3*n:n}function BE(n,e,t){return n.hasOwnProperty("duration")?n:function Tue(n,e,t){let r,o=0,s="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(H8()),{duration:0,delay:0,easing:""};r=p3(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(o=p3(parseFloat(l),a[4]));const u=a[5];u&&(s=u)}else r=n;if(!t){let a=!1,l=e.length;r<0&&(e.push(function Gle(){return new ce(3100,!1)}()),a=!0),o<0&&(e.push(function jle(){return new ce(3101,!1)}()),a=!0),a&&e.splice(l,0,H8())}return{duration:r,delay:o,easing:s}}(n,e,t)}function Ec(n,e,t){e.forEach((i,r)=>{const o=m3(r);t&&!t.has(r)&&t.set(r,n.style[o]),n.style[o]=i})}function cg(n,e){e.forEach((t,i)=>{const r=m3(i);n.style[r]=""})}function yw(n){return Array.isArray(n)?1==n.length?n[0]:function zle(n,e=null){return{type:sn.Sequence,steps:n,options:e}}(n):n}const g3=new RegExp("{{\\s*(.+?)\\s*}}","g");function Z8(n){let e=[];if("string"==typeof n){let t;for(;t=g3.exec(n);)e.push(t[1]);g3.lastIndex=0}return e}function vw(n,e,t){const i=`${n}`,r=i.replace(g3,(o,s)=>{let a=e[s];return null==a&&(t.push(function $le(){return new ce(3003,!1)}()),a=""),a.toString()});return r==i?n:r}const Iue=/-+([a-z0-9])/g;function m3(n){return n.replace(Iue,(...e)=>e[1].toUpperCase())}function tl(n,e,t){switch(e.type){case sn.Trigger:return n.visitTrigger(e,t);case sn.State:return n.visitState(e,t);case sn.Transition:return n.visitTransition(e,t);case sn.Sequence:return n.visitSequence(e,t);case sn.Group:return n.visitGroup(e,t);case sn.Animate:return n.visitAnimate(e,t);case sn.Keyframes:return n.visitKeyframes(e,t);case sn.Style:return n.visitStyle(e,t);case sn.Reference:return n.visitReference(e,t);case sn.AnimateChild:return n.visitAnimateChild(e,t);case sn.AnimateRef:return n.visitAnimateRef(e,t);case sn.Query:return n.visitQuery(e,t);case sn.Stagger:return n.visitStagger(e,t);default:throw function qle(){return new ce(3004,!1)}()}}function _3(n,e){return window.getComputedStyle(n)[e]}let y3=(()=>{class n{validateStyleProperty(t){return function Mue(n){ug||(ug=function Cue(){return typeof document<"u"?document.body:null}()||{},j8=!!ug.style&&"WebkitAppearance"in ug.style);let e=!0;return ug.style&&!function xue(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in ug.style,!e&&j8&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in ug.style)),e}(t)}containsElement(t,i){return W8(t,i)}getParentElement(t){return d3(t)}query(t,i,r){return $8(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,o,s,a=[],l){return new _w(r,o)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac})}return n})();class v3{static NOOP=new y3}class b3{}const Nue=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class K8 extends b3{normalizePropertyName(e,t){return m3(e)}normalizeStyleValue(e,t,i,r){let o="";const s=i.toString().trim();if(Nue.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)o="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function Xle(){return new ce(3005,!1)}())}return s+o}}const VE=new Set(["true","1"]),HE=new Set(["false","0"]);function J8(n,e){const t=VE.has(n)||HE.has(n),i=VE.has(e)||HE.has(e);return(r,o)=>{let s="*"==n||n==r,a="*"==e||e==o;return!s&&t&&"boolean"==typeof r&&(s=r?VE.has(n):HE.has(n)),!a&&i&&"boolean"==typeof o&&(a=o?VE.has(e):HE.has(e)),s&&a}}const Bue=new RegExp("s*:selfs*,?","g");function x3(n,e,t,i){return new Uue(n).build(e,t,i)}class Uue{_driver;constructor(e){this._driver=e}build(e,t,i){const r=new zue(t);return this._resetContextStyleTimingState(r),tl(this,yw(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const o=[],s=[];return"@"==e.name.charAt(0)&&t.errors.push(function Yle(){return new ce(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),a.type==sn.State){const l=a,u=l.name;u.toString().split(/\s*,\s*/).forEach(c=>{l.name=c,o.push(this.visitState(l,t))}),l.name=u}else if(a.type==sn.Transition){const l=this.visitTransition(a,t);i+=l.queryCount,r+=l.depCount,s.push(l)}else t.errors.push(function Zle(){return new ce(3007,!1)}())}),{type:sn.Trigger,name:e.name,states:o,transitions:s,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const o=new Set,s=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{Z8(l).forEach(u=>{s.hasOwnProperty(u)||o.add(u)})})}),o.size&&t.errors.push(function Kle(){return new ce(3008,!1)}(0,o.values()))}return{type:sn.State,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=tl(this,yw(e.animation),t),r=function Fue(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function Lue(n,e,t){if(":"==n[0]){const l=function kue(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function aue(){return new ce(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof l)return void e.push(l);n=l}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function sue(){return new ce(3015,!1)}()),e;const r=i[1],o=i[2],s=i[3];e.push(J8(r,s)),"<"==o[0]&&("*"!=r||"*"!=s)&&e.push(J8(s,r))}(i,t,e)):t.push(n),t}(e.expr,t.errors);return{type:sn.Transition,matchers:r,animation:i,queryCount:t.queryCount,depCount:t.depCount,options:dg(e.options)}}visitSequence(e,t){return{type:sn.Sequence,steps:e.steps.map(i=>tl(this,i,t)),options:dg(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const o=e.steps.map(s=>{t.currentTime=i;const a=tl(this,s,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:sn.Group,steps:o,options:dg(e.options)}}visitAnimate(e,t){const i=function jue(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return M3(BE(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=M3(0,0,"");return o.dynamic=!0,o.strValue=t,o}const r=BE(t,e);return M3(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,o=e.styles?e.styles:U8({});if(o.type==sn.Keyframes)r=this.visitKeyframes(o,t);else{let s=e.styles,a=!1;if(!s){a=!0;const u={};i.easing&&(u.easing=i.easing),s=U8(u)}t.currentTime+=i.duration+i.delay;const l=this.visitStyle(s,t);l.isEmptyStep=a,r=l}return t.currentAnimateTimings=null,{type:sn.Animate,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of r)"string"==typeof a?a===Cd?i.push(a):t.errors.push(new ce(3002,!1)):i.push(new Map(Object.entries(a)));let o=!1,s=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!o))for(let l of a.values())if(l.toString().indexOf("{{")>=0){o=!0;break}}),{type:sn.Style,styles:i,easing:s,offset:e.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,o=t.currentTime;i&&o>0&&(o-=i.duration+i.delay),e.styles.forEach(s=>{"string"!=typeof s&&s.forEach((a,l)=>{const u=t.collectedStyles.get(t.currentQuerySelector),c=u.get(l);let f=!0;c&&(o!=r&&o>=c.startTime&&r<=c.endTime&&(t.errors.push(function Qle(){return new ce(3010,!1)}()),f=!1),o=c.startTime),f&&u.set(l,{startTime:o,endTime:r}),t.options&&function Due(n,e,t){const i=e.params||{},r=Z8(n);r.length&&r.forEach(o=>{i.hasOwnProperty(o)||t.push(function Wle(){return new ce(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:sn.Keyframes,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function eue(){return new ce(3011,!1)}()),i;let o=0;const s=[];let a=!1,l=!1,u=0;const c=e.steps.map(y=>{const w=this._makeStyleAst(y,t);let x=null!=w.offset?w.offset:function Gue(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(w.styles),M=0;return null!=x&&(o++,M=w.offset=x),l=l||M<0||M>1,a=a||M<u,u=M,s.push(M),w});l&&t.errors.push(function tue(){return new ce(3012,!1)}()),a&&t.errors.push(function nue(){return new ce(3200,!1)}());const f=e.steps.length;let h=0;o>0&&o<f?t.errors.push(function iue(){return new ce(3202,!1)}()):0==o&&(h=1/(f-1));const g=f-1,m=t.currentTime,v=t.currentAnimateTimings,_=v.duration;return c.forEach((y,w)=>{const x=h>0?w==g?1:h*w:s[w],M=x*_;t.currentTime=m+v.delay+M,v.duration=M,this._validateStyleAst(y,t),y.offset=x,i.styles.push(y)}),i}visitReference(e,t){return{type:sn.Reference,animation:tl(this,yw(e.animation),t),options:dg(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:sn.AnimateChild,options:dg(e.options)}}visitAnimateRef(e,t){return{type:sn.AnimateRef,animation:this.visitReference(e.animation,t),options:dg(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[o,s]=function Vue(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(Bue,"")),n=n.replace(/@\*/g,kE).replace(/@\w+/g,t=>kE+"-"+t.slice(1)).replace(/:animating/g,h3),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+o:o,el(t.collectedStyles,t.currentQuerySelector,new Map);const a=tl(this,yw(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:sn.Query,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:a,originalSelector:e.selector,options:dg(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function rue(){return new ce(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:BE(e.timings,t.errors,!0);return{type:sn.Stagger,animation:tl(this,yw(e.animation),t),timings:i,options:null}}}class zue{errors;queryCount=0;depCount=0;currentTransition=null;currentQuery=null;currentQuerySelector=null;currentAnimateTimings=null;currentTime=0;collectedStyles=new Map;options=null;unsupportedCSSPropertiesFound=new Set;constructor(e){this.errors=e}}function dg(n){return n?(n={...n}).params&&(n.params=function Hue(n){return n?{...n}:null}(n.params)):n={},n}function M3(n,e,t){return{duration:n,delay:e,easing:t}}function C3(n,e,t,i,r,o,s=null,a=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:o,totalTime:r+o,easing:s,subTimeline:a}}class zE{_map=new Map;get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const que=new RegExp(":enter","g"),Yue=new RegExp(":leave","g");function S3(n,e,t,i,r,o=new Map,s=new Map,a,l,u=[]){return(new Zue).buildKeyframes(n,e,t,i,r,o,s,a,l,u)}class Zue{buildKeyframes(e,t,i,r,o,s,a,l,u,c=[]){u=u||new zE;const f=new E3(e,t,u,r,o,c,[]);f.options=l;const h=l.delay?Sd(l.delay):0;f.currentTimeline.delayNextStep(h),f.currentTimeline.setStyles([s],null,f.errors,l),tl(this,i,f);const g=f.timelines.filter(m=>m.containsAnimation());if(g.length&&a.size){let m;for(let v=g.length-1;v>=0;v--){const _=g[v];if(_.element===t){m=_;break}}m&&!m.allowOnlyTimelineStyles()&&m.setStyles([a],null,f.errors,l)}return g.length?g.map(m=>m.buildKeyframes()):[C3(t,[],[],[],0,h,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),o=t.currentTimeline.currentTime,s=this._visitSubInstructions(i,r,r.options);o!=s&&t.transformIntoNewTimeline(s)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const o=r?.delay;if(o){const s="number"==typeof o?o:Sd(vw(o,r?.params??{},t.errors));i.delayNextStep(s)}}}_visitSubInstructions(e,t,i){let o=t.currentTimeline.currentTime;const s=null!=i.duration?Sd(i.duration):null,a=null!=i.delay?Sd(i.delay):null;return 0!==s&&e.forEach(l=>{const u=t.appendInstructionToTimeline(l,s,a);o=Math.max(o,u.duration+u.delay)}),o}visitReference(e,t){t.updateOptions(e.options,!0),tl(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const o=e.options;if(o&&(o.params||o.delay)&&(r=t.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){r.previousNode.type==sn.Style&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=GE);const s=Sd(o.delay);r.delayNextStep(s)}e.steps.length&&(e.steps.forEach(s=>tl(this,s,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const o=e.options&&e.options.delay?Sd(e.options.delay):0;e.steps.forEach(s=>{const a=t.createSubContext(e.options);o&&a.delayNextStep(o),tl(this,s,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(s=>t.currentTimeline.mergeTimelineCollectedStyles(s)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return BE(t.params?vw(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const o=e.style;o.type==sn.Keyframes?this.visitKeyframes(o,t):(t.incrementTime(i.duration),this.visitStyle(o,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const o=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(o):i.setStyles(e.styles,o,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,o=i.duration,a=t.createSubContext().currentTimeline;a.easing=i.easing,e.styles.forEach(l=>{a.forwardTime((l.offset||0)*o),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+o),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},o=r.delay?Sd(r.delay):0;o&&(t.previousNode.type===sn.Style||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=GE);let s=i;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((u,c)=>{t.currentQueryIndex=c;const f=t.createSubContext(e.options,u);o&&f.delayNextStep(o),u===t.element&&(l=f.currentTimeline),tl(this,e.animation,f),f.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,f.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(s),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,o=e.timings,s=Math.abs(o.duration),a=s*(t.currentQueryTotal-1);let l=s*t.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const c=t.currentTimeline;l&&c.delayNextStep(l);const f=c.currentTime;tl(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-f+(r.startTime-i.currentTimeline.startTime)}}const GE={};class E3{_driver;element;subInstructions;_enterClassName;_leaveClassName;errors;timelines;parentContext=null;currentTimeline;currentAnimateTimings=null;previousNode=GE;subContextCount=0;options={};currentQueryIndex=0;currentQueryTotal=0;currentStaggerTime=0;constructor(e,t,i,r,o,s,a,l){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=o,this.errors=s,this.timelines=a,this.currentTimeline=l||new jE(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=Sd(i.duration)),null!=i.delay&&(r.delay=Sd(i.delay));const o=i.params;if(o){let s=r.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!t||!s.hasOwnProperty(a))&&(s[a]=vw(o[a],s,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,o=new E3(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(e),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(e){return this.previousNode=GE,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},o=new Kue(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,o,s){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(que,"."+this._enterClassName)).replace(Yue,"."+this._leaveClassName);let u=this._driver.query(this.element,e,1!=i);0!==i&&(u=i<0?u.slice(u.length+i,u.length):u.slice(0,i)),a.push(...u)}return!o&&0==a.length&&s.push(function oue(){return new ce(3014,!1)}()),a}}class jE{_driver;element;startTime;_elementTimelineStylesLookup;duration=0;easing=null;_previousKeyframe=new Map;_currentKeyframe=new Map;_keyframes=new Map;_styleSummary=new Map;_localTimelineStyles=new Map;_globalTimelineStyles;_pendingStyles=new Map;_backFill=new Map;_currentEmptyStepKeyframe=null;constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new jE(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||Cd),this._currentKeyframe.set(t,Cd);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const o=r&&r.params||{},s=function Jue(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i??=e.keys();for(let o of i)t.set(o,Cd)}else for(let[o,s]of r)t.set(o,s)}),t}(e,this._globalTimelineStyles);for(let[a,l]of s){const u=vw(l,o,i);this._pendingStyles.set(a,u),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??Cd),this._updateStyle(a,u)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const u=new Map([...this._backFill,...a]);u.forEach((c,f)=>{"!"===c?e.add(f):c===Cd&&t.add(f)}),i||u.set("offset",l/this.duration),r.push(u)});const o=[...e.values()],s=[...t.values()];if(i){const a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return C3(this.element,r,o,s,this.duration,this.startTime,this.easing,!1)}}class Kue extends jE{keyframes;preStyleProps;postStyleProps;_stretchStartingKeyframe;timings;constructor(e,t,i,r,o,s,a=!1){super(e,t,s.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const o=[],s=i+t,a=t/s,l=new Map(e[0]);l.set("offset",0),o.push(l);const u=new Map(e[0]);u.set("offset",tG(a)),o.push(u);const c=e.length-1;for(let f=1;f<=c;f++){let h=new Map(e[f]);const g=h.get("offset");h.set("offset",tG((t+g*i)/s)),o.push(h)}i=s,t=0,r="",e=o}return C3(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function tG(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}function nG(n,e,t,i,r,o,s,a,l,u,c,f,h){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:o,toState:i,toStyles:s,timelines:a,queriedElements:l,preStyleProps:u,postStyleProps:c,totalTime:f,errors:h}}const T3={};class iG{_triggerName;ast;_stateStyles;constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function Que(n,e,t,i,r){return n.some(o=>o(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,o,s,a,l,u,c){const f=[],h=this.ast.options&&this.ast.options.params||T3,m=this.buildStyles(i,a&&a.params||T3,f),v=l&&l.params||T3,_=this.buildStyles(r,v,f),y=new Set,w=new Map,x=new Map,M="void"===r,D={params:rG(v,h),delay:this.ast.options?.delay},E=c?[]:S3(e,t,this.ast.animation,o,s,m,_,D,u,f);let I=0;return E.forEach(R=>{I=Math.max(R.duration+R.delay,I)}),f.length?nG(t,this._triggerName,i,r,M,m,_,[],[],w,x,I,f):(E.forEach(R=>{const S=R.element,T=el(w,S,new Set);R.preStyleProps.forEach(Z=>T.add(Z));const z=el(x,S,new Set);R.postStyleProps.forEach(Z=>z.add(Z)),S!==t&&y.add(S)}),nG(t,this._triggerName,i,r,M,m,_,E,[...y.values()],w,x,I))}}function rG(n,e){const t={...e};return Object.entries(n).forEach(([i,r])=>{null!=r&&(t[i]=r)}),t}class ece{styles;defaultParams;normalizer;constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=rG(e,this.defaultParams);return this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((s,a)=>{s&&(s=vw(s,r,t));const l=this.normalizer.normalizePropertyName(a,t);s=this.normalizer.normalizeStyleValue(a,l,s,t),i.set(a,s)})}),i}}class nce{name;ast;_normalizer;transitionFactories=[];fallbackTransition;states=new Map;constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,t.states.forEach(r=>{this.states.set(r.name,new ece(r.style,r.options&&r.options.params||{},i))}),oG(this.states,"true","1"),oG(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new iG(e,r,this.states))}),this.fallbackTransition=function ice(n,e){return new iG(n,{type:sn.Transition,animation:{type:sn.Sequence,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(s=>s.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function oG(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const rce=new zE;class oce{bodyNode;_driver;_normalizer;_animations=new Map;_playersById=new Map;players=[];constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i}register(e,t){const i=[],o=x3(this._driver,t,i,[]);if(i.length)throw function cue(){return new ce(3503,!1)}();this._animations.set(e,o)}_buildPlayer(e,t,i){const r=e.element,o=z8(this._normalizer,e.keyframes,t,i);return this._driver.animate(r,o,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],o=this._animations.get(e);let s;const a=new Map;if(o?(s=S3(this._driver,t,o,X8,f3,new Map,new Map,i,rce,r),s.forEach(c=>{const f=el(a,c.element,new Map);c.postStyleProps.forEach(h=>f.set(h,null))})):(r.push(function due(){return new ce(3300,!1)}()),s=[]),r.length)throw function fue(){return new ce(3504,!1)}();a.forEach((c,f)=>{c.forEach((h,g)=>{c.set(g,this._driver.computeStyle(f,g,Cd))})});const u=ph(s.map(c=>{const f=a.get(c.element);return this._buildPlayer(c,new Map,f)}));return this._playersById.set(e,u),u.onDestroy(()=>this.destroy(e)),this.players.push(u),u}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function hue(){return new ce(3301,!1)}();return t}listen(e,t,i,r){const o=c3(t,"","","");return l3(this._getPlayer(e),i,o,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const o=this._getPlayer(e);switch(i){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const sG="ng-animate-queued",A3="ng-animate-disabled",cce=[],aG={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},dce={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Iu="__ng_removed";class D3{namespaceId;value;options;get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function gce(n){return n??null}(i?e.value:e),i){const{value:o,...s}=e;this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const bw="void",I3=new D3(bw);class fce{id;hostElement;_engine;players=[];_triggers=new Map;_queue=[];_elementListeners=new Map;_hostClassName;constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this._hostClassName="ng-tns-"+e,Ll(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function pue(){return new ce(3302,!1)}();if(null==i||0==i.length)throw function gue(){return new ce(3303,!1)}();if(!function mce(n){return"start"==n||"done"==n}(i))throw function mue(){return new ce(3400,!1)}();const o=el(this._elementListeners,e,[]),s={name:t,phase:i,callback:r};o.push(s);const a=el(this._engine.statesByElement,e,new Map);return a.has(t)||(Ll(e,LE),Ll(e,LE+"-"+t),a.set(t,I3)),()=>{this._engine.afterFlush(()=>{const l=o.indexOf(s);l>=0&&o.splice(l,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function _ue(){return new ce(3401,!1)}();return t}trigger(e,t,i,r=!0){const o=this._getTrigger(t),s=new R3(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(Ll(e,LE),Ll(e,LE+"-"+t),this._engine.statesByElement.set(e,a=new Map));let l=a.get(t);const u=new D3(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&u.absorbOptions(l.options),a.set(t,u),l||(l=I3),u.value!==bw&&l.value===u.value){if(!function vce(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const o=t[r];if(!e.hasOwnProperty(o)||n[o]!==e[o])return!1}return!0}(l.params,u.params)){const v=[],_=o.matchStyles(l.value,l.params,v),y=o.matchStyles(u.value,u.params,v);v.length?this._engine.reportError(v):this._engine.afterFlush(()=>{cg(e,_),Ec(e,y)})}return}const h=el(this._engine.playersByElement,e,[]);h.forEach(v=>{v.namespaceId==this.id&&v.triggerName==t&&v.queued&&v.destroy()});let g=o.matchTransition(l.value,u.value,e,u.params),m=!1;if(!g){if(!r)return;g=o.fallbackTransition,m=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:g,fromState:l,toState:u,player:s,isFallbackTransition:m}),m||(Ll(e,sG),s.onStart(()=>{__(e,sG)})),s.onDone(()=>{let v=this.players.indexOf(s);v>=0&&this.players.splice(v,1);const _=this._engine.playersByElement.get(e);if(_){let y=_.indexOf(s);y>=0&&_.splice(y,1)}}),this.players.push(s),h.push(s),s}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,kE,!0);i.forEach(r=>{if(r[Iu])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(s=>s.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const o=this._engine.statesByElement.get(e),s=new Map;if(o){const a=[];if(o.forEach((l,u)=>{if(s.set(u,l.value),this._triggers.has(u)){const c=this.trigger(e,u,bw,r);c&&a.push(c)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,s),i&&ph(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(o=>{const s=o.name;if(r.has(s))return;r.add(s);const l=this._triggers.get(s).fallbackTransition,u=i.get(s)||I3,c=new D3(bw),f=new R3(this.id,s,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:s,transition:l,fromState:u,toState:c,player:f,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const o=i.players.length?i.playersByQueriedElement.get(e):[];if(o&&o.length)r=!0;else{let s=e;for(;s=s.parentNode;)if(i.statesByElement.get(s)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const o=e[Iu];(!o||o===aG)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){Ll(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const o=i.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==i.triggerName){const l=c3(o,i.triggerName,i.fromState.value,i.toState.value);l._data=e,l3(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const o=i.transition.ast.depCount,s=r.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class hce{bodyNode;driver;_normalizer;players=[];newHostElements=new Map;playersByElement=new Map;playersByQueriedElement=new Map;statesByElement=new Map;disabledNodes=new Set;totalAnimations=0;totalQueuedPlayers=0;_namespaceLookup={};_namespaceList=[];_flushFns=[];_whenQuietFns=[];namespacesByHostElement=new Map;collectedEnterElements=[];collectedLeaveElements=[];onRemovalComplete=(e,t)=>{};_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new fce(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let s=!1,a=this.driver.getParentElement(t);for(;a;){const l=r.get(a);if(l){const u=i.indexOf(l);i.splice(u+1,0,e),s=!0;break}a=this.driver.getParentElement(a)}s||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(e);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const o=this._fetchNamespace(r.namespaceId);o&&t.add(o)}return t}trigger(e,t,i,r){if(WE(t)){const o=this._fetchNamespace(e);if(o)return o.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!WE(t))return;const o=t[Iu];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(t);s>=0&&this.collectedLeaveElements.splice(s,1)}if(e){const s=this._fetchNamespace(e);s&&s.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Ll(e,A3)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),__(e,A3))}removeNode(e,t,i){if(WE(t)){const r=e?this._fetchNamespace(e):null;r?r.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i);const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(e,t,i,r,o){this.collectedLeaveElements.push(t),t[Iu]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:o}}listen(e,t,i,r,o){return WE(t)?this._fetchNamespace(e).listen(t,i,r,o):()=>{}}_buildInstruction(e,t,i,r,o){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,o)}destroyInnerAnimations(e){let t=this.driver.query(e,kE,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,h3,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return ph(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[Iu];if(t&&t.setForRemoval){if(e[Iu]=aG,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(A3)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Ll(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?ph(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function yue(){return new ce(3402,!1)}()}_flushAnimations(e,t){const i=new zE,r=[],o=new Map,s=[],a=new Map,l=new Map,u=new Map,c=new Set;this.disabledNodes.forEach(W=>{c.add(W);const ie=this.driver.query(W,".ng-animate-queued",!0);for(let Y=0;Y<ie.length;Y++)c.add(ie[Y])});const f=this.bodyNode,h=Array.from(this.statesByElement.keys()),g=cG(h,this.collectedEnterElements),m=new Map;let v=0;g.forEach((W,ie)=>{const Y=X8+v++;m.set(ie,Y),W.forEach(ge=>Ll(ge,Y))});const _=[],y=new Set,w=new Set;for(let W=0;W<this.collectedLeaveElements.length;W++){const ie=this.collectedLeaveElements[W],Y=ie[Iu];Y&&Y.setForRemoval&&(_.push(ie),y.add(ie),Y.hasAnimation?this.driver.query(ie,".ng-star-inserted",!0).forEach(ge=>y.add(ge)):w.add(ie))}const x=new Map,M=cG(h,Array.from(y));M.forEach((W,ie)=>{const Y=f3+v++;x.set(ie,Y),W.forEach(ge=>Ll(ge,Y))}),e.push(()=>{g.forEach((W,ie)=>{const Y=m.get(ie);W.forEach(ge=>__(ge,Y))}),M.forEach((W,ie)=>{const Y=x.get(ie);W.forEach(ge=>__(ge,Y))}),_.forEach(W=>{this.processLeaveNode(W)})});const D=[],E=[];for(let W=this._namespaceList.length-1;W>=0;W--)this._namespaceList[W].drainQueuedTransitions(t).forEach(Y=>{const ge=Y.player,Le=Y.element;if(D.push(ge),this.collectedEnterElements.length){const Ne=Le[Iu];if(Ne&&Ne.setForMove){if(Ne.previousTriggersValues&&Ne.previousTriggersValues.has(Y.triggerName)){const ct=Ne.previousTriggersValues.get(Y.triggerName),At=this.statesByElement.get(Y.element);if(At&&At.has(Y.triggerName)){const ft=At.get(Y.triggerName);ft.value=ct,At.set(Y.triggerName,ft)}}return void ge.destroy()}}const We=!f||!this.driver.containsElement(f,Le),vt=x.get(Le),wt=m.get(Le),ue=this._buildInstruction(Y,i,wt,vt,We);if(ue.errors&&ue.errors.length)return void E.push(ue);if(We)return ge.onStart(()=>cg(Le,ue.fromStyles)),ge.onDestroy(()=>Ec(Le,ue.toStyles)),void r.push(ge);if(Y.isFallbackTransition)return ge.onStart(()=>cg(Le,ue.fromStyles)),ge.onDestroy(()=>Ec(Le,ue.toStyles)),void r.push(ge);const Ce=[];ue.timelines.forEach(Ne=>{Ne.stretchStartingKeyframe=!0,this.disabledNodes.has(Ne.element)||Ce.push(Ne)}),ue.timelines=Ce,i.append(Le,ue.timelines),s.push({instruction:ue,player:ge,element:Le}),ue.queriedElements.forEach(Ne=>el(a,Ne,[]).push(ge)),ue.preStyleProps.forEach((Ne,ct)=>{if(Ne.size){let At=l.get(ct);At||l.set(ct,At=new Set),Ne.forEach((ft,Xn)=>At.add(Xn))}}),ue.postStyleProps.forEach((Ne,ct)=>{let At=u.get(ct);At||u.set(ct,At=new Set),Ne.forEach((ft,Xn)=>At.add(Xn))})});if(E.length){const W=[];E.forEach(ie=>{W.push(function vue(){return new ce(3505,!1)}())}),D.forEach(ie=>ie.destroy()),this.reportError(W)}const I=new Map,R=new Map;s.forEach(W=>{const ie=W.element;i.has(ie)&&(R.set(ie,ie),this._beforeAnimationBuild(W.player.namespaceId,W.instruction,I))}),r.forEach(W=>{const ie=W.element;this._getPreviousPlayers(ie,!1,W.namespaceId,W.triggerName,null).forEach(ge=>{el(I,ie,[]).push(ge),ge.destroy()})});const S=_.filter(W=>fG(W,l,u)),T=new Map;uG(T,this.driver,w,u,Cd).forEach(W=>{fG(W,l,u)&&S.push(W)});const Z=new Map;g.forEach((W,ie)=>{uG(Z,this.driver,new Set(W),l,"!")}),S.forEach(W=>{const ie=T.get(W),Y=Z.get(W);T.set(W,new Map([...ie?.entries()??[],...Y?.entries()??[]]))});const J=[],le=[],fe={};s.forEach(W=>{const{element:ie,player:Y,instruction:ge}=W;if(i.has(ie)){if(c.has(ie))return Y.onDestroy(()=>Ec(ie,ge.toStyles)),Y.disabled=!0,Y.overrideTotalTime(ge.totalTime),void r.push(Y);let Le=fe;if(R.size>1){let vt=ie;const wt=[];for(;vt=vt.parentNode;){const ue=R.get(vt);if(ue){Le=ue;break}wt.push(vt)}wt.forEach(ue=>R.set(ue,Le))}const We=this._buildAnimation(Y.namespaceId,ge,I,o,Z,T);if(Y.setRealPlayer(We),Le===fe)J.push(Y);else{const vt=this.playersByElement.get(Le);vt&&vt.length&&(Y.parentPlayer=ph(vt)),r.push(Y)}}else cg(ie,ge.fromStyles),Y.onDestroy(()=>Ec(ie,ge.toStyles)),le.push(Y),c.has(ie)&&r.push(Y)}),le.forEach(W=>{const ie=o.get(W.element);if(ie&&ie.length){const Y=ph(ie);W.setRealPlayer(Y)}}),r.forEach(W=>{W.parentPlayer?W.syncPlayerEvents(W.parentPlayer):W.destroy()});for(let W=0;W<_.length;W++){const ie=_[W],Y=ie[Iu];if(__(ie,f3),Y&&Y.hasAnimation)continue;let ge=[];if(a.size){let We=a.get(ie);We&&We.length&&ge.push(...We);let vt=this.driver.query(ie,h3,!0);for(let wt=0;wt<vt.length;wt++){let ue=a.get(vt[wt]);ue&&ue.length&&ge.push(...ue)}}const Le=ge.filter(We=>!We.destroyed);Le.length?_ce(this,ie,Le):this.processLeaveNode(ie)}return _.length=0,J.forEach(W=>{this.players.push(W),W.onDone(()=>{W.destroy();const ie=this.players.indexOf(W);this.players.splice(ie,1)}),W.play()}),J}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,o){let s=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(s=a)}else{const a=this.playersByElement.get(e);if(a){const l=!o||o==bw;a.forEach(u=>{u.queued||!l&&u.triggerName!=r||s.push(u)})}}return(i||r)&&(s=s.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),s}_beforeAnimationBuild(e,t,i){const o=t.element,s=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const l of t.timelines){const u=l.element,c=u!==o,f=el(i,u,[]);this._getPreviousPlayers(u,c,s,a,t.toState).forEach(g=>{const m=g.getRealPlayer();m.beforeDestroy&&m.beforeDestroy(),g.destroy(),f.push(g)})}cg(o,t.fromStyles)}_buildAnimation(e,t,i,r,o,s){const a=t.triggerName,l=t.element,u=[],c=new Set,f=new Set,h=t.timelines.map(m=>{const v=m.element;c.add(v);const _=v[Iu];if(_&&_.removedBeforeQueried)return new _w(m.duration,m.delay);const y=v!==l,w=function yce(n){const e=[];return dG(n,e),e}((i.get(v)||cce).map(I=>I.getRealPlayer())).filter(I=>!!I.element&&I.element===v),x=o.get(v),M=s.get(v),D=z8(this._normalizer,m.keyframes,x,M),E=this._buildPlayer(m,D,w);if(m.subTimeline&&r&&f.add(v),y){const I=new R3(e,a,v);I.setRealPlayer(E),u.push(I)}return E});u.forEach(m=>{el(this.playersByQueriedElement,m.element,[]).push(m),m.onDone(()=>function pce(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,m.element,m))}),c.forEach(m=>Ll(m,Y8));const g=ph(h);return g.onDestroy(()=>{c.forEach(m=>__(m,Y8)),Ec(l,t.toStyles)}),f.forEach(m=>{el(r,m,[]).push(g)}),g}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new _w(e.duration,e.delay)}}class R3{namespaceId;triggerName;element;_player=new _w;_containsRealPlayer=!1;_queuedCallbacks=new Map;destroyed=!1;parentPlayer=null;markedForDestroy=!1;disabled=!1;queued=!0;totalTime=0;constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>l3(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){el(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function WE(n){return n&&1===n.nodeType}function lG(n,e){const t=n.style.display;return n.style.display=e??"none",t}function uG(n,e,t,i,r){const o=[];t.forEach(l=>o.push(lG(l)));const s=[];i.forEach((l,u)=>{const c=new Map;l.forEach(f=>{const h=e.computeStyle(u,f,r);c.set(f,h),(!h||0==h.length)&&(u[Iu]=dce,s.push(u))}),n.set(u,c)});let a=0;return t.forEach(l=>lG(l,o[a++])),s}function cG(n,e){const t=new Map;if(n.forEach(a=>t.set(a,[])),0==e.length)return t;const r=new Set(e),o=new Map;function s(a){if(!a)return 1;let l=o.get(a);if(l)return l;const u=a.parentNode;return l=t.has(u)?u:r.has(u)?1:s(u),o.set(a,l),l}return e.forEach(a=>{const l=s(a);1!==l&&t.get(l).push(a)}),t}function Ll(n,e){n.classList?.add(e)}function __(n,e){n.classList?.remove(e)}function _ce(n,e,t){ph(t).onDone(()=>n.processLeaveNode(e))}function dG(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof V8?dG(i.players,e):e.push(i)}}function fG(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(o=>r.add(o)):e.set(n,i),t.delete(n),!0}class y_{_driver;_normalizer;_transitionEngine;_timelineEngine;_triggerCache={};onRemovalComplete=(e,t)=>{};constructor(e,t,i){this._driver=t,this._normalizer=i,this._transitionEngine=new hce(e.body,t,i),this._timelineEngine=new oce(e.body,t,i),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(e,t,i,r,o){const s=e+"-"+r;let a=this._triggerCache[s];if(!a){const l=[],c=x3(this._driver,o,l,[]);if(l.length)throw function lue(){return new ce(3404,!1)}();a=function tce(n,e,t){return new nce(n,e,t)}(r,c,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i){this._transitionEngine.removeNode(e,t,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[o,s]=G8(i);this._timelineEngine.command(o,t,s,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,o){if("@"==i.charAt(0)){const[s,a]=G8(i);return this._timelineEngine.listen(s,t,a,o)}return this._transitionEngine.listen(e,t,i,r,o)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let wce=(()=>{class n{_element;_startStyles;_endStyles;static initialStylesByElement=new WeakMap;_state=0;_initialStyles;constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r;let o=n.initialStylesByElement.get(t);o||n.initialStylesByElement.set(t,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Ec(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Ec(this._element,this._initialStyles),this._endStyles&&(Ec(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(cg(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(cg(this._element,this._endStyles),this._endStyles=null),Ec(this._element,this._initialStyles),this._state=3)}}return n})();function P3(n){let e=null;return n.forEach((t,i)=>{(function xce(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class hG{element;keyframes;options;_specialStyles;_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_duration;_delay;_initialized=!1;_finished=!1;_started=!1;_destroyed=!1;_finalKeyframe;_originalOnDoneFns=[];_originalOnStartFns=[];domPlayer;time=0;parentPlayer=null;currentSnapshot=new Map;constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;const t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:_3(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class pG{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}containsElement(e,t){return W8(e,t)}getParentElement(e){return d3(e)}query(e,t,i){return $8(e,t,i)}computeStyle(e,t,i){return _3(e,t)}animate(e,t,i,r,o,s=[]){const l={duration:i,delay:r,fill:0==r?"both":"forwards"};o&&(l.easing=o);const u=new Map,c=s.filter(g=>g instanceof hG);(function Rue(n,e){return 0===n||0===e})(i,r)&&c.forEach(g=>{g.currentSnapshot.forEach((m,v)=>u.set(v,m))});let f=function Aue(n){return n.length?n[0]instanceof Map?n:n.map(e=>new Map(Object.entries(e))):[]}(t).map(g=>new Map(g));f=function Pue(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((o,s)=>{i.has(s)||r.push(s),i.set(s,o)}),r.length)for(let o=1;o<e.length;o++){let s=e[o];r.forEach(a=>s.set(a,_3(n,a)))}}return e}(e,f,u);const h=function bce(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=P3(e[0]),e.length>1&&(i=P3(e[e.length-1]))):e instanceof Map&&(t=P3(e)),t||i?new wce(n,t,i):null}(e,f);return new hG(e,f,l,h)}}const gG="@.disabled";class mG{namespaceId;delegate;engine;_onDestroy;\u0275type=0;constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.parentNode(t)&&this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==gG?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i,r){return this.delegate.listen(e,t,i,r)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Mce extends mG{factory;constructor(e,t,i,r,o){super(t,i,r,o),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==gG?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i,r){if("@"==t.charAt(0)){const o=function Cce(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),a="";return"@"!=s.charAt(0)&&([s,a]=function Sce(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,o,s,a,l=>{this.factory.scheduleListenerCallback(l._data||-1,i,l)})}return this.delegate.listen(e,t,i,r)}}class Ece{delegate;engine;_zone;_currentId=0;_microtaskId=1;_animationCallbacksBuffer=[];_rendererCache=new Map;_cdRecurDepth=0;constructor(e,t,i){this.delegate=e,this.engine=t,this._zone=i,t.onRemovalComplete=(r,o)=>{o?.removeChild(null,r)}}createRenderer(e,t){const r=this.delegate.createRenderer(e,t);if(!e||!t?.data?.animation){const u=this._rendererCache;let c=u.get(r);return c||(c=new mG("",r,this.engine,()=>u.delete(r)),u.set(r,c)),c}const o=t.id,s=t.id+"-"+this._currentId;this._currentId++,this.engine.register(s,e);const a=u=>{Array.isArray(u)?u.forEach(a):this.engine.registerTrigger(o,s,e,u.name,u)};return t.data.animation.forEach(a),new Mce(this,s,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,i){if(e>=0&&e<this._microtaskId)return void this._zone.run(()=>t(i));const r=this._animationCallbacksBuffer;0==r.length&&queueMicrotask(()=>{this._zone.run(()=>{r.forEach(o=>{const[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),r.push([t,i])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}componentReplaced(e){this.engine.flush(),this.delegate.componentReplaced?.(e)}}function O3(n,e){const t=!e?.manualCleanup;t&&!e?.injector&&iu();const i=t?e?.injector?.get(Hs)??j(Hs):null,r=function Ace(n=Object.is){return(e,t)=>1===e.kind&&1===t.kind&&n(e.value,t.value)}(e?.equal);let o;o=fs(e?.requireSync?{kind:0}:{kind:1,value:e?.initialValue},{equal:r});const s=n.subscribe({next:a=>o.set({kind:1,value:a}),error:a=>{if(e?.rejectErrors)throw a;o.set({kind:2,error:a})}});if(e?.requireSync&&0===o().kind)throw new ce(601,!1);return i?.onDestroy(s.unsubscribe.bind(s)),xu(()=>{const a=o();switch(a.kind){case 1:return a.value;case 2:throw a.error;case 0:throw new ce(601,!1)}},{equal:e?.equal})}const yG=/^((?!chrome|android).)*safari/i,Rce=/ipad|iphone|ipod/i;function N3({userAgent:n,maxTouchPoints:e}){return Rce.test(n)||yG.test(n)&&e>1}const Pce=new be("",{factory:()=>N3(j(hw))}),Oce=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series([46])0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/,Nce=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br([ev])w|bumb|bw-([nu])|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do([cp])o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly([-_])|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-([mpt])|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c([- _agpst])|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac([ \-/])|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja([tv])a|jbro|jemu|jigs|kddi|keji|kgt([ /])|klon|kpt |kwc-|kyo([ck])|le(no|xi)|lg( g|\/([klu])|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t([- ov])|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30([02])|n50([025])|n7(0([01])|10)|ne(([cm])-|on|tf|wf|wg|wt)|nok([6i])|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan([adt])|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c([-01])|47|mc|nd|ri)|sgh-|shar|sie([-m])|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel([im])|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c([- ])|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/,Fce=new be("",{factory:()=>Oce.test(j(OE).toLowerCase())||Nce.test(j(OE).slice(0,4).toLowerCase())});new be("",{factory:()=>j(Fce)&&!j(Pce)}),new be("",{factory:()=>{const n=j(Zs).matchMedia("(pointer: coarse)");return O3(ag(n,"change").pipe(Nt(()=>n.matches)),{initialValue:n.matches})}}),new be("",{factory:()=>!!j(Zs)?.webkitConvertPointFromNodeToPage});const kce=on(()=>{const n={onRemovalComplete:()=>{}},e=new Lr(null),t=j(y_,{optional:!0})||n,{onRemovalComplete:i=n.onRemovalComplete}=t;return t.onRemovalComplete=(r,o)=>{e.next(r),i.call(t,r,o)},e.pipe(xs(r=>mw(0).pipe(Nt(()=>null),qb(r))),m_())});function vG(n,e=null){return o3(n).activeElement!==n&&!n.matches(":disabled")&&!e?.contains(n)&&function B8(n){return!n.hasAttribute("disabled")&&("-1"===n.getAttribute("tabIndex")||function k8(n){if(n.hasAttribute("disabled")||"-1"===n.getAttribute("tabIndex"))return!1;if(function C8(n){const e=n?.ownerDocument.defaultView;return!!n&&!!e&&n instanceof e.HTMLElement}(n)&&n.isContentEditable||"0"===n.getAttribute("tabIndex"))return!0;switch(n.tagName){case"A":case"LINK":return n.hasAttribute("href");case"AUDIO":case"VIDEO":return n.hasAttribute("controls");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;case"INPUT":return"hidden"!==n.getAttribute("type");default:return!1}}(n))}(n)}on(()=>{const n=j(kce),e=j(Zs),t=j(fr),i=j(Hn),r=li(e,"focusout",{capture:!0}),o=li(e,"focusin",{capture:!0}),s=li(e,"blur"),a=li(e,"mousedown"),l=li(e,"mouseup");return Md(r.pipe(l_(a),T8({delay:()=>l}),function Hle(...n){const e=Z4(n);return or((t,i)=>{const r=n.length,o=new Array(r);let s=n.map(()=>!1),a=!1;for(let l=0;l<r;l++)Zo(n[l]).subscribe(Mi(i,u=>{o[l]=u,!a&&!s[l]&&(s[l]=!0,(a=s.every(da))&&(s=null))},yl));t.subscribe(Mi(i,l=>{if(a){const u=[l,...o];i.next(e?e(...u):u)}}))})}(n),Ms(([u,c])=>vG(r3(u),c)),Nt(([{relatedTarget:u}])=>u)),s.pipe(Nt(()=>t.activeElement),Ms(u=>!!u?.matches("iframe"))),o.pipe(xs(u=>{const c=r3(u),f=o3(c)||t;return f===t?$t(c):function Bce(n){return Md(li(n,"focusin").pipe(Nt(({target:e})=>e)),li(n,"focusout").pipe(Ms(({target:e,relatedTarget:t})=>!!t&&vG(e)),Nt(({relatedTarget:e})=>e)))}(f).pipe(qb(c))})),a.pipe(xs(u=>{const c=r3(u);return t.activeElement&&t.activeElement!==t.body?r.pipe(Yp(1),Nt(()=>c),l_(mw(0,x8(i)))):$t(c)}))).pipe(u8(),m_())}),on(()=>j(fr).querySelector("base")?.href??"");const Uce=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series([46])0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/,Vce=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br([ev])w|bumb|bw-([nu])|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do([cp])o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly([-_])|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-([mpt])|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c([- _agpst])|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac([ \-/])|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja([tv])a|jbro|jemu|jigs|kddi|keji|kgt([ /])|klon|kpt |kwc-|kyo([ck])|le(no|xi)|lg( g|\/([klu])|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t([- ov])|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30([02])|n50([025])|n7(0([01])|10)|ne(([cm])-|on|tf|wf|wg|wt)|nok([6i])|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan([adt])|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c([-01])|47|mc|nd|ri)|sgh-|shar|sie([-m])|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel([im])|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c([- ])|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/,bG=on(()=>Uce.test(j(OE).toLowerCase())||Vce.test(j(OE).slice(0,4).toLowerCase())),wG=on(()=>N3(j(hw))),Hce=on(()=>j(bG)&&!j(wG)),zce=(on(()=>!!j(Zs)?.webkitConvertPointFromNodeToPage),on(()=>j(wG)?"ios":j(Hce)?"android":"web"),on(()=>{const n=j(Zs).matchMedia("(pointer: coarse)");return O3(ag(n,"change").pipe(Nt(()=>n.matches)),{initialValue:n.matches})}),on(()=>!!j(Zs).Cypress)),Gce=on(t3);function xG(n,e,t){return Math.min(t,Math.max(e,n))}function gh(n,e,t){return n>=e&&n<t}function F3(n,e,t){return Number.isNaN(n)||n<=e?e:n>=t?t:Math.round(n)}on(()=>j(zce)||j(Gce)),Fi(null),on(()=>zH(j(Vf))?new Range:{}),on(()=>{const n=j(Zs);return li(n,"resize").pipe(qb(null),Nt(()=>{const e=Math.max(n.document.documentElement.clientWidth||0,n.innerWidth||0,n.visualViewport?.width||0),t=Math.max(n.document.documentElement.clientHeight||0,n.innerHeight||0,n.visualViewport?.height||0),i={width:e,height:t,top:0,left:0,right:e,bottom:t,x:0,y:0};return{...i,toJSON:()=>JSON.stringify(i)}}),QP({bufferSize:1,refCount:!0}))});const[VRe,tde]=function Qce(n){const e=Fi(n);return[e,t=>function Nle(n,e,t){return{provide:n,useFactory:()=>({...j(n,{optional:!0,skipSelf:!0})||t,...j(e,{optional:!0})||e})}}(e,t,n)]}({appearance:"primary",size:"l"});function nde(n,e){1&n&&oh(0)}function ide(n,e){if(1&n){const t=rn();L(0,"fieldset",5),Oe("waIntersectionObservee",function(r){const o=qe(t).index,s=me();return He(r[0]&&s.onIntersection(r[0],o))}),oh(1,6),k()}if(2&n){const t=e.$implicit,i=e.index,r=me();_u(r.getStyle(r.itemsCount)),ee("disabled",r.isDisabled(i)),q(),ee("ngTemplateOutlet",t)}}let YE=(()=>{class n extends Kn{constructor(){super(t=>this.output$.subscribe(t)),this.el=lg(),this.platform=j(Vf),this.visible$=j(sle),this.duration$=new Lr(0),this.running$=Md(li(this.el,"mouseenter").pipe(Nt(t3)),li(this.el,"touchstart").pipe(Nt(t3)),li(this.el,"touchend").pipe(Nt(_8)),li(this.el,"mouseleave").pipe(Nt(_8)),this.visible$),this.output$=F4(this.platform)?ws:J4([this.duration$,this.running$]).pipe(function yle(n,e=Boolean){return jc(xs(t=>e(t)?n(t):ws))}(([t])=>function Zce(n=0,e=gw){return n<0&&(n=0),mw(n,n,e)}(t),t=>t.every(Boolean)))}set duration(t){this.duration$.next(Number.isNaN(t)?this.duration$.value:t)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=_t({type:n,inputs:{duration:"duration"},features:[In]})}}return n})(),MG=(()=>{class n{constructor(){this.tuiCarouselAutoscroll=j(YE)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=_t({type:n,selectors:[["","tuiCarouselAutoscroll",""]],outputs:{tuiCarouselAutoscroll:"tuiCarouselAutoscroll"}})}}return n})(),CG=(()=>{class n{constructor(){this.el=lg(),this.tuiCarouselScroll=li(this.el,"wheel").pipe(Ms(({deltaX:t})=>Math.abs(t)>20),function Jce(n,e=gw,t){const i=mw(n,e);return function Kce(n,e){return or((t,i)=>{const{leading:r=!0,trailing:o=!1}=e??{};let s=!1,a=null,l=null,u=!1;const c=()=>{l?.unsubscribe(),l=null,o&&(g(),u&&i.complete())},f=()=>{l=null,u&&i.complete()},h=m=>l=Zo(n(m)).subscribe(Mi(i,c,f)),g=()=>{if(s){s=!1;const m=a;a=null,i.next(m),!u&&h(m)}};t.subscribe(Mi(i,m=>{s=!0,a=m,(!l||l.closed)&&(r?g():h(m))},()=>{u=!0,(!(o&&s&&l)||l.closed)&&i.complete()}))})}(()=>i,t)}(500,x8()),Nt(({deltaX:t})=>Math.sign(t)),No(()=>{this.el.scrollLeft=10}))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=_t({type:n,selectors:[["","tuiCarouselScroll",""]],outputs:{tuiCarouselScroll:"tuiCarouselScroll"}})}}return n})(),SG=(()=>{class n{constructor(){this.el=lg(),this.cdr=j(wu),this.isMobile=j(bG),this.directive=j(YE),this.translate=0,this.items=dle,this.transitioned=!0,this.index=0,this.draggable=!1,this.itemsCount=1,this.indexChange=new Oi,this.shift=new Oi}set indexSetter(t){this.index=t,this.directive.duration=NaN}next(){this.items&&this.index===this.items.length-this.itemsCount||this.updateIndex(this.index+1)}prev(){this.updateIndex(this.index-1)}get transform(){return`translateX(${100*this.x}%)`}getStyle(t){const i=100/t+"%";return{flexBasis:i,minWidth:i,maxWidth:i}}onTransitioned(t){this.transitioned=t,t||(this.translate=this.computedTranslate),this.onShift()}isDisabled(t){return t<this.index||t>=this.index+this.itemsCount}onIntersection({intersectionRatio:t},i){t&&t>=.5&&!this.transitioned&&this.updateIndex(this.index<i?i-this.itemsCount+1:i)}onScroll(t){this.isMobile||(t>0?this.next():this.prev())}onPan(t){this.computedDraggable&&(this.translate=xG(t/this.el.clientWidth+this.translate,1-this.items.length/this.itemsCount,0),this.onShift())}onSwipe(t){"left"===t?this.next():"right"===t&&this.prev()}onAutoscroll(){this.updateIndex(this.index===this.items.length-1?0:this.index+1)}onShift(){this.shift.emit(2*Math.abs(this.x%1+.5))}get x(){return this.transitioned?this.computedTranslate:this.translate}get computedTranslate(){return-this.index/this.itemsCount}get computedDraggable(){return this.isMobile||this.draggable}updateIndex(t){this.index=xG(t,0,this.items.length-1),this.indexChange.emit(this.index),this.cdr.markForCheck()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=mo({type:n,selectors:[["tui-carousel"]],contentQueries:function(i,r,o){if(1&i&&d4(o,ZP,4,Ws),2&i){let s;Po(s=Oo())&&(r.items=s)}},hostVars:4,hostBindings:function(i,r){1&i&&Oe("touchstart",function(){return r.onTransitioned(!1)})("touchend",function(){return r.onTransitioned(!0)})("mousedown",function(){return r.onTransitioned(!1)})("mouseup.zoneless",function(){return r.onTransitioned(!0)},!1,ba),2&i&&dr("_transitioned",r.transitioned)("_draggable",r.draggable)},inputs:{draggable:"draggable",itemsCount:"itemsCount",indexSetter:[0,"index","indexSetter"]},outputs:{indexChange:"indexChange",shift:"shift"},features:[Cn([{provide:F8,useValue:{timeout:200,threshold:30}}]),bB([{directive:YE,inputs:["duration","duration"]}])],decls:6,vars:6,consts:[[4,"ngIf"],[1,"t-scroller",3,"tuiCarouselScroll"],["waIntersectionObserver","","waIntersectionThreshold","0.5",1,"t-wrapper"],[1,"t-items",3,"tuiCarouselAutoscroll","tuiPan","tuiSwipe"],["class","t-item",3,"disabled","style","waIntersectionObservee",4,"ngFor","ngForOf"],[1,"t-item",3,"waIntersectionObservee","disabled"],[3,"ngTemplateOutlet"]],template:function(i,r){1&i&&(ze(0,nde,1,0,"ng-container",0),r_(1,"async"),L(2,"div",1),Oe("tuiCarouselScroll",function(s){return r.onScroll(s)}),L(3,"div",2)(4,"div",3),Oe("tuiCarouselAutoscroll",function(){return r.onAutoscroll()})("tuiPan",function(s){return r.onPan(s[0])})("tuiSwipe",function(s){return r.onSwipe(s.direction)}),ze(5,ide,2,4,"fieldset",4),k()()()),2&i&&(ee("ngIf",o_(1,4,r.items.changes)),q(4),oo("transform",r.transform),q(),ee("ngForOf",r.items))},dependencies:[s8,Au,Cs,g_,MG,CG,Ale,Ule,e3,g8],styles:['[_nghost-%COMP%]{position:relative;display:block;overflow:hidden}._draggable[_nghost-%COMP%]{-webkit-user-select:none;user-select:none}._draggable[_nghost-%COMP%]:hover{cursor:grab}._draggable[_nghost-%COMP%]:active{cursor:grabbing}.t-items[_ngcontent-%COMP%]{display:flex}._transitioned[_nghost-%COMP%]   .t-items[_ngcontent-%COMP%]{transition-property:transform;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}  [tuiCarouselButtons] [tuiIconButton]{border-radius:100%}.t-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:var(--tui-carousel-padding, 0 1.25rem);flex:1;min-inline-size:100%;max-inline-size:100%;box-sizing:border-box;border:none;margin:0}.t-wrapper[_ngcontent-%COMP%]{position:sticky;left:0;right:0;min-inline-size:100%;overflow:hidden}.t-scroller[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none;display:flex;overflow:auto;overscroll-behavior-x:none;touch-action:pan-y}.t-scroller[_ngcontent-%COMP%]::-webkit-scrollbar, .t-scroller[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{display:none}.t-scroller[_ngcontent-%COMP%]:before, .t-scroller[_ngcontent-%COMP%]:after{content:"";display:block;min-inline-size:1rem}'],changeDetection:0})}}return function rz(n,e,t,i){var s,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(e,t,o):s(e,t))||o);return r>3&&o&&Object.defineProperty(e,t,o),o}([Lle],n.prototype,"getStyle",null),n})();function rde(n,e){if(1&n){const t=rn();L(0,"button",7),Oe("click",function(){qe(t);const r=me(2).index;return He(me(2).changeMainImage(r))}),re(1),k()}if(2&n){const t=me(2).index,i=me(2);q(),Ei(i.imagesData.idMainImage===t?"\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f":"\u0421\u0434\u0435\u043b\u0430\u0442\u044c \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439")}}function ode(n,e){if(1&n&&(L(0,"div",4),Te(1,"img",5),ze(2,rde,2,1,"button",6),k()),2&n){const t=me(),i=t.$implicit,r=t.index,o=me(2);dr("active",r===o.index+1),q(),ee("src",i,mc),q(),ee("ngIf",o.changeModeSlider)}}function sde(n,e){1&n&&(ih(0),ze(1,ode,3,4,"div",3),rh())}function ade(n,e){if(1&n){const t=rn();L(0,"tui-carousel",1),Pl("indexChange",function(r){qe(t);const o=me();return bu(o.index,r)||(o.index=r),He(r)}),ze(1,sde,2,0,"ng-container",2),k()}if(2&n){const t=me();ee("draggable",!0)("itemsCount",t.getItemsCount()),Rl("index",t.index),q(),ee("ngForOf",t.imagesData.images)}}let EG=(()=>{class n{index=0;isMobileView=!1;imagesData;changeModeSlider=!1;ngOnInit(){this.checkViewport()}checkViewport(){this.isMobileView=window.innerWidth<=768}changeMainImage(t){this.imagesData.idMainImage=t}getItemsCount(){return this.imagesData.images.length<3||this.isMobileView?1:3}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=mo({type:n,selectors:[["app-image-slider"]],hostBindings:function(i,r){1&i&&Oe("resize",function(s){return r.checkViewport(s)},0,Zf)},inputs:{imagesData:"imagesData",changeModeSlider:"changeModeSlider"},decls:1,vars:1,consts:[[3,"draggable","itemsCount","index","indexChange",4,"ngIf"],[3,"indexChange","draggable","itemsCount","index"],[4,"ngFor","ngForOf"],["alt","","draggable","false","class","item",3,"active",4,"tuiItem"],["alt","","draggable","false",1,"item"],[3,"src"],[3,"click",4,"ngIf"],[3,"click"]],template:function(i,r){1&i&&ze(0,ade,2,4,"tui-carousel",0),2&i&&ee("ngIf",r.imagesData)},dependencies:[Cs,Au,ZP,SG],styles:["tui-carousel[_ngcontent-%COMP%]{width:100%;max-width:90vw}.item[_ngcontent-%COMP%]{transition:box-shadow .3s,transform .3s;margin:2rem auto;width:100%;max-height:350px;max-width:350px;aspect-ratio:1;border-radius:20px;background-color:#fff;display:grid;place-items:center;outline:none;border:none}.item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{grid-area:1/1/2/2;width:90%;pointer-events:none}.item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{grid-area:1/1/2/2;align-self:flex-end;margin-bottom:10px;background:none;outline:none;border:none;font-family:Courier New,Courier,monospace;cursor:pointer;padding:5px;background-color:#fff;border-radius:5px;transition:all .3s ease-in-out}.item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{box-shadow:0 0 5px #fff}"]})}return n})(),TG=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||n)(se(Dl),se(gi))};static \u0275dir=_t({type:n})}return n})(),fg=(()=>{class n extends TG{static \u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})();static \u0275dir=_t({type:n,features:[In]})}return n})();const Tc=new be(""),cde={provide:Tc,useExisting:Ri(()=>Ed),multi:!0},fde=new be("");let Ed=(()=>{class n extends TG{_compositionMode;_composing=!1;constructor(t,i,r){super(t,i),this._compositionMode=r,null==this._compositionMode&&(this._compositionMode=!function dde(){const n=lh()?lh().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||n)(se(Dl),se(gi),se(fde,8))};static \u0275dir=_t({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&Oe("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},standalone:!1,features:[Cn([cde]),In]})}return n})();function L3(n){return null==n||0===k3(n)}function k3(n){return null==n?null:Array.isArray(n)||"string"==typeof n?n.length:n instanceof Set?n.size:null}const Ss=new be(""),mh=new be(""),hde=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class pn{static min(e){return DG(e)}static max(e){return IG(e)}static required(e){return function RG(n){return L3(n.value)?{required:!0}:null}(e)}static requiredTrue(e){return function PG(n){return!0===n.value?null:{required:!0}}(e)}static email(e){return function OG(n){return L3(n.value)||hde.test(n.value)?null:{email:!0}}(e)}static minLength(e){return function NG(n){return e=>{const t=e.value?.length??k3(e.value);return null===t||0===t?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}(e)}static maxLength(e){return FG(e)}static pattern(e){return function LG(n){if(!n)return ZE;let e,t;return"string"==typeof n?(t="","^"!==n.charAt(0)&&(t+="^"),t+=n,"$"!==n.charAt(n.length-1)&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(L3(i.value))return null;const r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}(e)}static nullValidator(e){return null}static compose(e){return zG(e)}static composeAsync(e){return GG(e)}}function DG(n){return e=>{if(null==e.value||null==n)return null;const t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function IG(n){return e=>{if(null==e.value||null==n)return null;const t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function FG(n){return e=>{const t=e.value?.length??k3(e.value);return null!==t&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function ZE(n){return null}function kG(n){return null!=n}function BG(n){return Ab(n)?vo(n):n}function UG(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function VG(n,e){return e.map(t=>t(n))}function HG(n){return n.map(e=>function pde(n){return!n.validate}(e)?e:t=>e.validate(t))}function zG(n){if(!n)return null;const e=n.filter(kG);return 0==e.length?null:function(t){return UG(VG(t,e))}}function B3(n){return null!=n?zG(HG(n)):null}function GG(n){if(!n)return null;const e=n.filter(kG);return 0==e.length?null:function(t){return function lde(...n){const e=Z4(n),{args:t,keys:i}=xz(n),r=new Kn(o=>{const{length:s}=t;if(!s)return void o.complete();const a=new Array(s);let l=s,u=s;for(let c=0;c<s;c++){let f=!1;Zo(t[c]).subscribe(Mi(o,h=>{f||(f=!0,u--),a[c]=h},()=>l--,void 0,()=>{(!l||!f)&&(u||o.next(i?Mz(i,a):a),o.complete())}))}});return e?r.pipe(K4(e)):r}(VG(t,e).map(BG)).pipe(Nt(UG))}}function U3(n){return null!=n?GG(HG(n)):null}function jG(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function WG(n){return n._rawValidators}function $G(n){return n._rawAsyncValidators}function V3(n){return n?Array.isArray(n)?n:[n]:[]}function KE(n,e){return Array.isArray(n)?n.includes(e):n===e}function qG(n,e){const t=V3(e);return V3(n).forEach(r=>{KE(t,r)||t.push(r)}),t}function XG(n,e){return V3(e).filter(t=>!KE(n,t))}class YG{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=B3(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=U3(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Ks extends YG{name;get formDirective(){return null}get path(){return null}}class _h extends YG{_parent=null;name=null;valueAccessor=null}class ZG{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}}let hg=(()=>{class n extends ZG{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(se(_h,2))};static \u0275dir=_t({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&dr("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[In]})}return n})(),pg=(()=>{class n extends ZG{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(se(Ks,10))};static \u0275dir=_t({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){2&i&&dr("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[In]})}return n})();const ww="VALID",QE="INVALID",v_="PENDING",xw="DISABLED";class b_{}class JG extends b_{value;source;constructor(e,t){super(),this.value=e,this.source=t}}class G3 extends b_{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}}class j3 extends b_{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}}class eT extends b_{status;source;constructor(e,t){super(),this.status=e,this.source=t}}class QG extends b_{source;constructor(e){super(),this.source=e}}class ej extends b_{source;constructor(e){super(),this.source=e}}function W3(n){return(tT(n)?n.validators:n)||null}function $3(n,e){return(tT(e)?e.asyncValidators:n)||null}function tT(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class q3{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Hr(this.statusReactive)}set status(e){Hr(()=>this.statusReactive.set(e))}_status=xu(()=>this.statusReactive());statusReactive=fs(void 0);get valid(){return this.status===ww}get invalid(){return this.status===QE}get pending(){return this.status==v_}get disabled(){return this.status===xw}get enabled(){return this.status!==xw}errors;get pristine(){return Hr(this.pristineReactive)}set pristine(e){Hr(()=>this.pristineReactive.set(e))}_pristine=xu(()=>this.pristineReactive());pristineReactive=fs(!0);get dirty(){return!this.pristine}get touched(){return Hr(this.touchedReactive)}set touched(e){Hr(()=>this.touchedReactive.set(e))}_touched=xu(()=>this.touchedReactive());touchedReactive=fs(!1);get untouched(){return!this.touched}_events=new Xr;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(qG(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(qG(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(XG(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(XG(e,this._rawAsyncValidators))}hasValidator(e){return KE(this._rawValidators,e)}hasAsyncValidator(e){return KE(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){const t=!1===this.touched;this.touched=!0;const i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched({...e,sourceControl:i}),t&&!1!==e.emitEvent&&this._events.next(new j3(!0,i))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){const t=!0===this.touched;this.touched=!1,this._pendingTouched=!1;const i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&!1!==e.emitEvent&&this._events.next(new j3(!1,i))}markAsDirty(e={}){const t=!0===this.pristine;this.pristine=!1;const i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty({...e,sourceControl:i}),t&&!1!==e.emitEvent&&this._events.next(new G3(!1,i))}markAsPristine(e={}){const t=!1===this.pristine;this.pristine=!0,this._pendingDirty=!1;const i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&!1!==e.emitEvent&&this._events.next(new G3(!0,i))}markAsPending(e={}){this.status=v_;const t=e.sourceControl??this;!1!==e.emitEvent&&(this._events.next(new eT(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending({...e,sourceControl:t})}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=xw,this.errors=null,this._forEachChild(r=>{r.disable({...e,onlySelf:!0})}),this._updateValue();const i=e.sourceControl??this;!1!==e.emitEvent&&(this._events.next(new JG(this.value,i)),this._events.next(new eT(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t},this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=ww,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t},this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){const i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ww||this.status===v_)&&this._runAsyncValidator(i,e.emitEvent)}const t=e.sourceControl??this;!1!==e.emitEvent&&(this._events.next(new JG(this.value,t)),this._events.next(new eT(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity({...e,sourceControl:t})}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?xw:ww}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=v_,this._hasOwnPendingAsyncValidator={emitEvent:!1!==t};const i=BG(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();const e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent,this,t.shouldHaveEmitted)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new eT(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new Oi,this.statusChanges=new Oi}_calculateStatus(){return this._allControlsDisabled()?xw:this.errors?QE:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(v_)?v_:this._anyControlsHaveStatus(QE)?QE:ww}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){const i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new G3(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new j3(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){tT(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function wde(n){return Array.isArray(n)?B3(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function xde(n){return Array.isArray(n)?U3(n):n||null}(this._rawAsyncValidators)}}class Ko extends q3{constructor(e,t,i){super(W3(t),$3(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){(function nj(n,e,t){n._forEachChild((i,r)=>{if(void 0===t[r])throw new ce(1002,"")})})(this,0,e),Object.keys(e).forEach(i=>{(function tj(n,e,t){const i=n.controls;if(!(e?Object.keys(i):i).length)throw new ce(1e3,"");if(!i[t])throw new ce(1001,"")})(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(i=>{const r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>!!i._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,o)=>{i=t(i,r,o)}),i}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}const gg=new be("",{providedIn:"root",factory:()=>Mw}),Mw="always";function nT(n,e){return[...e.path,n]}function Cw(n,e,t=Mw){X3(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function Sde(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&ij(n,e)})}(n,e),function Tde(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function Ede(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&ij(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function Cde(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function iT(n,e,t=!0){const i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),oT(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function rT(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function X3(n,e){const t=WG(n);null!==e.validator?n.setValidators(jG(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=$G(n);null!==e.asyncValidator?n.setAsyncValidators(jG(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();rT(e._rawValidators,r),rT(e._rawAsyncValidators,r)}function oT(n,e){let t=!1;if(null!==n){if(null!==e.validator){const r=WG(n);if(Array.isArray(r)&&r.length>0){const o=r.filter(s=>s!==e.validator);o.length!==r.length&&(t=!0,n.setValidators(o))}}if(null!==e.asyncValidator){const r=$G(n);if(Array.isArray(r)&&r.length>0){const o=r.filter(s=>s!==e.asyncValidator);o.length!==r.length&&(t=!0,n.setAsyncValidators(o))}}}const i=()=>{};return rT(e._rawValidators,i),rT(e._rawAsyncValidators,i),t}function ij(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function rj(n,e){X3(n,e)}function Z3(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}function oj(n,e){n._syncPendingControls(),e.forEach(t=>{const i=t.control;"submit"===i.updateOn&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function K3(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(o=>{o.constructor===Ed?t=o:function Ide(n){return Object.getPrototypeOf(n.constructor)===fg}(o)?i=o:r=o}),r||i||t||null}const Pde={provide:Ks,useExisting:Ri(()=>Ew)},Sw=Promise.resolve();let Ew=(()=>{class n extends Ks{callSetDisabledState;get submitted(){return Hr(this.submittedReactive)}_submitted=xu(()=>this.submittedReactive());submittedReactive=fs(!1);_directives=new Set;form;ngSubmit=new Oi;options;constructor(t,i,r){super(),this.callSetDisabledState=r,this.form=new Ko({},B3(t),U3(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Sw.then(()=>{const i=this._findContainer(t.path);t.control=i.registerControl(t.name,t.control),Cw(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Sw.then(()=>{const i=this._findContainer(t.path);i&&i.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){Sw.then(()=>{const i=this._findContainer(t.path),r=new Ko({});rj(r,t),i.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Sw.then(()=>{const i=this._findContainer(t.path);i&&i.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,i){Sw.then(()=>{this.form.get(t.path).setValue(i)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),oj(this.form,this._directives),this.ngSubmit.emit(t),this.form._events.next(new QG(this.control)),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1),this.form._events.next(new ej(this.form))}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static \u0275fac=function(i){return new(i||n)(se(Ss,10),se(mh,10),se(gg,8))};static \u0275dir=_t({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){1&i&&Oe("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Cn([Pde]),In]})}return n})();function sj(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function aj(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const Li=class extends q3{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,i){super(W3(t),$3(i,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),tT(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=aj(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){sj(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){sj(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){aj(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},kde={provide:_h,useExisting:Ri(()=>lT)},lj=Promise.resolve();let lT=(()=>{class n extends _h{_changeDetectorRef;callSetDisabledState;control=new Li;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new Oi;constructor(t,i,r,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=K3(0,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),Z3(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Cw(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){lj.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&a_(i);lj.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?nT(t,this._parent):[t]}static \u0275fac=function(i){return new(i||n)(se(Ks,9),se(Ss,10),se(mh,10),se(Tc,10),se(wu,8),se(gg,8))};static \u0275dir=_t({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Cn([kde]),In,as]})}return n})(),mg=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275dir=_t({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();const Bde={provide:Tc,useExisting:Ri(()=>uT),multi:!0};let uT=(()=>{class n extends fg{writeValue(t){this.setProperty("value",t??"")}registerOnChange(t){this.onChange=i=>{t(""==i?null:parseFloat(i))}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})();static \u0275dir=_t({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,r){1&i&&Oe("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Cn([Bde]),In]})}return n})();const J3=new be(""),Gde={provide:Ks,useExisting:Ri(()=>Ac)};let Ac=(()=>{class n extends Ks{callSetDisabledState;get submitted(){return Hr(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=xu(()=>this._submittedReactive());_submittedReactive=fs(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new Oi;constructor(t,i,r){super(),this.callSetDisabledState=r,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(oT(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const i=this.form.get(t.path);return Cw(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){iT(t.control||null,t,!1),function Rde(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,i){this.form.get(t.path).setValue(i)}onSubmit(t){return this._submittedReactive.set(!0),oj(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new QG(this.control)),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this._submittedReactive.set(!1),this.form._events.next(new ej(this.form))}_updateDomValue(){this.directives.forEach(t=>{const i=t.control,r=this.form.get(t.path);i!==r&&(iT(i||null,t),(n=>n instanceof Li)(r)&&(Cw(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const i=this.form.get(t.path);rj(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const i=this.form.get(t.path);i&&function Ade(n,e){return oT(n,e)}(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){X3(this.form,this),this._oldForm&&oT(this._oldForm,this)}static \u0275fac=function(i){return new(i||n)(se(Ss,10),se(mh,10),se(gg,8))};static \u0275dir=_t({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){1&i&&Oe("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Cn([Gde]),In,as]})}return n})();const $de={provide:_h,useExisting:Ri(()=>yh)};let yh=(()=>{class n extends _h{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new Oi;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,i,r,o,s){super(),this._ngModelWarningConfig=s,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=K3(0,o)}ngOnChanges(t){this._added||this._setUpControl(),Z3(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return nT(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(i){return new(i||n)(se(Ks,13),se(Ss,10),se(mh,10),se(Tc,10),se(J3,8))};static \u0275dir=_t({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Cn([$de]),In,as]})}return n})();const qde={provide:Tc,useExisting:Ri(()=>dT),multi:!0};function hj(n,e){return null==n?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let dT=(()=>{class n extends fg{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;const r=hj(this._getOptionId(t),t);this.setProperty("value",r)}registerOnChange(t){this.onChange=i=>{this.value=this._getOptionValue(i),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),t))return i;return null}_getOptionValue(t){const i=function Xde(n){return n.split(":")[0]}(t);return this._optionMap.has(i)?this._optionMap.get(i):t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})();static \u0275dir=_t({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){1&i&&Oe("change",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Cn([qde]),In]})}return n})(),pj=(()=>{class n{_element;_renderer;_select;id;constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(hj(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(i){return new(i||n)(se(gi),se(Dl),se(dT,9))};static \u0275dir=_t({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();const Yde={provide:Tc,useExisting:Ri(()=>Q3),multi:!0};function gj(n,e){return null==n?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let Q3=(()=>{class n extends fg{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){let i;if(this.value=t,Array.isArray(t)){const r=t.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(t){this.onChange=i=>{const r=[],o=i.selectedOptions;if(void 0!==o){const s=o;for(let a=0;a<s.length;a++){const u=this._getOptionValue(s[a].value);r.push(u)}}else{const s=i.options;for(let a=0;a<s.length;a++){const l=s[a];if(l.selected){const u=this._getOptionValue(l.value);r.push(u)}}}this.value=r,t(r)}}_registerOption(t){const i=(this._idCounter++).toString();return this._optionMap.set(i,t),i}_getOptionId(t){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,t))return i;return null}_getOptionValue(t){const i=function Zde(n){return n.split(":")[0]}(t);return this._optionMap.has(i)?this._optionMap.get(i)._value:t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})();static \u0275dir=_t({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){1&i&&Oe("change",function(s){return r.onChange(s.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Cn([Yde]),In]})}return n})(),mj=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(gj(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(gj(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(i){return new(i||n)(se(gi),se(Dl),se(Q3,9))};static \u0275dir=_t({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();function yj(n){return"number"==typeof n?n:parseFloat(n)}let _g=(()=>{class n{_validator=ZE;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){const i=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):ZE,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return null!=t}static \u0275fac=function(i){return new(i||n)};static \u0275dir=_t({type:n,features:[as]})}return n})();const Kde={provide:Ss,useExisting:Ri(()=>eO),multi:!0};let eO=(()=>{class n extends _g{max;inputName="max";normalizeInput=t=>yj(t);createValidator=t=>IG(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})();static \u0275dir=_t({type:n,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&$s("max",r._enabled?r.max:null)},inputs:{max:"max"},standalone:!1,features:[Cn([Kde]),In]})}return n})();const Jde={provide:Ss,useExisting:Ri(()=>fT),multi:!0};let fT=(()=>{class n extends _g{min;inputName="min";normalizeInput=t=>yj(t);createValidator=t=>DG(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})();static \u0275dir=_t({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&$s("min",r._enabled?r.min:null)},inputs:{min:"min"},standalone:!1,features:[Cn([Jde]),In]})}return n})();const ife={provide:Ss,useExisting:Ri(()=>nO),multi:!0};let nO=(()=>{class n extends _g{maxlength;inputName="maxlength";normalizeInput=t=>function _j(n){return"number"==typeof n?n:parseInt(n,10)}(t);createValidator=t=>FG(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})();static \u0275dir=_t({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&$s("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},standalone:!1,features:[Cn([ife]),In]})}return n})(),Mj=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Hp({type:n});static \u0275inj=Ku({})}return n})(),iO=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:gg,useValue:t.callSetDisabledState??Mw}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=Hp({type:n});static \u0275inj=Ku({imports:[Mj]})}return n})(),yg=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:J3,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:gg,useValue:t.callSetDisabledState??Mw}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=Hp({type:n});static \u0275inj=Ku({imports:[Mj]})}return n})();var Cj=je(770);let Sj=(()=>{class n{el=j(gi);mobileView=!1;constructor(){}ngOnInit(){this.mobileView&&this.el.nativeElement.addEventListener("input",this.onInput.bind(this.el.nativeElement))}onInput(t){const i=t.target;(0,Cj.throttle)(()=>{i.style.height="auto",i.style.height=i.scrollHeight+"px"},250)()}static \u0275fac=function(i){return new(i||n)};static \u0275dir=_t({type:n,selectors:[["","appAutoHeight",""]],inputs:{mobileView:"mobileView"}})}return n})(),hT=(()=>{class n{transform(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")+" \u20bd"}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=_s({name:"costFormat",type:n,pure:!0})}return n})();var sfe=je(404),afe=je.n(sfe);let Ej=(()=>{class n{compressImage(t){return new Promise((i,r)=>{new(afe())(t,{quality:.6,success:o=>{i(o)},error:o=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0436\u0430\u0442\u0438\u044f:",o.message),r(o)}})})}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Aw="http://localhost:4200/",Es=Aw+"api/";function nr(n,e){const t="object"==typeof e;return new Promise((i,r)=>{const o=new Kl({next:s=>{i(s),o.unsubscribe()},error:r,complete:()=>{t?i(e.defaultValue):r(new Wb)}});n.subscribe(o)})}let rO=(()=>{class n{httpModule;baseServiceUrl=Es+"category";constructor(t){this.httpModule=t}GETgetAllCategories(){return nr(this.httpModule.get(this.baseServiceUrl))}static \u0275fac=function(i){return new(i||n)(Ze(Mu))};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),kl=(()=>{class n{errorSubject=new Lr("");successSubject=new Lr("");error$=this.errorSubject.asObservable();success$=this.successSubject.asObservable();setError(t,i){this.errorSubject.next(t),setTimeout(()=>this.clearNotification(),i)}setSuccess(t,i){this.successSubject.next(t),setTimeout(()=>this.clearNotification(),i)}clearNotification(){this.errorSubject.next(""),this.successSubject.next("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const lfe=["colorModule"],ufe=["shopsModule"],cfe=["additionalModule"],dfe=()=>({standalone:!0}),oO=n=>({invalid:n}),ffe=n=>({filterData:n});function hfe(n,e){if(1&n){const t=rn();L(0,"button",31),Oe("click",function(){return qe(t),He(me().removeImages())}),Te(1,"img",32),k()}}function pfe(n,e){if(1&n&&Te(0,"app-image-slider",33),2&n){const t=me();ee("imagesData",t.furnitureData.colors[t.currentColorId].imagesData)("changeModeSlider",!0)}}function gfe(n,e){if(1&n){const t=rn();L(0,"div",34)(1,"input",35),Oe("input",function(r){return qe(t),He(me().onInputImages(r))}),k(),Te(2,"img",36),k()}}function mfe(n,e){if(1&n){const t=rn();L(0,"button",39),Oe("click",function(){const r=qe(t).index;return He(me(2).openFurnitureVariant(r))}),k()}if(2&n){const i=e.index;oo("background-color",e.$implicit.color),$s("data-idColor",i)}}function _fe(n,e){if(1&n&&(L(0,"span",37),ze(1,mfe,1,3,"button",38),k()),2&n){const t=me();oo("--total-items",t.furnitureData.colors.length.toString()),q(),ee("ngForOf",t.furnitureData.colors)}}function yfe(n,e){if(1&n){const t=rn();L(0,"button",40),Oe("click",function(){const r=qe(t).index;return He(me().openShopsModule(r))}),L(1,"div",41),re(2),r_(3,"costFormat"),k(),L(4,"div",42),Te(5,"img",43),k()()}if(2&n){const t=e.$implicit;q(2),Ei(o_(3,1,t.cost))}}function vfe(n,e){1&n&&oh(0)}function bfe(n,e){1&n&&(L(0,"span",54),re(1," \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u0446\u0432\u0435\u0442 "),k())}function wfe(n,e){if(1&n){const t=rn();L(0,"form",44),Oe("ngSubmit",function(){return qe(t),He(me().addColor())}),L(1,"button",45),Oe("click",function(){return qe(t),He(me().closeAddModule())}),Te(2,"img",46),k(),L(3,"span",47)(4,"h2",48),re(5,"\u0412\u0430\u0440\u0438\u0430\u043d\u0442 \u043c\u0435\u0431\u0435\u043b\u0438"),k(),L(6,"span",49)(7,"label",50),re(8,"\u0426\u0432\u0435\u0442"),k(),Te(9,"input",51),ze(10,bfe,2,0,"span",52),k(),L(11,"button",53),re(12,"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c"),k()()()}if(2&n){let t;const i=me();ee("formGroup",i.colorForm),q(10),ee("ngIf",(null==(t=i.colorForm.get("color"))?null:t.invalid)&&((null==(t=i.colorForm.get("color"))?null:t.dirty)||(null==(t=i.colorForm.get("color"))?null:t.touched))),q(),ee("disabled",!i.colorForm.valid)}}function xfe(n,e){1&n&&(L(0,"span",54),re(1," \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u0443\u044e \u0446\u0435\u043d\u0443 "),k())}function Mfe(n,e){1&n&&(L(0,"span",54),re(1," \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u0441\u0441\u044b\u043b\u043a\u0443 "),k())}function Cfe(n,e){if(1&n){const t=rn();L(0,"button",62),Oe("click",function(){return qe(t),He(me(2).deleteShop())}),Te(1,"img",63),k()}}function Sfe(n,e){if(1&n){const t=rn();L(0,"form",44),Oe("ngSubmit",function(){return qe(t),He(me().addShop())}),L(1,"button",45),Oe("click",function(){return qe(t),He(me().closeAddModule())}),Te(2,"img",46),k(),L(3,"span",47)(4,"h2",48),re(5,"\u0412\u0430\u0440\u0438\u0430\u043d\u0442 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0430"),k(),L(6,"span",49)(7,"label",55),re(8,"\u0426\u0435\u043d\u0430"),k(),Te(9,"input",56),ze(10,xfe,2,0,"span",52),k(),L(11,"span",49)(12,"label",57),re(13,"\u0421\u0441\u044b\u043b\u043a\u0430"),k(),Te(14,"input",58),ze(15,Mfe,2,0,"span",52),k(),L(16,"span",59)(17,"button",60),re(18,"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c"),k(),ze(19,Cfe,2,0,"button",61),k()()()}if(2&n){let t,i;const r=me();ee("formGroup",r.shopForm),q(10),ee("ngIf",(null==(t=r.shopForm.get("cost"))?null:t.invalid)&&((null==(t=r.shopForm.get("cost"))?null:t.dirty)||(null==(t=r.shopForm.get("cost"))?null:t.touched))),q(5),ee("ngIf",(null==(i=r.shopForm.get("url"))?null:i.invalid)&&((null==(i=r.shopForm.get("url"))?null:i.dirty)||(null==(i=r.shopForm.get("url"))?null:i.touched))),q(2),ee("disabled",!r.shopForm.valid),q(2),ee("ngIf",void 0!==r.lastClickedShop)}}function Efe(n,e){if(1&n&&(L(0,"option",77),re(1),k()),2&n){const t=e.$implicit;ee("value",t.name),q(),Ca("",t.translateOne," ")}}function Tfe(n,e){1&n&&(L(0,"span",54),re(1," \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u0448\u0438\u0440\u0438\u043d\u0443 "),k())}function Afe(n,e){1&n&&(L(0,"span",54),re(1," \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u0434\u043b\u0438\u043d\u0443 "),k())}function Dfe(n,e){1&n&&(L(0,"span",54),re(1," \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u0432\u044b\u0441\u043e\u0442\u0443 "),k())}function Ife(n,e){1&n&&oh(0)}function Rfe(n,e){if(1&n&&(ih(0),ze(1,Ife,1,0,"ng-container",79),rh()),2&n){const t=e.$implicit;me(4);const i=yo(37),r=yo(39);q(),ee("ngTemplateOutlet","select"===t.type?i:r)("ngTemplateOutletContext",Sa(2,ffe,t))}}function Pfe(n,e){if(1&n&&(ih(0),ze(1,Rfe,2,4,"ng-container",78),rh()),2&n){const t=me(3);q(),ee("ngForOf",t.getfilterData())}}function Ofe(n,e){if(1&n){const t=rn();L(0,"span",49)(1,"label",67),re(2,"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f"),k(),L(3,"select",68),Pl("ngModelChange",function(r){qe(t);const o=me(2);return bu(o.furnitureData.additionalData.category,r)||(o.furnitureData.additionalData.category=r),He(r)}),ze(4,Efe,2,2,"option",69),k(),L(5,"label",70),re(6,"\u0428\u0438\u0440\u0438\u043d\u0430(\u0441\u043c)"),k(),Te(7,"input",71),ze(8,Tfe,2,0,"span",52),L(9,"label",72),re(10,"\u0414\u043b\u0438\u043d\u0430(\u0441\u043c)"),k(),Te(11,"input",73),ze(12,Afe,2,0,"span",52),L(13,"label",74),re(14,"\u0412\u044b\u0441\u043e\u0442\u0430(\u0441\u043c)"),k(),Te(15,"input",75),ze(16,Dfe,2,0,"span",52)(17,Pfe,2,1,"ng-container",76),k()}if(2&n){let t,i,r,o,s,a;const l=me(2);q(3),ee("ngModelOptions",i_(10,dfe)),Rl("ngModel",l.furnitureData.additionalData.category),q(),ee("ngForOf",l.categoryArray),q(3),ee("ngClass",Sa(11,oO,(null==(t=l.proportionsForm.get("width"))?null:t.invalid)&&((null==(t=l.proportionsForm.get("width"))?null:t.dirty)||(null==(t=l.proportionsForm.get("width"))?null:t.touched)))),q(),ee("ngIf",(null==(i=l.proportionsForm.get("width"))?null:i.invalid)&&((null==(i=l.proportionsForm.get("width"))?null:i.dirty)||(null==(i=l.proportionsForm.get("width"))?null:i.touched))),q(3),ee("ngClass",Sa(13,oO,(null==(r=l.proportionsForm.get("length"))?null:r.invalid)&&((null==(r=l.proportionsForm.get("length"))?null:r.dirty)||(null==(r=l.proportionsForm.get("length"))?null:r.touched)))),q(),ee("ngIf",(null==(o=l.proportionsForm.get("length"))?null:o.invalid)&&((null==(o=l.proportionsForm.get("length"))?null:o.dirty)||(null==(o=l.proportionsForm.get("length"))?null:o.touched))),q(3),ee("ngClass",Sa(15,oO,(null==(s=l.proportionsForm.get("height"))?null:s.invalid)&&((null==(s=l.proportionsForm.get("height"))?null:s.dirty)||(null==(s=l.proportionsForm.get("height"))?null:s.touched)))),q(),ee("ngIf",(null==(a=l.proportionsForm.get("height"))?null:a.invalid)&&((null==(a=l.proportionsForm.get("height"))?null:a.dirty)||(null==(a=l.proportionsForm.get("height"))?null:a.touched))),q(),ee("ngIf",l.furnitureData.additionalData.category)}}function Nfe(n,e){if(1&n){const t=rn();L(0,"form",44),Oe("ngSubmit",function(){return qe(t),He(me().saveAdditional())}),L(1,"button",45),Oe("click",function(){return qe(t),He(me().closeAddModule())}),Te(2,"img",46),k(),L(3,"span",47)(4,"h2",48),re(5,"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"),k(),L(6,"span",64),ze(7,Ofe,18,17,"span",65),k(),L(8,"button",66),re(9,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),k()()()}if(2&n){const t=me();ee("formGroup",t.proportionsForm),q(7),ee("ngIf",void 0!==t.categoryArray),q(),ee("disabled",t.proportionsForm.invalid)}}function Ffe(n,e){if(1&n&&(L(0,"option",77),re(1),k()),2&n){const t=e.$implicit;ee("value",t.queryValue),q(),Ei(t.name)}}function Lfe(n,e){if(1&n){const t=rn();L(0,"span",80)(1,"label",81),re(2),k(),L(3,"select",82),Pl("ngModelChange",function(r){const o=qe(t).filterData,s=me();return bu(s.furnitureData.additionalData[o.field],r)||(s.furnitureData.additionalData[o.field]=r),He(r)}),ze(4,Ffe,2,2,"option",69),k()()}if(2&n){const t=e.filterData,i=me();q(),ee("for",t.field),q(),Ei(t.name),q(),ee("id",t.field),Rl("ngModel",i.furnitureData.additionalData[t.field]),q(),ee("ngForOf",t.options)}}function kfe(n,e){if(1&n){const t=rn();L(0,"span",80)(1,"label",81),re(2),k(),L(3,"input",83),Pl("ngModelChange",function(r){const o=qe(t).filterData,s=me();return bu(s.furnitureData.additionalData[o.field],r)||(s.furnitureData.additionalData[o.field]=r),He(r)}),k()()}if(2&n){const t=e.filterData,i=me();q(),ee("for",t.field),q(),Ei(t.name),q(),ee("id",t.field),Rl("ngModel",i.furnitureData.additionalData[t.field])}}let pT=(()=>{class n{elementRef;changeDetectorRef;clientImageControl;categoryService;notification;constructor(t,i,r,o,s){this.elementRef=t,this.changeDetectorRef=i,this.clientImageControl=r,this.categoryService=o,this.notification=s}addModule;isMobileView=!1;lastClickedShop=void 0;lastClickedColor=void 0;addModuleTemplate;addColorVisible=!1;categoryArray=[];currentColorId=void 0;furnitureModelInput;furnitureData;colorModuleTemplate;shopsModuleTemplate;additionalModuleTemplate;ngOnInit(){this.initCategories(),this.checkViewport()}ngAfterViewInit(){this.addModule=this.elementRef.nativeElement.querySelector(".addModule"),this.furnitureModelInput=this.elementRef.nativeElement.querySelector(".furnitureModelInput")}initCategories(){var t=this;return N(function*(){try{t.categoryArray=(yield t.categoryService.GETgetAllCategories()).categoryArray}catch{t.notification.setError("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439",5e3)}})()}onInputImages(t){var i=this;return N(function*(){const o=t.target.files;if(o&&void 0!==i.currentColorId)try{let s=[];for(let a=0;a<o.length;a++){const l=yield i.clientImageControl.compressImage(o[a]);l&&s.push(URL.createObjectURL(l))}i.furnitureData.colors[i.currentColorId].imagesData.images=s}catch{i.notification.setError("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0439",5e3)}})()}checkViewport(){this.isMobileView=window.innerWidth<=600}numberValidator(t){const i=t.value;return null!==i&&isNaN(i)?{notANumber:!0}:null}removeImages(){void 0===this.currentColorId||!this.furnitureData.colors[this.currentColorId].imagesData.images||(this.furnitureData.colors[this.currentColorId].imagesData.images.length=0)}saveAdditional(){if(this.proportionsForm.invalid)return this.proportionsForm.markAllAsTouched(),void this.notification.setError("\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u0441\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b",5e3);const{width:t,length:i,height:r}=this.proportionsForm.value;t&&i&&r&&(this.furnitureData.proportions={width:t,length:i,height:r}),this.closeAddModule()}openFurnitureVariant(t){const i=this.elementRef.nativeElement.querySelector(".colors"),r=i.querySelector(`[data-idColor="${t}"]`),o=i.querySelectorAll(".colorVariant");let s=[],a=[];o.forEach((l,u)=>{u>+t?a=[...a,l]:u<+t&&(s=[...s,l])}),[r,...a,...s].forEach((l,u)=>{l.style.setProperty("--index",(u+1).toString())}),setTimeout(()=>{r.style.setProperty("margin-right","115px")},500),setTimeout(()=>{this.currentColorId=+t,r.style.setProperty("margin-right","0")},1250)}getfilterData(){if(!this.furnitureData.additionalData.category)return[];const t=this.categoryArray.findIndex(i=>i.name===this.furnitureData.additionalData.category);return this.categoryArray[t].filters??[]}addColor(){const t=this.colorForm.value.color;if(t){for(let r of this.furnitureData.colors)if(r.color===t)return this.closeAddModule(),void this.notification.setError("\u0422\u0430\u043a\u043e\u0439 \u0446\u0432\u0435\u0442 \u0443\u0436\u0435 \u0435\u0441\u0442\u044c",5e3);this.furnitureData.colors.push({color:t,imagesData:{images:[],idMainImage:0}}),this.colorForm.patchValue({color:""}),this.currentColorId=this.furnitureData.colors.length-1,setTimeout(()=>{this.closeAddModule(),this.openFurnitureVariant(this.currentColorId)},0)}else this.notification.setError("\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0446\u0432\u0435\u0442",5e3)}closeAddModule(){this.addModule.classList.add("disabled")}addShop(){void 0!==this.lastClickedShop&&(this.furnitureData.shops[this.lastClickedShop]={cost:this.shopForm.value.cost,url:this.shopForm.value.url}),this.furnitureData.shops.push({cost:this.shopForm.value.cost,url:this.shopForm.value.url}),this.closeAddModule(),this.shopForm.patchValue({cost:null,url:null})}deleteShop(){null!=this.lastClickedShop&&this.lastClickedShop>=0&&this.lastClickedShop<this.furnitureData.shops.length&&(this.furnitureData.shops.splice(this.lastClickedShop,1),this.changeDetectorRef.detectChanges(),this.lastClickedShop=void 0,this.closeAddModule())}openColorModule(t){t&&t.preventDefault(),this.addModuleTemplate=this.colorModuleTemplate,this.addModule.classList.remove("disabled"),setTimeout(()=>{this.elementRef.nativeElement.querySelector(".addModuleInput").focus()},10)}deleteColor(){const t=this.currentColorId;this.currentColorId=1===this.furnitureData.colors.length?void 0:0,this.furnitureData.colors=this.furnitureData.colors.filter((i,r)=>r!==t)}openShopsModule(t){void 0!==t?(this.lastClickedShop=t,this.shopForm.patchValue({cost:this.furnitureData.shops[t].cost,url:this.furnitureData.shops[t].url})):(this.lastClickedShop=void 0,this.shopForm.patchValue({cost:null,url:""})),this.addModuleTemplate=this.shopsModuleTemplate,this.addModule.classList.remove("disabled")}openAdditional(){this.proportionsForm.patchValue({width:this.furnitureData.proportions.width,length:this.furnitureData.proportions.length,height:this.furnitureData.proportions.height}),null===this.furnitureData.proportions.width&&this.proportionsForm.get("width")?.markAsTouched(),null===this.furnitureData.proportions.length&&this.proportionsForm.get("length")?.markAsTouched(),null===this.furnitureData.proportions.height&&this.proportionsForm.get("height")?.markAsTouched(),this.addModuleTemplate=this.additionalModuleTemplate,this.addModule.classList.remove("disabled")}colorForm=new Ko({color:new Li("",[pn.required])});shopForm=new Ko({cost:new Li(null,[pn.required,this.numberValidator]),url:new Li("",[pn.required])});proportionsForm=new Ko({width:new Li(null,[pn.required,pn.min(0)]),length:new Li(null,[pn.required,pn.min(0)]),height:new Li(null,[pn.required,pn.min(0)])});static \u0275fac=function(i){return new(i||n)(se(gi),se(wu),se(Ej),se(rO),se(kl))};static \u0275cmp=mo({type:n,selectors:[["app-create-furniture"]],viewQuery:function(i,r){if(1&i&&(ys(lfe,5),ys(ufe,5),ys(cfe,5)),2&i){let o;Po(o=Oo())&&(r.colorModuleTemplate=o.first),Po(o=Oo())&&(r.shopsModuleTemplate=o.first),Po(o=Oo())&&(r.additionalModuleTemplate=o.first)}},hostBindings:function(i,r){1&i&&Oe("resize",function(s){return r.checkViewport(s)},0,Zf)},inputs:{furnitureData:"furnitureData"},decls:40,vars:9,consts:[["colorModule",""],["shopsModule",""],["additionalModule",""],["selectFilter",""],["rangeFilter",""],[1,"body",3,"click"],["placeholder","\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435","title","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0431\u0435\u043b\u0438",1,"furnitureTitle",3,"ngModelChange","ngModel"],[1,"imageSlideSpan"],["class","editImagesBtn",3,"click",4,"ngIf"],[3,"imagesData","changeModeSlider",4,"ngIf"],["class","uploadImagesDiv",4,"ngIf"],[1,"footer"],[1,"leftPiece"],[1,"colorSlider"],["title","\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0446\u0432\u0435\u0442",1,"addColorBtn",3,"click"],["loading","lazy","src","/assets/images/addIcon.svg","alt","\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"],["class","colors",3,"--total-items",4,"ngIf"],["type","file","accept",".obj,.fbx,.gltf,.glb","id","furnitureModel","title","\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c 3D \u043c\u043e\u0434\u0435\u043b\u044c",1,"furnitureModelInput"],[1,"informationSpan"],[1,"descriptionSpan"],[1,"descriptionTitle"],["appAutoHeight","","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435...","title","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043c\u0435\u0431\u0435\u043b\u0438",1,"descriptionInformation",3,"ngModelChange","mobileView","ngModel"],[1,"rightFunctionalSection"],[1,"shopsTitle"],[1,"shopsSpan"],[1,"shopsListSpan"],["class","shopFunctions","title","\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u0430\u0433\u0430\u0437\u0438\u043d",3,"click",4,"ngFor","ngForOf"],["title","\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0430\u0433\u0430\u0437\u0438\u043d",1,"addShopButton",3,"click"],["title","\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f",1,"additionalFunctions",3,"click"],[1,"addModule","disabled"],[4,"ngTemplateOutlet"],[1,"editImagesBtn",3,"click"],["loading","lazy","alt","edit","src","/assets/images/editIcon.svg","alt",""],[3,"imagesData","changeModeSlider"],[1,"uploadImagesDiv"],["multiple","","type","file","accept",".png,.jpeg,.jpg","title","\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f",1,"uploadImagesInput",3,"input"],["loading","lazy","src","/assets/images/uploadIcon.png","alt","\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c",1,"uploadImagesIcon"],[1,"colors"],["class","colorVariant","title","\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0446\u0432\u0435\u0442",3,"background-color","click",4,"ngFor","ngForOf"],["title","\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0446\u0432\u0435\u0442",1,"colorVariant",3,"click"],["title","\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u0430\u0433\u0430\u0437\u0438\u043d",1,"shopFunctions",3,"click"],[1,"furnitureCost"],[1,"linkShop"],["loading","lazy","src","/assets/images/linkIcon.svg","alt","\u0421\u0441\u044b\u043b\u043a\u0430"],[1,"addModuleSpan",3,"ngSubmit","formGroup"],["type","button",1,"closeAddModuleBtn",3,"click"],["loading","lazy","src","/assets/images/addIcon.svg","alt","\u0417\u0430\u043a\u0440\u044b\u0442\u044c"],[1,"addModuleFormContent"],[1,"addModuleTitle"],[1,"addModuleInputSpan"],["for","colorVariant",1,"inputLabel"],["formControlName","color","placeholder","\u041d\u0430 \u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u043e\u043c \u0438\u043b\u0438 #hex","id","colorVariant","type","text","title","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0446\u0432\u0435\u0442 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 #hex \u0438\u043b\u0438 \u043d\u0430 \u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u043e\u043c",1,"addModuleInput"],["class","error-message",4,"ngIf"],["type","submit","title","\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0446\u0432\u0435\u0442",1,"submitAddModuleFormBtn",3,"disabled"],[1,"error-message"],["for","cost",1,"inputLabel"],["formControlName","cost","id","cost","type","text","title","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0446\u0435\u043d\u0443",1,"addModuleInput"],["for","url",1,"inputLabel"],["formControlName","url","id","url","type","text","title","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0441\u044b\u043b\u043a\u0443 \u043d\u0430 \u043c\u0430\u0433\u0430\u0437\u0438\u043d",1,"addModuleInput"],[1,"functionShopsModuleBtns"],["type","submit","title","\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043c\u0430\u0433\u0430\u0437\u0438\u043d",1,"submitAddModuleFormBtn",3,"disabled"],["class","deleteItemAddModuleBtn","title","\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043c\u0430\u0433\u0430\u0437\u0438\u043d",3,"click",4,"ngIf"],["title","\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043c\u0430\u0433\u0430\u0437\u0438\u043d",1,"deleteItemAddModuleBtn",3,"click"],["loading","lazy","src","/assets/images/deleteIcon.svg","alt","\u0423\u0434\u0430\u043b\u0438\u0442\u044c"],[1,"params"],["class","addModuleInputSpan",4,"ngIf"],["type","submit","title","\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e",1,"submitAddModuleFormBtn","additionalBtn",3,"disabled"],["for","category",1,"inputLabel"],["aria-placeholder","\u0414\u0438\u0432\u0430\u043d","name","category","id","category","title","\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044e",1,"categorySelect",3,"ngModelChange","ngModelOptions","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","width",1,"inputLabel"],["formControlName","width","placeholder","170","id","width","type","number","min","1","step","1","title","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0448\u0438\u0440\u0438\u043d\u0443",1,"addModuleInput",3,"ngClass"],["for","length",1,"inputLabel"],["formControlName","length","placeholder","150","id","length","type","number","min","1","step","1","title","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u043b\u0438\u043d\u0443",1,"addModuleInput",3,"ngClass"],["for","height",1,"inputLabel"],["formControlName","height","placeholder","100","id","height","type","number","min","1","step","1","title","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u044b\u0441\u043e\u0442\u0443",1,"addModuleInput",3,"ngClass"],[4,"ngIf"],[3,"value"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"filterSpan"],[1,"inputLabel",3,"for"],["type","number",1,"categorySelect",3,"ngModelChange","id","ngModel"],["type","number",1,"addModuleInput",3,"ngModelChange","id","ngModel"]],template:function(i,r){if(1&i){const o=rn();L(0,"span",5),Oe("click",function(a){let l;return qe(o),He(null!==(l=r.currentColorId)&&void 0!==l?l:r.openColorModule(a))}),L(1,"input",6),Pl("ngModelChange",function(a){return qe(o),bu(r.furnitureData.name,a)||(r.furnitureData.name=a),He(a)}),k(),L(2,"span",7),ze(3,hfe,2,0,"button",8)(4,pfe,1,2,"app-image-slider",9),k(),ze(5,gfe,3,0,"div",10),L(6,"span",11)(7,"span",12)(8,"span",13)(9,"button",14),Oe("click",function(a){return qe(o),He(r.openColorModule(a))}),Te(10,"img",15),k(),ze(11,_fe,2,3,"span",16),k(),Te(12,"input",17),k(),L(13,"span",18)(14,"span",19)(15,"div",20),re(16,"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"),k(),L(17,"textarea",21),Pl("ngModelChange",function(a){return qe(o),bu(r.furnitureData.description,a)||(r.furnitureData.description=a),He(a)}),k()(),L(18,"span",22)(19,"div",23),re(20,"\u041c\u0430\u0433\u0430\u0437\u0438\u043d\u044b"),k(),L(21,"span",24)(22,"span",25),ze(23,yfe,6,3,"button",26),k(),L(24,"button",27),Oe("click",function(){return qe(o),He(r.openShopsModule())}),Te(25,"img",15),k()(),L(26,"button",28),Oe("click",function(){return qe(o),He(r.openAdditional())}),re(27," \u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f "),k()()()()(),L(28,"div",29),ze(29,vfe,1,0,"ng-container",30),k(),ze(30,wfe,13,3,"ng-template",null,0,vs)(32,Sfe,20,5,"ng-template",null,1,vs)(34,Nfe,10,3,"ng-template",null,2,vs)(36,Lfe,5,5,"ng-template",null,3,vs)(38,kfe,4,4,"ng-template",null,4,vs)}2&i&&(q(),Rl("ngModel",r.furnitureData.name),q(2),ee("ngIf",void 0!==r.currentColorId&&r.furnitureData.colors[r.currentColorId].imagesData.images.length>0),q(),ee("ngIf",void 0!==r.currentColorId&&r.furnitureData.colors[r.currentColorId].imagesData.images.length>0),q(),ee("ngIf",void 0===r.currentColorId||void 0!==r.currentColorId&&r.furnitureData.colors[r.currentColorId].imagesData.images.length<=0),q(6),ee("ngIf",void 0!==r.furnitureData.colors),q(6),ee("mobileView",r.isMobileView),Rl("ngModel",r.furnitureData.description),q(6),ee("ngForOf",r.furnitureData.shops),q(6),ee("ngTemplateOutlet",r.addModuleTemplate))},dependencies:[yg,mg,pj,mj,Ed,uT,dT,hg,pg,fT,Ac,yh,sg,Sj,EG,Au,Cs,g_,iO,lT,hT],styles:['@font-face{font-family:Calypso;src:url(/assets/fonts/Calypso.ttf) format("truetype");font-weight:400}@font-face{font-family:Courier New;src:url(/assets/fonts/Courier\\ New.ttf) format("truetype");font-weight:400}*[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}html[_ngcontent-%COMP%]{scroll-behavior:smooth}img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}button[_ngcontent-%COMP%]:not(.colorVariant), .furnitureModelInput[_ngcontent-%COMP%]{transition:all .3s ease-in-out}button[_ngcontent-%COMP%]:not(.colorVariant):hover, .furnitureModelInput[_ngcontent-%COMP%]:hover{transform:translateY(-3px)}.body[_ngcontent-%COMP%]{background-color:#000;display:flex;flex-direction:column;gap:30px;margin:60px auto 0}.imageSlideSpan[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:1fr}.addModuleInput[_ngcontent-%COMP%]{border-radius:10px;background-color:transparent;border:#888888 1px solid;padding:10px;outline:none;color:#fff}.editImagesBtn[_ngcontent-%COMP%]{aspect-ratio:1;border:none;background:none;grid-area:1/1/2/2;align-self:start;z-index:4;justify-self:end;margin-top:-10px;margin-right:-10px}@media (max-width: 768px){.editImagesBtn[_ngcontent-%COMP%]{margin:0}}.editImagesBtn[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:25px;cursor:pointer}app-image-slider[_ngcontent-%COMP%]{width:100%;display:block;grid-area:1/1/2/2}.leftPiece[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.furnitureTitle[_ngcontent-%COMP%]{color:#fff;text-align:center;margin:0 auto;width:fit-content;background:none;border:none;outline:none;font-size:1.5vw}.uploadImagesDiv[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:1fr;width:60px;place-items:center;margin:60px auto}.uploadImagesInput[_ngcontent-%COMP%]{grid-area:1/1/2/2;border:none;background:none;width:100%;height:100%;cursor:pointer;opacity:0}.uploadImagesIcon[_ngcontent-%COMP%]{grid-area:1/1/2/2;width:100%}.colorSlider[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:1fr;place-items:center;width:30%;height:300px;aspect-ratio:1;position:relative;--radius: 60px}.colorVariant[_ngcontent-%COMP%]{--angle: calc(360deg / var(--total-items) * (var(--index) - 1));transform:rotate(var(--angle)) translate(var(--radius)) rotate(calc(-1 * var(--angle)))}.colors[_ngcontent-%COMP%]{grid-area:1/1/2/2;display:flex;justify-content:center;align-items:center;width:100%;height:100%;transition:all .5s ease-in-out}.colorVariant[_ngcontent-%COMP%]{cursor:pointer;position:absolute;width:40px;aspect-ratio:1;border:5px solid black;color:#fff;border-radius:50%;display:flex;justify-content:center;align-items:center;transition:all .5s ease-in-out;box-shadow:0 0 3px #fff}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]:nth-child(1){--index: 1}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]:nth-child(2){--index: 2}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]:nth-child(3){--index: 3}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]:nth-child(4){--index: 4}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]:nth-child(5){--index: 5}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]:nth-child(6){--index: 6}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]:nth-child(7){--index: 7}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]:nth-child(8){--index: 8}.addColorBtn[_ngcontent-%COMP%]{border-radius:50%;grid-area:1/1/2/2;width:40px;aspect-ratio:1;z-index:3;background-color:#000;border:none;display:flex;place-content:center;cursor:pointer;box-shadow:0 0 10px #fff}.addColorBtn[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:75%}.addModule[_ngcontent-%COMP%]{z-index:4;transition:all .5s ease-in-out;position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:#000000bf;display:flex;justify-content:center;align-items:center}.addModuleSpan[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:1fr}.addModuleFormContent[_ngcontent-%COMP%]{grid-area:1/1/2/2;width:25vw;min-width:350px;border-radius:10px;background-color:#000;padding:30px 45px;display:flex;flex-direction:column;gap:15px;box-shadow:0 0 10px #fff}.addModuleFormContent[_ngcontent-%COMP%]   .params[_ngcontent-%COMP%]{max-height:40vh;overflow-y:scroll;overflow-x:hidden}.addModuleInputSpan[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px;padding-right:5px}.inputLabel[_ngcontent-%COMP%]{color:#dad7cd;cursor:pointer;width:100%}.categorySelect[_ngcontent-%COMP%]{width:100%;background:none;border:1px solid #888888;border-radius:10px;padding:10px;background-color:#000;color:#fff;cursor:pointer}.addModuleInput[_ngcontent-%COMP%]{width:calc(100% - 20px);border-radius:10px;background-color:transparent;border:#888888 1px solid;padding:10px;outline:none;color:#fff}.addModuleTitle[_ngcontent-%COMP%]{color:#a3b18a;text-align:center;font-size:28px}.submitAddModuleFormBtn[_ngcontent-%COMP%]{background-color:#a3b18a;color:#fff;border-radius:10px;padding:15px;width:100%;border:none;cursor:pointer}.submitAddModuleFormBtn[_ngcontent-%COMP%]:disabled{background-color:#344e41}.disabled[_ngcontent-%COMP%]{filter:opacity(0);pointer-events:none}.closeAddModuleBtn[_ngcontent-%COMP%]{grid-area:1/1/2/2;background:none;border:none;z-index:3;width:30px;aspect-ratio:1;margin-right:10px;margin-top:10px;justify-self:end;cursor:pointer}.closeAddModuleBtn[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{transform:rotate(45deg)}.footer[_ngcontent-%COMP%]{width:100%;display:flex;background-color:#000}.informationSpan[_ngcontent-%COMP%]{display:flex;gap:5px;width:75%}.descriptionSpan[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;width:60%}.descriptionTitle[_ngcontent-%COMP%]{background-color:#344e41;color:#fff;border-radius:10px 0 0 10px;padding:15px;width:calc(100% - 30px);text-align:center}.descriptionInformation[_ngcontent-%COMP%]{color:#fff;padding:0 10px;min-height:300px;background:none;border:none;outline:none;resize:vertical}.rightFunctionalSection[_ngcontent-%COMP%]{width:40%;display:flex;height:100%;flex-direction:column;gap:20px}.additionalFunctions[_ngcontent-%COMP%]{width:100%;background-color:#a3b18a;border-radius:10px;border:none;color:#fff;font-size:115%;line-height:50px;height:50px;cursor:pointer}.shopsSpan[_ngcontent-%COMP%]{width:100%;height:calc(100% - 60px);display:flex;flex-direction:column;gap:10px;transition:all .5s ease-in-out}.shopsTitle[_ngcontent-%COMP%]{width:calc(100% - 30px);text-align:center;background-color:#344e41;border-radius:0 10px 10px 0;padding:15px;color:#fff}.shopFunctions[_ngcontent-%COMP%]{width:100%;display:flex;gap:5px;height:45px;background:none;padding:0;border:none;border-radius:10px;cursor:pointer}.furnitureCost[_ngcontent-%COMP%]{width:75%;background-color:#000;color:#fff;border-radius:10px 0 0 10px;align-content:center;text-align:center;border:2px solid rgba(163,177,138,.3)}.shopsListSpan[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.linkShop[_ngcontent-%COMP%]{width:25%;background-color:#000;border-radius:0 10px 10px 0;place-content:center;display:flex;border:2px solid rgba(163,177,138,.3)}.linkShop[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:40px}.addShopButton[_ngcontent-%COMP%]{background-color:#000;border:2px solid rgba(163,177,138,.3);display:flex;place-content:center;border-radius:10px;height:45px;cursor:pointer}.addShopButton[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:30px}.functionShopsModuleBtns[_ngcontent-%COMP%]{width:100%;display:flex;gap:10px}.deleteItemAddModuleBtn[_ngcontent-%COMP%]{border-radius:10px;background-color:#a3b18a;height:50px;width:20%;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer}.deleteItemAddModuleBtn[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{height:50%}.furnitureModelInput[_ngcontent-%COMP%]{color:#fff;cursor:pointer;border-radius:10px;box-shadow:0 0 5px #fff;height:30px;padding:10px;align-content:center;justify-content:center;display:flex}.furnitureModelInput[_ngcontent-%COMP%]::file-selector-button{color:transparent;border-radius:50%;height:100%;aspect-ratio:1;border:none;background-color:transparent;background-image:url(/assets/images/addIcon.svg);background-repeat:no-repeat}.furnitureModelLabel[_ngcontent-%COMP%]{color:#fff}@media (max-width: 1200px){.furnitureTitle[_ngcontent-%COMP%]{font-size:2vw}}@media (max-width: 1000px){app-create-furniture[_ngcontent-%COMP%]{width:calc(100% - 10px)}.leftPiece[_ngcontent-%COMP%]{gap:30px}.colorSlider[_ngcontent-%COMP%]{height:150px}.furnitureModelInput[_ngcontent-%COMP%]{height:25px}.furnitureTitle[_ngcontent-%COMP%]{font-size:2.5vw}}@media (max-width: 600px){.rightFunctionalSection[_ngcontent-%COMP%]{gap:10px}.furnitureTitle[_ngcontent-%COMP%]{font-size:3vw}.leftPiece[_ngcontent-%COMP%]{gap:0}.shopsTitle[_ngcontent-%COMP%], .descriptionTitle[_ngcontent-%COMP%]{border-radius:10px}.body[_ngcontent-%COMP%]{max-width:400px;margin-top:30px;gap:15px}.furnitureTitle[_ngcontent-%COMP%]{font-size:1.5rem;width:90%}.footer[_ngcontent-%COMP%]{flex-direction:column;gap:20px}.colorSlider[_ngcontent-%COMP%]{width:100%;height:200px;margin-bottom:20px}.informationSpan[_ngcontent-%COMP%]{width:100%;flex-direction:column}.descriptionSpan[_ngcontent-%COMP%], .rightFunctionalSection[_ngcontent-%COMP%]{width:100%}.addModuleFormContent[_ngcontent-%COMP%]{width:calc(85vw - 40px);min-width:none;padding:20px}.shopsSpan[_ngcontent-%COMP%]{height:auto}.furnitureModelInput[_ngcontent-%COMP%]{width:calc(100% - 20px);margin-top:10px}}.error-message[_ngcontent-%COMP%]{color:#f44;font-size:.8rem;margin-top:5px}.invalid[_ngcontent-%COMP%]{border-color:#f44!important;box-shadow:0 0 5px #ff444480}.addModuleInput.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#f44}']})}return n})();const Bfe=new be("WindowToken",typeof window<"u"&&window.document?{providedIn:"root",factory:()=>window}:{providedIn:"root",factory:()=>{}});let Ufe=(()=>{class n{constructor(t,i,r){this.ngZone=t,this.document=i,this.window=r,this.copySubject=new Xr,this.copyResponse$=this.copySubject.asObservable(),this.config={}}configure(t){this.config=t}copy(t){if(!this.isSupported||!t)return this.pushCopyResponse({isSuccess:!1,content:t});const i=this.copyFromContent(t);return this.pushCopyResponse(i?{content:t,isSuccess:i}:{isSuccess:!1,content:t})}get isSupported(){return!!this.document.queryCommandSupported&&!!this.document.queryCommandSupported("copy")&&!!this.window}isTargetValid(t){if(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement){if(t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');return!0}throw new Error("Target should be input or textarea")}copyFromInputElement(t,i=!0){try{this.selectTarget(t);const r=this.copyText();return this.clearSelection(i?t:void 0,this.window),r&&this.isCopySuccessInIE11()}catch{return!1}}isCopySuccessInIE11(){const t=this.window.clipboardData;return!(t&&t.getData&&!t.getData("Text"))}copyFromContent(t,i=this.document.body){if(this.tempTextArea&&!i.contains(this.tempTextArea)&&this.destroy(this.tempTextArea.parentElement||void 0),!this.tempTextArea){this.tempTextArea=this.createTempTextArea(this.document,this.window);try{i.appendChild(this.tempTextArea)}catch{throw new Error("Container should be a Dom element")}}this.tempTextArea.value=t;const r=this.copyFromInputElement(this.tempTextArea,!1);return this.config.cleanUpAfterCopy&&this.destroy(this.tempTextArea.parentElement||void 0),r}destroy(t=this.document.body){this.tempTextArea&&(t.removeChild(this.tempTextArea),this.tempTextArea=void 0)}selectTarget(t){return t.select(),t.setSelectionRange(0,t.value.length),t.value.length}copyText(){return this.document.execCommand("copy")}clearSelection(t,i){t&&t.focus(),i.getSelection()?.removeAllRanges()}createTempTextArea(t,i){const r="rtl"===t.documentElement.getAttribute("dir");let o;return o=t.createElement("textarea"),o.style.fontSize="12pt",o.style.border="0",o.style.padding="0",o.style.margin="0",o.style.position="absolute",o.style[r?"right":"left"]="-9999px",o.style.top=(i.pageYOffset||t.documentElement.scrollTop)+"px",o.setAttribute("readonly",""),o}pushCopyResponse(t){this.copySubject.observers.length>0&&this.ngZone.run(()=>{this.copySubject.next(t)})}pushCopyReponse(t){this.pushCopyResponse(t)}}return n.\u0275fac=function(t){return new(t||n)(Ze(Hn),Ze(fr),Ze(Bfe,8))},n.\u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Dw=(()=>{class n{httpModule;baseServiceUrl=Es+"furniture/card";constructor(t){this.httpModule=t}GETfurnitureCard(t,i){var r=this;return N(function*(){let o=(new di).set("furnitureCardId",t);void 0!==i&&(o=o.set("jwt",i));try{const s=yield nr(r.httpModule.get(r.baseServiceUrl,{params:o}));if(!s?.furnitureCard)throw new Error("Invalid response structure: furnitureCard missing");return{furnitureCard:{...s.furnitureCard,colors:s.furnitureCard.colors.map(l=>({color:l.color,imagesData:{idMainImage:l.imagesData.idMainImage,images:l.imagesData.images.map(u=>Es+u)}}))},authorMatched:s.authorMatched}}catch(s){throw s}})()}POSTcreateFurnitureCard(t,i){let r=(new di).set("jwt",i);return nr(this.httpModule.post(this.baseServiceUrl,t,{params:r}))}PUTupdateFurnitureCard(t,i,r){let o=(new di).set("jwt",r).set("furnitureCardId",i);return nr(this.httpModule.put(this.baseServiceUrl,t,{params:o}))}DELETEfurnitureCard(t,i){const r=(new di).set("jwt",t).set("furnitureCardId",i);return nr(this.httpModule.delete(this.baseServiceUrl,{params:r}))}static \u0275fac=function(i){return new(i||n)(Ze(Mu))};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Vfe(n,e){if(1&n&&Te(0,"app-image-slider",18),2&n){const t=me(2);ee("imagesData",t.furnitureData.colors[t.currentColorId].imagesData)}}function Hfe(n,e){1&n&&(L(0,"div",19),Te(1,"input",20)(2,"img",21),k())}function zfe(n,e){if(1&n){const t=rn();L(0,"button",22),Oe("click",function(r){return qe(t),He(me(2).openFurnitureVariant(r.target))}),k()}if(2&n){const i=e.index;oo("background-color",e.$implicit.color),$s("data-idColor",i)}}function Gfe(n,e){if(1&n){const t=rn();L(0,"span",23)(1,"a",24),re(2),r_(3,"costFormat"),k(),L(4,"button",25),Oe("click",function(){const r=qe(t).$implicit;return He(me(2).copyShopLink(r.url))}),Te(5,"img",26),k()()}if(2&n){const t=e.$implicit;q(),ee("href",t.url,mc),q(),Ei(o_(3,3,t.cost)),q(2),ee("title","\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443: "+t.url)}}function jfe(n,e){if(1&n&&(L(0,"span",1)(1,"h1",2),re(2),k(),ze(3,Vfe,1,1,"app-image-slider",3)(4,Hfe,3,0,"div",4),L(5,"span",5)(6,"span",6),Te(7,"img",7),L(8,"span",8),ze(9,zfe,1,3,"button",9),k()(),L(10,"span",10)(11,"span",11)(12,"div",12),re(13,"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"),k(),L(14,"div",13),re(15),k()(),L(16,"span",14)(17,"div",15),re(18,"\u041c\u0430\u0433\u0430\u0437\u0438\u043d\u044b"),k(),L(19,"span",16),ze(20,Gfe,6,5,"span",17),k()()()()()),2&n){const t=me();q(2),Ei(t.furnitureData.name),q(),ee("ngIf",t.furnitureData.colors[t.currentColorId].imagesData),q(),ee("ngIf",!t.furnitureData.colors[t.currentColorId].imagesData),q(4),oo("--total-items",t.furnitureData.colors.length.toString()),q(),ee("ngForOf",t.furnitureData.colors),q(6),Ei(t.proccessDescription(t.furnitureData.description,t.furnitureData.proportions)),q(5),ee("ngForOf",t.furnitureData.shops)}}let Tj=(()=>{class n{elementRef;clipboardService;furnitureCardService;notification;router;constructor(t,i,r,o,s){this.elementRef=t,this.clipboardService=i,this.furnitureCardService=r,this.notification=o,this.router=s}currentColorId=0;furnitureCardId;furnitureData;ngOnChanges(){var t=this;return N(function*(){if(void 0!==t.furnitureCardId)try{const i=yield t.furnitureCardService.GETfurnitureCard(t.furnitureCardId);t.furnitureData=i.furnitureCard}catch(i){t.notification.setError("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438",5e3),t.router.navigateByUrl("/shop"),console.log(i)}})()}openFurnitureVariant(t){const i=t,r=this.elementRef.nativeElement.querySelector(".colors"),o=i.getAttribute("data-idcolor");if(!o)return;const s=r.querySelectorAll(".colorVariant");let a=[],l=[];s.forEach((u,c)=>{c>+o?l=[...l,u]:c<+o&&(a=[...a,u])}),[i,...l,...a].forEach((u,c)=>{u.style.setProperty("--index",(c+1).toString())}),setTimeout(()=>{i.style.setProperty("margin-right","115px")},500),setTimeout(()=>{this.currentColorId=+o,i.style.setProperty("margin-right","0")},1250)}proccessDescription(t,i){return`\u0428\u0438\u0440\u0438\u043d\u0430: ${i.width} \u0441\u043c\n\u0414\u043b\u0438\u043d\u0430: ${i.length} \u0441\u043c\n\u0412\u044b\u0441\u043e\u0442\u0430: ${i.height} \u0441\u043c\n${t}`}copyShopLink(t){this.clipboardService.copyFromContent(t)}static \u0275fac=function(i){return new(i||n)(se(gi),se(Ufe),se(Dw),se(kl),se(Ea))};static \u0275cmp=mo({type:n,selectors:[["app-view-furniture"]],inputs:{furnitureCardId:"furnitureCardId",furnitureData:"furnitureData"},features:[as],decls:1,vars:1,consts:[["class","body",4,"ngIf"],[1,"body"],["title","\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0431\u0435\u043b\u0438",1,"furnitureTitle"],[3,"imagesData",4,"ngIf"],["class","uploadImagesDiv",4,"ngIf"],[1,"footer"],[1,"colorSlider"],["loading","lazy","src","assets/images/paletteIcon.svg","alt","\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0446\u0432\u0435\u0442","title","\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0446\u0432\u0435\u0442",1,"addColorBtn"],[1,"colors"],["class","colorVariant","title","\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0446\u0432\u0435\u0442",3,"background-color","click",4,"ngFor","ngForOf"],[1,"informationSpan"],[1,"descriptionSpan"],["title","\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",1,"descriptionTitle"],["title","\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043c\u0435\u0431\u0435\u043b\u0438",1,"descriptionInformation"],[1,"shopsSpan"],["title","\u041c\u0430\u0433\u0430\u0437\u0438\u043d\u044b",1,"shopsTitle"],[1,"shopsListSpan"],["class","shopFunctions",4,"ngFor","ngForOf"],[3,"imagesData"],[1,"uploadImagesDiv"],["type","file","accept",".png,.jpeg","title","\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f",1,"uploadImagesInput"],["loading","lazy","src","assets/images/uploadIcon.png","alt","\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c",1,"uploadImagesIcon"],["title","\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0446\u0432\u0435\u0442",1,"colorVariant",3,"click"],[1,"shopFunctions"],["title","\u0426\u0435\u043d\u0430",1,"furnitureCost",3,"href"],[1,"linkShop",3,"click","title"],["loading","lazy","src","assets/images/linkIcon.svg","alt","\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443"]],template:function(i,r){1&i&&ze(0,jfe,21,8,"span",0),2&i&&ee("ngIf",r.furnitureData)},dependencies:[EG,Au,Cs,yg,hT],styles:['@font-face{font-family:Calypso;src:url(/assets/fonts/Calypso.ttf) format("truetype");font-weight:400}@font-face{font-family:Courier New;src:url(/assets/fonts/Courier\\ New.ttf) format("truetype");font-weight:400}*[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}html[_ngcontent-%COMP%]{scroll-behavior:smooth}img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.body[_ngcontent-%COMP%]{background-color:#000;display:flex;flex-direction:column;gap:30px;margin-bottom:15px;position:relative}.furnitureTitle[_ngcontent-%COMP%]{color:#fff;text-align:center;margin:0}.uploadImagesDiv[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:1fr;width:60px;place-items:center;margin:60px auto}.uploadImagesInput[_ngcontent-%COMP%]{grid-area:1/1/2/2;border:none;background:none;width:100%;height:100%;cursor:pointer;opacity:0}.uploadImagesIcon[_ngcontent-%COMP%]{grid-area:1/1/2/2;width:100%}.colorSlider[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:1fr;place-items:center;width:30%;height:200px;aspect-ratio:1;position:relative;--radius: 60px}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]{--angle: calc(360deg / var(--total-items) * (var(--index) - 1));transform:rotate(var(--angle)) translate(var(--radius)) rotate(calc(-1 * var(--angle)))}.colors[_ngcontent-%COMP%]{grid-area:1/1/2/2;display:flex;justify-content:center;align-items:center;width:100%;height:100%;transition:all .5s ease-in-out}.colorVariant[_ngcontent-%COMP%]{cursor:pointer;box-shadow:0 0 10px #fff;position:absolute;width:40px;aspect-ratio:1;border:5px solid black;color:#fff;border-radius:50%;display:flex;justify-content:center;align-items:center;transition:all .5s ease-in-out}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]:nth-child(1){--index: 1}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]:nth-child(2){--index: 2}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]:nth-child(3){--index: 3}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]:nth-child(4){--index: 4}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]:nth-child(5){--index: 5}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]:nth-child(6){--index: 6}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]:nth-child(7){--index: 7}.colors[_ngcontent-%COMP%] > .colorVariant[_ngcontent-%COMP%]:nth-child(8){--index: 8}.addColorBtn[_ngcontent-%COMP%]{border-radius:50%;grid-area:1/1/2/2;width:30px;aspect-ratio:1;z-index:3;padding:5px;background-color:#000;display:flex;place-content:center;cursor:pointer;box-shadow:0 0 10px #fff}.footer[_ngcontent-%COMP%]{width:100%;display:flex;background-color:#000}.informationSpan[_ngcontent-%COMP%]{display:flex;gap:5px;width:75%}.descriptionSpan[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;width:60%}.descriptionTitle[_ngcontent-%COMP%]{background-color:#344e41;color:#fff;border-radius:10px 0 0 10px;padding:15px;width:calc(100% - 30px);text-align:center}.descriptionInformation[_ngcontent-%COMP%]{color:#fff;padding:0 10px;white-space:pre-line;font-size:16px}.shopsSpan[_ngcontent-%COMP%]{width:40%;display:flex;flex-direction:column;gap:10px;transition:all .5s ease-in-out}.shopsTitle[_ngcontent-%COMP%]{width:calc(100% - 30px);text-align:center;background-color:#344e41;border-radius:0 10px 10px 0;padding:15px;color:#fff}.shopFunctions[_ngcontent-%COMP%]{width:100%;display:flex;gap:5px;height:45px;background:none;padding:0;border:none;border-radius:10px;cursor:pointer}.furnitureCost[_ngcontent-%COMP%]{width:75%;background-color:#a3b18a;color:#fff;border-radius:10px 0 0 10px;align-content:center;text-align:center;box-shadow:0 0 10px #fff;border:none;text-decoration:none}.shopsListSpan[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.linkShop[_ngcontent-%COMP%]{width:25%;background-color:#a3b18a;border-radius:0 10px 10px 0;border:none;place-content:center;display:flex;box-shadow:0 0 10px #fff;transition:all .5s ease-in-out;cursor:copy}.linkShop[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:40px}@media (max-width: 1200px){.furnitureTitle[_ngcontent-%COMP%]{font-size:2vw}}@media (max-width: 1000px){app-view-furniture[_ngcontent-%COMP%]{width:calc(100% - 10px)}.colorSlider[_ngcontent-%COMP%]{height:200px}.furnitureTitle[_ngcontent-%COMP%]{font-size:2.5vw}}@media (max-width: 600px){.body[_ngcontent-%COMP%]{max-width:400px;margin:30px auto;gap:15px}.furnitureTitle[_ngcontent-%COMP%]{font-size:1.5rem;width:90%}.footer[_ngcontent-%COMP%]{flex-direction:column;gap:20px}.colorSlider[_ngcontent-%COMP%]{width:100%;height:200px;margin-bottom:20px}.informationSpan[_ngcontent-%COMP%]{width:100%;flex-direction:column}.descriptionSpan[_ngcontent-%COMP%], .shopsSpan[_ngcontent-%COMP%]{width:100%}.descriptionTitle[_ngcontent-%COMP%], .shopsTitle[_ngcontent-%COMP%]{border-radius:10px}.descriptionInformation[_ngcontent-%COMP%]{padding:0 10px}}']})}return n})();const Ad=0,Ta=1,Dc=2,vg=100,Yfe=101,Zfe=102,Qfe=200,ehe=201,the=202,nhe=203,aO=204,lO=205,ihe=206,rhe=207,ohe=208,she=209,ahe=210,lhe=211,uhe=212,che=213,dhe=214,uO=0,cO=1,dO=2,C_=3,fO=4,hO=5,pO=6,gO=7,Oj="attached",Dd=1e3,Aa=1001,Pw=1002,Fo=1003,_O=1004,S_=1005,zr=1006,Ow=1007,Ru=1008,Ic=1009,Nw=1012,xh=1014,nl=1015,Fw=1016,Lw=1020,Da=1023,kw=1026,Bw=1027,yT=33776,vT=33777,bT=33778,wT=33779,xT=36492,Uw=2300,Vw=2301,fi="srgb",Js="srgb-linear",CT="linear",ki="srgb",A_=7680,Dhe=512,Ihe=513,Rhe=514,jj=515,Phe=516,Ohe=517,Nhe=518,Fhe=519,Pu=2e3;class Id{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){const i=this._listeners;return void 0!==i&&void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){const i=this._listeners;if(void 0===i)return;const r=i[e];if(void 0!==r){const o=r.indexOf(t);-1!==o&&r.splice(o,1)}}dispatchEvent(e){const t=this._listeners;if(void 0===t)return;const i=t[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let o=0,s=r.length;o<s;o++)r[o].call(this,e);e.target=null}}}const Ts=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const xg=Math.PI/180,D_=180/Math.PI;function il(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Ts[255&n]+Ts[n>>8&255]+Ts[n>>16&255]+Ts[n>>24&255]+"-"+Ts[255&e]+Ts[e>>8&255]+"-"+Ts[e>>16&15|64]+Ts[e>>24&255]+"-"+Ts[63&t|128]+Ts[t>>8&255]+"-"+Ts[t>>16&255]+Ts[t>>24&255]+Ts[255&i]+Ts[i>>8&255]+Ts[i>>16&255]+Ts[i>>24&255]).toLowerCase()}function _n(n,e,t){return Math.max(e,Math.min(t,n))}function QO(n,e){return(n%e+e)%e}function Hw(n,e,t){return(1-t)*n+t*e}function Qs(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Sn(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(4294967295*n);case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int32Array:return Math.round(2147483647*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const Pr_DEG2RAD=xg,Pr_degToRad=function $he(n){return n*xg},Pr_radToDeg=function qhe(n){return n*D_};class xe{constructor(e=0,t=0){xe.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=_n(this.x,e.x,t.x),this.y=_n(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=_n(this.x,e,t),this.y=_n(this.y,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(_n(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(_n(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),o=this.x-e.x,s=this.y-e.y;return this.x=o*i-s*r+e.x,this.y=o*r+s*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class vn{constructor(e,t,i,r,o,s,a,l,u){vn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,o,s,a,l,u)}set(e,t,i,r,o,s,a,l,u){const c=this.elements;return c[0]=e,c[1]=r,c[2]=a,c[3]=t,c[4]=o,c[5]=l,c[6]=i,c[7]=s,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,o=this.elements,s=i[0],a=i[3],l=i[6],u=i[1],c=i[4],f=i[7],h=i[2],g=i[5],m=i[8],v=r[0],_=r[3],y=r[6],w=r[1],x=r[4],M=r[7],D=r[2],E=r[5],I=r[8];return o[0]=s*v+a*w+l*D,o[3]=s*_+a*x+l*E,o[6]=s*y+a*M+l*I,o[1]=u*v+c*w+f*D,o[4]=u*_+c*x+f*E,o[7]=u*y+c*M+f*I,o[2]=h*v+g*w+m*D,o[5]=h*_+g*x+m*E,o[8]=h*y+g*M+m*I,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t*s*c-t*a*u-i*o*c+i*a*l+r*o*u-r*s*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],f=c*s-a*u,h=a*l-c*o,g=u*o-s*l,m=t*f+i*h+r*g;if(0===m)return this.set(0,0,0,0,0,0,0,0,0);const v=1/m;return e[0]=f*v,e[1]=(r*u-c*i)*v,e[2]=(a*i-r*s)*v,e[3]=h*v,e[4]=(c*t-r*l)*v,e[5]=(r*o-a*t)*v,e[6]=g*v,e[7]=(i*l-u*t)*v,e[8]=(s*t-i*o)*v,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,o,s,a){const l=Math.cos(o),u=Math.sin(o);return this.set(i*l,i*u,-i*(l*s+u*a)+s+e,-r*u,r*l,-r*(-u*s+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(eN.makeScale(e,t)),this}rotate(e){return this.premultiply(eN.makeRotation(-e)),this}translate(e,t){return this.premultiply(eN.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const eN=new vn;function qj(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function zw(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function Qhe(){const n=zw("canvas");return n.style.display="block",n}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const Xj={};function TT(n){n in Xj||(Xj[n]=!0,console.warn(n))}const Yj=(new vn).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Zj=(new vn).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function ipe(){const n={enabled:!0,workingColorSpace:Js,spaces:{},convert:function(r,o,s){return!1===this.enabled||o===s||!o||!s||(this.spaces[o].transfer===ki&&(r.r=Rd(r.r),r.g=Rd(r.g),r.b=Rd(r.b)),this.spaces[o].primaries!==this.spaces[s].primaries&&(r.applyMatrix3(this.spaces[o].toXYZ),r.applyMatrix3(this.spaces[s].fromXYZ)),this.spaces[s].transfer===ki&&(r.r=R_(r.r),r.g=R_(r.g),r.b=R_(r.b))),r},fromWorkingColorSpace:function(r,o){return this.convert(r,this.workingColorSpace,o)},toWorkingColorSpace:function(r,o){return this.convert(r,o,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return""===r?CT:this.spaces[r].transfer},getLuminanceCoefficients:function(r,o=this.workingColorSpace){return r.fromArray(this.spaces[o].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,o,s){return r.copy(this.spaces[o].toXYZ).multiply(this.spaces[s].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],i=[.3127,.329];return n.define({[Js]:{primaries:e,whitePoint:i,transfer:CT,toXYZ:Yj,fromXYZ:Zj,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:fi},outputColorSpaceConfig:{drawingBufferColorSpace:fi}},[fi]:{primaries:e,whitePoint:i,transfer:ki,toXYZ:Yj,fromXYZ:Zj,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:fi}}}),n}const bn=ipe();function Rd(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function R_(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}let P_;class rpe{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{void 0===P_&&(P_=zw("canvas")),P_.width=e.width,P_.height=e.height;const r=P_.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),i=P_}return i.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=zw("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),o=r.data;for(let s=0;s<o.length;s++)o[s]=255*Rd(o[s]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Rd(t[i]/255)):Rd(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let ope=0;class Mg{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:ope++}),this.uuid=il(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let o;if(Array.isArray(r)){o=[];for(let s=0,a=r.length;s<a;s++)o.push(tN(r[s].isDataTexture?r[s].image:r[s]))}else o=tN(r);i.url=o}return t||(e.images[this.uuid]=i),i}}function tN(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?rpe.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let spe=0,Jo=(()=>{class n extends Id{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=Aa,o=Aa,s=zr,a=Ru,l=Da,u=Ic,c=n.DEFAULT_ANISOTROPY,f=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:spe++}),this.uuid=il(),this.name="",this.source=new Mg(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=o,this.magFilter=s,this.minFilter=a,this.anisotropy=c,this.format=l,this.internalFormat=null,this.type=u,this.offset=new xe(0,0),this.repeat=new xe(1,1),this.center=new xe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new vn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=f,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isTextureArray=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.isTextureArray=t.isTextureArray,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Dd:t.x=t.x-Math.floor(t.x);break;case Aa:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Dd:t.y=t.y-Math.floor(t.y);break;case Aa:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){!0===t&&this.pmremVersion++}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class $n{constructor(e=0,t=0,i=0,r=1){$n.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,o=this.w,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r+s[12]*o,this.y=s[1]*t+s[5]*i+s[9]*r+s[13]*o,this.z=s[2]*t+s[6]*i+s[10]*r+s[14]*o,this.w=s[3]*t+s[7]*i+s[11]*r+s[15]*o,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,o;const l=e.elements,u=l[0],c=l[4],f=l[8],h=l[1],g=l[5],m=l[9],v=l[2],_=l[6],y=l[10];if(Math.abs(c-h)<.01&&Math.abs(f-v)<.01&&Math.abs(m-_)<.01){if(Math.abs(c+h)<.1&&Math.abs(f+v)<.1&&Math.abs(m+_)<.1&&Math.abs(u+g+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const x=(u+1)/2,M=(g+1)/2,D=(y+1)/2,E=(c+h)/4,I=(f+v)/4,R=(m+_)/4;return x>M&&x>D?x<.01?(i=0,r=.707106781,o=.707106781):(i=Math.sqrt(x),r=E/i,o=I/i):M>D?M<.01?(i=.707106781,r=0,o=.707106781):(r=Math.sqrt(M),i=E/r,o=R/r):D<.01?(i=.707106781,r=.707106781,o=0):(o=Math.sqrt(D),i=I/o,r=R/o),this.set(i,r,o,t),this}let w=Math.sqrt((_-m)*(_-m)+(f-v)*(f-v)+(h-c)*(h-c));return Math.abs(w)<.001&&(w=1),this.x=(_-m)/w,this.y=(f-v)/w,this.z=(h-c)/w,this.w=Math.acos((u+g+y-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=_n(this.x,e.x,t.x),this.y=_n(this.y,e.y,t.y),this.z=_n(this.z,e.z,t.z),this.w=_n(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=_n(this.x,e,t),this.y=_n(this.y,e,t),this.z=_n(this.z,e,t),this.w=_n(this.w,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(_n(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class nN extends Id{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=i.depth?i.depth:1,this.scissor=new $n(0,0,e,t),this.scissorTest=!1,this.viewport=new $n(0,0,e,t);const r={width:e,height:t,depth:this.depth};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:zr,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,multiview:!1},i);const o=new Jo(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);o.flipY=!1,o.generateMipmaps=i.generateMipmaps,o.internalFormat=i.internalFormat,this.textures=[];const s=i.count;for(let a=0;a<s;a++)this.textures[a]=o.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==e&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,o=this.textures.length;r<o;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,i=e.textures.length;t<i;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new Mg(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Pd extends nN{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class AT extends Jo{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Fo,this.minFilter=Fo,this.wrapR=Aa,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class iN extends Jo{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Fo,this.minFilter=Fo,this.wrapR=Aa,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class hr{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,o,s,a){let l=i[r+0],u=i[r+1],c=i[r+2],f=i[r+3];const h=o[s+0],g=o[s+1],m=o[s+2],v=o[s+3];if(0===a)return e[t+0]=l,e[t+1]=u,e[t+2]=c,void(e[t+3]=f);if(1===a)return e[t+0]=h,e[t+1]=g,e[t+2]=m,void(e[t+3]=v);if(f!==v||l!==h||u!==g||c!==m){let _=1-a;const y=l*h+u*g+c*m+f*v,w=y>=0?1:-1,x=1-y*y;if(x>Number.EPSILON){const D=Math.sqrt(x),E=Math.atan2(D,y*w);_=Math.sin(_*E)/D,a=Math.sin(a*E)/D}const M=a*w;if(l=l*_+h*M,u=u*_+g*M,c=c*_+m*M,f=f*_+v*M,_===1-a){const D=1/Math.sqrt(l*l+u*u+c*c+f*f);l*=D,u*=D,c*=D,f*=D}}e[t]=l,e[t+1]=u,e[t+2]=c,e[t+3]=f}static multiplyQuaternionsFlat(e,t,i,r,o,s){const a=i[r],l=i[r+1],u=i[r+2],c=i[r+3],f=o[s],h=o[s+1],g=o[s+2],m=o[s+3];return e[t]=a*m+c*f+l*g-u*h,e[t+1]=l*m+c*h+u*f-a*g,e[t+2]=u*m+c*g+a*h-l*f,e[t+3]=c*m-a*f-l*h-u*g,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,r=e._y,o=e._z,s=e._order,a=Math.cos,l=Math.sin,u=a(i/2),c=a(r/2),f=a(o/2),h=l(i/2),g=l(r/2),m=l(o/2);switch(s){case"XYZ":this._x=h*c*f+u*g*m,this._y=u*g*f-h*c*m,this._z=u*c*m+h*g*f,this._w=u*c*f-h*g*m;break;case"YXZ":this._x=h*c*f+u*g*m,this._y=u*g*f-h*c*m,this._z=u*c*m-h*g*f,this._w=u*c*f+h*g*m;break;case"ZXY":this._x=h*c*f-u*g*m,this._y=u*g*f+h*c*m,this._z=u*c*m+h*g*f,this._w=u*c*f-h*g*m;break;case"ZYX":this._x=h*c*f-u*g*m,this._y=u*g*f+h*c*m,this._z=u*c*m-h*g*f,this._w=u*c*f+h*g*m;break;case"YZX":this._x=h*c*f+u*g*m,this._y=u*g*f+h*c*m,this._z=u*c*m-h*g*f,this._w=u*c*f-h*g*m;break;case"XZY":this._x=h*c*f-u*g*m,this._y=u*g*f-h*c*m,this._z=u*c*m+h*g*f,this._w=u*c*f+h*g*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],o=t[8],s=t[1],a=t[5],l=t[9],u=t[2],c=t[6],f=t[10],h=i+a+f;if(h>0){const g=.5/Math.sqrt(h+1);this._w=.25/g,this._x=(c-l)*g,this._y=(o-u)*g,this._z=(s-r)*g}else if(i>a&&i>f){const g=2*Math.sqrt(1+i-a-f);this._w=(c-l)/g,this._x=.25*g,this._y=(r+s)/g,this._z=(o+u)/g}else if(a>f){const g=2*Math.sqrt(1+a-i-f);this._w=(o-u)/g,this._x=(r+s)/g,this._y=.25*g,this._z=(l+c)/g}else{const g=2*Math.sqrt(1+f-i-a);this._w=(s-r)/g,this._x=(o+u)/g,this._y=(l+c)/g,this._z=.25*g}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(_n(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,o=e._z,s=e._w,a=t._x,l=t._y,u=t._z,c=t._w;return this._x=i*c+s*a+r*u-o*l,this._y=r*c+s*l+o*a-i*u,this._z=o*c+s*u+i*l-r*a,this._w=s*c-i*a-r*l-o*u,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,o=this._z,s=this._w;let a=s*e._w+i*e._x+r*e._y+o*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=i,this._y=r,this._z=o,this;const l=1-a*a;if(l<=Number.EPSILON){const g=1-t;return this._w=g*s+t*this._w,this._x=g*i+t*this._x,this._y=g*r+t*this._y,this._z=g*o+t*this._z,this.normalize(),this}const u=Math.sqrt(l),c=Math.atan2(u,a),f=Math.sin((1-t)*c)/u,h=Math.sin(t*c)/u;return this._w=s*f+this._w*h,this._x=i*f+this._x*h,this._y=r*f+this._y*h,this._z=o*f+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),o=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),o*Math.sin(t),o*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class U{constructor(e=0,t=0,i=0){U.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Kj.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Kj.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[3]*i+o[6]*r,this.y=o[1]*t+o[4]*i+o[7]*r,this.z=o[2]*t+o[5]*i+o[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,o=e.elements,s=1/(o[3]*t+o[7]*i+o[11]*r+o[15]);return this.x=(o[0]*t+o[4]*i+o[8]*r+o[12])*s,this.y=(o[1]*t+o[5]*i+o[9]*r+o[13])*s,this.z=(o[2]*t+o[6]*i+o[10]*r+o[14])*s,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,o=e.x,s=e.y,a=e.z,l=e.w,u=2*(s*r-a*i),c=2*(a*t-o*r),f=2*(o*i-s*t);return this.x=t+l*u+s*f-a*c,this.y=i+l*c+a*u-o*f,this.z=r+l*f+o*c-s*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r,this.y=o[1]*t+o[5]*i+o[9]*r,this.z=o[2]*t+o[6]*i+o[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=_n(this.x,e.x,t.x),this.y=_n(this.y,e.y,t.y),this.z=_n(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=_n(this.x,e,t),this.y=_n(this.y,e,t),this.z=_n(this.z,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(_n(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,o=e.z,s=t.x,a=t.y,l=t.z;return this.x=r*l-o*a,this.y=o*s-i*l,this.z=i*a-r*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return rN.copy(this).projectOnVector(e),this.sub(rN)}reflect(e){return this.sub(rN.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(_n(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const rN=new U,Kj=new hr;class Qo{constructor(e=new U(1/0,1/0,1/0),t=new U(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Ou.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Ou.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Ou.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i){const o=i.getAttribute("position");if(!0===t&&void 0!==o&&!0!==e.isInstancedMesh)for(let s=0,a=o.count;s<a;s++)!0===e.isMesh?e.getVertexPosition(s,Ou):Ou.fromBufferAttribute(o,s),Ou.applyMatrix4(e.matrixWorld),this.expandByPoint(Ou);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),DT.copy(e.boundingBox)):(null===i.boundingBox&&i.computeBoundingBox(),DT.copy(i.boundingBox)),DT.applyMatrix4(e.matrixWorld),this.union(DT)}const r=e.children;for(let o=0,s=r.length;o<s;o++)this.expandByObject(r[o],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Ou),Ou.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Gw),IT.subVectors(this.max,Gw),O_.subVectors(e.a,Gw),N_.subVectors(e.b,Gw),F_.subVectors(e.c,Gw),Ch.subVectors(N_,O_),Sh.subVectors(F_,N_),Cg.subVectors(O_,F_);let t=[0,-Ch.z,Ch.y,0,-Sh.z,Sh.y,0,-Cg.z,Cg.y,Ch.z,0,-Ch.x,Sh.z,0,-Sh.x,Cg.z,0,-Cg.x,-Ch.y,Ch.x,0,-Sh.y,Sh.x,0,-Cg.y,Cg.x,0];return!(!oN(t,O_,N_,F_,IT)||(t=[1,0,0,0,1,0,0,0,1],!oN(t,O_,N_,F_,IT)))&&(RT.crossVectors(Ch,Sh),t=[RT.x,RT.y,RT.z],oN(t,O_,N_,F_,IT))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ou).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Ou).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Od[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Od[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Od[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Od[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Od[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Od[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Od[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Od[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Od)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Od=[new U,new U,new U,new U,new U,new U,new U,new U],Ou=new U,DT=new Qo,O_=new U,N_=new U,F_=new U,Ch=new U,Sh=new U,Cg=new U,Gw=new U,IT=new U,RT=new U,Sg=new U;function oN(n,e,t,i,r){for(let o=0,s=n.length-3;o<=s;o+=3){Sg.fromArray(n,o);const a=r.x*Math.abs(Sg.x)+r.y*Math.abs(Sg.y)+r.z*Math.abs(Sg.z),l=e.dot(Sg),u=t.dot(Sg),c=i.dot(Sg);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>a)return!1}return!0}const ape=new Qo,jw=new U,sN=new U;class es{constructor(e=new U,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):ape.setFromPoints(e).getCenter(i);let r=0;for(let o=0,s=e.length;o<s;o++)r=Math.max(r,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;jw.subVectors(e,this.center);const t=jw.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(jw,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(sN.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(jw.copy(e.center).add(sN)),this.expandByPoint(jw.copy(e.center).sub(sN))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Nd=new U,aN=new U,PT=new U,Eh=new U,lN=new U,OT=new U,uN=new U;class L_{constructor(e=new U,t=new U(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Nd)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Nd.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Nd.copy(this.origin).addScaledVector(this.direction,t),Nd.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){aN.copy(e).add(t).multiplyScalar(.5),PT.copy(t).sub(e).normalize(),Eh.copy(this.origin).sub(aN);const o=.5*e.distanceTo(t),s=-this.direction.dot(PT),a=Eh.dot(this.direction),l=-Eh.dot(PT),u=Eh.lengthSq(),c=Math.abs(1-s*s);let f,h,g,m;if(c>0)if(f=s*l-a,h=s*a-l,m=o*c,f>=0)if(h>=-m)if(h<=m){const v=1/c;f*=v,h*=v,g=f*(f+s*h+2*a)+h*(s*f+h+2*l)+u}else h=o,f=Math.max(0,-(s*h+a)),g=-f*f+h*(h+2*l)+u;else h=-o,f=Math.max(0,-(s*h+a)),g=-f*f+h*(h+2*l)+u;else h<=-m?(f=Math.max(0,-(-s*o+a)),h=f>0?-o:Math.min(Math.max(-o,-l),o),g=-f*f+h*(h+2*l)+u):h<=m?(f=0,h=Math.min(Math.max(-o,-l),o),g=h*(h+2*l)+u):(f=Math.max(0,-(s*o+a)),h=f>0?o:Math.min(Math.max(-o,-l),o),g=-f*f+h*(h+2*l)+u);else h=s>0?-o:o,f=Math.max(0,-(s*h+a)),g=-f*f+h*(h+2*l)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,f),r&&r.copy(aN).addScaledVector(PT,h),g}intersectSphere(e,t){Nd.subVectors(e.center,this.origin);const i=Nd.dot(this.direction),r=Nd.dot(Nd)-i*i,o=e.radius*e.radius;if(r>o)return null;const s=Math.sqrt(o-r),a=i-s,l=i+s;return l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,o,s,a,l;const u=1/this.direction.x,c=1/this.direction.y,f=1/this.direction.z,h=this.origin;return u>=0?(i=(e.min.x-h.x)*u,r=(e.max.x-h.x)*u):(i=(e.max.x-h.x)*u,r=(e.min.x-h.x)*u),c>=0?(o=(e.min.y-h.y)*c,s=(e.max.y-h.y)*c):(o=(e.max.y-h.y)*c,s=(e.min.y-h.y)*c),i>s||o>r||((o>i||isNaN(i))&&(i=o),(s<r||isNaN(r))&&(r=s),f>=0?(a=(e.min.z-h.z)*f,l=(e.max.z-h.z)*f):(a=(e.max.z-h.z)*f,l=(e.min.z-h.z)*f),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,Nd)}intersectTriangle(e,t,i,r,o){lN.subVectors(t,e),OT.subVectors(i,e),uN.crossVectors(lN,OT);let a,s=this.direction.dot(uN);if(s>0){if(r)return null;a=1}else{if(!(s<0))return null;a=-1,s=-s}Eh.subVectors(this.origin,e);const l=a*this.direction.dot(OT.crossVectors(Eh,OT));if(l<0)return null;const u=a*this.direction.dot(lN.cross(Eh));if(u<0||l+u>s)return null;const c=-a*Eh.dot(uN);return c<0?null:this.at(c/s,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class at{constructor(e,t,i,r,o,s,a,l,u,c,f,h,g,m,v,_){at.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,o,s,a,l,u,c,f,h,g,m,v,_)}set(e,t,i,r,o,s,a,l,u,c,f,h,g,m,v,_){const y=this.elements;return y[0]=e,y[4]=t,y[8]=i,y[12]=r,y[1]=o,y[5]=s,y[9]=a,y[13]=l,y[2]=u,y[6]=c,y[10]=f,y[14]=h,y[3]=g,y[7]=m,y[11]=v,y[15]=_,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new at).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/k_.setFromMatrixColumn(e,0).length(),o=1/k_.setFromMatrixColumn(e,1).length(),s=1/k_.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*o,t[5]=i[5]*o,t[6]=i[6]*o,t[7]=0,t[8]=i[8]*s,t[9]=i[9]*s,t[10]=i[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,o=e.z,s=Math.cos(i),a=Math.sin(i),l=Math.cos(r),u=Math.sin(r),c=Math.cos(o),f=Math.sin(o);if("XYZ"===e.order){const h=s*c,g=s*f,m=a*c,v=a*f;t[0]=l*c,t[4]=-l*f,t[8]=u,t[1]=g+m*u,t[5]=h-v*u,t[9]=-a*l,t[2]=v-h*u,t[6]=m+g*u,t[10]=s*l}else if("YXZ"===e.order){const h=l*c,g=l*f,m=u*c,v=u*f;t[0]=h+v*a,t[4]=m*a-g,t[8]=s*u,t[1]=s*f,t[5]=s*c,t[9]=-a,t[2]=g*a-m,t[6]=v+h*a,t[10]=s*l}else if("ZXY"===e.order){const h=l*c,g=l*f,m=u*c,v=u*f;t[0]=h-v*a,t[4]=-s*f,t[8]=m+g*a,t[1]=g+m*a,t[5]=s*c,t[9]=v-h*a,t[2]=-s*u,t[6]=a,t[10]=s*l}else if("ZYX"===e.order){const h=s*c,g=s*f,m=a*c,v=a*f;t[0]=l*c,t[4]=m*u-g,t[8]=h*u+v,t[1]=l*f,t[5]=v*u+h,t[9]=g*u-m,t[2]=-u,t[6]=a*l,t[10]=s*l}else if("YZX"===e.order){const h=s*l,g=s*u,m=a*l,v=a*u;t[0]=l*c,t[4]=v-h*f,t[8]=m*f+g,t[1]=f,t[5]=s*c,t[9]=-a*c,t[2]=-u*c,t[6]=g*f+m,t[10]=h-v*f}else if("XZY"===e.order){const h=s*l,g=s*u,m=a*l,v=a*u;t[0]=l*c,t[4]=-f,t[8]=u*c,t[1]=h*f+v,t[5]=s*c,t[9]=g*f-m,t[2]=m*f-g,t[6]=a*c,t[10]=v*f+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(lpe,e,upe)}lookAt(e,t,i){const r=this.elements;return rl.subVectors(e,t),0===rl.lengthSq()&&(rl.z=1),rl.normalize(),Th.crossVectors(i,rl),0===Th.lengthSq()&&(1===Math.abs(i.z)?rl.x+=1e-4:rl.z+=1e-4,rl.normalize(),Th.crossVectors(i,rl)),Th.normalize(),NT.crossVectors(rl,Th),r[0]=Th.x,r[4]=NT.x,r[8]=rl.x,r[1]=Th.y,r[5]=NT.y,r[9]=rl.y,r[2]=Th.z,r[6]=NT.z,r[10]=rl.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,o=this.elements,s=i[0],a=i[4],l=i[8],u=i[12],c=i[1],f=i[5],h=i[9],g=i[13],m=i[2],v=i[6],_=i[10],y=i[14],w=i[3],x=i[7],M=i[11],D=i[15],E=r[0],I=r[4],R=r[8],S=r[12],T=r[1],z=r[5],Z=r[9],J=r[13],le=r[2],fe=r[6],W=r[10],ie=r[14],Y=r[3],ge=r[7],Le=r[11],We=r[15];return o[0]=s*E+a*T+l*le+u*Y,o[4]=s*I+a*z+l*fe+u*ge,o[8]=s*R+a*Z+l*W+u*Le,o[12]=s*S+a*J+l*ie+u*We,o[1]=c*E+f*T+h*le+g*Y,o[5]=c*I+f*z+h*fe+g*ge,o[9]=c*R+f*Z+h*W+g*Le,o[13]=c*S+f*J+h*ie+g*We,o[2]=m*E+v*T+_*le+y*Y,o[6]=m*I+v*z+_*fe+y*ge,o[10]=m*R+v*Z+_*W+y*Le,o[14]=m*S+v*J+_*ie+y*We,o[3]=w*E+x*T+M*le+D*Y,o[7]=w*I+x*z+M*fe+D*ge,o[11]=w*R+x*Z+M*W+D*Le,o[15]=w*S+x*J+M*ie+D*We,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],o=e[12],s=e[1],a=e[5],l=e[9],u=e[13],c=e[2],f=e[6],h=e[10],g=e[14];return e[3]*(+o*l*f-r*u*f-o*a*h+i*u*h+r*a*g-i*l*g)+e[7]*(+t*l*g-t*u*h+o*s*h-r*s*g+r*u*c-o*l*c)+e[11]*(+t*u*f-t*a*g-o*s*f+i*s*g+o*a*c-i*u*c)+e[15]*(-r*a*c-t*l*f+t*a*h+r*s*f-i*s*h+i*l*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],g=e[11],m=e[12],v=e[13],_=e[14],y=e[15],w=f*_*u-v*h*u+v*l*g-a*_*g-f*l*y+a*h*y,x=m*h*u-c*_*u-m*l*g+s*_*g+c*l*y-s*h*y,M=c*v*u-m*f*u+m*a*g-s*v*g-c*a*y+s*f*y,D=m*f*l-c*v*l-m*a*h+s*v*h+c*a*_-s*f*_,E=t*w+i*x+r*M+o*D;if(0===E)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/E;return e[0]=w*I,e[1]=(v*h*o-f*_*o-v*r*g+i*_*g+f*r*y-i*h*y)*I,e[2]=(a*_*o-v*l*o+v*r*u-i*_*u-a*r*y+i*l*y)*I,e[3]=(f*l*o-a*h*o-f*r*u+i*h*u+a*r*g-i*l*g)*I,e[4]=x*I,e[5]=(c*_*o-m*h*o+m*r*g-t*_*g-c*r*y+t*h*y)*I,e[6]=(m*l*o-s*_*o-m*r*u+t*_*u+s*r*y-t*l*y)*I,e[7]=(s*h*o-c*l*o+c*r*u-t*h*u-s*r*g+t*l*g)*I,e[8]=M*I,e[9]=(m*f*o-c*v*o-m*i*g+t*v*g+c*i*y-t*f*y)*I,e[10]=(s*v*o-m*a*o+m*i*u-t*v*u-s*i*y+t*a*y)*I,e[11]=(c*a*o-s*f*o-c*i*u+t*f*u+s*i*g-t*a*g)*I,e[12]=D*I,e[13]=(c*v*r-m*f*r+m*i*h-t*v*h-c*i*_+t*f*_)*I,e[14]=(m*a*r-s*v*r-m*i*l+t*v*l+s*i*_-t*a*_)*I,e[15]=(s*f*r-c*a*r+c*i*l-t*f*l-s*i*h+t*a*h)*I,this}scale(e){const t=this.elements,i=e.x,r=e.y,o=e.z;return t[0]*=i,t[4]*=r,t[8]*=o,t[1]*=i,t[5]*=r,t[9]*=o,t[2]*=i,t[6]*=r,t[10]*=o,t[3]*=i,t[7]*=r,t[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),o=1-i,s=e.x,a=e.y,l=e.z,u=o*s,c=o*a;return this.set(u*s+i,u*a-r*l,u*l+r*a,0,u*a+r*l,c*a+i,c*l-r*s,0,u*l-r*a,c*l+r*s,o*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,o,s){return this.set(1,i,o,0,e,1,s,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,o=t._x,s=t._y,a=t._z,l=t._w,u=o+o,c=s+s,f=a+a,h=o*u,g=o*c,m=o*f,v=s*c,_=s*f,y=a*f,w=l*u,x=l*c,M=l*f,D=i.x,E=i.y,I=i.z;return r[0]=(1-(v+y))*D,r[1]=(g+M)*D,r[2]=(m-x)*D,r[3]=0,r[4]=(g-M)*E,r[5]=(1-(h+y))*E,r[6]=(_+w)*E,r[7]=0,r[8]=(m+x)*I,r[9]=(_-w)*I,r[10]=(1-(h+v))*I,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let o=k_.set(r[0],r[1],r[2]).length();const s=k_.set(r[4],r[5],r[6]).length(),a=k_.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),e.x=r[12],e.y=r[13],e.z=r[14],Nu.copy(this);const u=1/o,c=1/s,f=1/a;return Nu.elements[0]*=u,Nu.elements[1]*=u,Nu.elements[2]*=u,Nu.elements[4]*=c,Nu.elements[5]*=c,Nu.elements[6]*=c,Nu.elements[8]*=f,Nu.elements[9]*=f,Nu.elements[10]*=f,t.setFromRotationMatrix(Nu),i.x=o,i.y=s,i.z=a,this}makePerspective(e,t,i,r,o,s,a=Pu){const l=this.elements,u=2*o/(t-e),c=2*o/(i-r),f=(t+e)/(t-e),h=(i+r)/(i-r);let g,m;if(a===Pu)g=-(s+o)/(s-o),m=-2*s*o/(s-o);else{if(2001!==a)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);g=-s/(s-o),m=-s*o/(s-o)}return l[0]=u,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=c,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=g,l[14]=m,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,o,s,a=Pu){const l=this.elements,u=1/(t-e),c=1/(i-r),f=1/(s-o),h=(t+e)*u,g=(i+r)*c;let m,v;if(a===Pu)m=(s+o)*f,v=-2*f;else{if(2001!==a)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);m=o*f,v=-1*f}return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-h,l[1]=0,l[5]=2*c,l[9]=0,l[13]=-g,l[2]=0,l[6]=0,l[10]=v,l[14]=-m,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const k_=new U,Nu=new at,lpe=new U(0,0,0),upe=new U(1,1,1),Th=new U,NT=new U,rl=new U,Jj=new at,Qj=new hr;let As=(()=>{class n{constructor(t=0,i=0,r=0,o=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=o}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,o=this._order){return this._x=t,this._y=i,this._z=r,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const o=t.elements,s=o[0],a=o[4],l=o[8],u=o[1],c=o[5],f=o[9],h=o[2],g=o[6],m=o[10];switch(i){case"XYZ":this._y=Math.asin(_n(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-f,m),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(g,c),this._z=0);break;case"YXZ":this._x=Math.asin(-_n(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(l,m),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(_n(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(-h,m),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(u,s));break;case"ZYX":this._y=Math.asin(-_n(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(g,m),this._z=Math.atan2(u,s)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(_n(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-f,c),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(l,m));break;case"XZY":this._z=Math.asin(-_n(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(g,c),this._y=Math.atan2(l,s)):(this._x=Math.atan2(-f,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return Jj.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Jj,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return Qj.setFromEuler(this),this.setFromQuaternion(Qj,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class cN{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return!!(this.mask&e.mask)}isEnabled(e){return!!(this.mask&1<<e)}}let cpe=0;const e6=new U,B_=new hr,Fd=new at,FT=new U,Ww=new U,dpe=new U,fpe=new hr,t6=new U(1,0,0),n6=new U(0,1,0),i6=new U(0,0,1),r6={type:"added"},hpe={type:"removed"},U_={type:"childadded",child:null},dN={type:"childremoved",child:null};let mi=(()=>{class n extends Id{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:cpe++}),this.uuid=il(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new U,i=new As,r=new hr,o=new U(1,1,1);i._onChange(function s(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new at},normalMatrix:{value:new vn}}),this.matrix=new at,this.matrixWorld=new at,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new cN,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return B_.setFromAxisAngle(t,i),this.quaternion.multiply(B_),this}rotateOnWorldAxis(t,i){return B_.setFromAxisAngle(t,i),this.quaternion.premultiply(B_),this}rotateX(t){return this.rotateOnAxis(t6,t)}rotateY(t){return this.rotateOnAxis(n6,t)}rotateZ(t){return this.rotateOnAxis(i6,t)}translateOnAxis(t,i){return e6.copy(t).applyQuaternion(this.quaternion),this.position.add(e6.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(t6,t)}translateY(t){return this.translateOnAxis(n6,t)}translateZ(t){return this.translateOnAxis(i6,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Fd.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?FT.copy(t):FT.set(t,i,r);const o=this.parent;this.updateWorldMatrix(!0,!1),Ww.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Fd.lookAt(Ww,FT,this.up):Fd.lookAt(FT,Ww,this.up),this.quaternion.setFromRotationMatrix(Fd),o&&(Fd.extractRotation(o.matrixWorld),B_.setFromRotationMatrix(Fd),this.quaternion.premultiply(B_.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(r6),U_.child=t,this.dispatchEvent(U_),U_.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(hpe),dN.child=t,this.dispatchEvent(dN),dN.child=null),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Fd.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Fd.multiply(t.parent.matrixWorld)),t.applyMatrix4(Fd),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(r6),U_.child=t,this.dispatchEvent(U_),U_.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,o=this.children.length;r<o;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i,r=[]){this[t]===i&&r.push(this);const o=this.children;for(let s=0,a=o.length;s<a;s++)o[s].getObjectsByProperty(t,i,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ww,t,dpe),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ww,fpe,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,o=i.length;r<o;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,o=i.length;r<o;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,o=i.length;r<o;r++)i[r].updateMatrixWorld(t)}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===i){const o=this.children;for(let s=0,a=o.length;s<a;s++)o[s].updateWorldMatrix(!1,!0)}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const o={};function s(l,u){return void 0===l[u.uuid]&&(l[u.uuid]=u.toJSON(t)),u.uuid}if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),!0===this.castShadow&&(o.castShadow=!0),!0===this.receiveShadow&&(o.receiveShadow=!0),!1===this.visible&&(o.visible=!1),!1===this.frustumCulled&&(o.frustumCulled=!1),0!==this.renderOrder&&(o.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),o.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(o.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(o.type="BatchedMesh",o.perObjectFrustumCulled=this.perObjectFrustumCulled,o.sortObjects=this.sortObjects,o.drawRanges=this._drawRanges,o.reservedRanges=this._reservedRanges,o.geometryInfo=this._geometryInfo.map(l=>({...l,boundingBox:l.boundingBox?{min:l.boundingBox.min.toArray(),max:l.boundingBox.max.toArray()}:void 0,boundingSphere:l.boundingSphere?{radius:l.boundingSphere.radius,center:l.boundingSphere.center.toArray()}:void 0})),o.instanceInfo=this._instanceInfo.map(l=>({...l})),o.availableInstanceIds=this._availableInstanceIds.slice(),o.availableGeometryIds=this._availableGeometryIds.slice(),o.nextIndexStart=this._nextIndexStart,o.nextVertexStart=this._nextVertexStart,o.geometryCount=this._geometryCount,o.maxInstanceCount=this._maxInstanceCount,o.maxVertexCount=this._maxVertexCount,o.maxIndexCount=this._maxIndexCount,o.geometryInitialized=this._geometryInitialized,o.matricesTexture=this._matricesTexture.toJSON(t),o.indirectTexture=this._indirectTexture.toJSON(t),null!==this._colorsTexture&&(o.colorsTexture=this._colorsTexture.toJSON(t)),null!==this.boundingSphere&&(o.boundingSphere={center:this.boundingSphere.center.toArray(),radius:this.boundingSphere.radius}),null!==this.boundingBox&&(o.boundingBox={min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(o.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=s(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const u=l.shapes;if(Array.isArray(u))for(let c=0,f=u.length;c<f;c++)s(t.shapes,u[c]);else s(t.shapes,u)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(s(t.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let u=0,c=this.material.length;u<c;u++)l.push(s(t.materials,this.material[u]));o.material=l}else o.material=s(t.materials,this.material);if(this.children.length>0){o.children=[];for(let l=0;l<this.children.length;l++)o.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){o.animations=[];for(let l=0;l<this.animations.length;l++)o.animations.push(s(t.animations,this.animations[l]))}if(i){const l=a(t.geometries),u=a(t.materials),c=a(t.textures),f=a(t.images),h=a(t.shapes),g=a(t.skeletons),m=a(t.animations),v=a(t.nodes);l.length>0&&(r.geometries=l),u.length>0&&(r.materials=u),c.length>0&&(r.textures=c),f.length>0&&(r.images=f),h.length>0&&(r.shapes=h),g.length>0&&(r.skeletons=g),m.length>0&&(r.animations=m),v.length>0&&(r.nodes=v)}return r.object=o,r;function a(l){const u=[];for(const c in l){const f=l[c];delete f.metadata,u.push(f)}return u}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new U(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const Fu=new U,Ld=new U,fN=new U,kd=new U,V_=new U,H_=new U,o6=new U,hN=new U,pN=new U,gN=new U,mN=new $n,_N=new $n,yN=new $n;class ol{constructor(e=new U,t=new U,i=new U){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Fu.subVectors(e,t),r.cross(Fu);const o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(e,t,i,r,o){Fu.subVectors(r,t),Ld.subVectors(i,t),fN.subVectors(e,t);const s=Fu.dot(Fu),a=Fu.dot(Ld),l=Fu.dot(fN),u=Ld.dot(Ld),c=Ld.dot(fN),f=s*u-a*a;if(0===f)return o.set(0,0,0),null;const h=1/f,g=(u*l-a*c)*h,m=(s*c-a*l)*h;return o.set(1-g-m,m,g)}static containsPoint(e,t,i,r){return null!==this.getBarycoord(e,t,i,r,kd)&&kd.x>=0&&kd.y>=0&&kd.x+kd.y<=1}static getInterpolation(e,t,i,r,o,s,a,l){return null===this.getBarycoord(e,t,i,r,kd)?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(o,kd.x),l.addScaledVector(s,kd.y),l.addScaledVector(a,kd.z),l)}static getInterpolatedAttribute(e,t,i,r,o,s){return mN.setScalar(0),_N.setScalar(0),yN.setScalar(0),mN.fromBufferAttribute(e,t),_N.fromBufferAttribute(e,i),yN.fromBufferAttribute(e,r),s.setScalar(0),s.addScaledVector(mN,o.x),s.addScaledVector(_N,o.y),s.addScaledVector(yN,o.z),s}static isFrontFacing(e,t,i,r){return Fu.subVectors(i,t),Ld.subVectors(e,t),Fu.cross(Ld).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Fu.subVectors(this.c,this.b),Ld.subVectors(this.a,this.b),.5*Fu.cross(Ld).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ol.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ol.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,r,o){return ol.getInterpolation(e,this.a,this.b,this.c,t,i,r,o)}containsPoint(e){return ol.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ol.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,o=this.c;let s,a;V_.subVectors(r,i),H_.subVectors(o,i),hN.subVectors(e,i);const l=V_.dot(hN),u=H_.dot(hN);if(l<=0&&u<=0)return t.copy(i);pN.subVectors(e,r);const c=V_.dot(pN),f=H_.dot(pN);if(c>=0&&f<=c)return t.copy(r);const h=l*f-c*u;if(h<=0&&l>=0&&c<=0)return s=l/(l-c),t.copy(i).addScaledVector(V_,s);gN.subVectors(e,o);const g=V_.dot(gN),m=H_.dot(gN);if(m>=0&&g<=m)return t.copy(o);const v=g*u-l*m;if(v<=0&&u>=0&&m<=0)return a=u/(u-m),t.copy(i).addScaledVector(H_,a);const _=c*m-g*f;if(_<=0&&f-c>=0&&g-m>=0)return o6.subVectors(o,r),a=(f-c)/(f-c+(g-m)),t.copy(r).addScaledVector(o6,a);const y=1/(_+v+h);return s=v*y,a=h*y,t.copy(i).addScaledVector(V_,s).addScaledVector(H_,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const s6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ah={h:0,s:0,l:0},LT={h:0,s:0,l:0};function vN(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class Ke{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=fi){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,bn.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=bn.workingColorSpace){return this.r=e,this.g=t,this.b=i,bn.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=bn.workingColorSpace){if(e=QO(e,1),t=_n(t,0,1),i=_n(i,0,1),0===t)this.r=this.g=this.b=i;else{const o=i<=.5?i*(1+t):i+t-i*t,s=2*i-o;this.r=vN(s,o,e+1/3),this.g=vN(s,o,e),this.b=vN(s,o,e-1/3)}return bn.toWorkingColorSpace(this,r),this}setStyle(e,t=fi){function i(o){void 0!==o&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,t);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,t);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=r[1],s=o.length;if(3===s)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,t);if(6===s)return this.setHex(parseInt(o,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=fi){const i=s6[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Rd(e.r),this.g=Rd(e.g),this.b=Rd(e.b),this}copyLinearToSRGB(e){return this.r=R_(e.r),this.g=R_(e.g),this.b=R_(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=fi){return bn.fromWorkingColorSpace(Ds.copy(this),e),65536*Math.round(_n(255*Ds.r,0,255))+256*Math.round(_n(255*Ds.g,0,255))+Math.round(_n(255*Ds.b,0,255))}getHexString(e=fi){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=bn.workingColorSpace){bn.fromWorkingColorSpace(Ds.copy(this),t);const i=Ds.r,r=Ds.g,o=Ds.b,s=Math.max(i,r,o),a=Math.min(i,r,o);let l,u;const c=(a+s)/2;if(a===s)l=0,u=0;else{const f=s-a;switch(u=c<=.5?f/(s+a):f/(2-s-a),s){case i:l=(r-o)/f+(r<o?6:0);break;case r:l=(o-i)/f+2;break;case o:l=(i-r)/f+4}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,t=bn.workingColorSpace){return bn.fromWorkingColorSpace(Ds.copy(this),t),e.r=Ds.r,e.g=Ds.g,e.b=Ds.b,e}getStyle(e=fi){bn.fromWorkingColorSpace(Ds.copy(this),e);const t=Ds.r,i=Ds.g,r=Ds.b;return e!==fi?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(Ah),this.setHSL(Ah.h+e,Ah.s+t,Ah.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Ah),e.getHSL(LT);const i=Hw(Ah.h,LT.h,t),r=Hw(Ah.s,LT.s,t),o=Hw(Ah.l,LT.l,t);return this.setHSL(i,r,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,o=e.elements;return this.r=o[0]*t+o[3]*i+o[6]*r,this.g=o[1]*t+o[4]*i+o[7]*r,this.b=o[2]*t+o[5]*i+o[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Ds=new Ke;Ke.NAMES=s6;let ppe=0;class lo extends Id{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:ppe++}),this.uuid=il(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ke(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=A_,this.stencilZFail=A_,this.stencilZPass=A_,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(o){const s=[];for(const a in o){const l=o[a];delete l.metadata,s.push(l)}return s}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(i.dispersion=this.dispersion),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapRotation&&(i.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),204!==this.blendSrc&&(i.blendSrc=this.blendSrc),205!==this.blendDst&&(i.blendDst=this.blendDst),100!==this.blendEquation&&(i.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(i.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(i.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(i.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(i.depthFunc=this.depthFunc),!1===this.depthTest&&(i.depthTest=this.depthTest),!1===this.depthWrite&&(i.depthWrite=this.depthWrite),!1===this.colorWrite&&(i.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(i.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(i.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(i.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==A_&&(i.stencilFail=this.stencilFail),this.stencilZFail!==A_&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==A_&&(i.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(i.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const o=r(e.textures),s=r(e.images);o.length>0&&(i.textures=o),s.length>0&&(i.images=s)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let o=0;o!==r;++o)i[o]=t[o].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class sl extends lo{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ke(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new As,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const uo=new U,kT=new xe;let mpe=0;class bi{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:mpe++}),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRanges=[],this.gpuType=nl,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)kT.fromBufferAttribute(this,t),kT.applyMatrix3(e),this.setXY(t,kT.x,kT.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)uo.fromBufferAttribute(this,t),uo.applyMatrix3(e),this.setXYZ(t,uo.x,uo.y,uo.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)uo.fromBufferAttribute(this,t),uo.applyMatrix4(e),this.setXYZ(t,uo.x,uo.y,uo.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)uo.fromBufferAttribute(this,t),uo.applyNormalMatrix(e),this.setXYZ(t,uo.x,uo.y,uo.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)uo.fromBufferAttribute(this,t),uo.transformDirection(e),this.setXYZ(t,uo.x,uo.y,uo.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Qs(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Sn(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Qs(t,this.array)),t}setX(e,t){return this.normalized&&(t=Sn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Qs(t,this.array)),t}setY(e,t){return this.normalized&&(t=Sn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Qs(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Sn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Qs(t,this.array)),t}setW(e,t){return this.normalized&&(t=Sn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Sn(t,this.array),i=Sn(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Sn(t,this.array),i=Sn(i,this.array),r=Sn(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,o){return e*=this.itemSize,this.normalized&&(t=Sn(t,this.array),i=Sn(i,this.array),r=Sn(r,this.array),o=Sn(o,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),e}}class bN extends bi{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class a6 extends bi{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class it extends bi{constructor(e,t,i){super(new Float32Array(e),t,i)}}let _pe=0;const Bl=new at,wN=new mi,z_=new U,al=new Qo,qw=new Qo,Lo=new U;class cn extends Id{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_pe++}),this.uuid=il(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(qj(e)?a6:bN)(e,1):e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const o=(new vn).getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Bl.makeRotationFromQuaternion(e),this.applyMatrix4(Bl),this}rotateX(e){return Bl.makeRotationX(e),this.applyMatrix4(Bl),this}rotateY(e){return Bl.makeRotationY(e),this.applyMatrix4(Bl),this}rotateZ(e){return Bl.makeRotationZ(e),this.applyMatrix4(Bl),this}translate(e,t,i){return Bl.makeTranslation(e,t,i),this.applyMatrix4(Bl),this}scale(e,t,i){return Bl.makeScale(e,t,i),this.applyMatrix4(Bl),this}lookAt(e){return wN.lookAt(e),wN.updateMatrix(),this.applyMatrix4(wN.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(z_).negate(),this.translate(z_.x,z_.y,z_.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const i=[];for(let r=0,o=e.length;r<o;r++){const s=e[r];i.push(s.x,s.y,s.z||0)}this.setAttribute("position",new it(i,3))}else{const i=Math.min(e.length,t.count);for(let r=0;r<i;r++){const o=e[r];t.setXYZ(r,o.x,o.y,o.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Qo);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new U(-1/0,-1/0,-1/0),new U(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)al.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(Lo.addVectors(this.boundingBox.min,al.min),this.boundingBox.expandByPoint(Lo),Lo.addVectors(this.boundingBox.max,al.max),this.boundingBox.expandByPoint(Lo)):(this.boundingBox.expandByPoint(al.min),this.boundingBox.expandByPoint(al.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new es);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new U,1/0);if(e){const i=this.boundingSphere.center;if(al.setFromBufferAttribute(e),t)for(let o=0,s=t.length;o<s;o++)qw.setFromBufferAttribute(t[o]),this.morphTargetsRelative?(Lo.addVectors(al.min,qw.min),al.expandByPoint(Lo),Lo.addVectors(al.max,qw.max),al.expandByPoint(Lo)):(al.expandByPoint(qw.min),al.expandByPoint(qw.max));al.getCenter(i);let r=0;for(let o=0,s=e.count;o<s;o++)Lo.fromBufferAttribute(e,o),r=Math.max(r,i.distanceToSquared(Lo));if(t)for(let o=0,s=t.length;o<s;o++){const a=t[o],l=this.morphTargetsRelative;for(let u=0,c=a.count;u<c;u++)Lo.fromBufferAttribute(a,u),l&&(z_.fromBufferAttribute(e,u),Lo.add(z_)),r=Math.max(r,i.distanceToSquared(Lo))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=t.position,r=t.normal,o=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new bi(new Float32Array(4*i.count),4));const s=this.getAttribute("tangent"),a=[],l=[];for(let R=0;R<i.count;R++)a[R]=new U,l[R]=new U;const u=new U,c=new U,f=new U,h=new xe,g=new xe,m=new xe,v=new U,_=new U;function y(R,S,T){u.fromBufferAttribute(i,R),c.fromBufferAttribute(i,S),f.fromBufferAttribute(i,T),h.fromBufferAttribute(o,R),g.fromBufferAttribute(o,S),m.fromBufferAttribute(o,T),c.sub(u),f.sub(u),g.sub(h),m.sub(h);const z=1/(g.x*m.y-m.x*g.y);isFinite(z)&&(v.copy(c).multiplyScalar(m.y).addScaledVector(f,-g.y).multiplyScalar(z),_.copy(f).multiplyScalar(g.x).addScaledVector(c,-m.x).multiplyScalar(z),a[R].add(v),a[S].add(v),a[T].add(v),l[R].add(_),l[S].add(_),l[T].add(_))}let w=this.groups;0===w.length&&(w=[{start:0,count:e.count}]);for(let R=0,S=w.length;R<S;++R){const T=w[R],z=T.start;for(let J=z,le=z+T.count;J<le;J+=3)y(e.getX(J+0),e.getX(J+1),e.getX(J+2))}const x=new U,M=new U,D=new U,E=new U;function I(R){D.fromBufferAttribute(r,R),E.copy(D);const S=a[R];x.copy(S),x.sub(D.multiplyScalar(D.dot(S))).normalize(),M.crossVectors(E,S);const z=M.dot(l[R])<0?-1:1;s.setXYZW(R,x.x,x.y,x.z,z)}for(let R=0,S=w.length;R<S;++R){const T=w[R],z=T.start;for(let J=z,le=z+T.count;J<le;J+=3)I(e.getX(J+0)),I(e.getX(J+1)),I(e.getX(J+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new bi(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let h=0,g=i.count;h<g;h++)i.setXYZ(h,0,0,0);const r=new U,o=new U,s=new U,a=new U,l=new U,u=new U,c=new U,f=new U;if(e)for(let h=0,g=e.count;h<g;h+=3){const m=e.getX(h+0),v=e.getX(h+1),_=e.getX(h+2);r.fromBufferAttribute(t,m),o.fromBufferAttribute(t,v),s.fromBufferAttribute(t,_),c.subVectors(s,o),f.subVectors(r,o),c.cross(f),a.fromBufferAttribute(i,m),l.fromBufferAttribute(i,v),u.fromBufferAttribute(i,_),a.add(c),l.add(c),u.add(c),i.setXYZ(m,a.x,a.y,a.z),i.setXYZ(v,l.x,l.y,l.z),i.setXYZ(_,u.x,u.y,u.z)}else for(let h=0,g=t.count;h<g;h+=3)r.fromBufferAttribute(t,h+0),o.fromBufferAttribute(t,h+1),s.fromBufferAttribute(t,h+2),c.subVectors(s,o),f.subVectors(r,o),c.cross(f),i.setXYZ(h+0,c.x,c.y,c.z),i.setXYZ(h+1,c.x,c.y,c.z),i.setXYZ(h+2,c.x,c.y,c.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Lo.fromBufferAttribute(e,t),Lo.normalize(),e.setXYZ(t,Lo.x,Lo.y,Lo.z)}toNonIndexed(){function e(a,l){const u=a.array,c=a.itemSize,f=a.normalized,h=new u.constructor(l.length*c);let g=0,m=0;for(let v=0,_=l.length;v<_;v++){g=a.isInterleavedBufferAttribute?l[v]*a.data.stride+a.offset:l[v]*c;for(let y=0;y<c;y++)h[m++]=u[g++]}return new bi(h,c,f)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new cn,i=this.index.array,r=this.attributes;for(const a in r){const u=e(r[a],i);t.setAttribute(a,u)}const o=this.morphAttributes;for(const a in o){const l=[],u=o[a];for(let c=0,f=u.length;c<f;c++){const g=e(u[c],i);l.push(g)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,l=s.length;a<l;a++){const u=s[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const u in l)void 0!==l[u]&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let o=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],c=[];for(let f=0,h=u.length;f<h;f++)c.push(u[f].toJSON(e.data));c.length>0&&(r[l]=c,o=!0)}o&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone());const r=e.attributes;for(const u in r)this.setAttribute(u,r[u].clone(t));const o=e.morphAttributes;for(const u in o){const c=[],f=o[u];for(let h=0,g=f.length;h<g;h++)c.push(f[h].clone(t));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let u=0,c=s.length;u<c;u++){const f=s[u];this.addGroup(f.start,f.count,f.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const l6=new at,Eg=new L_,BT=new es,u6=new U,UT=new U,VT=new U,HT=new U,xN=new U,zT=new U,c6=new U,GT=new U;class yr extends mi{constructor(e=new cn,t=new sl){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}getVertexPosition(e,t){const i=this.geometry,o=i.morphAttributes.position,s=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(o&&a){zT.set(0,0,0);for(let l=0,u=o.length;l<u;l++){const c=a[l];0!==c&&(xN.fromBufferAttribute(o[l],e),zT.addScaledVector(s?xN:xN.sub(t),c))}t.add(zT)}return t}raycast(e,t){const i=this.geometry,o=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),BT.copy(i.boundingSphere),BT.applyMatrix4(o),Eg.copy(e.ray).recast(e.near),(!1!==BT.containsPoint(Eg.origin)||!(null===Eg.intersectSphere(BT,u6)||Eg.origin.distanceToSquared(u6)>(e.far-e.near)**2))&&(l6.copy(o).invert(),Eg.copy(e.ray).applyMatrix4(l6),(null===i.boundingBox||!1!==Eg.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,Eg)))}_computeIntersections(e,t,i){let r;const o=this.geometry,s=this.material,a=o.index,l=o.attributes.position,u=o.attributes.uv,c=o.attributes.uv1,f=o.attributes.normal,h=o.groups,g=o.drawRange;if(null!==a)if(Array.isArray(s))for(let m=0,v=h.length;m<v;m++){const _=h[m],y=s[_.materialIndex];for(let M=Math.max(_.start,g.start),D=Math.min(a.count,Math.min(_.start+_.count,g.start+g.count));M<D;M+=3)r=jT(this,y,e,i,u,c,f,a.getX(M),a.getX(M+1),a.getX(M+2)),r&&(r.faceIndex=Math.floor(M/3),r.face.materialIndex=_.materialIndex,t.push(r))}else for(let _=Math.max(0,g.start),y=Math.min(a.count,g.start+g.count);_<y;_+=3)r=jT(this,s,e,i,u,c,f,a.getX(_),a.getX(_+1),a.getX(_+2)),r&&(r.faceIndex=Math.floor(_/3),t.push(r));else if(void 0!==l)if(Array.isArray(s))for(let m=0,v=h.length;m<v;m++){const _=h[m],y=s[_.materialIndex];for(let M=Math.max(_.start,g.start),D=Math.min(l.count,Math.min(_.start+_.count,g.start+g.count));M<D;M+=3)r=jT(this,y,e,i,u,c,f,M,M+1,M+2),r&&(r.faceIndex=Math.floor(M/3),r.face.materialIndex=_.materialIndex,t.push(r))}else for(let _=Math.max(0,g.start),y=Math.min(l.count,g.start+g.count);_<y;_+=3)r=jT(this,s,e,i,u,c,f,_,_+1,_+2),r&&(r.faceIndex=Math.floor(_/3),t.push(r))}}function jT(n,e,t,i,r,o,s,a,l,u){n.getVertexPosition(a,UT),n.getVertexPosition(l,VT),n.getVertexPosition(u,HT);const c=function ype(n,e,t,i,r,o,s,a){let l;if(l=1===e.side?i.intersectTriangle(s,o,r,!0,a):i.intersectTriangle(r,o,s,0===e.side,a),null===l)return null;GT.copy(a),GT.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(GT);return u<t.near||u>t.far?null:{distance:u,point:GT.clone(),object:n}}(n,e,t,i,UT,VT,HT,c6);if(c){const f=new U;ol.getBarycoord(c6,UT,VT,HT,f),r&&(c.uv=ol.getInterpolatedAttribute(r,a,l,u,f,new xe)),o&&(c.uv1=ol.getInterpolatedAttribute(o,a,l,u,f,new xe)),s&&(c.normal=ol.getInterpolatedAttribute(s,a,l,u,f,new U),c.normal.dot(i.direction)>0&&c.normal.multiplyScalar(-1));const h={a,b:l,c:u,normal:new U,materialIndex:0};ol.getNormal(UT,VT,HT,h.normal),c.face=h,c.barycoord=f}return c}class G_ extends cn{constructor(e=1,t=1,i=1,r=1,o=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:o,depthSegments:s};const a=this;r=Math.floor(r),o=Math.floor(o),s=Math.floor(s);const l=[],u=[],c=[],f=[];let h=0,g=0;function m(v,_,y,w,x,M,D,E,I,R,S){const T=M/I,z=D/R,Z=M/2,J=D/2,le=E/2,fe=I+1,W=R+1;let ie=0,Y=0;const ge=new U;for(let Le=0;Le<W;Le++){const We=Le*z-J;for(let vt=0;vt<fe;vt++)ge[v]=(vt*T-Z)*w,ge[_]=We*x,ge[y]=le,u.push(ge.x,ge.y,ge.z),ge[v]=0,ge[_]=0,ge[y]=E>0?1:-1,c.push(ge.x,ge.y,ge.z),f.push(vt/I),f.push(1-Le/R),ie+=1}for(let Le=0;Le<R;Le++)for(let We=0;We<I;We++){const wt=h+We+fe*(Le+1),ue=h+(We+1)+fe*(Le+1),Ce=h+(We+1)+fe*Le;l.push(h+We+fe*Le,wt,Ce),l.push(wt,ue,Ce),Y+=6}a.addGroup(g,Y,S),g+=Y,h+=ie}m("z","y","x",-1,-1,i,t,e,s,o,0),m("z","y","x",1,-1,i,t,-e,s,o,1),m("x","z","y",1,1,e,i,t,r,s,2),m("x","z","y",1,-1,e,i,-t,r,s,3),m("x","y","z",1,-1,e,t,i,r,o,4),m("x","y","z",-1,-1,e,t,-i,r,o,5),this.setIndex(l),this.setAttribute("position",new it(u,3)),this.setAttribute("normal",new it(c,3)),this.setAttribute("uv",new it(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new G_(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function j_(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():e[t][i]=Array.isArray(r)?r.slice():r}}return e}function ea(n){const e={};for(let t=0;t<n.length;t++){const i=j_(n[t]);for(const r in i)e[r]=i[r]}return e}function d6(n){const e=n.getRenderTarget();return null===e?n.outputColorSpace:!0===e.isXRRenderTarget?e.texture.colorSpace:bn.workingColorSpace}const bpe={clone:j_,merge:ea};class Rc extends lo{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=j_(e.uniforms),this.uniformsGroups=function vpe(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const s=this.uniforms[r].value;t.uniforms[r]=s&&s.isTexture?{type:"t",value:s.toJSON(e).uuid}:s&&s.isColor?{type:"c",value:s.getHex()}:s&&s.isVector2?{type:"v2",value:s.toArray()}:s&&s.isVector3?{type:"v3",value:s.toArray()}:s&&s.isVector4?{type:"v4",value:s.toArray()}:s&&s.isMatrix3?{type:"m3",value:s.toArray()}:s&&s.isMatrix4?{type:"m4",value:s.toArray()}:{value:s}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class MN extends mi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new at,this.projectionMatrix=new at,this.projectionMatrixInverse=new at,this.coordinateSystem=Pu}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Dh=new U,f6=new xe,h6=new xe;class bo extends MN{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*D_*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*xg*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*D_*Math.atan(Math.tan(.5*xg*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){Dh.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Dh.x,Dh.y).multiplyScalar(-e/Dh.z),Dh.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Dh.x,Dh.y).multiplyScalar(-e/Dh.z)}getViewSize(e,t){return this.getViewBounds(e,f6,h6),t.subVectors(h6,f6)}setViewOffset(e,t,i,r,o,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*xg*this.fov)/this.zoom,i=2*t,r=this.aspect*i,o=-.5*r;const s=this.view;if(null!==this.view&&this.view.enabled){const l=s.fullWidth,u=s.fullHeight;o+=s.offsetX*r/l,t-=s.offsetY*i/u,r*=s.width/l,i*=s.height/u}const a=this.filmOffset;0!==a&&(o+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class Mpe extends mi{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new bo(-90,1,e,t);r.layers=this.layers,this.add(r);const o=new bo(-90,1,e,t);o.layers=this.layers,this.add(o);const s=new bo(-90,1,e,t);s.layers=this.layers,this.add(s);const a=new bo(-90,1,e,t);a.layers=this.layers,this.add(a);const l=new bo(-90,1,e,t);l.layers=this.layers,this.add(l);const u=new bo(-90,1,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,o,s,a,l]=t;for(const u of t)this.remove(u);if(e===Pu)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1)}for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[o,s,a,l,u,c]=this.children,f=e.getRenderTarget(),h=e.getActiveCubeFace(),g=e.getActiveMipmapLevel(),m=e.xr.enabled;e.xr.enabled=!1;const v=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,o),e.setRenderTarget(i,1,r),e.render(t,s),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,u),i.texture.generateMipmaps=v,e.setRenderTarget(i,5,r),e.render(t,c),e.setRenderTarget(f,h,g),e.xr.enabled=m,i.texture.needsPMREMUpdate=!0}}class WT extends Jo{constructor(e=[],t=301,i,r,o,s,a,l,u,c){super(e,t,i,r,o,s,a,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Cpe extends Pd{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1};this.texture=new WT([i,i,i,i,i,i],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:zr}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new G_(5,5,5),o=new Rc({name:"CubemapFromEquirect",uniforms:j_(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});o.uniforms.tEquirect.value=t;const s=new yr(r,o),a=t.minFilter;return t.minFilter===Ru&&(t.minFilter=zr),new Mpe(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t=!0,i=!0,r=!0){const o=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,i,r);e.setRenderTarget(o)}}class Lu extends mi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Spe={type:"move"};class CN{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Lu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Lu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new U,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new U),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Lu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new U,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new U),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,o=null,s=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(u&&e.hand){s=!0;for(const v of e.hand.values()){const _=t.getJointPose(v,i),y=this._getHandJoint(u,v);null!==_&&(y.matrix.fromArray(_.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,y.jointRadius=_.radius),y.visible=null!==_}const h=u.joints["index-finger-tip"].position.distanceTo(u.joints["thumb-tip"].position),g=.02,m=.005;u.inputState.pinching&&h>g+m?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&h<=g-m&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(o=t.getPose(e.gripSpace,i),null!==o&&(l.matrix.fromArray(o.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,o.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(o.linearVelocity)):l.hasLinearVelocity=!1,o.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(o.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==o&&(r=o),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Spe)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==o),null!==u&&(u.visible=null!==s),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new Lu;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class p6 extends mi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new As,this.environmentIntensity=1,this.environmentRotation=new As,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class $T{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRanges=[],this.version=0,this.uuid=il()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,o=this.stride;r<o;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=il()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=il()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ta=new U;class Tg{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)ta.fromBufferAttribute(this,t),ta.applyMatrix4(e),this.setXYZ(t,ta.x,ta.y,ta.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ta.fromBufferAttribute(this,t),ta.applyNormalMatrix(e),this.setXYZ(t,ta.x,ta.y,ta.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ta.fromBufferAttribute(this,t),ta.transformDirection(e),this.setXYZ(t,ta.x,ta.y,ta.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=Qs(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Sn(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=Sn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Sn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Sn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Sn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Qs(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Qs(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Qs(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Qs(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Sn(t,this.array),i=Sn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Sn(t,this.array),i=Sn(i,this.array),r=Sn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,o){return e=e*this.data.stride+this.offset,this.normalized&&(t=Sn(t,this.array),i=Sn(i,this.array),r=Sn(r,this.array),o=Sn(o,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=o,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[r+o])}return new bi(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Tg(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[r+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const b6=new U,w6=new $n,x6=new $n,Ape=new U,M6=new at,KT=new U,AN=new es,C6=new at,DN=new L_;class IN extends yr{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Oj,this.bindMatrix=new at,this.bindMatrixInverse=new at,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Qo),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,KT),this.boundingBox.expandByPoint(KT)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new es),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,KT),this.boundingSphere.expandByPoint(KT)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),AN.copy(this.boundingSphere),AN.applyMatrix4(r),!1!==e.ray.intersectsSphere(AN)&&(C6.copy(r).invert(),DN.copy(e.ray).applyMatrix4(C6),(null===this.boundingBox||!1!==DN.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,DN)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new $n,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===Oj?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;w6.fromBufferAttribute(r.attributes.skinIndex,e),x6.fromBufferAttribute(r.attributes.skinWeight,e),b6.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let o=0;o<4;o++){const s=x6.getComponent(o);if(0!==s){const a=w6.getComponent(o);M6.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(Ape.copy(b6).applyMatrix4(M6),s)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Kw extends mi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Ud extends Jo{constructor(e=null,t=1,i=1,r,o,s,a,l,u=Fo,c=Fo,f,h){super(null,s,a,l,u,c,r,o,f,h),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const S6=new at,Dpe=new at;class Jw{constructor(e=[],t=[]){this.uuid=il(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new at)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new at;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let o=0,s=e.length;o<s;o++)S6.multiplyMatrices(e[o]?e[o].matrixWorld:Dpe,t[o]),S6.toArray(i,16*o);null!==r&&(r.needsUpdate=!0)}clone(){return new Jw(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Ud(t,e,e,Da,nl);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const o=e.bones[i];let s=t[o];void 0===s&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),s=new Kw),this.bones.push(s),this.boneInverses.push((new at).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,o=t.length;r<o;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class K_ extends bi{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const J_=new at,E6=new at,JT=[],T6=new Qo,Ipe=new at,Qw=new yr,ex=new es;class A6 extends yr{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new K_(new Float32Array(16*i),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,Ipe)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Qo),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,J_),T6.copy(e.boundingBox).applyMatrix4(J_),this.boundingBox.union(T6)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new es),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,J_),ex.copy(e.boundingSphere).applyMatrix4(J_),this.boundingSphere.union(ex)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.morphTexture&&(this.morphTexture=e.morphTexture.clone()),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,t){const i=t.morphTargetInfluences,r=this.morphTexture.source.data.data,s=e*(i.length+1)+1;for(let a=0;a<i.length;a++)i[a]=r[s+a]}raycast(e,t){const i=this.matrixWorld,r=this.count;if(Qw.geometry=this.geometry,Qw.material=this.material,void 0!==Qw.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),ex.copy(this.boundingSphere),ex.applyMatrix4(i),!1!==e.ray.intersectsSphere(ex)))for(let o=0;o<r;o++){this.getMatrixAt(o,J_),E6.multiplyMatrices(i,J_),Qw.matrixWorld=E6,Qw.raycast(e,JT);for(let s=0,a=JT.length;s<a;s++){const l=JT[s];l.instanceId=o,l.object=this,t.push(l)}JT.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new K_(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,t){const i=t.morphTargetInfluences,r=i.length+1;null===this.morphTexture&&(this.morphTexture=new Ud(new Float32Array(r*this.count),r,this.count,1028,nl));const o=this.morphTexture.source.data.data;let s=0;for(let u=0;u<i.length;u++)s+=i[u];const l=r*e;o[l]=this.geometry.morphTargetsRelative?1:1-s,o.set(i,l+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null)}}const RN=new U,Rpe=new U,Ppe=new vn;class Ih{constructor(e=new U(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=RN.subVectors(i,t).cross(Rpe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(RN),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:t.copy(e.start).addScaledVector(i,o)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||Ppe.getNormalMatrix(e),r=this.coplanarPoint(RN).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Ag=new es,QT=new U;class tx{constructor(e=new Ih,t=new Ih,i=new Ih,r=new Ih,o=new Ih,s=new Ih){this.planes=[e,t,i,r,o,s]}set(e,t,i,r,o,s){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(o),a[5].copy(s),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Pu){const i=this.planes,r=e.elements,o=r[0],s=r[1],a=r[2],l=r[3],u=r[4],c=r[5],f=r[6],h=r[7],g=r[8],m=r[9],v=r[10],_=r[11],y=r[12],w=r[13],x=r[14],M=r[15];if(i[0].setComponents(l-o,h-u,_-g,M-y).normalize(),i[1].setComponents(l+o,h+u,_+g,M+y).normalize(),i[2].setComponents(l+s,h+c,_+m,M+w).normalize(),i[3].setComponents(l-s,h-c,_-m,M-w).normalize(),i[4].setComponents(l-a,h-f,_-v,M-x).normalize(),t===Pu)i[5].setComponents(l+a,h+f,_+v,M+x).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(a,f,v,x).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Ag.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Ag.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Ag)}intersectsSprite(e){return Ag.center.set(0,0,0),Ag.radius=.7071067811865476,Ag.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ag)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(QT.x=r.normal.x>0?e.max.x:e.min.x,QT.y=r.normal.y>0?e.max.y:e.min.y,QT.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(QT)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class wo extends lo{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ke(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const n1=new U,r1=new U,R6=new at,ix=new L_,o1=new es,FN=new U,P6=new U;class Vd extends mi{constructor(e=new cn,t=new wo){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,o=t.count;r<o;r++)n1.fromBufferAttribute(t,r-1),r1.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=n1.distanceTo(r1);e.setAttribute("lineDistance",new it(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,o=e.params.Line.threshold,s=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),o1.copy(i.boundingSphere),o1.applyMatrix4(r),o1.radius+=o,!1===e.ray.intersectsSphere(o1))return;R6.copy(r).invert(),ix.copy(e.ray).applyMatrix4(R6);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=this.isLineSegments?2:1,c=i.index,h=i.attributes.position;if(null!==c){const g=Math.max(0,s.start),m=Math.min(c.count,s.start+s.count);for(let v=g,_=m-1;v<_;v+=u){const y=c.getX(v),w=c.getX(v+1),x=s1(this,e,ix,l,y,w,v);x&&t.push(x)}if(this.isLineLoop){const v=c.getX(m-1),_=c.getX(g),y=s1(this,e,ix,l,v,_,m-1);y&&t.push(y)}}else{const g=Math.max(0,s.start),m=Math.min(h.count,s.start+s.count);for(let v=g,_=m-1;v<_;v+=u){const y=s1(this,e,ix,l,v,v+1,v);y&&t.push(y)}if(this.isLineLoop){const v=s1(this,e,ix,l,m-1,g,m-1);v&&t.push(v)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}}function s1(n,e,t,i,r,o,s){const a=n.geometry.attributes.position;if(n1.fromBufferAttribute(a,r),r1.fromBufferAttribute(a,o),t.distanceSqToSegment(n1,r1,FN,P6)>i)return;FN.applyMatrix4(n.matrixWorld);const u=e.ray.origin.distanceTo(FN);return u<e.near||u>e.far?void 0:{distance:u,point:P6.clone().applyMatrix4(n.matrixWorld),index:s,face:null,faceIndex:null,barycoord:null,object:n}}const O6=new U,N6=new U;class Ul extends Vd{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,o=t.count;r<o;r+=2)O6.fromBufferAttribute(t,r),N6.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+O6.distanceTo(N6);e.setAttribute("lineDistance",new it(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class F6 extends Vd{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Rg extends lo{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ke(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const L6=new at,LN=new L_,a1=new es,l1=new U;class rx extends mi{constructor(e=new cn,t=new Rg){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,o=e.params.Points.threshold,s=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),a1.copy(i.boundingSphere),a1.applyMatrix4(r),a1.radius+=o,!1===e.ray.intersectsSphere(a1))return;L6.copy(r).invert(),LN.copy(e.ray).applyMatrix4(L6);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=i.index,f=i.attributes.position;if(null!==u)for(let m=Math.max(0,s.start),v=Math.min(u.count,s.start+s.count);m<v;m++){const _=u.getX(m);l1.fromBufferAttribute(f,_),k6(l1,_,l,r,e,t,this)}else for(let m=Math.max(0,s.start),v=Math.min(f.count,s.start+s.count);m<v;m++)l1.fromBufferAttribute(f,m),k6(l1,m,l,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}}function k6(n,e,t,i,r,o,s){const a=LN.distanceSqToPoint(n);if(a<t){const l=new U;LN.closestPointToPoint(n,l),l.applyMatrix4(i);const u=r.ray.origin.distanceTo(l);if(u<r.near||u>r.far)return;o.push({distance:u,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:s})}}class BN extends Jo{constructor(e,t,i=xh,r,o,s,a=Fo,l=Fo,u,c=kw){if(c!==kw&&c!==Bw)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,r,o,s,a,l,c,i,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Mg(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class ku{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),o=0;t.push(0);for(let s=1;s<=e;s++)i=this.getPoint(s/e),o+=i.distanceTo(r),t.push(o),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const i=this.getLengths();let r=0;const o=i.length;let s;s=t||e*i[o-1];let u,a=0,l=o-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),u=i[r]-s,u<0)a=r+1;else{if(!(u>0)){l=r;break}l=r-1}if(r=l,i[r]===s)return r/(o-1);const c=i[r];return(r+(s-c)/(i[r+1]-c))/(o-1)}getTangent(e,t){let r=e-1e-4,o=e+1e-4;r<0&&(r=0),o>1&&(o=1);const s=this.getPoint(r),a=this.getPoint(o),l=t||(s.isVector2?new xe:new U);return l.copy(a).sub(s).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t=!1){const i=new U,r=[],o=[],s=[],a=new U,l=new at;for(let g=0;g<=e;g++)r[g]=this.getTangentAt(g/e,new U);o[0]=new U,s[0]=new U;let u=Number.MAX_VALUE;const c=Math.abs(r[0].x),f=Math.abs(r[0].y),h=Math.abs(r[0].z);c<=u&&(u=c,i.set(1,0,0)),f<=u&&(u=f,i.set(0,1,0)),h<=u&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),o[0].crossVectors(r[0],a),s[0].crossVectors(r[0],o[0]);for(let g=1;g<=e;g++){if(o[g]=o[g-1].clone(),s[g]=s[g-1].clone(),a.crossVectors(r[g-1],r[g]),a.length()>Number.EPSILON){a.normalize();const m=Math.acos(_n(r[g-1].dot(r[g]),-1,1));o[g].applyMatrix4(l.makeRotationAxis(a,m))}s[g].crossVectors(r[g],o[g])}if(!0===t){let g=Math.acos(_n(o[0].dot(o[e]),-1,1));g/=e,r[0].dot(a.crossVectors(o[0],o[e]))>0&&(g=-g);for(let m=1;m<=e;m++)o[m].applyMatrix4(l.makeRotationAxis(r[m],g*m)),s[m].crossVectors(r[m],o[m])}return{tangents:r,normals:o,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class GN extends ku{constructor(e=0,t=0,i=1,r=1,o=0,s=2*Math.PI,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=o,this.aEndAngle=s,this.aClockwise=a,this.aRotation=l}getPoint(e,t=new xe){const i=t,r=2*Math.PI;let o=this.aEndAngle-this.aStartAngle;const s=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=r;for(;o>r;)o-=r;o<Number.EPSILON&&(o=s?0:r),!0===this.aClockwise&&!s&&(o===r?o=-r:o-=r);const a=this.aStartAngle+e*o;let l=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const c=Math.cos(this.aRotation),f=Math.sin(this.aRotation),h=l-this.aX,g=u-this.aY;l=h*c-g*f+this.aX,u=h*f+g*c+this.aY}return i.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}function jN(){let n=0,e=0,t=0,i=0;function r(o,s,a,l){n=o,e=a,t=-3*o+3*s-2*a-l,i=2*o-2*s+a+l}return{initCatmullRom:function(o,s,a,l,u){r(s,a,u*(a-o),u*(l-s))},initNonuniformCatmullRom:function(o,s,a,l,u,c,f){let h=(s-o)/u-(a-o)/(u+c)+(a-s)/c,g=(a-s)/c-(l-s)/(c+f)+(l-a)/f;h*=c,g*=c,r(s,a,h,g)},calc:function(o){const s=o*o;return n+e*o+t*s+i*(s*o)}}}const p1=new U,WN=new jN,$N=new jN,qN=new jN;function B6(n,e,t,i,r){const o=.5*(i-e),s=.5*(r-t),a=n*n;return(2*t-2*i+o+s)*(n*a)+(-3*t+3*i-2*o-s)*a+o*n+t}function ox(n,e,t,i){return function Wpe(n,e){const t=1-n;return t*t*e}(n,e)+function $pe(n,e){return 2*(1-n)*n*e}(n,t)+function qpe(n,e){return n*n*e}(n,i)}function sx(n,e,t,i,r){return function Xpe(n,e){const t=1-n;return t*t*t*e}(n,e)+function Ype(n,e){const t=1-n;return 3*t*t*n*e}(n,t)+function Zpe(n,e){return 3*(1-n)*n*n*e}(n,i)+function Kpe(n,e){return n*n*n*e}(n,r)}class U6 extends ku{constructor(e=new xe,t=new xe,i=new xe,r=new xe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new xe){const i=t,r=this.v0,o=this.v1,s=this.v2,a=this.v3;return i.set(sx(e,r.x,o.x,s.x,a.x),sx(e,r.y,o.y,s.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class V6 extends ku{constructor(e=new xe,t=new xe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new xe){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new xe){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class H6 extends ku{constructor(e=new xe,t=new xe,i=new xe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new xe){const i=t,r=this.v0,o=this.v1,s=this.v2;return i.set(ox(e,r.x,o.x,s.x),ox(e,r.y,o.y,s.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class G6 extends ku{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new xe){const i=t,r=this.points,o=(r.length-1)*e,s=Math.floor(o),a=o-s,l=r[0===s?s:s-1],u=r[s],c=r[s>r.length-2?r.length-1:s+1],f=r[s>r.length-3?r.length-1:s+2];return i.set(B6(a,l.x,u.x,c.x,f.x),B6(a,l.y,u.y,c.y,f.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new xe).fromArray(r))}return this}}var g1=Object.freeze({__proto__:null,ArcCurve:class Gpe extends GN{constructor(e,t,i,r,o,s){super(e,t,i,i,r,o,s),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class jpe extends ku{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new U){const i=t,r=this.points,o=r.length,s=(o-(this.closed?0:1))*e;let u,c,a=Math.floor(s),l=s-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/o)+1)*o:0===l&&a===o-1&&(a=o-2,l=1),this.closed||a>0?u=r[(a-1)%o]:(p1.subVectors(r[0],r[1]).add(r[0]),u=p1);const f=r[a%o],h=r[(a+1)%o];if(this.closed||a+2<o?c=r[(a+2)%o]:(p1.subVectors(r[o-1],r[o-2]).add(r[o-1]),c=p1),"centripetal"===this.curveType||"chordal"===this.curveType){const g="chordal"===this.curveType?.5:.25;let m=Math.pow(u.distanceToSquared(f),g),v=Math.pow(f.distanceToSquared(h),g),_=Math.pow(h.distanceToSquared(c),g);v<1e-4&&(v=1),m<1e-4&&(m=v),_<1e-4&&(_=v),WN.initNonuniformCatmullRom(u.x,f.x,h.x,c.x,m,v,_),$N.initNonuniformCatmullRom(u.y,f.y,h.y,c.y,m,v,_),qN.initNonuniformCatmullRom(u.z,f.z,h.z,c.z,m,v,_)}else"catmullrom"===this.curveType&&(WN.initCatmullRom(u.x,f.x,h.x,c.x,this.tension),$N.initCatmullRom(u.y,f.y,h.y,c.y,this.tension),qN.initCatmullRom(u.z,f.z,h.z,c.z,this.tension));return i.set(WN.calc(l),$N.calc(l),qN.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new U).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},CubicBezierCurve:U6,CubicBezierCurve3:class Jpe extends ku{constructor(e=new U,t=new U,i=new U,r=new U){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new U){const i=t,r=this.v0,o=this.v1,s=this.v2,a=this.v3;return i.set(sx(e,r.x,o.x,s.x,a.x),sx(e,r.y,o.y,s.y,a.y),sx(e,r.z,o.z,s.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},EllipseCurve:GN,LineCurve:V6,LineCurve3:class Qpe extends ku{constructor(e=new U,t=new U){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new U){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new U){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:H6,QuadraticBezierCurve3:class z6 extends ku{constructor(e=new U,t=new U,i=new U){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new U){const i=t,r=this.v0,o=this.v1,s=this.v2;return i.set(ox(e,r.x,o.x,s.x),ox(e,r.y,o.y,s.y),ox(e,r.z,o.z,s.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},SplineCurve:G6});class ege extends ku{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);return e.equals(t)||this.curves.push(new g1[!0===e.isVector2?"LineCurve":"LineCurve3"](t,e)),this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let o=0;for(;o<r.length;){if(r[o]>=i){const s=r[o]-i,a=this.curves[o],l=a.getLength();return a.getPointAt(0===l?0:1-s/l,t)}o++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,o=this.curves;r<o.length;r++){const s=o[r],l=s.getPoints(s.isEllipseCurve?2*e:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e);for(let u=0;u<l.length;u++){const c=l[u];i&&i.equals(c)||(t.push(c),i=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push((new g1[r.type]).fromJSON(r))}return this}}class XN extends ege{constructor(e){super(),this.type="Path",this.currentPoint=new xe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new V6(this.currentPoint.clone(),new xe(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const o=new H6(this.currentPoint.clone(),new xe(e,t),new xe(i,r));return this.curves.push(o),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,o,s){const a=new U6(this.currentPoint.clone(),new xe(e,t),new xe(i,r),new xe(o,s));return this.curves.push(a),this.currentPoint.set(o,s),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new G6(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,o,s){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,i,r,o,s),this}absarc(e,t,i,r,o,s){return this.absellipse(e,t,i,i,r,o,s),this}ellipse(e,t,i,r,o,s,a,l){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,i,r,o,s,a,l),this}absellipse(e,t,i,r,o,s,a,l){const u=new GN(e,t,i,r,o,s,a,l);if(this.curves.length>0){const f=u.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(u);const c=u.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Og extends XN{constructor(e){super(e),this.uuid=il(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push((new XN).fromJSON(r))}return this}}function j6(n,e,t,i,r){let o;if(r===function _ge(n,e,t,i){let r=0;for(let o=e,s=t-i;o<t;o+=i)r+=(n[s]-n[o])*(n[o+1]+n[s+1]),s=o;return r}(n,e,t,i)>0)for(let s=e;s<t;s+=i)o=X6(s/i|0,n[s],n[s+1],o);else for(let s=t-i;s>=e;s-=i)o=X6(s/i|0,n[s],n[s+1],o);return o&&Q_(o,o.next)&&(cx(o),o=o.next),o}function Ng(n,e){if(!n)return n;e||(e=n);let i,t=n;do{if(i=!1,t.steiner||!Q_(t,t.next)&&0!==Sr(t.prev,t,t.next))t=t.next;else{if(cx(t),t=e=t.prev,t===t.next)break;i=!0}}while(i||t!==e);return e}function ax(n,e,t,i,r,o,s){if(!n)return;!s&&o&&function dge(n,e,t,i){let r=n;do{0===r.z&&(r.z=YN(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,function fge(n){let e,t=1;do{let r,i=n;n=null;let o=null;for(e=0;i;){e++;let s=i,a=0;for(let u=0;u<t&&(a++,s=s.nextZ,s);u++);let l=t;for(;a>0||l>0&&s;)0!==a&&(0===l||!s||i.z<=s.z)?(r=i,i=i.nextZ,a--):(r=s,s=s.nextZ,l--),o?o.nextZ=r:n=r,r.prevZ=o,o=r;i=s}o.nextZ=null,t*=2}while(e>1)}(r)}(n,i,r,o);let a=n;for(;n.prev!==n.next;){const l=n.prev,u=n.next;if(o?ige(n,i,r,o):nge(n))e.push(l.i,n.i,u.i),cx(n),n=u.next,a=u.next;else if((n=u)===a){s?1===s?ax(n=rge(Ng(n),e),e,t,i,r,o,2):2===s&&oge(n,e,t,i,r,o):ax(Ng(n),e,t,i,r,o,1);break}}}function nge(n){const e=n.prev,t=n,i=n.next;if(Sr(e,t,i)>=0)return!1;const r=e.x,o=t.x,s=i.x,a=e.y,l=t.y,u=i.y,c=Math.min(r,o,s),f=Math.min(a,l,u),h=Math.max(r,o,s),g=Math.max(a,l,u);let m=i.next;for(;m!==e;){if(m.x>=c&&m.x<=h&&m.y>=f&&m.y<=g&&lx(r,a,o,l,s,u,m.x,m.y)&&Sr(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function ige(n,e,t,i){const r=n.prev,o=n,s=n.next;if(Sr(r,o,s)>=0)return!1;const a=r.x,l=o.x,u=s.x,c=r.y,f=o.y,h=s.y,g=Math.min(a,l,u),m=Math.min(c,f,h),v=Math.max(a,l,u),_=Math.max(c,f,h),y=YN(g,m,e,t,i),w=YN(v,_,e,t,i);let x=n.prevZ,M=n.nextZ;for(;x&&x.z>=y&&M&&M.z<=w;){if(x.x>=g&&x.x<=v&&x.y>=m&&x.y<=_&&x!==r&&x!==s&&lx(a,c,l,f,u,h,x.x,x.y)&&Sr(x.prev,x,x.next)>=0||(x=x.prevZ,M.x>=g&&M.x<=v&&M.y>=m&&M.y<=_&&M!==r&&M!==s&&lx(a,c,l,f,u,h,M.x,M.y)&&Sr(M.prev,M,M.next)>=0))return!1;M=M.nextZ}for(;x&&x.z>=y;){if(x.x>=g&&x.x<=v&&x.y>=m&&x.y<=_&&x!==r&&x!==s&&lx(a,c,l,f,u,h,x.x,x.y)&&Sr(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;M&&M.z<=w;){if(M.x>=g&&M.x<=v&&M.y>=m&&M.y<=_&&M!==r&&M!==s&&lx(a,c,l,f,u,h,M.x,M.y)&&Sr(M.prev,M,M.next)>=0)return!1;M=M.nextZ}return!0}function rge(n,e){let t=n;do{const i=t.prev,r=t.next.next;!Q_(i,r)&&$6(i,t,t.next,r)&&ux(i,r)&&ux(r,i)&&(e.push(i.i,t.i,r.i),cx(t),cx(t.next),t=n=r),t=t.next}while(t!==n);return Ng(t)}function oge(n,e,t,i,r,o){let s=n;do{let a=s.next.next;for(;a!==s.prev;){if(s.i!==a.i&&pge(s,a)){let l=q6(s,a);return s=Ng(s,s.next),l=Ng(l,l.next),ax(s,e,t,i,r,o,0),void ax(l,e,t,i,r,o,0)}a=a.next}s=s.next}while(s!==n)}function age(n,e){let t=n.x-e.x;return 0===t&&(t=n.y-e.y,0===t)&&(t=(n.next.y-n.y)/(n.next.x-n.x)-(e.next.y-e.y)/(e.next.x-e.x)),t}function lge(n,e){const t=function uge(n,e){let t=e;const i=n.x,r=n.y;let s,o=-1/0;if(Q_(n,t))return t;do{if(Q_(n,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const f=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(f<=i&&f>o&&(o=f,s=t.x<t.next.x?t:t.next,f===i))return s}t=t.next}while(t!==e);if(!s)return null;const a=s,l=s.x,u=s.y;let c=1/0;t=s;do{if(i>=t.x&&t.x>=l&&i!==t.x&&W6(r<u?i:o,r,l,u,r<u?o:i,r,t.x,t.y)){const f=Math.abs(r-t.y)/(i-t.x);ux(t,n)&&(f<c||f===c&&(t.x>s.x||t.x===s.x&&cge(s,t)))&&(s=t,c=f)}t=t.next}while(t!==a);return s}(n,e);if(!t)return e;const i=q6(t,n);return Ng(i,i.next),Ng(t,t.next)}function cge(n,e){return Sr(n.prev,n,e.prev)<0&&Sr(e.next,n,n.next)<0}function YN(n,e,t,i,r){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-t)*r|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function hge(n){let e=n,t=n;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==n);return t}function W6(n,e,t,i,r,o,s,a){return(r-s)*(e-a)>=(n-s)*(o-a)&&(n-s)*(i-a)>=(t-s)*(e-a)&&(t-s)*(o-a)>=(r-s)*(i-a)}function lx(n,e,t,i,r,o,s,a){return!(n===s&&e===a)&&W6(n,e,t,i,r,o,s,a)}function pge(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function gge(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&$6(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}(n,e)&&(ux(n,e)&&ux(e,n)&&function mge(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,o=(n.y+e.y)/2;do{t.y>o!=t.next.y>o&&t.next.y!==t.y&&r<(t.next.x-t.x)*(o-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next}while(t!==n);return i}(n,e)&&(Sr(n.prev,n,e.prev)||Sr(n,e.prev,e))||Q_(n,e)&&Sr(n.prev,n,n.next)>0&&Sr(e.prev,e,e.next)>0)}function Sr(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Q_(n,e){return n.x===e.x&&n.y===e.y}function $6(n,e,t,i){const r=_1(Sr(n,e,t)),o=_1(Sr(n,e,i)),s=_1(Sr(t,i,n)),a=_1(Sr(t,i,e));return!!(r!==o&&s!==a||0===r&&m1(n,t,e)||0===o&&m1(n,i,e)||0===s&&m1(t,n,i)||0===a&&m1(t,e,i))}function m1(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function _1(n){return n>0?1:n<0?-1:0}function ux(n,e){return Sr(n.prev,n,n.next)<0?Sr(n,e,n.next)>=0&&Sr(n,n.prev,e)>=0:Sr(n,e,n.prev)<0||Sr(n,n.next,e)<0}function q6(n,e){const t=ZN(n.i,n.x,n.y),i=ZN(e.i,e.x,e.y),r=n.next,o=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,o.next=i,i.prev=o,i}function X6(n,e,t,i){const r=ZN(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function cx(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function ZN(n,e,t){return{i:n,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class yge{static triangulate(e,t,i=2){return function tge(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let o=j6(n,0,r,t,!0);const s=[];if(!o||o.next===o.prev)return s;let a,l,u;if(i&&(o=function sge(n,e,t,i){const r=[];for(let o=0,s=e.length;o<s;o++){const u=j6(n,e[o]*i,o<s-1?e[o+1]*i:n.length,i,!1);u===u.next&&(u.steiner=!0),r.push(hge(u))}r.sort(age);for(let o=0;o<r.length;o++)t=lge(r[o],t);return t}(n,e,o,t)),n.length>80*t){a=1/0,l=1/0;let c=-1/0,f=-1/0;for(let h=t;h<r;h+=t){const g=n[h],m=n[h+1];g<a&&(a=g),m<l&&(l=m),g>c&&(c=g),m>f&&(f=m)}u=Math.max(c-a,f-l),u=0!==u?32767/u:0}return ax(o,s,t,a,l,u,0),s}(e,t,i)}}class Bu{static area(e){const t=e.length;let i=0;for(let r=t-1,o=0;o<t;r=o++)i+=e[r].x*e[o].y-e[o].x*e[r].y;return.5*i}static isClockWise(e){return Bu.area(e)<0}static triangulateShape(e,t){const i=[],r=[],o=[];Y6(e),Z6(i,e);let s=e.length;t.forEach(Y6);for(let l=0;l<t.length;l++)r.push(s),s+=t[l].length,Z6(i,t[l]);const a=yge.triangulate(i,r);for(let l=0;l<a.length;l+=3)o.push(a.slice(l,l+3));return o}}function Y6(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function Z6(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class dx extends cn{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const o=e/2,s=t/2,a=Math.floor(i),l=Math.floor(r),u=a+1,c=l+1,f=e/a,h=t/l,g=[],m=[],v=[],_=[];for(let y=0;y<c;y++){const w=y*h-s;for(let x=0;x<u;x++)m.push(x*f-o,-w,0),v.push(0,0,1),_.push(x/a),_.push(1-y/l)}for(let y=0;y<l;y++)for(let w=0;w<a;w++){const M=w+u*(y+1),D=w+1+u*(y+1),E=w+1+u*y;g.push(w+u*y,M,E),g.push(M,D,E)}this.setIndex(g),this.setAttribute("position",new it(m,3)),this.setAttribute("normal",new it(v,3)),this.setAttribute("uv",new it(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dx(e.width,e.height,e.widthSegments,e.heightSegments)}}class v1 extends cn{constructor(e=new Og([new xe(0,.5),new xe(-.5,-.5),new xe(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],o=[],s=[];let a=0,l=0;if(!1===Array.isArray(e))u(e);else for(let c=0;c<e.length;c++)u(e[c]),this.addGroup(a,l,c),a+=l,l=0;function u(c){const f=r.length/3,h=c.extractPoints(t);let g=h.shape;const m=h.holes;!1===Bu.isClockWise(g)&&(g=g.reverse());for(let _=0,y=m.length;_<y;_++){const w=m[_];!0===Bu.isClockWise(w)&&(m[_]=w.reverse())}const v=Bu.triangulateShape(g,m);for(let _=0,y=m.length;_<y;_++)g=g.concat(m[_]);for(let _=0,y=g.length;_<y;_++){const w=g[_];r.push(w.x,w.y,0),o.push(0,0,1),s.push(w.x,w.y)}for(let _=0,y=v.length;_<y;_++){const w=v[_];i.push(w[0]+f,w[1]+f,w[2]+f),l+=3}}this.setIndex(i),this.setAttribute("position",new it(r,3)),this.setAttribute("normal",new it(o,3)),this.setAttribute("uv",new it(s,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function wge(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++)e.shapes.push(n[t].uuid);else e.shapes.push(n.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const i=[];for(let r=0,o=e.shapes.length;r<o;r++)i.push(t[e.shapes[r]]);return new v1(i,e.curveSegments)}}class w1 extends lo{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Ke(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ke(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new As,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Uu extends w1{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new xe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return _n(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ke(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ke(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ke(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class ey extends lo{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ke(16777215),this.specular=new Ke(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ke(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new As,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Q6 extends lo{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ke(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ke(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new As,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class eW extends lo{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class tW extends lo{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Fg(n,e){return n&&n.constructor!==e?"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n):n}function iW(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,o){return n[r]-n[o]}),i}function oF(n,e,t){const i=n.length,r=new n.constructor(i);for(let o=0,s=0;s!==i;++o){const a=t[o]*e;for(let l=0;l!==e;++l)r[s++]=n[a+l]}return r}function sF(n,e,t,i){let r=1,o=n[0];for(;void 0!==o&&void 0===o[i];)o=n[r++];if(void 0===o)return;let s=o[i];if(void 0!==s)if(Array.isArray(s))do{s=o[i],void 0!==s&&(e.push(o.time),t.push(...s)),o=n[r++]}while(void 0!==o);else if(void 0!==s.toArray)do{s=o[i],void 0!==s&&(e.push(o.time),s.toArray(t,t.length)),o=n[r++]}while(void 0!==o);else do{s=o[i],void 0!==s&&(e.push(o.time),t.push(s)),o=n[r++]}while(void 0!==o)}class fx{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],o=t[i-1];e:{t:{let s;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<o)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(o=r,r=t[++i],e<r)break t}s=t.length;break n}if(e>=o)break e;{const a=t[1];e<a&&(i=2,o=a);for(let l=i-2;;){if(void 0===o)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=o,o=t[--i-1],e>=o)break t}s=i,i=0}}for(;i<s;){const a=i+s>>>1;e<t[a]?s=a:i=a+1}if(r=t[i],o=t[i-1],void 0===o)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,o,r)}return this.interpolate_(i,o,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,o=e*r;for(let s=0;s!==r;++s)t[s]=i[o+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Rge extends fx{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let o=e-2,s=e+1,a=r[o],l=r[s];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:o=e,a=2*t-i;break;case 2402:o=r.length-2,a=t+r[o]-r[o+1];break;default:o=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case 2401:s=e,l=2*i-t;break;case 2402:s=1,l=i+r[1]-r[0];break;default:s=e-1,l=t}const u=.5*(i-t),c=this.valueSize;this._weightPrev=u/(t-a),this._weightNext=u/(l-i),this._offsetPrev=o*c,this._offsetNext=s*c}interpolate_(e,t,i,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,c=this._offsetPrev,f=this._offsetNext,h=this._weightPrev,g=this._weightNext,m=(i-t)/(r-t),v=m*m,_=v*m,y=-h*_+2*h*v-h*m,w=(1+h)*_+(-1.5-2*h)*v+(-.5+h)*m+1,x=(-1-g)*_+(1.5+g)*v+.5*m,M=g*_-g*v;for(let D=0;D!==a;++D)o[D]=y*s[c+D]+w*s[u+D]+x*s[l+D]+M*s[f+D];return o}}class rW extends fx{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,c=(i-t)/(r-t),f=1-c;for(let h=0;h!==a;++h)o[h]=s[u+h]*f+s[l+h]*c;return o}}class Pge extends fx{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Vu{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Fg(t,this.TimeBufferType),this.values=Fg(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Fg(e.times,Array),values:Fg(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new Pge(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new rW(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Rge(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Uw:t=this.InterpolantFactoryMethodDiscrete;break;case Vw:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Uw;case this.InterpolantFactoryMethodLinear:return Vw;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let o=0,s=r-1;for(;o!==r&&i[o]<e;)++o;for(;-1!==s&&i[s]>t;)--s;if(++s,0!==o||s!==r){o>=s&&(s=Math.max(s,1),o=s-1);const a=this.getValueSize();this.times=i.slice(o,s),this.values=this.values.slice(o*a,s*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,o=i.length;0===o&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==o;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==s&&s>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,s),e=!1;break}s=l}if(void 0!==r&&function nW(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(r))for(let a=0,l=r.length;a!==l;++a){const u=r[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=2302===this.getInterpolation(),o=e.length-1;let s=1;for(let a=1;a<o;++a){let l=!1;const u=e[a];if(u!==e[a+1]&&(1!==a||u!==e[0]))if(r)l=!0;else{const f=a*i,h=f-i,g=f+i;for(let m=0;m!==i;++m){const v=t[f+m];if(v!==t[h+m]||v!==t[g+m]){l=!0;break}}}if(l){if(a!==s){e[s]=e[a];const f=a*i,h=s*i;for(let g=0;g!==i;++g)t[h+g]=t[f+g]}++s}}if(o>0){e[s]=e[o];for(let a=o*i,l=s*i,u=0;u!==i;++u)t[l+u]=t[a+u];++s}return s!==e.length?(this.times=e.slice(0,s),this.values=t.slice(0,s*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Vu.prototype.ValueTypeName="",Vu.prototype.TimeBufferType=Float32Array,Vu.prototype.ValueBufferType=Float32Array,Vu.prototype.DefaultInterpolation=Vw;class ty extends Vu{constructor(e,t,i){super(e,t,i)}}ty.prototype.ValueTypeName="bool",ty.prototype.ValueBufferType=Array,ty.prototype.DefaultInterpolation=Uw,ty.prototype.InterpolantFactoryMethodLinear=void 0,ty.prototype.InterpolantFactoryMethodSmooth=void 0;class oW extends Vu{constructor(e,t,i,r){super(e,t,i,r)}}oW.prototype.ValueTypeName="color";class Lg extends Vu{constructor(e,t,i,r){super(e,t,i,r)}}Lg.prototype.ValueTypeName="number";class Oge extends fx{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let u=e*a;for(let c=u+a;u!==c;u+=4)hr.slerpFlat(o,0,s,u-a,s,u,l);return o}}class Rh extends Vu{constructor(e,t,i,r){super(e,t,i,r)}InterpolantFactoryMethodLinear(e){return new Oge(this.times,this.values,this.getValueSize(),e)}}Rh.prototype.ValueTypeName="quaternion",Rh.prototype.InterpolantFactoryMethodSmooth=void 0;class ny extends Vu{constructor(e,t,i){super(e,t,i)}}ny.prototype.ValueTypeName="string",ny.prototype.ValueBufferType=Array,ny.prototype.DefaultInterpolation=Uw,ny.prototype.InterpolantFactoryMethodLinear=void 0,ny.prototype.InterpolantFactoryMethodSmooth=void 0;class kg extends Vu{constructor(e,t,i,r){super(e,t,i,r)}}kg.prototype.ValueTypeName="vector";class iy{constructor(e="",t=-1,i=[],r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=il(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let s=0,a=i.length;s!==a;++s)t.push(Fge(i[s]).scale(r));const o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,s=i.length;o!==s;++o)t.push(Vu.toJSON(i[o]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const o=t.length,s=[];for(let a=0;a<o;a++){let l=[],u=[];l.push((a+o-1)%o,a,(a+1)%o),u.push(0,1,0);const c=iW(l);l=oF(l,1,c),u=oF(u,1,c),!r&&0===l[0]&&(l.push(o),u.push(u[0])),s.push(new Lg(".morphTargetInfluences["+t[a].name+"]",l,u).scale(1/i))}return new this(e,-1,s)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},o=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const u=e[a],c=u.name.match(o);if(c&&c.length>1){const f=c[1];let h=r[f];h||(r[f]=h=[]),h.push(u)}}const s=[];for(const a in r)s.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return s}static parseAnimation(e,t){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(f,h,g,m,v){if(0!==g.length){const _=[],y=[];sF(g,_,y,m),0!==_.length&&v.push(new f(h,_,y))}},r=[],o=e.name||"default",s=e.fps||30,a=e.blendMode;let l=e.length||-1;const u=e.hierarchy||[];for(let f=0;f<u.length;f++){const h=u[f].keys;if(h&&0!==h.length)if(h[0].morphTargets){const g={};let m;for(m=0;m<h.length;m++)if(h[m].morphTargets)for(let v=0;v<h[m].morphTargets.length;v++)g[h[m].morphTargets[v]]=-1;for(const v in g){const _=[],y=[];for(let w=0;w!==h[m].morphTargets.length;++w){const x=h[m];_.push(x.time),y.push(x.morphTarget===v?1:0)}r.push(new Lg(".morphTargetInfluence["+v+"]",_,y))}l=g.length*s}else{const g=".bones["+t[f].name+"]";i(kg,g+".position",h,"pos",r),i(Rh,g+".quaternion",h,"rot",r),i(kg,g+".scale",h,"scl",r)}}return 0===r.length?null:new this(o,l,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const o=this.tracks[i];t=Math.max(t,o.times[o.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Fge(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function Nge(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Lg;case"vector":case"vector2":case"vector3":case"vector4":return kg;case"color":return oW;case"quaternion":return Rh;case"bool":case"boolean":return ty;case"string":return ny}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];sF(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Ph={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class sW{constructor(e,t,i){const r=this;let l,o=!1,s=0,a=0;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(c){a++,!1===o&&void 0!==r.onStart&&r.onStart(c,s,a),o=!0},this.itemEnd=function(c){s++,void 0!==r.onProgress&&r.onProgress(c,s,a),s===a&&(o=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(c){void 0!==r.onError&&r.onError(c)},this.resolveURL=function(c){return l?l(c):c},this.setURLModifier=function(c){return l=c,this},this.addHandler=function(c,f){return u.push(c,f),this},this.removeHandler=function(c){const f=u.indexOf(c);return-1!==f&&u.splice(f,2),this},this.getHandler=function(c){for(let f=0,h=u.length;f<h;f+=2){const g=u[f],m=u[f+1];if(g.global&&(g.lastIndex=0),g.test(c))return m}return null}}}const Lge=new sW;let ts=(()=>{class n{constructor(t){this.manager=void 0!==t?t:Lge,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const r=this;return new Promise(function(o,s){r.load(t,o,i,s)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})();const Hd={};class kge extends Error{constructor(e,t){super(e),this.response=t}}class Vl extends ts{constructor(e){super(e),this.mimeType="",this.responseType=""}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const o=Ph.get(e);if(void 0!==o)return this.manager.itemStart(e),setTimeout(()=>{t&&t(o),this.manager.itemEnd(e)},0),o;if(void 0!==Hd[e])return void Hd[e].push({onLoad:t,onProgress:i,onError:r});Hd[e]=[],Hd[e].push({onLoad:t,onProgress:i,onError:r});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(s).then(u=>{if(200===u.status||0===u.status){if(0===u.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===u.body||void 0===u.body.getReader)return u;const c=Hd[e],f=u.body.getReader(),h=u.headers.get("X-File-Size")||u.headers.get("Content-Length"),g=h?parseInt(h):0,m=0!==g;let v=0;const _=new ReadableStream({start(y){!function w(){f.read().then(({done:x,value:M})=>{if(x)y.close();else{v+=M.byteLength;const D=new ProgressEvent("progress",{lengthComputable:m,loaded:v,total:g});for(let E=0,I=c.length;E<I;E++){const R=c[E];R.onProgress&&R.onProgress(D)}y.enqueue(M),w()}},x=>{y.error(x)})}()}});return new Response(_)}throw new kge(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(c=>(new DOMParser).parseFromString(c,a));case"json":return u.json();default:if(""===a)return u.text();{const f=/charset="?([^;"\s]*)"?/i.exec(a),h=f&&f[1]?f[1].toLowerCase():void 0,g=new TextDecoder(h);return u.arrayBuffer().then(m=>g.decode(m))}}}).then(u=>{Ph.add(e,u);const c=Hd[e];delete Hd[e];for(let f=0,h=c.length;f<h;f++){const g=c[f];g.onLoad&&g.onLoad(u)}}).catch(u=>{const c=Hd[e];if(void 0===c)throw this.manager.itemError(e),u;delete Hd[e];for(let f=0,h=c.length;f<h;f++){const g=c[f];g.onError&&g.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class x1 extends ts{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,s=Ph.get(e);if(void 0!==s)return o.manager.itemStart(e),setTimeout(function(){t&&t(s),o.manager.itemEnd(e)},0),s;const a=zw("img");function l(){c(),Ph.add(e,this),t&&t(this),o.manager.itemEnd(e)}function u(f){c(),r&&r(f),o.manager.itemError(e),o.manager.itemEnd(e)}function c(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),o.manager.itemStart(e),a.src=e,a}}class aW extends ts{constructor(e){super(e)}load(e,t,i,r){const o=new Jo,s=new x1(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(a){o.image=a,o.needsUpdate=!0,void 0!==t&&t(o)},i,r),o}}class Bg extends mi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ke(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}}class lW extends Bg{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(mi.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ke(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const aF=new at,uW=new U,cW=new U;class lF{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new xe(512,512),this.mapType=Ic,this.map=null,this.mapPass=null,this.matrix=new at,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new tx,this._frameExtents=new xe(1,1),this._viewportCount=1,this._viewports=[new $n(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;uW.setFromMatrixPosition(e.matrixWorld),t.position.copy(uW),cW.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(cW),t.updateMatrixWorld(),aF.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(aF),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(aF)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Bge extends lF{constructor(){super(new bo(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*D_*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,o=e.distance||t.far;(i!==t.fov||r!==t.aspect||o!==t.far)&&(t.fov=i,t.aspect=r,t.far=o,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class uF extends Bg{constructor(e,t,i=0,r=Math.PI/3,o=0,s=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(mi.DEFAULT_UP),this.updateMatrix(),this.target=new mi,this.distance=i,this.angle=r,this.penumbra=o,this.decay=s,this.map=null,this.shadow=new Bge}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const dW=new at,hx=new U,cF=new U;class Uge extends lF{constructor(){super(new bo(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new xe(4,2),this._viewportCount=6,this._viewports=[new $n(2,1,1,1),new $n(0,1,1,1),new $n(3,1,1,1),new $n(1,1,1,1),new $n(3,0,1,1),new $n(1,0,1,1)],this._cubeDirections=[new U(1,0,0),new U(-1,0,0),new U(0,0,1),new U(0,0,-1),new U(0,1,0),new U(0,-1,0)],this._cubeUps=[new U(0,1,0),new U(0,1,0),new U(0,1,0),new U(0,1,0),new U(0,0,1),new U(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,o=e.distance||i.far;o!==i.far&&(i.far=o,i.updateProjectionMatrix()),hx.setFromMatrixPosition(e.matrixWorld),i.position.copy(hx),cF.copy(i.position),cF.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(cF),i.updateMatrixWorld(),r.makeTranslation(-hx.x,-hx.y,-hx.z),dW.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(dW)}}class M1 extends Bg{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new Uge}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class C1 extends MN{constructor(e=-1,t=1,i=1,r=-1,o=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=o,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,o,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let o=i-e,s=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=u*this.view.offsetX,s=o+u*this.view.width,a-=c*this.view.offsetY,l=a-c*this.view.height}this.projectionMatrix.makeOrthographic(o,s,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class Vge extends lF{constructor(){super(new C1(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class dF extends Bg{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(mi.DEFAULT_UP),this.updateMatrix(),this.target=new mi,this.shadow=new Vge}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class fW extends Bg{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Oh{static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class qge extends ts{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,s=Ph.get(e);if(void 0!==s)return o.manager.itemStart(e),s.then?void s.then(u=>{t&&t(u),o.manager.itemEnd(e)}).catch(u=>{r&&r(u)}):(setTimeout(function(){t&&t(s),o.manager.itemEnd(e)},0),s);const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader;const l=fetch(e,a).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(u){return Ph.add(e,u),t&&t(u),o.manager.itemEnd(e),u}).catch(function(u){r&&r(u),Ph.remove(e),o.manager.itemError(e),o.manager.itemEnd(e)});Ph.add(e,l),o.manager.itemStart(e)}}class Xge extends bo{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}const hF="\\[\\]\\.:\\/",eme=new RegExp("["+hF+"]","g"),pF="[^"+hF+"]",tme="[^"+hF.replace("\\.","")+"]",sme=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",pF)+/(WCOD+)?/.source.replace("WCOD",tme)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",pF)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",pF)+"$"),ame=["material","materials","bones","map"];class lme{constructor(e,t,i){const r=i||wi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,o=i.length;r!==o;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let wi=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(eme,"")}static parseTrackName(t){const i=sme.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},o=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==o&&-1!==o){const s=r.nodeName.substring(o+1);-1!==ame.indexOf(s)&&(r.nodeName=r.nodeName.substring(0,o),r.objectName=s)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(s){for(let a=0;a<s.length;a++){const l=s[a];if(l.name===i||l.uuid===i)return l;const u=r(l.children);if(u)return u}return null},o=r(t.children);if(o)return o}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let o=0,s=r.length;o!==s;++o)t[i++]=r[o]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let o=0,s=r.length;o!==s;++o)r[o]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let o=0,s=r.length;o!==s;++o)r[o]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let o=0,s=r.length;o!==s;++o)r[o]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,o=i.propertyName;let s=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(r){let c=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let f=0;f<t.length;f++)if(t[f].name===c){c=f;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==c){if(void 0===t[c])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[c]}}const a=t[o];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+o+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,!0===t.isMaterial?l=this.Versioning.NeedsUpdate:!0===t.isObject3D&&(l=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(void 0!==s){if("morphTargetInfluences"===o){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[s]&&(s=t.morphTargetDictionary[s])}u=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else void 0!==a.fromArray&&void 0!==a.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(u=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=o;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=lme,n})();wi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},wi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},wi.prototype.GetterByBindingType=[wi.prototype._getValue_direct,wi.prototype._getValue_array,wi.prototype._getValue_arrayElement,wi.prototype._getValue_toArray],wi.prototype.SetterByBindingTypeAndVersioning=[[wi.prototype._setValue_direct,wi.prototype._setValue_direct_setNeedsUpdate,wi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[wi.prototype._setValue_array,wi.prototype._setValue_array_setNeedsUpdate,wi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[wi.prototype._setValue_arrayElement,wi.prototype._setValue_arrayElement_setNeedsUpdate,wi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[wi.prototype._setValue_fromArray,wi.prototype._setValue_fromArray_setNeedsUpdate,wi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);const xW=new at;class fme{constructor(e,t,i=0,r=1/0){this.ray=new L_(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new cN,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return xW.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(xW),this}intersectObject(e,t=!0,i=[]){return gF(e,this,i,t),i.sort(MW),i}intersectObjects(e,t=!0,i=[]){for(let r=0,o=e.length;r<o;r++)gF(e[r],this,i,t);return i.sort(MW),i}}function MW(n,e){return n.distance-e.distance}function gF(n,e,t,i){let r=!0;if(n.layers.test(e.layers)&&!1===n.raycast(e,t)&&(r=!1),!0===r&&!0===i){const o=n.children;for(let s=0,a=o.length;s<a;s++)gF(o[s],e,t,!0)}}class CW{constructor(e=1,t=0,i=0){this.radius=e,this.phi=t,this.theta=i}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=_n(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(_n(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class pme extends Id{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){void 0!==e?(null!==this.domElement&&this.disconnect(),this.domElement=e):console.warn("THREE.Controls: connect() now requires an element.")}disconnect(){}dispose(){}update(){}}function yF(n,e,t,i){const r=function yme(n){switch(n){case Ic:case 1010:return{byteLength:1,components:1};case Nw:case 1011:case Fw:return{byteLength:2,components:1};case 1017:case 1018:return{byteLength:2,components:4};case xh:case 1013:case nl:return{byteLength:4,components:1};case 35902:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}(i);switch(t){case 1021:return n*e;case 1028:case 1029:return n*e/r.components*r.byteLength;case 1030:case 1031:return n*e*2/r.components*r.byteLength;case 1022:return n*e*3/r.components*r.byteLength;case Da:case 1033:return n*e*4/r.components*r.byteLength;case yT:case vT:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case bT:case wT:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case 35841:case 35843:return Math.max(n,16)*Math.max(e,8)/4;case 35840:case 35842:return Math.max(n,8)*Math.max(e,8)/2;case 36196:case 37492:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case 37496:case 37808:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case 37809:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case 37810:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case 37811:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case 37812:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case 37813:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case 37814:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case 37815:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case 37816:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case 37817:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case 37818:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case 37819:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case 37820:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case 37821:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case xT:case 36494:case 36495:return Math.ceil(n/4)*Math.ceil(e/4)*16;case 36283:case 36284:return Math.ceil(n/4)*Math.ceil(e/4)*8;case 36285:case 36286:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function FW(){let n=null,e=!1,t=null,i=null;function r(o,s){t(o,s),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){n=o}}}function vme(n){const e=new WeakMap;return{get:function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)},remove:function o(a){a.isInterleavedBufferAttribute&&(a=a.data);const l=e.get(a);l&&(n.deleteBuffer(l.buffer),e.delete(a))},update:function s(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const c=e.get(a);return void((!c||c.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version}))}const u=e.get(a);if(void 0===u)e.set(a,function t(a,l){const u=a.array,c=a.usage,f=u.byteLength,h=n.createBuffer();let g;if(n.bindBuffer(l,h),n.bufferData(l,u,c),a.onUploadCallback(),u instanceof Float32Array)g=n.FLOAT;else if(u instanceof Uint16Array)g=a.isFloat16BufferAttribute?n.HALF_FLOAT:n.UNSIGNED_SHORT;else if(u instanceof Int16Array)g=n.SHORT;else if(u instanceof Uint32Array)g=n.UNSIGNED_INT;else if(u instanceof Int32Array)g=n.INT;else if(u instanceof Int8Array)g=n.BYTE;else if(u instanceof Uint8Array)g=n.UNSIGNED_BYTE;else{if(!(u instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);g=n.UNSIGNED_BYTE}return{buffer:h,type:g,bytesPerElement:u.BYTES_PER_ELEMENT,version:a.version,size:f}}(a,l));else if(u.version<a.version){if(u.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");(function i(a,l,u){const c=l.array,f=l.updateRanges;if(n.bindBuffer(u,a),0===f.length)n.bufferSubData(u,0,c);else{f.sort((g,m)=>g.start-m.start);let h=0;for(let g=1;g<f.length;g++){const m=f[h],v=f[g];v.start<=m.start+m.count+1?m.count=Math.max(m.count,v.start+v.count-m.start):(++h,f[h]=v)}f.length=h+1;for(let g=0,m=f.length;g<m;g++){const v=f[g];n.bufferSubData(u,v.start*c.BYTES_PER_ELEMENT,c,v.start,v.count)}l.clearUpdateRanges()}l.onUploadCallback()})(u.buffer,a,l),u.version=a.version}}}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"176"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="176");const Nn={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},rt={common:{diffuse:{value:new Ke(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new vn},alphaMap:{value:null},alphaMapTransform:{value:new vn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new vn}},envmap:{envMap:{value:null},envMapRotation:{value:new vn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new vn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new vn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new vn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new vn},normalScale:{value:new xe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new vn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new vn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new vn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new vn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ke(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ke(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new vn},alphaTest:{value:0},uvTransform:{value:new vn}},sprite:{diffuse:{value:new Ke(16777215)},opacity:{value:1},center:{value:new xe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new vn},alphaMap:{value:null},alphaMapTransform:{value:new vn},alphaTest:{value:0}}},Nc={basic:{uniforms:ea([rt.common,rt.specularmap,rt.envmap,rt.aomap,rt.lightmap,rt.fog]),vertexShader:Nn.meshbasic_vert,fragmentShader:Nn.meshbasic_frag},lambert:{uniforms:ea([rt.common,rt.specularmap,rt.envmap,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.fog,rt.lights,{emissive:{value:new Ke(0)}}]),vertexShader:Nn.meshlambert_vert,fragmentShader:Nn.meshlambert_frag},phong:{uniforms:ea([rt.common,rt.specularmap,rt.envmap,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.fog,rt.lights,{emissive:{value:new Ke(0)},specular:{value:new Ke(1118481)},shininess:{value:30}}]),vertexShader:Nn.meshphong_vert,fragmentShader:Nn.meshphong_frag},standard:{uniforms:ea([rt.common,rt.envmap,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.roughnessmap,rt.metalnessmap,rt.fog,rt.lights,{emissive:{value:new Ke(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Nn.meshphysical_vert,fragmentShader:Nn.meshphysical_frag},toon:{uniforms:ea([rt.common,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.gradientmap,rt.fog,rt.lights,{emissive:{value:new Ke(0)}}]),vertexShader:Nn.meshtoon_vert,fragmentShader:Nn.meshtoon_frag},matcap:{uniforms:ea([rt.common,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.fog,{matcap:{value:null}}]),vertexShader:Nn.meshmatcap_vert,fragmentShader:Nn.meshmatcap_frag},points:{uniforms:ea([rt.points,rt.fog]),vertexShader:Nn.points_vert,fragmentShader:Nn.points_frag},dashed:{uniforms:ea([rt.common,rt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Nn.linedashed_vert,fragmentShader:Nn.linedashed_frag},depth:{uniforms:ea([rt.common,rt.displacementmap]),vertexShader:Nn.depth_vert,fragmentShader:Nn.depth_frag},normal:{uniforms:ea([rt.common,rt.bumpmap,rt.normalmap,rt.displacementmap,{opacity:{value:1}}]),vertexShader:Nn.meshnormal_vert,fragmentShader:Nn.meshnormal_frag},sprite:{uniforms:ea([rt.sprite,rt.fog]),vertexShader:Nn.sprite_vert,fragmentShader:Nn.sprite_frag},background:{uniforms:{uvTransform:{value:new vn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Nn.background_vert,fragmentShader:Nn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new vn}},vertexShader:Nn.backgroundCube_vert,fragmentShader:Nn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Nn.cube_vert,fragmentShader:Nn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Nn.equirect_vert,fragmentShader:Nn.equirect_frag},distanceRGBA:{uniforms:ea([rt.common,rt.displacementmap,{referencePosition:{value:new U},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Nn.distanceRGBA_vert,fragmentShader:Nn.distanceRGBA_frag},shadow:{uniforms:ea([rt.lights,rt.fog,{color:{value:new Ke(0)},opacity:{value:1}}]),vertexShader:Nn.shadow_vert,fragmentShader:Nn.shadow_frag}};Nc.physical={uniforms:ea([Nc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new vn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new vn},clearcoatNormalScale:{value:new xe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new vn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new vn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new vn},sheen:{value:0},sheenColor:{value:new Ke(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new vn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new vn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new vn},transmissionSamplerSize:{value:new xe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new vn},attenuationDistance:{value:0},attenuationColor:{value:new Ke(0)},specularColor:{value:new Ke(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new vn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new vn},anisotropyVector:{value:new xe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new vn}}]),vertexShader:Nn.meshphysical_vert,fragmentShader:Nn.meshphysical_frag};const P1={r:0,b:0,g:0},jg=new As,v_e=new at;function b_e(n,e,t,i,r,o,s){const a=new Ke(0);let u,c,l=!0===o?0:1,f=null,h=0,g=null;function m(x){let M=!0===x.isScene?x.background:null;return M&&M.isTexture&&(M=(x.backgroundBlurriness>0?t:e).get(M)),M}function y(x,M){x.getRGB(P1,d6(n)),i.buffers.color.setClear(P1.r,P1.g,P1.b,M,s)}return{getClearColor:function(){return a},setClearColor:function(x,M=1){a.set(x),l=M,y(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(x){l=x,y(a,l)},render:function v(x){let M=!1;const D=m(x);null===D?y(a,l):D&&D.isColor&&(y(D,1),M=!0);const E=n.xr.getEnvironmentBlendMode();"additive"===E?i.buffers.color.setClear(0,0,0,1,s):"alpha-blend"===E&&i.buffers.color.setClear(0,0,0,0,s),(n.autoClear||M)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))},addToRenderList:function _(x,M){const D=m(M);D&&(D.isCubeTexture||306===D.mapping)?(void 0===c&&(c=new yr(new G_(1,1,1),new Rc({name:"BackgroundCubeMaterial",uniforms:j_(Nc.backgroundCube.uniforms),vertexShader:Nc.backgroundCube.vertexShader,fragmentShader:Nc.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(E,I,R){this.matrixWorld.copyPosition(R.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),jg.copy(M.backgroundRotation),jg.x*=-1,jg.y*=-1,jg.z*=-1,D.isCubeTexture&&!1===D.isRenderTargetTexture&&(jg.y*=-1,jg.z*=-1),c.material.uniforms.envMap.value=D,c.material.uniforms.flipEnvMap.value=D.isCubeTexture&&!1===D.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=M.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=M.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(v_e.makeRotationFromEuler(jg)),c.material.toneMapped=bn.getTransfer(D.colorSpace)!==ki,(f!==D||h!==D.version||g!==n.toneMapping)&&(c.material.needsUpdate=!0,f=D,h=D.version,g=n.toneMapping),c.layers.enableAll(),x.unshift(c,c.geometry,c.material,0,0,null)):D&&D.isTexture&&(void 0===u&&(u=new yr(new dx(2,2),new Rc({name:"BackgroundMaterial",uniforms:j_(Nc.background.uniforms),vertexShader:Nc.background.vertexShader,fragmentShader:Nc.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(u)),u.material.uniforms.t2D.value=D,u.material.uniforms.backgroundIntensity.value=M.backgroundIntensity,u.material.toneMapped=bn.getTransfer(D.colorSpace)!==ki,!0===D.matrixAutoUpdate&&D.updateMatrix(),u.material.uniforms.uvTransform.value.copy(D.matrix),(f!==D||h!==D.version||g!==n.toneMapping)&&(u.material.needsUpdate=!0,f=D,h=D.version,g=n.toneMapping),u.layers.enableAll(),x.unshift(u,u.geometry,u.material,0,0,null))},dispose:function w(){void 0!==c&&(c.geometry.dispose(),c.material.dispose(),c=void 0),void 0!==u&&(u.geometry.dispose(),u.material.dispose(),u=void 0)}}}function w_e(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),i={},r=h(null);let o=r,s=!1;function u(T){return n.bindVertexArray(T)}function c(T){return n.deleteVertexArray(T)}function h(T){const z=[],Z=[],J=[];for(let le=0;le<t;le++)z[le]=0,Z[le]=0,J[le]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:z,enabledAttributes:Z,attributeDivisors:J,object:T,attributes:{},index:null}}function v(){const T=o.newAttributes;for(let z=0,Z=T.length;z<Z;z++)T[z]=0}function _(T){y(T,0)}function y(T,z){const J=o.enabledAttributes,le=o.attributeDivisors;o.newAttributes[T]=1,0===J[T]&&(n.enableVertexAttribArray(T),J[T]=1),le[T]!==z&&(n.vertexAttribDivisor(T,z),le[T]=z)}function w(){const T=o.newAttributes,z=o.enabledAttributes;for(let Z=0,J=z.length;Z<J;Z++)z[Z]!==T[Z]&&(n.disableVertexAttribArray(Z),z[Z]=0)}function x(T,z,Z,J,le,fe,W){!0===W?n.vertexAttribIPointer(T,z,Z,le,fe):n.vertexAttribPointer(T,z,Z,J,le,fe)}function R(){S(),s=!0,o!==r&&(o=r,u(o.object))}function S(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:function a(T,z,Z,J,le){let fe=!1;const W=function f(T,z,Z){const J=!0===Z.wireframe;let le=i[T.id];void 0===le&&(le={},i[T.id]=le);let fe=le[z.id];void 0===fe&&(fe={},le[z.id]=fe);let W=fe[J];return void 0===W&&(W=h(function l(){return n.createVertexArray()}()),fe[J]=W),W}(J,Z,z);o!==W&&(o=W,u(o.object)),fe=function g(T,z,Z,J){const le=o.attributes,fe=z.attributes;let W=0;const ie=Z.getAttributes();for(const Y in ie)if(ie[Y].location>=0){const Le=le[Y];let We=fe[Y];if(void 0===We&&("instanceMatrix"===Y&&T.instanceMatrix&&(We=T.instanceMatrix),"instanceColor"===Y&&T.instanceColor&&(We=T.instanceColor)),void 0===Le||Le.attribute!==We||We&&Le.data!==We.data)return!0;W++}return o.attributesNum!==W||o.index!==J}(T,J,Z,le),fe&&function m(T,z,Z,J){const le={},fe=z.attributes;let W=0;const ie=Z.getAttributes();for(const Y in ie)if(ie[Y].location>=0){let Le=fe[Y];void 0===Le&&("instanceMatrix"===Y&&T.instanceMatrix&&(Le=T.instanceMatrix),"instanceColor"===Y&&T.instanceColor&&(Le=T.instanceColor));const We={};We.attribute=Le,Le&&Le.data&&(We.data=Le.data),le[Y]=We,W++}o.attributes=le,o.attributesNum=W,o.index=J}(T,J,Z,le),null!==le&&e.update(le,n.ELEMENT_ARRAY_BUFFER),(fe||s)&&(s=!1,function M(T,z,Z,J){v();const le=J.attributes,fe=Z.getAttributes(),W=z.defaultAttributeValues;for(const ie in fe){const Y=fe[ie];if(Y.location>=0){let ge=le[ie];if(void 0===ge&&("instanceMatrix"===ie&&T.instanceMatrix&&(ge=T.instanceMatrix),"instanceColor"===ie&&T.instanceColor&&(ge=T.instanceColor)),void 0!==ge){const Le=ge.normalized,We=ge.itemSize,vt=e.get(ge);if(void 0===vt)continue;const wt=vt.buffer,ue=vt.type,Ce=vt.bytesPerElement,Qe=ue===n.INT||ue===n.UNSIGNED_INT||1013===ge.gpuType;if(ge.isInterleavedBufferAttribute){const Ne=ge.data,ct=Ne.stride,At=ge.offset;if(Ne.isInstancedInterleavedBuffer){for(let ft=0;ft<Y.locationSize;ft++)y(Y.location+ft,Ne.meshPerAttribute);!0!==T.isInstancedMesh&&void 0===J._maxInstanceCount&&(J._maxInstanceCount=Ne.meshPerAttribute*Ne.count)}else for(let ft=0;ft<Y.locationSize;ft++)_(Y.location+ft);n.bindBuffer(n.ARRAY_BUFFER,wt);for(let ft=0;ft<Y.locationSize;ft++)x(Y.location+ft,We/Y.locationSize,ue,Le,ct*Ce,(At+We/Y.locationSize*ft)*Ce,Qe)}else{if(ge.isInstancedBufferAttribute){for(let Ne=0;Ne<Y.locationSize;Ne++)y(Y.location+Ne,ge.meshPerAttribute);!0!==T.isInstancedMesh&&void 0===J._maxInstanceCount&&(J._maxInstanceCount=ge.meshPerAttribute*ge.count)}else for(let Ne=0;Ne<Y.locationSize;Ne++)_(Y.location+Ne);n.bindBuffer(n.ARRAY_BUFFER,wt);for(let Ne=0;Ne<Y.locationSize;Ne++)x(Y.location+Ne,We/Y.locationSize,ue,Le,We*Ce,We/Y.locationSize*Ne*Ce,Qe)}}else if(void 0!==W){const Le=W[ie];if(void 0!==Le)switch(Le.length){case 2:n.vertexAttrib2fv(Y.location,Le);break;case 3:n.vertexAttrib3fv(Y.location,Le);break;case 4:n.vertexAttrib4fv(Y.location,Le);break;default:n.vertexAttrib1fv(Y.location,Le)}}}}w()}(T,z,Z,J),null!==le&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(le).buffer))},reset:R,resetDefaultState:S,dispose:function D(){R();for(const T in i){const z=i[T];for(const Z in z){const J=z[Z];for(const le in J)c(J[le].object),delete J[le];delete z[Z]}delete i[T]}},releaseStatesOfGeometry:function E(T){if(void 0===i[T.id])return;const z=i[T.id];for(const Z in z){const J=z[Z];for(const le in J)c(J[le].object),delete J[le];delete z[Z]}delete i[T.id]},releaseStatesOfProgram:function I(T){for(const z in i){const Z=i[z];if(void 0===Z[T.id])continue;const J=Z[T.id];for(const le in J)c(J[le].object),delete J[le];delete Z[T.id]}},initAttributes:v,enableAttribute:_,disableUnusedAttributes:w}}function x_e(n,e,t){let i;function s(u,c,f){0!==f&&(n.drawArraysInstanced(i,u,c,f),t.update(c,i,f))}this.setMode=function r(u){i=u},this.render=function o(u,c){n.drawArrays(i,u,c),t.update(c,i,1)},this.renderInstances=s,this.renderMultiDraw=function a(u,c,f){if(0===f)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,u,0,c,0,f);let g=0;for(let m=0;m<f;m++)g+=c[m];t.update(g,i,1)},this.renderMultiDrawInstances=function l(u,c,f,h){if(0===f)return;const g=e.get("WEBGL_multi_draw");if(null===g)for(let m=0;m<u.length;m++)s(u[m],c[m],h[m]);else{g.multiDrawArraysInstancedWEBGL(i,u,0,c,0,h,0,f);let m=0;for(let v=0;v<f;v++)m+=c[v]*h[v];t.update(m,i,1)}}}function M_e(n,e,t,i){let r;function l(I){if("highp"===I){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";I="mediump"}return"mediump"===I&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=void 0!==t.precision?t.precision:"highp";const c=l(u);c!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",c,"instead."),u=c);const f=!0===t.logarithmicDepthBuffer,h=!0===t.reverseDepthBuffer&&e.has("EXT_clip_control"),g=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),m=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function o(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){const I=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:l,textureFormatReadable:function s(I){return!(I!==Da&&i.convert(I)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))},textureTypeReadable:function a(I){const R=I===Fw&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(I!==Ic&&i.convert(I)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&I!==nl&&!R)},precision:u,logarithmicDepthBuffer:f,reverseDepthBuffer:h,maxTextures:g,maxVertexTextures:m,maxTextureSize:n.getParameter(n.MAX_TEXTURE_SIZE),maxCubemapSize:n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:n.getParameter(n.MAX_VERTEX_ATTRIBS),maxVertexUniforms:n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:n.getParameter(n.MAX_VARYING_VECTORS),maxFragmentUniforms:n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:m>0,maxSamples:n.getParameter(n.MAX_SAMPLES)}}function C_e(n){const e=this;let t=null,i=0,r=!1,o=!1;const s=new Ih,a=new vn,l={value:null,needsUpdate:!1};function c(f,h,g,m){const v=null!==f?f.length:0;let _=null;if(0!==v){if(_=l.value,!0!==m||null===_){const y=g+4*v,w=h.matrixWorldInverse;a.getNormalMatrix(w),(null===_||_.length<y)&&(_=new Float32Array(y));for(let x=0,M=g;x!==v;++x,M+=4)s.copy(f[x]).applyMatrix4(w,a),s.normal.toArray(_,M),_[M+3]=s.constant}l.value=_,l.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,_}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(f,h){const g=0!==f.length||h||0!==i||r;return r=h,i=f.length,g},this.beginShadows=function(){o=!0,c(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(f,h){t=c(f,h,0)},this.setState=function(f,h,g){const m=f.clippingPlanes,v=f.clipIntersection,_=f.clipShadows,y=n.get(f);if(!r||null===m||0===m.length||o&&!_)o?c(null):function u(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const w=o?0:i,x=4*w;let M=y.clippingState||null;l.value=M,M=c(m,h,x,g);for(let D=0;D!==x;++D)M[D]=t[D];y.clippingState=M,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=w}}}function S_e(n){let e=new WeakMap;function t(s,a){return 303===a?s.mapping=301:304===a&&(s.mapping=302),s}function r(s){const a=s.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(s){if(s&&s.isTexture){const a=s.mapping;if(303===a||304===a){if(e.has(s))return t(e.get(s).texture,s.mapping);{const l=s.image;if(l&&l.height>0){const u=new Cpe(l.height);return u.fromEquirectangularTexture(n,s),e.set(s,u),s.addEventListener("dispose",r),t(u.texture,s.mapping)}return null}}}return s},dispose:function o(){e=new WeakMap}}}const LW=[.125,.215,.35,.446,.526,.582],vF=new C1,kW=new Ke;let bF=null,wF=0,xF=0,MF=!1;const $g=(1+Math.sqrt(5))/2,oy=1/$g,BW=[new U(-$g,oy,0),new U($g,oy,0),new U(-oy,0,$g),new U(oy,0,$g),new U(0,$g,-oy),new U(0,$g,oy),new U(-1,1,-1),new U(1,1,-1),new U(-1,1,1),new U(1,1,1)],E_e=new U;class UW{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100,o={}){const{size:s=256,position:a=E_e}=o;bF=this._renderer.getRenderTarget(),wF=this._renderer.getActiveCubeFace(),xF=this._renderer.getActiveMipmapLevel(),MF=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(s);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,i,r,l,a),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=zW(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=HW(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(bF,wF,xF),this._renderer.xr.enabled=MF,e.scissorTest=!1,O1(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),bF=this._renderer.getRenderTarget(),wF=this._renderer.getActiveCubeFace(),xF=this._renderer.getActiveMipmapLevel(),MF=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:zr,minFilter:zr,generateMipmaps:!1,type:Fw,format:Da,colorSpace:Js,depthBuffer:!1},r=VW(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=VW(e,t,i);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function T_e(n){const e=[],t=[],i=[];let r=n;const o=n-4+1+LW.length;for(let s=0;s<o;s++){const a=Math.pow(2,r);t.push(a);let l=1/a;s>n-4?l=LW[s-n+4-1]:0===s&&(l=0),i.push(l);const u=1/(a-2),c=-u,f=1+u,h=[c,c,f,c,f,f,c,c,f,f,c,f],g=6,m=6,v=3,_=2,y=1,w=new Float32Array(v*m*g),x=new Float32Array(_*m*g),M=new Float32Array(y*m*g);for(let E=0;E<g;E++){const I=E%3*2/3-1,R=E>2?0:-1;w.set([I,R,0,I+2/3,R,0,I+2/3,R+1,0,I,R,0,I+2/3,R+1,0,I,R+1,0],v*m*E),x.set(h,_*m*E),M.set([E,E,E,E,E,E],y*m*E)}const D=new cn;D.setAttribute("position",new bi(w,v)),D.setAttribute("uv",new bi(x,_)),D.setAttribute("faceIndex",new bi(M,y)),e.push(D),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(o)),this._blurMaterial=function A_e(n,e,t){const i=new Float32Array(20),r=new U(0,1,0);return new Rc({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(o,e,t)}return r}_compileMaterial(e){const t=new yr(this._lodPlanes[0],e);this._renderer.compile(t,vF)}_sceneToCubeUV(e,t,i,r,o){const l=new bo(90,1,t,i),u=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],f=this._renderer,h=f.autoClear,g=f.toneMapping;f.getClearColor(kW),f.toneMapping=0,f.autoClear=!1;const m=new sl({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),v=new yr(new G_,m);let _=!1;const y=e.background;y?y.isColor&&(m.color.copy(y),e.background=null,_=!0):(m.color.copy(kW),_=!0);for(let w=0;w<6;w++){const x=w%3;0===x?(l.up.set(0,u[w],0),l.position.set(o.x,o.y,o.z),l.lookAt(o.x+c[w],o.y,o.z)):1===x?(l.up.set(0,0,u[w]),l.position.set(o.x,o.y,o.z),l.lookAt(o.x,o.y+c[w],o.z)):(l.up.set(0,u[w],0),l.position.set(o.x,o.y,o.z),l.lookAt(o.x,o.y,o.z+c[w]));const M=this._cubeSize;O1(r,x*M,w>2?M:0,M,M),f.setRenderTarget(r),_&&f.render(v,l),f.render(e,l)}v.geometry.dispose(),v.material.dispose(),f.toneMapping=g,f.autoClear=h,e.background=y}_textureToCubeUV(e,t){const i=this._renderer,r=301===e.mapping||302===e.mapping;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=zW()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=HW());const o=r?this._cubemapMaterial:this._equirectMaterial,s=new yr(this._lodPlanes[0],o);o.uniforms.envMap.value=e;const l=this._cubeSize;O1(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(s,vF)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let o=1;o<r;o++){const s=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]);this._blur(e,o-1,o,s,BW[(r-o-1)%BW.length])}t.autoClear=i}_blur(e,t,i,r,o){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,i,r,"latitudinal",o),this._halfBlur(s,e,i,i,r,"longitudinal",o)}_halfBlur(e,t,i,r,o,s,a){const l=this._renderer,u=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");const f=new yr(this._lodPlanes[r],u),h=u.uniforms,g=this._sizeLods[i]-1,m=isFinite(o)?Math.PI/(2*g):2*Math.PI/39,v=o/m,_=isFinite(o)?1+Math.floor(3*v):20;_>20&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${_} samples when the maximum is set to 20`);const y=[];let w=0;for(let I=0;I<20;++I){const R=I/v,S=Math.exp(-R*R/2);y.push(S),0===I?w+=S:I<_&&(w+=2*S)}for(let I=0;I<y.length;I++)y[I]=y[I]/w;h.envMap.value=e.texture,h.samples.value=_,h.weights.value=y,h.latitudinal.value="latitudinal"===s,a&&(h.poleAxis.value=a);const{_lodMax:x}=this;h.dTheta.value=m,h.mipInt.value=x-i;const M=this._sizeLods[r];O1(t,3*M*(r>x-4?r-x+4:0),4*(this._cubeSize-M),3*M,2*M),l.setRenderTarget(t),l.render(f,vF)}}function VW(n,e,t){const i=new Pd(n,e,t);return i.texture.mapping=306,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function O1(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function HW(){return new Rc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function zW(){return new Rc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function D_e(n){let e=new WeakMap,t=null;function o(a){const l=a.target;l.removeEventListener("dispose",o);const u=e.get(l);void 0!==u&&(e.delete(l),u.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,u=303===l||304===l,c=301===l||302===l;if(u||c){let f=e.get(a);if(a.isRenderTargetTexture&&a.pmremVersion!==(void 0!==f?f.texture.pmremVersion:0))return null===t&&(t=new UW(n)),f=u?t.fromEquirectangular(a,f):t.fromCubemap(a,f),f.texture.pmremVersion=a.pmremVersion,e.set(a,f),f.texture;if(void 0!==f)return f.texture;{const g=a.image;return u&&g&&g.height>0||c&&g&&function r(a){let l=0;for(let c=0;c<6;c++)void 0!==a[c]&&l++;return 6===l}(g)?(null===t&&(t=new UW(n)),f=u?t.fromEquirectangular(a):t.fromCubemap(a),f.texture.pmremVersion=a.pmremVersion,e.set(a,f),a.addEventListener("dispose",o),f.texture):null}}}return a},dispose:function s(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function I_e(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(i){const r=t(i);return null===r&&TT("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function R_e(n,e,t,i){const r={},o=new WeakMap;function s(f){const h=f.target;null!==h.index&&e.remove(h.index);for(const m in h.attributes)e.remove(h.attributes[m]);h.removeEventListener("dispose",s),delete r[h.id];const g=o.get(h);g&&(e.remove(g),o.delete(h)),i.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,t.memory.geometries--}function u(f){const h=[],g=f.index,m=f.attributes.position;let v=0;if(null!==g){const w=g.array;v=g.version;for(let x=0,M=w.length;x<M;x+=3){const D=w[x+0],E=w[x+1],I=w[x+2];h.push(D,E,E,I,I,D)}}else{if(void 0===m)return;v=m.version;for(let x=0,M=m.array.length/3-1;x<M;x+=3){const D=x+0,E=x+1,I=x+2;h.push(D,E,E,I,I,D)}}const _=new(qj(h)?a6:bN)(h,1);_.version=v;const y=o.get(f);y&&e.remove(y),o.set(f,_)}return{get:function a(f,h){return!0===r[h.id]||(h.addEventListener("dispose",s),r[h.id]=!0,t.memory.geometries++),h},update:function l(f){const h=f.attributes;for(const g in h)e.update(h[g],n.ARRAY_BUFFER)},getWireframeAttribute:function c(f){const h=o.get(f);if(h){const g=f.index;null!==g&&h.version<g.version&&u(f)}else u(f);return o.get(f)}}}function P_e(n,e,t){let i,o,s;function u(h,g,m){0!==m&&(n.drawElementsInstanced(i,g,o,h*s,m),t.update(g,i,m))}this.setMode=function r(h){i=h},this.setIndex=function a(h){o=h.type,s=h.bytesPerElement},this.render=function l(h,g){n.drawElements(i,g,o,h*s),t.update(g,i,1)},this.renderInstances=u,this.renderMultiDraw=function c(h,g,m){if(0===m)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,g,0,o,h,0,m);let _=0;for(let y=0;y<m;y++)_+=g[y];t.update(_,i,1)},this.renderMultiDrawInstances=function f(h,g,m,v){if(0===m)return;const _=e.get("WEBGL_multi_draw");if(null===_)for(let y=0;y<h.length;y++)u(h[y]/s,g[y],v[y]);else{_.multiDrawElementsInstancedWEBGL(i,g,0,o,h,0,v,0,m);let y=0;for(let w=0;w<m;w++)y+=g[w]*v[w];t.update(y,i,1)}}}function O_e(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(o,s,a){switch(t.calls++,s){case n.TRIANGLES:t.triangles+=a*(o/3);break;case n.LINES:t.lines+=a*(o/2);break;case n.LINE_STRIP:t.lines+=a*(o-1);break;case n.LINE_LOOP:t.lines+=a*o;break;case n.POINTS:t.points+=a*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",s)}}}}function N_e(n,e,t){const i=new WeakMap,r=new $n;return{update:function o(s,a,l){const u=s.morphTargetInfluences,c=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,f=void 0!==c?c.length:0;let h=i.get(a);if(void 0===h||h.count!==f){let S=function(){I.dispose(),i.delete(a),a.removeEventListener("dispose",S)};void 0!==h&&h.texture.dispose();const g=void 0!==a.morphAttributes.position,m=void 0!==a.morphAttributes.normal,v=void 0!==a.morphAttributes.color,_=a.morphAttributes.position||[],y=a.morphAttributes.normal||[],w=a.morphAttributes.color||[];let x=0;!0===g&&(x=1),!0===m&&(x=2),!0===v&&(x=3);let M=a.attributes.position.count*x,D=1;M>e.maxTextureSize&&(D=Math.ceil(M/e.maxTextureSize),M=e.maxTextureSize);const E=new Float32Array(M*D*4*f),I=new AT(E,M,D,f);I.type=nl,I.needsUpdate=!0;const R=4*x;for(let T=0;T<f;T++){const z=_[T],Z=y[T],J=w[T],le=M*D*4*T;for(let fe=0;fe<z.count;fe++){const W=fe*R;!0===g&&(r.fromBufferAttribute(z,fe),E[le+W+0]=r.x,E[le+W+1]=r.y,E[le+W+2]=r.z,E[le+W+3]=0),!0===m&&(r.fromBufferAttribute(Z,fe),E[le+W+4]=r.x,E[le+W+5]=r.y,E[le+W+6]=r.z,E[le+W+7]=0),!0===v&&(r.fromBufferAttribute(J,fe),E[le+W+8]=r.x,E[le+W+9]=r.y,E[le+W+10]=r.z,E[le+W+11]=4===J.itemSize?r.w:1)}}h={count:f,texture:I,size:new xe(M,D)},i.set(a,h),a.addEventListener("dispose",S)}if(!0===s.isInstancedMesh&&null!==s.morphTexture)l.getUniforms().setValue(n,"morphTexture",s.morphTexture,t);else{let g=0;for(let v=0;v<u.length;v++)g+=u[v];const m=a.morphTargetsRelative?1:1-g;l.getUniforms().setValue(n,"morphTargetBaseInfluence",m),l.getUniforms().setValue(n,"morphTargetInfluences",u)}l.getUniforms().setValue(n,"morphTargetsTexture",h.texture,t),l.getUniforms().setValue(n,"morphTargetsTextureSize",h.size)}}}function F_e(n,e,t,i){let r=new WeakMap;function a(l){const u=l.target;u.removeEventListener("dispose",a),t.remove(u.instanceMatrix),null!==u.instanceColor&&t.remove(u.instanceColor)}return{update:function o(l){const u=i.render.frame,f=e.get(l,l.geometry);if(r.get(f)!==u&&(e.update(f),r.set(f,u)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),r.get(l)!==u&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),null!==l.instanceColor&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,u))),l.isSkinnedMesh){const h=l.skeleton;r.get(h)!==u&&(h.update(),r.set(h,u))}return f},dispose:function s(){r=new WeakMap}}}const GW=new Jo,jW=new BN(1,1),WW=new AT,$W=new iN,qW=new WT,XW=[],YW=[],ZW=new Float32Array(16),KW=new Float32Array(9),JW=new Float32Array(4);function sy(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let o=XW[r];if(void 0===o&&(o=new Float32Array(r),XW[r]=o),0!==e){i.toArray(o,0);for(let s=1,a=0;s!==e;++s)a+=t,n[s].toArray(o,a)}return o}function xo(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Mo(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function N1(n,e){let t=YW[e];void 0===t&&(t=new Int32Array(e),YW[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function L_e(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function k_e(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(xo(t,e))return;n.uniform2fv(this.addr,e),Mo(t,e)}}function B_e(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(xo(t,e))return;n.uniform3fv(this.addr,e),Mo(t,e)}}function U_e(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(xo(t,e))return;n.uniform4fv(this.addr,e),Mo(t,e)}}function V_e(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(xo(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Mo(t,e)}else{if(xo(t,i))return;JW.set(i),n.uniformMatrix2fv(this.addr,!1,JW),Mo(t,i)}}function H_e(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(xo(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Mo(t,e)}else{if(xo(t,i))return;KW.set(i),n.uniformMatrix3fv(this.addr,!1,KW),Mo(t,i)}}function z_e(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(xo(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Mo(t,e)}else{if(xo(t,i))return;ZW.set(i),n.uniformMatrix4fv(this.addr,!1,ZW),Mo(t,i)}}function G_e(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function j_e(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(xo(t,e))return;n.uniform2iv(this.addr,e),Mo(t,e)}}function W_e(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(xo(t,e))return;n.uniform3iv(this.addr,e),Mo(t,e)}}function $_e(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(xo(t,e))return;n.uniform4iv(this.addr,e),Mo(t,e)}}function q_e(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function X_e(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(xo(t,e))return;n.uniform2uiv(this.addr,e),Mo(t,e)}}function Y_e(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(xo(t,e))return;n.uniform3uiv(this.addr,e),Mo(t,e)}}function Z_e(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(xo(t,e))return;n.uniform4uiv(this.addr,e),Mo(t,e)}}function K_e(n,e,t){const i=this.cache,r=t.allocateTextureUnit();let o;i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),this.type===n.SAMPLER_2D_SHADOW?(jW.compareFunction=515,o=jW):o=GW,t.setTexture2D(e||o,r)}function J_e(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||$W,r)}function Q_e(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||qW,r)}function eye(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||WW,r)}function nye(n,e){n.uniform1fv(this.addr,e)}function iye(n,e){const t=sy(e,this.size,2);n.uniform2fv(this.addr,t)}function rye(n,e){const t=sy(e,this.size,3);n.uniform3fv(this.addr,t)}function oye(n,e){const t=sy(e,this.size,4);n.uniform4fv(this.addr,t)}function sye(n,e){const t=sy(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function aye(n,e){const t=sy(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function lye(n,e){const t=sy(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function uye(n,e){n.uniform1iv(this.addr,e)}function cye(n,e){n.uniform2iv(this.addr,e)}function dye(n,e){n.uniform3iv(this.addr,e)}function fye(n,e){n.uniform4iv(this.addr,e)}function hye(n,e){n.uniform1uiv(this.addr,e)}function pye(n,e){n.uniform2uiv(this.addr,e)}function gye(n,e){n.uniform3uiv(this.addr,e)}function mye(n,e){n.uniform4uiv(this.addr,e)}function _ye(n,e,t){const i=this.cache,r=e.length,o=N1(t,r);xo(i,o)||(n.uniform1iv(this.addr,o),Mo(i,o));for(let s=0;s!==r;++s)t.setTexture2D(e[s]||GW,o[s])}function yye(n,e,t){const i=this.cache,r=e.length,o=N1(t,r);xo(i,o)||(n.uniform1iv(this.addr,o),Mo(i,o));for(let s=0;s!==r;++s)t.setTexture3D(e[s]||$W,o[s])}function vye(n,e,t){const i=this.cache,r=e.length,o=N1(t,r);xo(i,o)||(n.uniform1iv(this.addr,o),Mo(i,o));for(let s=0;s!==r;++s)t.setTextureCube(e[s]||qW,o[s])}function bye(n,e,t){const i=this.cache,r=e.length,o=N1(t,r);xo(i,o)||(n.uniform1iv(this.addr,o),Mo(i,o));for(let s=0;s!==r;++s)t.setTexture2DArray(e[s]||WW,o[s])}class xye{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=function tye(n){switch(n){case 5126:return L_e;case 35664:return k_e;case 35665:return B_e;case 35666:return U_e;case 35674:return V_e;case 35675:return H_e;case 35676:return z_e;case 5124:case 35670:return G_e;case 35667:case 35671:return j_e;case 35668:case 35672:return W_e;case 35669:case 35673:return $_e;case 5125:return q_e;case 36294:return X_e;case 36295:return Y_e;case 36296:return Z_e;case 35678:case 36198:case 36298:case 36306:case 35682:return K_e;case 35679:case 36299:case 36307:return J_e;case 35680:case 36300:case 36308:case 36293:return Q_e;case 36289:case 36303:case 36311:case 36292:return eye}}(t.type)}}class Mye{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function wye(n){switch(n){case 5126:return nye;case 35664:return iye;case 35665:return rye;case 35666:return oye;case 35674:return sye;case 35675:return aye;case 35676:return lye;case 5124:case 35670:return uye;case 35667:case 35671:return cye;case 35668:case 35672:return dye;case 35669:case 35673:return fye;case 5125:return hye;case 36294:return pye;case 36295:return gye;case 36296:return mye;case 35678:case 36198:case 36298:case 36306:case 35682:return _ye;case 35679:case 36299:case 36307:return yye;case 35680:case 36300:case 36308:case 36293:return vye;case 36289:case 36303:case 36311:case 36292:return bye}}(t.type)}}class Cye{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let o=0,s=r.length;o!==s;++o){const a=r[o];a.setValue(e,t[a.id],i)}}}const SF=/(\w+)(\])?(\[|\.)?/g;function QW(n,e){n.seq.push(e),n.map[e.id]=e}function Sye(n,e,t){const i=n.name,r=i.length;for(SF.lastIndex=0;;){const o=SF.exec(i);let a=o[1];const u=o[3];if("]"===o[2]&&(a|=0),void 0===u||"["===u&&SF.lastIndex+2===r){QW(t,void 0===u?new xye(a,n,e):new Mye(a,n,e));break}{let f=t.map[a];void 0===f&&(f=new Cye(a),QW(t,f)),t=f}}}class F1{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const o=e.getActiveUniform(t,r);Sye(o,e.getUniformLocation(t,o.name),this)}}setValue(e,t,i,r){const o=this.map[t];void 0!==o&&o.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let o=0,s=t.length;o!==s;++o){const a=t[o],l=i[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,o=e.length;r!==o;++r){const s=e[r];s.id in t&&i.push(s)}return i}}function e$(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let Tye=0;const t$=new vn;function n$(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const o=/ERROR: 0:(\d+)/.exec(r);if(o){const s=parseInt(o[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function Aye(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let s=r;s<o;s++){const a=s+1;i.push(`${a===e?">":" "} ${a}: ${t[s]}`)}return i.join("\n")}(n.getShaderSource(e),s)}return r}function Iye(n,e){const t=function Dye(n){bn._getMatrix(t$,bn.workingColorSpace,n);const e=`mat3( ${t$.elements.map(t=>t.toFixed(4))} )`;switch(bn.getTransfer(n)){case CT:return[e,"LinearTransferOETF"];case ki:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}(e);return[`vec4 ${n}( vec4 value ) {`,`\treturn ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join("\n")}function Rye(n,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="Cineon";break;case 4:t="ACESFilmic";break;case 6:t="AgX";break;case 7:t="Neutral";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const L1=new U;function px(n){return""!==n}function i$(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function r$(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Lye=/^[ \t]*#include +<([\w\d./]+)>/gm;function EF(n){return n.replace(Lye,Bye)}const kye=new Map;function Bye(n,e){let t=Nn[e];if(void 0===t){const i=kye.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=Nn[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return EF(t)}const Uye=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function o$(n){return n.replace(Uye,Vye)}function Vye(n,e,t,i){let r="";for(let o=parseInt(e);o<parseInt(t);o++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function s$(n){let e=`precision ${n.precision} float;\n\tprecision ${n.precision} int;\n\tprecision ${n.precision} sampler2D;\n\tprecision ${n.precision} samplerCube;\n\tprecision ${n.precision} sampler3D;\n\tprecision ${n.precision} sampler2DArray;\n\tprecision ${n.precision} sampler2DShadow;\n\tprecision ${n.precision} samplerCubeShadow;\n\tprecision ${n.precision} sampler2DArrayShadow;\n\tprecision ${n.precision} isampler2D;\n\tprecision ${n.precision} isampler3D;\n\tprecision ${n.precision} isamplerCube;\n\tprecision ${n.precision} isampler2DArray;\n\tprecision ${n.precision} usampler2D;\n\tprecision ${n.precision} usampler3D;\n\tprecision ${n.precision} usamplerCube;\n\tprecision ${n.precision} usampler2DArray;\n\t`;return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function $ye(n,e,t,i){const r=n.getContext(),o=t.defines;let s=t.vertexShader,a=t.fragmentShader;const l=function Hye(n){let e="SHADOWMAP_TYPE_BASIC";return 1===n.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===n.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===n.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),u=function zye(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),c=function Gye(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&302===n.envMapMode&&(e="ENVMAP_MODE_REFRACTION"),e}(t),f=function jye(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),h=function Wye(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),g=function Oye(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(px).join("\n")}(t),m=function Nye(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(o),v=r.createProgram();let _,y,w=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(_=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,m].filter(px).join("\n"),_.length>0&&(_+="\n"),y=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,m].filter(px).join("\n"),y.length>0&&(y+="\n")):(_=[s$(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,m,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(px).join("\n"),y=[s$(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,m,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+c:"",t.envMap?"#define "+f:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?Nn.tonemapping_pars_fragment:"",0!==t.toneMapping?Rye("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Nn.colorspace_pars_fragment,Iye("linearToOutputTexel",t.outputColorSpace),(bn.getLuminanceCoefficients(L1),["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${L1.x.toFixed(4)}, ${L1.y.toFixed(4)}, ${L1.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(px).join("\n")),s=EF(s),s=i$(s,t),s=r$(s,t),a=EF(a),a=i$(a,t),a=r$(a,t),s=o$(s),a=o$(a),!0!==t.isRawShaderMaterial&&(w="#version 300 es\n",_=[g,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+_,y=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const M=w+y+a,D=e$(r,r.VERTEX_SHADER,w+_+s),E=e$(r,r.FRAGMENT_SHADER,M);function I(z){if(n.debug.checkShaderErrors){const Z=r.getProgramInfoLog(v).trim(),J=r.getShaderInfoLog(D).trim(),le=r.getShaderInfoLog(E).trim();let fe=!0,W=!0;if(!1===r.getProgramParameter(v,r.LINK_STATUS))if(fe=!1,"function"==typeof n.debug.onShaderError)n.debug.onShaderError(r,v,D,E);else{const ie=n$(r,D,"vertex"),Y=n$(r,E,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(v,r.VALIDATE_STATUS)+"\n\nMaterial Name: "+z.name+"\nMaterial Type: "+z.type+"\n\nProgram Info Log: "+Z+"\n"+ie+"\n"+Y)}else""!==Z?console.warn("THREE.WebGLProgram: Program Info Log:",Z):(""===J||""===le)&&(W=!1);W&&(z.diagnostics={runnable:fe,programLog:Z,vertexShader:{log:J,prefix:_},fragmentShader:{log:le,prefix:y}})}r.deleteShader(D),r.deleteShader(E),R=new F1(r,v),S=function Fye(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const o=n.getActiveAttrib(e,r),s=o.name;let a=1;o.type===n.FLOAT_MAT2&&(a=2),o.type===n.FLOAT_MAT3&&(a=3),o.type===n.FLOAT_MAT4&&(a=4),t[s]={type:o.type,location:n.getAttribLocation(e,s),locationSize:a}}return t}(r,v)}let R,S;r.attachShader(v,D),r.attachShader(v,E),void 0!==t.index0AttributeName?r.bindAttribLocation(v,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(v,0,"position"),r.linkProgram(v),this.getUniforms=function(){return void 0===R&&I(this),R},this.getAttributes=function(){return void 0===S&&I(this),S};let T=!1===t.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===T&&(T=r.getProgramParameter(v,37297)),T},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(v),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Tye++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=D,this.fragmentShader=E,this}let qye=0;class Xye{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),o=this._getShaderStage(i),s=this._getShaderCacheForMaterial(e);return!1===s.has(r)&&(s.add(r),r.usedTimes++),!1===s.has(o)&&(s.add(o),o.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new Yye(e),t.set(e,i)),i}}class Yye{constructor(e){this.id=qye++,this.code=e,this.usedTimes=0}}function Zye(n,e,t,i,r,o,s){const a=new cN,l=new Xye,u=new Set,c=[],f=r.logarithmicDepthBuffer,h=r.vertexTextures;let g=r.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(S){return u.add(S),0===S?"uv":`uv${S}`}return{getParameters:function _(S,T,z,Z,J){const le=Z.fog,fe=J.geometry,ie=(S.isMeshStandardMaterial?t:e).get(S.envMap||(S.isMeshStandardMaterial?Z.environment:null)),Y=ie&&306===ie.mapping?ie.image.height:null,ge=m[S.type];null!==S.precision&&(g=r.getMaxPrecision(S.precision),g!==S.precision&&console.warn("THREE.WebGLProgram.getParameters:",S.precision,"not supported, using",g,"instead."));const Le=fe.morphAttributes.position||fe.morphAttributes.normal||fe.morphAttributes.color,We=void 0!==Le?Le.length:0;let wt,ue,Ce,Qe,vt=0;if(void 0!==fe.morphAttributes.position&&(vt=1),void 0!==fe.morphAttributes.normal&&(vt=2),void 0!==fe.morphAttributes.color&&(vt=3),ge){const Ai=Nc[ge];wt=Ai.vertexShader,ue=Ai.fragmentShader}else wt=S.vertexShader,ue=S.fragmentShader,l.update(S),Ce=l.getVertexShaderID(S),Qe=l.getFragmentShaderID(S);const Ne=n.getRenderTarget(),ct=n.state.buffers.depth.getReversed(),At=!0===J.isInstancedMesh,ft=!0===J.isBatchedMesh,Xn=!!S.map,qt=!!ie,H=!!S.aoMap,tt=!!S.lightMap,ke=!!S.bumpMap,Xe=!!S.normalMap,Ae=!!S.displacementMap,Ot=!!S.emissiveMap,Ue=!!S.metalnessMap,V=!!S.roughnessMap,P=S.anisotropy>0,ae=S.clearcoat>0,Ie=S.iridescence>0,_e=S.sheen>0,It=S.transmission>0,ot=P&&!!S.anisotropyMap,Ht=ae&&!!S.clearcoatMap,nn=ae&&!!S.clearcoatNormalMap,Ge=ae&&!!S.clearcoatRoughnessMap,bt=Ie&&!!S.iridescenceMap,en=Ie&&!!S.iridescenceThicknessMap,gn=_e&&!!S.sheenColorMap,Tt=_e&&!!S.sheenRoughnessMap,ri=!!S.specularMap,Fn=!!S.specularColorMap,ir=!!S.specularIntensityMap,Q=It&&!!S.transmissionMap,ht=It&&!!S.thicknessMap,De=!!S.alphaMap,Pn=!!S.extensions;let Nr=0;S.toneMapped&&(null===Ne||!0===Ne.isXRRenderTarget)&&(Nr=n.toneMapping);const Ps={shaderID:ge,shaderType:S.type,shaderName:S.name,vertexShader:wt,fragmentShader:ue,defines:S.defines,customVertexShaderID:Ce,customFragmentShaderID:Qe,isRawShaderMaterial:!0===S.isRawShaderMaterial,glslVersion:S.glslVersion,precision:g,batching:ft,batchingColor:ft&&null!==J._colorsTexture,instancing:At,instancingColor:At&&null!==J.instanceColor,instancingMorph:At&&null!==J.morphTexture,supportsVertexTextures:h,outputColorSpace:null===Ne?n.outputColorSpace:!0===Ne.isXRRenderTarget?Ne.texture.colorSpace:Js,alphaToCoverage:!!S.alphaToCoverage,map:Xn,matcap:!!S.matcap,envMap:qt,envMapMode:qt&&ie.mapping,envMapCubeUVHeight:Y,aoMap:H,lightMap:tt,bumpMap:ke,normalMap:Xe,displacementMap:h&&Ae,emissiveMap:Ot,normalMapObjectSpace:Xe&&1===S.normalMapType,normalMapTangentSpace:Xe&&0===S.normalMapType,metalnessMap:Ue,roughnessMap:V,anisotropy:P,anisotropyMap:ot,clearcoat:ae,clearcoatMap:Ht,clearcoatNormalMap:nn,clearcoatRoughnessMap:Ge,dispersion:S.dispersion>0,iridescence:Ie,iridescenceMap:bt,iridescenceThicknessMap:en,sheen:_e,sheenColorMap:gn,sheenRoughnessMap:Tt,specularMap:ri,specularColorMap:Fn,specularIntensityMap:ir,transmission:It,transmissionMap:Q,thicknessMap:ht,gradientMap:!!S.gradientMap,opaque:!1===S.transparent&&1===S.blending&&!1===S.alphaToCoverage,alphaMap:De,alphaTest:S.alphaTest>0,alphaHash:!!S.alphaHash,combine:S.combine,mapUv:Xn&&v(S.map.channel),aoMapUv:H&&v(S.aoMap.channel),lightMapUv:tt&&v(S.lightMap.channel),bumpMapUv:ke&&v(S.bumpMap.channel),normalMapUv:Xe&&v(S.normalMap.channel),displacementMapUv:Ae&&v(S.displacementMap.channel),emissiveMapUv:Ot&&v(S.emissiveMap.channel),metalnessMapUv:Ue&&v(S.metalnessMap.channel),roughnessMapUv:V&&v(S.roughnessMap.channel),anisotropyMapUv:ot&&v(S.anisotropyMap.channel),clearcoatMapUv:Ht&&v(S.clearcoatMap.channel),clearcoatNormalMapUv:nn&&v(S.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ge&&v(S.clearcoatRoughnessMap.channel),iridescenceMapUv:bt&&v(S.iridescenceMap.channel),iridescenceThicknessMapUv:en&&v(S.iridescenceThicknessMap.channel),sheenColorMapUv:gn&&v(S.sheenColorMap.channel),sheenRoughnessMapUv:Tt&&v(S.sheenRoughnessMap.channel),specularMapUv:ri&&v(S.specularMap.channel),specularColorMapUv:Fn&&v(S.specularColorMap.channel),specularIntensityMapUv:ir&&v(S.specularIntensityMap.channel),transmissionMapUv:Q&&v(S.transmissionMap.channel),thicknessMapUv:ht&&v(S.thicknessMap.channel),alphaMapUv:De&&v(S.alphaMap.channel),vertexTangents:!!fe.attributes.tangent&&(Xe||P),vertexColors:S.vertexColors,vertexAlphas:!0===S.vertexColors&&!!fe.attributes.color&&4===fe.attributes.color.itemSize,pointsUvs:!0===J.isPoints&&!!fe.attributes.uv&&(Xn||De),fog:!!le,useFog:!0===S.fog,fogExp2:!!le&&le.isFogExp2,flatShading:!0===S.flatShading,sizeAttenuation:!0===S.sizeAttenuation,logarithmicDepthBuffer:f,reverseDepthBuffer:ct,skinning:!0===J.isSkinnedMesh,morphTargets:void 0!==fe.morphAttributes.position,morphNormals:void 0!==fe.morphAttributes.normal,morphColors:void 0!==fe.morphAttributes.color,morphTargetsCount:We,morphTextureStride:vt,numDirLights:T.directional.length,numPointLights:T.point.length,numSpotLights:T.spot.length,numSpotLightMaps:T.spotLightMap.length,numRectAreaLights:T.rectArea.length,numHemiLights:T.hemi.length,numDirLightShadows:T.directionalShadowMap.length,numPointLightShadows:T.pointShadowMap.length,numSpotLightShadows:T.spotShadowMap.length,numSpotLightShadowsWithMaps:T.numSpotLightShadowsWithMaps,numLightProbes:T.numLightProbes,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:S.dithering,shadowMapEnabled:n.shadowMap.enabled&&z.length>0,shadowMapType:n.shadowMap.type,toneMapping:Nr,decodeVideoTexture:Xn&&!0===S.map.isVideoTexture&&bn.getTransfer(S.map.colorSpace)===ki,decodeVideoTextureEmissive:Ot&&!0===S.emissiveMap.isVideoTexture&&bn.getTransfer(S.emissiveMap.colorSpace)===ki,premultipliedAlpha:S.premultipliedAlpha,doubleSided:2===S.side,flipSided:1===S.side,useDepthPacking:S.depthPacking>=0,depthPacking:S.depthPacking||0,index0AttributeName:S.index0AttributeName,extensionClipCullDistance:Pn&&!0===S.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Pn&&!0===S.extensions.multiDraw||ft)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:S.customProgramCacheKey()};return Ps.vertexUv1s=u.has(1),Ps.vertexUv2s=u.has(2),Ps.vertexUv3s=u.has(3),u.clear(),Ps},getProgramCacheKey:function y(S){const T=[];if(S.shaderID?T.push(S.shaderID):(T.push(S.customVertexShaderID),T.push(S.customFragmentShaderID)),void 0!==S.defines)for(const z in S.defines)T.push(z),T.push(S.defines[z]);return!1===S.isRawShaderMaterial&&(function w(S,T){S.push(T.precision),S.push(T.outputColorSpace),S.push(T.envMapMode),S.push(T.envMapCubeUVHeight),S.push(T.mapUv),S.push(T.alphaMapUv),S.push(T.lightMapUv),S.push(T.aoMapUv),S.push(T.bumpMapUv),S.push(T.normalMapUv),S.push(T.displacementMapUv),S.push(T.emissiveMapUv),S.push(T.metalnessMapUv),S.push(T.roughnessMapUv),S.push(T.anisotropyMapUv),S.push(T.clearcoatMapUv),S.push(T.clearcoatNormalMapUv),S.push(T.clearcoatRoughnessMapUv),S.push(T.iridescenceMapUv),S.push(T.iridescenceThicknessMapUv),S.push(T.sheenColorMapUv),S.push(T.sheenRoughnessMapUv),S.push(T.specularMapUv),S.push(T.specularColorMapUv),S.push(T.specularIntensityMapUv),S.push(T.transmissionMapUv),S.push(T.thicknessMapUv),S.push(T.combine),S.push(T.fogExp2),S.push(T.sizeAttenuation),S.push(T.morphTargetsCount),S.push(T.morphAttributeCount),S.push(T.numDirLights),S.push(T.numPointLights),S.push(T.numSpotLights),S.push(T.numSpotLightMaps),S.push(T.numHemiLights),S.push(T.numRectAreaLights),S.push(T.numDirLightShadows),S.push(T.numPointLightShadows),S.push(T.numSpotLightShadows),S.push(T.numSpotLightShadowsWithMaps),S.push(T.numLightProbes),S.push(T.shadowMapType),S.push(T.toneMapping),S.push(T.numClippingPlanes),S.push(T.numClipIntersection),S.push(T.depthPacking)}(T,S),function x(S,T){a.disableAll(),T.supportsVertexTextures&&a.enable(0),T.instancing&&a.enable(1),T.instancingColor&&a.enable(2),T.instancingMorph&&a.enable(3),T.matcap&&a.enable(4),T.envMap&&a.enable(5),T.normalMapObjectSpace&&a.enable(6),T.normalMapTangentSpace&&a.enable(7),T.clearcoat&&a.enable(8),T.iridescence&&a.enable(9),T.alphaTest&&a.enable(10),T.vertexColors&&a.enable(11),T.vertexAlphas&&a.enable(12),T.vertexUv1s&&a.enable(13),T.vertexUv2s&&a.enable(14),T.vertexUv3s&&a.enable(15),T.vertexTangents&&a.enable(16),T.anisotropy&&a.enable(17),T.alphaHash&&a.enable(18),T.batching&&a.enable(19),T.dispersion&&a.enable(20),T.batchingColor&&a.enable(21),S.push(a.mask),a.disableAll(),T.fog&&a.enable(0),T.useFog&&a.enable(1),T.flatShading&&a.enable(2),T.logarithmicDepthBuffer&&a.enable(3),T.reverseDepthBuffer&&a.enable(4),T.skinning&&a.enable(5),T.morphTargets&&a.enable(6),T.morphNormals&&a.enable(7),T.morphColors&&a.enable(8),T.premultipliedAlpha&&a.enable(9),T.shadowMapEnabled&&a.enable(10),T.doubleSided&&a.enable(11),T.flipSided&&a.enable(12),T.useDepthPacking&&a.enable(13),T.dithering&&a.enable(14),T.transmission&&a.enable(15),T.sheen&&a.enable(16),T.opaque&&a.enable(17),T.pointsUvs&&a.enable(18),T.decodeVideoTexture&&a.enable(19),T.decodeVideoTextureEmissive&&a.enable(20),T.alphaToCoverage&&a.enable(21),S.push(a.mask)}(T,S),T.push(n.outputColorSpace)),T.push(S.customProgramCacheKey),T.join()},getUniforms:function M(S){const T=m[S.type];let z;return z=T?bpe.clone(Nc[T].uniforms):S.uniforms,z},acquireProgram:function D(S,T){let z;for(let Z=0,J=c.length;Z<J;Z++){const le=c[Z];if(le.cacheKey===T){z=le,++z.usedTimes;break}}return void 0===z&&(z=new $ye(n,T,S,o),c.push(z)),z},releaseProgram:function E(S){if(0==--S.usedTimes){const T=c.indexOf(S);c[T]=c[c.length-1],c.pop(),S.destroy()}},releaseShaderCache:function I(S){l.remove(S)},programs:c,dispose:function R(){l.dispose()}}}function Kye(){let n=new WeakMap;return{has:function e(s){return n.has(s)},get:function t(s){let a=n.get(s);return void 0===a&&(a={},n.set(s,a)),a},remove:function i(s){n.delete(s)},update:function r(s,a,l){n.get(s)[a]=l},dispose:function o(){n=new WeakMap}}}function Jye(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function a$(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function l$(){const n=[];let e=0;const t=[],i=[],r=[];function s(f,h,g,m,v,_){let y=n[e];return void 0===y?(y={id:f.id,object:f,geometry:h,material:g,groupOrder:m,renderOrder:f.renderOrder,z:v,group:_},n[e]=y):(y.id=f.id,y.object=f,y.geometry=h,y.material=g,y.groupOrder=m,y.renderOrder=f.renderOrder,y.z=v,y.group=_),e++,y}return{opaque:t,transmissive:i,transparent:r,init:function o(){e=0,t.length=0,i.length=0,r.length=0},push:function a(f,h,g,m,v,_){const y=s(f,h,g,m,v,_);g.transmission>0?i.push(y):!0===g.transparent?r.push(y):t.push(y)},unshift:function l(f,h,g,m,v,_){const y=s(f,h,g,m,v,_);g.transmission>0?i.unshift(y):!0===g.transparent?r.unshift(y):t.unshift(y)},finish:function c(){for(let f=e,h=n.length;f<h;f++){const g=n[f];if(null===g.id)break;g.id=null,g.object=null,g.geometry=null,g.material=null,g.group=null}},sort:function u(f,h){t.length>1&&t.sort(f||Jye),i.length>1&&i.sort(h||a$),r.length>1&&r.sort(h||a$)}}}function Qye(){let n=new WeakMap;return{get:function e(i,r){const o=n.get(i);let s;return void 0===o?(s=new l$,n.set(i,[s])):r>=o.length?(s=new l$,o.push(s)):s=o[r],s},dispose:function t(){n=new WeakMap}}}function eve(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new U,color:new Ke};break;case"SpotLight":t={position:new U,direction:new U,color:new Ke,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new U,color:new Ke,distance:0,decay:0};break;case"HemisphereLight":t={direction:new U,skyColor:new Ke,groundColor:new Ke};break;case"RectAreaLight":t={color:new Ke,position:new U,halfWidth:new U,halfHeight:new U}}return n[e.id]=t,t}}}let nve=0;function ive(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function rve(n){const e=new eve,t=function tve(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xe};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xe,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)i.probe.push(new U);const r=new U,o=new at,s=new at;return{setup:function a(u){let c=0,f=0,h=0;for(let S=0;S<9;S++)i.probe[S].set(0,0,0);let g=0,m=0,v=0,_=0,y=0,w=0,x=0,M=0,D=0,E=0,I=0;u.sort(ive);for(let S=0,T=u.length;S<T;S++){const z=u[S],Z=z.color,J=z.intensity,le=z.distance,fe=z.shadow&&z.shadow.map?z.shadow.map.texture:null;if(z.isAmbientLight)c+=Z.r*J,f+=Z.g*J,h+=Z.b*J;else if(z.isLightProbe){for(let W=0;W<9;W++)i.probe[W].addScaledVector(z.sh.coefficients[W],J);I++}else if(z.isDirectionalLight){const W=e.get(z);if(W.color.copy(z.color).multiplyScalar(z.intensity),z.castShadow){const ie=z.shadow,Y=t.get(z);Y.shadowIntensity=ie.intensity,Y.shadowBias=ie.bias,Y.shadowNormalBias=ie.normalBias,Y.shadowRadius=ie.radius,Y.shadowMapSize=ie.mapSize,i.directionalShadow[g]=Y,i.directionalShadowMap[g]=fe,i.directionalShadowMatrix[g]=z.shadow.matrix,w++}i.directional[g]=W,g++}else if(z.isSpotLight){const W=e.get(z);W.position.setFromMatrixPosition(z.matrixWorld),W.color.copy(Z).multiplyScalar(J),W.distance=le,W.coneCos=Math.cos(z.angle),W.penumbraCos=Math.cos(z.angle*(1-z.penumbra)),W.decay=z.decay,i.spot[v]=W;const ie=z.shadow;if(z.map&&(i.spotLightMap[D]=z.map,D++,ie.updateMatrices(z),z.castShadow&&E++),i.spotLightMatrix[v]=ie.matrix,z.castShadow){const Y=t.get(z);Y.shadowIntensity=ie.intensity,Y.shadowBias=ie.bias,Y.shadowNormalBias=ie.normalBias,Y.shadowRadius=ie.radius,Y.shadowMapSize=ie.mapSize,i.spotShadow[v]=Y,i.spotShadowMap[v]=fe,M++}v++}else if(z.isRectAreaLight){const W=e.get(z);W.color.copy(Z).multiplyScalar(J),W.halfWidth.set(.5*z.width,0,0),W.halfHeight.set(0,.5*z.height,0),i.rectArea[_]=W,_++}else if(z.isPointLight){const W=e.get(z);if(W.color.copy(z.color).multiplyScalar(z.intensity),W.distance=z.distance,W.decay=z.decay,z.castShadow){const ie=z.shadow,Y=t.get(z);Y.shadowIntensity=ie.intensity,Y.shadowBias=ie.bias,Y.shadowNormalBias=ie.normalBias,Y.shadowRadius=ie.radius,Y.shadowMapSize=ie.mapSize,Y.shadowCameraNear=ie.camera.near,Y.shadowCameraFar=ie.camera.far,i.pointShadow[m]=Y,i.pointShadowMap[m]=fe,i.pointShadowMatrix[m]=z.shadow.matrix,x++}i.point[m]=W,m++}else if(z.isHemisphereLight){const W=e.get(z);W.skyColor.copy(z.color).multiplyScalar(J),W.groundColor.copy(z.groundColor).multiplyScalar(J),i.hemi[y]=W,y++}}_>0&&(!0===n.has("OES_texture_float_linear")?(i.rectAreaLTC1=rt.LTC_FLOAT_1,i.rectAreaLTC2=rt.LTC_FLOAT_2):(i.rectAreaLTC1=rt.LTC_HALF_1,i.rectAreaLTC2=rt.LTC_HALF_2)),i.ambient[0]=c,i.ambient[1]=f,i.ambient[2]=h;const R=i.hash;(R.directionalLength!==g||R.pointLength!==m||R.spotLength!==v||R.rectAreaLength!==_||R.hemiLength!==y||R.numDirectionalShadows!==w||R.numPointShadows!==x||R.numSpotShadows!==M||R.numSpotMaps!==D||R.numLightProbes!==I)&&(i.directional.length=g,i.spot.length=v,i.rectArea.length=_,i.point.length=m,i.hemi.length=y,i.directionalShadow.length=w,i.directionalShadowMap.length=w,i.pointShadow.length=x,i.pointShadowMap.length=x,i.spotShadow.length=M,i.spotShadowMap.length=M,i.directionalShadowMatrix.length=w,i.pointShadowMatrix.length=x,i.spotLightMatrix.length=M+D-E,i.spotLightMap.length=D,i.numSpotLightShadowsWithMaps=E,i.numLightProbes=I,R.directionalLength=g,R.pointLength=m,R.spotLength=v,R.rectAreaLength=_,R.hemiLength=y,R.numDirectionalShadows=w,R.numPointShadows=x,R.numSpotShadows=M,R.numSpotMaps=D,R.numLightProbes=I,i.version=nve++)},setupView:function l(u,c){let f=0,h=0,g=0,m=0,v=0;const _=c.matrixWorldInverse;for(let y=0,w=u.length;y<w;y++){const x=u[y];if(x.isDirectionalLight){const M=i.directional[f];M.direction.setFromMatrixPosition(x.matrixWorld),r.setFromMatrixPosition(x.target.matrixWorld),M.direction.sub(r),M.direction.transformDirection(_),f++}else if(x.isSpotLight){const M=i.spot[g];M.position.setFromMatrixPosition(x.matrixWorld),M.position.applyMatrix4(_),M.direction.setFromMatrixPosition(x.matrixWorld),r.setFromMatrixPosition(x.target.matrixWorld),M.direction.sub(r),M.direction.transformDirection(_),g++}else if(x.isRectAreaLight){const M=i.rectArea[m];M.position.setFromMatrixPosition(x.matrixWorld),M.position.applyMatrix4(_),s.identity(),o.copy(x.matrixWorld),o.premultiply(_),s.extractRotation(o),M.halfWidth.set(.5*x.width,0,0),M.halfHeight.set(0,.5*x.height,0),M.halfWidth.applyMatrix4(s),M.halfHeight.applyMatrix4(s),m++}else if(x.isPointLight){const M=i.point[h];M.position.setFromMatrixPosition(x.matrixWorld),M.position.applyMatrix4(_),h++}else if(x.isHemisphereLight){const M=i.hemi[v];M.direction.setFromMatrixPosition(x.matrixWorld),M.direction.transformDirection(_),v++}}},state:i}}function u$(n){const e=new rve(n),t=[],i=[],u={lightsArray:t,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:function r(c){u.camera=c,t.length=0,i.length=0},state:u,setupLights:function a(){e.setup(t)},setupLightsView:function l(c){e.setupView(t,c)},pushLight:function o(c){t.push(c)},pushShadow:function s(c){i.push(c)}}}function ove(n){let e=new WeakMap;return{get:function t(r,o=0){const s=e.get(r);let a;return void 0===s?(a=new u$(n),e.set(r,[a])):o>=s.length?(a=new u$(n),s.push(a)):a=s[o],a},dispose:function i(){e=new WeakMap}}}function lve(n,e,t){let i=new tx;const r=new xe,o=new xe,s=new $n,a=new eW({depthPacking:3201}),l=new tW,u={},c=t.maxTextureSize,f={[Ad]:1,[Ta]:0,[Dc]:2},h=new Rc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new xe},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),g=h.clone();g.defines.HORIZONTAL_PASS=1;const m=new cn;m.setAttribute("position",new bi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new yr(m,h),_=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let y=this.type;function w(E,I){const R=e.update(v);h.defines.VSM_SAMPLES!==E.blurSamples&&(h.defines.VSM_SAMPLES=E.blurSamples,g.defines.VSM_SAMPLES=E.blurSamples,h.needsUpdate=!0,g.needsUpdate=!0),null===E.mapPass&&(E.mapPass=new Pd(r.x,r.y)),h.uniforms.shadow_pass.value=E.map.texture,h.uniforms.resolution.value=E.mapSize,h.uniforms.radius.value=E.radius,n.setRenderTarget(E.mapPass),n.clear(),n.renderBufferDirect(I,null,R,h,v,null),g.uniforms.shadow_pass.value=E.mapPass.texture,g.uniforms.resolution.value=E.mapSize,g.uniforms.radius.value=E.radius,n.setRenderTarget(E.map),n.clear(),n.renderBufferDirect(I,null,R,g,v,null)}function x(E,I,R,S){let T=null;const z=!0===R.isPointLight?E.customDistanceMaterial:E.customDepthMaterial;if(void 0!==z)T=z;else if(T=!0===R.isPointLight?l:a,n.localClippingEnabled&&!0===I.clipShadows&&Array.isArray(I.clippingPlanes)&&0!==I.clippingPlanes.length||I.displacementMap&&0!==I.displacementScale||I.alphaMap&&I.alphaTest>0||I.map&&I.alphaTest>0||!0===I.alphaToCoverage){const Z=T.uuid,J=I.uuid;let le=u[Z];void 0===le&&(le={},u[Z]=le);let fe=le[J];void 0===fe&&(fe=T.clone(),le[J]=fe,I.addEventListener("dispose",D)),T=fe}return T.visible=I.visible,T.wireframe=I.wireframe,T.side=3===S?null!==I.shadowSide?I.shadowSide:I.side:null!==I.shadowSide?I.shadowSide:f[I.side],T.alphaMap=I.alphaMap,T.alphaTest=!0===I.alphaToCoverage?.5:I.alphaTest,T.map=I.map,T.clipShadows=I.clipShadows,T.clippingPlanes=I.clippingPlanes,T.clipIntersection=I.clipIntersection,T.displacementMap=I.displacementMap,T.displacementScale=I.displacementScale,T.displacementBias=I.displacementBias,T.wireframeLinewidth=I.wireframeLinewidth,T.linewidth=I.linewidth,!0===R.isPointLight&&!0===T.isMeshDistanceMaterial&&(n.properties.get(T).light=R),T}function M(E,I,R,S,T){if(!1===E.visible)return;if(E.layers.test(I.layers)&&(E.isMesh||E.isLine||E.isPoints)&&(E.castShadow||E.receiveShadow&&3===T)&&(!E.frustumCulled||i.intersectsObject(E))){E.modelViewMatrix.multiplyMatrices(R.matrixWorldInverse,E.matrixWorld);const J=e.update(E),le=E.material;if(Array.isArray(le)){const fe=J.groups;for(let W=0,ie=fe.length;W<ie;W++){const Y=fe[W],ge=le[Y.materialIndex];if(ge&&ge.visible){const Le=x(E,ge,S,T);E.onBeforeShadow(n,E,I,R,J,Le,Y),n.renderBufferDirect(R,null,J,Le,E,Y),E.onAfterShadow(n,E,I,R,J,Le,Y)}}}else if(le.visible){const fe=x(E,le,S,T);E.onBeforeShadow(n,E,I,R,J,fe,null),n.renderBufferDirect(R,null,J,fe,E,null),E.onAfterShadow(n,E,I,R,J,fe,null)}}const Z=E.children;for(let J=0,le=Z.length;J<le;J++)M(Z[J],I,R,S,T)}function D(E){E.target.removeEventListener("dispose",D);for(const R in u){const S=u[R],T=E.target.uuid;T in S&&(S[T].dispose(),delete S[T])}}this.render=function(E,I,R){if(!1===_.enabled||!1===_.autoUpdate&&!1===_.needsUpdate||0===E.length)return;const S=n.getRenderTarget(),T=n.getActiveCubeFace(),z=n.getActiveMipmapLevel(),Z=n.state;Z.setBlending(0),Z.buffers.color.setClear(1,1,1,1),Z.buffers.depth.setTest(!0),Z.setScissorTest(!1);const J=3!==y&&3===this.type,le=3===y&&3!==this.type;for(let fe=0,W=E.length;fe<W;fe++){const ie=E[fe],Y=ie.shadow;if(void 0===Y){console.warn("THREE.WebGLShadowMap:",ie,"has no shadow.");continue}if(!1===Y.autoUpdate&&!1===Y.needsUpdate)continue;r.copy(Y.mapSize);const ge=Y.getFrameExtents();if(r.multiply(ge),o.copy(Y.mapSize),(r.x>c||r.y>c)&&(r.x>c&&(o.x=Math.floor(c/ge.x),r.x=o.x*ge.x,Y.mapSize.x=o.x),r.y>c&&(o.y=Math.floor(c/ge.y),r.y=o.y*ge.y,Y.mapSize.y=o.y)),null===Y.map||!0===J||!0===le){const We=3!==this.type?{minFilter:Fo,magFilter:Fo}:{};null!==Y.map&&Y.map.dispose(),Y.map=new Pd(r.x,r.y,We),Y.map.texture.name=ie.name+".shadowMap",Y.camera.updateProjectionMatrix()}n.setRenderTarget(Y.map),n.clear();const Le=Y.getViewportCount();for(let We=0;We<Le;We++){const vt=Y.getViewport(We);s.set(o.x*vt.x,o.y*vt.y,o.x*vt.z,o.y*vt.w),Z.viewport(s),Y.updateMatrices(ie,We),i=Y.getFrustum(),M(I,R,Y.camera,ie,this.type)}!0!==Y.isPointLightShadow&&3===this.type&&w(Y,R),Y.needsUpdate=!1}y=this.type,_.needsUpdate=!1,n.setRenderTarget(S,T,z)}}const uve={[uO]:1,[dO]:6,[fO]:7,[C_]:5,[cO]:0,[pO]:2,[gO]:4,[hO]:3};function cve(n,e){const o=new function t(){let Q=!1;const ht=new $n;let ve=null;const De=new $n(0,0,0,0);return{setMask:function(yt){ve!==yt&&!Q&&(n.colorMask(yt,yt,yt,yt),ve=yt)},setLocked:function(yt){Q=yt},setClear:function(yt,pt,Pn,Nr,Ps){!0===Ps&&(yt*=Nr,pt*=Nr,Pn*=Nr),ht.set(yt,pt,Pn,Nr),!1===De.equals(ht)&&(n.clearColor(yt,pt,Pn,Nr),De.copy(ht))},reset:function(){Q=!1,ve=null,De.set(-1,0,0,0)}}},s=new function i(){let Q=!1,ht=!1,ve=null,De=null,yt=null;return{setReversed:function(pt){if(ht!==pt){const Pn=e.get("EXT_clip_control");Pn.clipControlEXT(Pn.LOWER_LEFT_EXT,pt?Pn.ZERO_TO_ONE_EXT:Pn.NEGATIVE_ONE_TO_ONE_EXT),ht=pt;const Nr=yt;yt=null,this.setClear(Nr)}},getReversed:function(){return ht},setTest:function(pt){pt?Ne(n.DEPTH_TEST):ct(n.DEPTH_TEST)},setMask:function(pt){ve!==pt&&!Q&&(n.depthMask(pt),ve=pt)},setFunc:function(pt){if(ht&&(pt=uve[pt]),De!==pt){switch(pt){case 0:n.depthFunc(n.NEVER);break;case 1:n.depthFunc(n.ALWAYS);break;case 2:n.depthFunc(n.LESS);break;case 3:default:n.depthFunc(n.LEQUAL);break;case 4:n.depthFunc(n.EQUAL);break;case 5:n.depthFunc(n.GEQUAL);break;case 6:n.depthFunc(n.GREATER);break;case 7:n.depthFunc(n.NOTEQUAL)}De=pt}},setLocked:function(pt){Q=pt},setClear:function(pt){yt!==pt&&(ht&&(pt=1-pt),n.clearDepth(pt),yt=pt)},reset:function(){Q=!1,ve=null,De=null,yt=null,ht=!1}}},a=new function r(){let Q=!1,ht=null,ve=null,De=null,yt=null,pt=null,Pn=null,Nr=null,Ps=null;return{setTest:function(Ai){Q||(Ai?Ne(n.STENCIL_TEST):ct(n.STENCIL_TEST))},setMask:function(Ai){ht!==Ai&&!Q&&(n.stencilMask(Ai),ht=Ai)},setFunc:function(Ai,Wu,ef){(ve!==Ai||De!==Wu||yt!==ef)&&(n.stencilFunc(Ai,Wu,ef),ve=Ai,De=Wu,yt=ef)},setOp:function(Ai,Wu,ef){(pt!==Ai||Pn!==Wu||Nr!==ef)&&(n.stencilOp(Ai,Wu,ef),pt=Ai,Pn=Wu,Nr=ef)},setLocked:function(Ai){Q=Ai},setClear:function(Ai){Ps!==Ai&&(n.clearStencil(Ai),Ps=Ai)},reset:function(){Q=!1,ht=null,ve=null,De=null,yt=null,pt=null,Pn=null,Nr=null,Ps=null}}},l=new WeakMap,u=new WeakMap;let c={},f={},h=new WeakMap,g=[],m=null,v=!1,_=null,y=null,w=null,x=null,M=null,D=null,E=null,I=new Ke(0,0,0),R=0,S=!1,T=null,z=null,Z=null,J=null,le=null;const fe=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let W=!1,ie=0;const Y=n.getParameter(n.VERSION);-1!==Y.indexOf("WebGL")?(ie=parseFloat(/^WebGL (\d)/.exec(Y)[1]),W=ie>=1):-1!==Y.indexOf("OpenGL ES")&&(ie=parseFloat(/^OpenGL ES (\d)/.exec(Y)[1]),W=ie>=2);let ge=null,Le={};const We=n.getParameter(n.SCISSOR_BOX),vt=n.getParameter(n.VIEWPORT),wt=(new $n).fromArray(We),ue=(new $n).fromArray(vt);function Ce(Q,ht,ve,De){const yt=new Uint8Array(4),pt=n.createTexture();n.bindTexture(Q,pt),n.texParameteri(Q,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(Q,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Pn=0;Pn<ve;Pn++)Q===n.TEXTURE_3D||Q===n.TEXTURE_2D_ARRAY?n.texImage3D(ht,0,n.RGBA,1,1,De,0,n.RGBA,n.UNSIGNED_BYTE,yt):n.texImage2D(ht+Pn,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,yt);return pt}const Qe={};function Ne(Q){!0!==c[Q]&&(n.enable(Q),c[Q]=!0)}function ct(Q){!1!==c[Q]&&(n.disable(Q),c[Q]=!1)}Qe[n.TEXTURE_2D]=Ce(n.TEXTURE_2D,n.TEXTURE_2D,1),Qe[n.TEXTURE_CUBE_MAP]=Ce(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),Qe[n.TEXTURE_2D_ARRAY]=Ce(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Qe[n.TEXTURE_3D]=Ce(n.TEXTURE_3D,n.TEXTURE_3D,1,1),o.setClear(0,0,0,1),s.setClear(1),a.setClear(0),Ne(n.DEPTH_TEST),s.setFunc(3),ke(!1),Xe(1),Ne(n.CULL_FACE),H(0);const kn={[vg]:n.FUNC_ADD,[Yfe]:n.FUNC_SUBTRACT,[Zfe]:n.FUNC_REVERSE_SUBTRACT};kn[103]=n.MIN,kn[104]=n.MAX;const qt={[Qfe]:n.ZERO,[ehe]:n.ONE,[the]:n.SRC_COLOR,[aO]:n.SRC_ALPHA,[ahe]:n.SRC_ALPHA_SATURATE,[ohe]:n.DST_COLOR,[ihe]:n.DST_ALPHA,[nhe]:n.ONE_MINUS_SRC_COLOR,[lO]:n.ONE_MINUS_SRC_ALPHA,[she]:n.ONE_MINUS_DST_COLOR,[rhe]:n.ONE_MINUS_DST_ALPHA,[lhe]:n.CONSTANT_COLOR,[uhe]:n.ONE_MINUS_CONSTANT_COLOR,[che]:n.CONSTANT_ALPHA,[dhe]:n.ONE_MINUS_CONSTANT_ALPHA};function H(Q,ht,ve,De,yt,pt,Pn,Nr,Ps,Ai){if(0!==Q){if(!1===v&&(Ne(n.BLEND),v=!0),5===Q)yt=yt||ht,pt=pt||ve,Pn=Pn||De,(ht!==y||yt!==M)&&(n.blendEquationSeparate(kn[ht],kn[yt]),y=ht,M=yt),(ve!==w||De!==x||pt!==D||Pn!==E)&&(n.blendFuncSeparate(qt[ve],qt[De],qt[pt],qt[Pn]),w=ve,x=De,D=pt,E=Pn),(!1===Nr.equals(I)||Ps!==R)&&(n.blendColor(Nr.r,Nr.g,Nr.b,Ps),I.copy(Nr),R=Ps),_=Q,S=!1;else if(Q!==_||Ai!==S){if((100!==y||100!==M)&&(n.blendEquation(n.FUNC_ADD),y=100,M=100),Ai)switch(Q){case 1:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.ONE,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Q)}else switch(Q){case 1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Q)}w=null,x=null,D=null,E=null,I.set(0,0,0),R=0,_=Q,S=Ai}}else!0===v&&(ct(n.BLEND),v=!1)}function ke(Q){T!==Q&&(n.frontFace(Q?n.CW:n.CCW),T=Q)}function Xe(Q){0!==Q?(Ne(n.CULL_FACE),Q!==z&&n.cullFace(1===Q?n.BACK:2===Q?n.FRONT:n.FRONT_AND_BACK)):ct(n.CULL_FACE),z=Q}function Ot(Q,ht,ve){Q?(Ne(n.POLYGON_OFFSET_FILL),(J!==ht||le!==ve)&&(n.polygonOffset(ht,ve),J=ht,le=ve)):ct(n.POLYGON_OFFSET_FILL)}return{buffers:{color:o,depth:s,stencil:a},enable:Ne,disable:ct,bindFramebuffer:function At(Q,ht){return f[Q]!==ht&&(n.bindFramebuffer(Q,ht),f[Q]=ht,Q===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=ht),Q===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=ht),!0)},drawBuffers:function ft(Q,ht){let ve=g,De=!1;if(Q){ve=h.get(ht),void 0===ve&&(ve=[],h.set(ht,ve));const yt=Q.textures;if(ve.length!==yt.length||ve[0]!==n.COLOR_ATTACHMENT0){for(let pt=0,Pn=yt.length;pt<Pn;pt++)ve[pt]=n.COLOR_ATTACHMENT0+pt;ve.length=yt.length,De=!0}}else ve[0]!==n.BACK&&(ve[0]=n.BACK,De=!0);De&&n.drawBuffers(ve)},useProgram:function Xn(Q){return m!==Q&&(n.useProgram(Q),m=Q,!0)},setBlending:H,setMaterial:function tt(Q,ht){2===Q.side?ct(n.CULL_FACE):Ne(n.CULL_FACE);let ve=1===Q.side;ht&&(ve=!ve),ke(ve),1===Q.blending&&!1===Q.transparent?H(0):H(Q.blending,Q.blendEquation,Q.blendSrc,Q.blendDst,Q.blendEquationAlpha,Q.blendSrcAlpha,Q.blendDstAlpha,Q.blendColor,Q.blendAlpha,Q.premultipliedAlpha),s.setFunc(Q.depthFunc),s.setTest(Q.depthTest),s.setMask(Q.depthWrite),o.setMask(Q.colorWrite);const De=Q.stencilWrite;a.setTest(De),De&&(a.setMask(Q.stencilWriteMask),a.setFunc(Q.stencilFunc,Q.stencilRef,Q.stencilFuncMask),a.setOp(Q.stencilFail,Q.stencilZFail,Q.stencilZPass)),Ot(Q.polygonOffset,Q.polygonOffsetFactor,Q.polygonOffsetUnits),!0===Q.alphaToCoverage?Ne(n.SAMPLE_ALPHA_TO_COVERAGE):ct(n.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:ke,setCullFace:Xe,setLineWidth:function Ae(Q){Q!==Z&&(W&&n.lineWidth(Q),Z=Q)},setPolygonOffset:Ot,setScissorTest:function Ue(Q){Q?Ne(n.SCISSOR_TEST):ct(n.SCISSOR_TEST)},activeTexture:function V(Q){void 0===Q&&(Q=n.TEXTURE0+fe-1),ge!==Q&&(n.activeTexture(Q),ge=Q)},bindTexture:function P(Q,ht,ve){void 0===ve&&(ve=null===ge?n.TEXTURE0+fe-1:ge);let De=Le[ve];void 0===De&&(De={type:void 0,texture:void 0},Le[ve]=De),(De.type!==Q||De.texture!==ht)&&(ge!==ve&&(n.activeTexture(ve),ge=ve),n.bindTexture(Q,ht||Qe[Q]),De.type=Q,De.texture=ht)},unbindTexture:function ae(){const Q=Le[ge];void 0!==Q&&void 0!==Q.type&&(n.bindTexture(Q.type,null),Q.type=void 0,Q.texture=void 0)},compressedTexImage2D:function we(){try{n.compressedTexImage2D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}},compressedTexImage3D:function Ie(){try{n.compressedTexImage3D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}},texImage2D:function bt(){try{n.texImage2D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}},texImage3D:function en(){try{n.texImage3D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}},updateUBOMapping:function ri(Q,ht){let ve=u.get(ht);void 0===ve&&(ve=new WeakMap,u.set(ht,ve));let De=ve.get(Q);void 0===De&&(De=n.getUniformBlockIndex(ht,Q.name),ve.set(Q,De))},uniformBlockBinding:function Fn(Q,ht){const De=u.get(ht).get(Q);l.get(ht)!==De&&(n.uniformBlockBinding(ht,De,Q.__bindingPointIndex),l.set(ht,De))},texStorage2D:function nn(){try{n.texStorage2D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}},texStorage3D:function Ge(){try{n.texStorage3D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}},texSubImage2D:function _e(){try{n.texSubImage2D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}},texSubImage3D:function It(){try{n.texSubImage3D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}},compressedTexSubImage2D:function ot(){try{n.compressedTexSubImage2D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}},compressedTexSubImage3D:function Ht(){try{n.compressedTexSubImage3D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}},scissor:function gn(Q){!1===wt.equals(Q)&&(n.scissor(Q.x,Q.y,Q.z,Q.w),wt.copy(Q))},viewport:function Tt(Q){!1===ue.equals(Q)&&(n.viewport(Q.x,Q.y,Q.z,Q.w),ue.copy(Q))},reset:function ir(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),s.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),c={},ge=null,Le={},f={},h=new WeakMap,g=[],m=null,v=!1,_=null,y=null,w=null,x=null,M=null,D=null,E=null,I=new Ke(0,0,0),R=0,S=!1,T=null,z=null,Z=null,J=null,le=null,wt.set(0,0,n.canvas.width,n.canvas.height),ue.set(0,0,n.canvas.width,n.canvas.height),o.reset(),s.reset(),a.reset()}}}function dve(n,e,t,i,r,o,s){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),u=new xe,c=new WeakMap;let f;const h=new WeakMap;let g=!1;try{g=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function m(V,P){return g?new OffscreenCanvas(V,P):zw("canvas")}function v(V,P,ae){let we=1;const Ie=Ue(V);if((Ie.width>ae||Ie.height>ae)&&(we=ae/Math.max(Ie.width,Ie.height)),we<1){if(typeof HTMLImageElement<"u"&&V instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&V instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&V instanceof ImageBitmap||typeof VideoFrame<"u"&&V instanceof VideoFrame){const _e=Math.floor(we*Ie.width),It=Math.floor(we*Ie.height);void 0===f&&(f=m(_e,It));const ot=P?m(_e,It):f;return ot.width=_e,ot.height=It,ot.getContext("2d").drawImage(V,0,0,_e,It),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ie.width+"x"+Ie.height+") to ("+_e+"x"+It+")."),ot}return"data"in V&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ie.width+"x"+Ie.height+")."),V}return V}function _(V){return V.generateMipmaps}function y(V){n.generateMipmap(V)}function w(V){return V.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:V.isWebGL3DRenderTarget?n.TEXTURE_3D:V.isWebGLArrayRenderTarget||V.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function x(V,P,ae,we,Ie=!1){if(null!==V){if(void 0!==n[V])return n[V];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+V+"'")}let _e=P;if(P===n.RED&&(ae===n.FLOAT&&(_e=n.R32F),ae===n.HALF_FLOAT&&(_e=n.R16F),ae===n.UNSIGNED_BYTE&&(_e=n.R8)),P===n.RED_INTEGER&&(ae===n.UNSIGNED_BYTE&&(_e=n.R8UI),ae===n.UNSIGNED_SHORT&&(_e=n.R16UI),ae===n.UNSIGNED_INT&&(_e=n.R32UI),ae===n.BYTE&&(_e=n.R8I),ae===n.SHORT&&(_e=n.R16I),ae===n.INT&&(_e=n.R32I)),P===n.RG&&(ae===n.FLOAT&&(_e=n.RG32F),ae===n.HALF_FLOAT&&(_e=n.RG16F),ae===n.UNSIGNED_BYTE&&(_e=n.RG8)),P===n.RG_INTEGER&&(ae===n.UNSIGNED_BYTE&&(_e=n.RG8UI),ae===n.UNSIGNED_SHORT&&(_e=n.RG16UI),ae===n.UNSIGNED_INT&&(_e=n.RG32UI),ae===n.BYTE&&(_e=n.RG8I),ae===n.SHORT&&(_e=n.RG16I),ae===n.INT&&(_e=n.RG32I)),P===n.RGB_INTEGER&&(ae===n.UNSIGNED_BYTE&&(_e=n.RGB8UI),ae===n.UNSIGNED_SHORT&&(_e=n.RGB16UI),ae===n.UNSIGNED_INT&&(_e=n.RGB32UI),ae===n.BYTE&&(_e=n.RGB8I),ae===n.SHORT&&(_e=n.RGB16I),ae===n.INT&&(_e=n.RGB32I)),P===n.RGBA_INTEGER&&(ae===n.UNSIGNED_BYTE&&(_e=n.RGBA8UI),ae===n.UNSIGNED_SHORT&&(_e=n.RGBA16UI),ae===n.UNSIGNED_INT&&(_e=n.RGBA32UI),ae===n.BYTE&&(_e=n.RGBA8I),ae===n.SHORT&&(_e=n.RGBA16I),ae===n.INT&&(_e=n.RGBA32I)),P===n.RGB&&ae===n.UNSIGNED_INT_5_9_9_9_REV&&(_e=n.RGB9_E5),P===n.RGBA){const It=Ie?CT:bn.getTransfer(we);ae===n.FLOAT&&(_e=n.RGBA32F),ae===n.HALF_FLOAT&&(_e=n.RGBA16F),ae===n.UNSIGNED_BYTE&&(_e=It===ki?n.SRGB8_ALPHA8:n.RGBA8),ae===n.UNSIGNED_SHORT_4_4_4_4&&(_e=n.RGBA4),ae===n.UNSIGNED_SHORT_5_5_5_1&&(_e=n.RGB5_A1)}return(_e===n.R16F||_e===n.R32F||_e===n.RG16F||_e===n.RG32F||_e===n.RGBA16F||_e===n.RGBA32F)&&e.get("EXT_color_buffer_float"),_e}function M(V,P){let ae;return V?null===P||P===xh||P===Lw?ae=n.DEPTH24_STENCIL8:P===nl?ae=n.DEPTH32F_STENCIL8:P===Nw&&(ae=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===P||P===xh||P===Lw?ae=n.DEPTH_COMPONENT24:P===nl?ae=n.DEPTH_COMPONENT32F:P===Nw&&(ae=n.DEPTH_COMPONENT16),ae}function D(V,P){return!0===_(V)||V.isFramebufferTexture&&V.minFilter!==Fo&&V.minFilter!==zr?Math.log2(Math.max(P.width,P.height))+1:void 0!==V.mipmaps&&V.mipmaps.length>0?V.mipmaps.length:V.isCompressedTexture&&Array.isArray(V.image)?P.mipmaps.length:1}function E(V){const P=V.target;P.removeEventListener("dispose",E),function R(V){const P=i.get(V);if(void 0===P.__webglInit)return;const ae=V.source,we=h.get(ae);if(we){const Ie=we[P.__cacheKey];Ie.usedTimes--,0===Ie.usedTimes&&S(V),0===Object.keys(we).length&&h.delete(ae)}i.remove(V)}(P),P.isVideoTexture&&c.delete(P)}function I(V){const P=V.target;P.removeEventListener("dispose",I),function T(V){const P=i.get(V);if(V.depthTexture&&(V.depthTexture.dispose(),i.remove(V.depthTexture)),V.isWebGLCubeRenderTarget)for(let we=0;we<6;we++){if(Array.isArray(P.__webglFramebuffer[we]))for(let Ie=0;Ie<P.__webglFramebuffer[we].length;Ie++)n.deleteFramebuffer(P.__webglFramebuffer[we][Ie]);else n.deleteFramebuffer(P.__webglFramebuffer[we]);P.__webglDepthbuffer&&n.deleteRenderbuffer(P.__webglDepthbuffer[we])}else{if(Array.isArray(P.__webglFramebuffer))for(let we=0;we<P.__webglFramebuffer.length;we++)n.deleteFramebuffer(P.__webglFramebuffer[we]);else n.deleteFramebuffer(P.__webglFramebuffer);if(P.__webglDepthbuffer&&n.deleteRenderbuffer(P.__webglDepthbuffer),P.__webglMultisampledFramebuffer&&n.deleteFramebuffer(P.__webglMultisampledFramebuffer),P.__webglColorRenderbuffer)for(let we=0;we<P.__webglColorRenderbuffer.length;we++)P.__webglColorRenderbuffer[we]&&n.deleteRenderbuffer(P.__webglColorRenderbuffer[we]);P.__webglDepthRenderbuffer&&n.deleteRenderbuffer(P.__webglDepthRenderbuffer)}const ae=V.textures;for(let we=0,Ie=ae.length;we<Ie;we++){const _e=i.get(ae[we]);_e.__webglTexture&&(n.deleteTexture(_e.__webglTexture),s.memory.textures--),i.remove(ae[we])}i.remove(V)}(P)}function S(V){const P=i.get(V);n.deleteTexture(P.__webglTexture),delete h.get(V.source)[P.__cacheKey],s.memory.textures--}let z=0;function fe(V,P){const ae=i.get(V);if(V.isVideoTexture&&function Ae(V){const P=s.render.frame;c.get(V)!==P&&(c.set(V,P),V.update())}(V),!1===V.isRenderTargetTexture&&V.version>0&&ae.__version!==V.version){const we=V.image;if(null===we)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==we.complete)return void ue(ae,V,P);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(n.TEXTURE_2D,ae.__webglTexture,n.TEXTURE0+P)}const ge={[Dd]:n.REPEAT,[Aa]:n.CLAMP_TO_EDGE,[Pw]:n.MIRRORED_REPEAT},Le={[Fo]:n.NEAREST,[_O]:n.NEAREST_MIPMAP_NEAREST,[S_]:n.NEAREST_MIPMAP_LINEAR,[zr]:n.LINEAR,[Ow]:n.LINEAR_MIPMAP_NEAREST,[Ru]:n.LINEAR_MIPMAP_LINEAR},We={[Dhe]:n.NEVER,[Fhe]:n.ALWAYS,[Ihe]:n.LESS,[jj]:n.LEQUAL,[Rhe]:n.EQUAL,[Nhe]:n.GEQUAL,[Phe]:n.GREATER,[Ohe]:n.NOTEQUAL};function vt(V,P){if(P.type===nl&&!1===e.has("OES_texture_float_linear")&&(P.magFilter===zr||1007===P.magFilter||P.magFilter===S_||P.magFilter===Ru||P.minFilter===zr||1007===P.minFilter||P.minFilter===S_||P.minFilter===Ru)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(V,n.TEXTURE_WRAP_S,ge[P.wrapS]),n.texParameteri(V,n.TEXTURE_WRAP_T,ge[P.wrapT]),(V===n.TEXTURE_3D||V===n.TEXTURE_2D_ARRAY)&&n.texParameteri(V,n.TEXTURE_WRAP_R,ge[P.wrapR]),n.texParameteri(V,n.TEXTURE_MAG_FILTER,Le[P.magFilter]),n.texParameteri(V,n.TEXTURE_MIN_FILTER,Le[P.minFilter]),P.compareFunction&&(n.texParameteri(V,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(V,n.TEXTURE_COMPARE_FUNC,We[P.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){if(P.magFilter===Fo||P.minFilter!==S_&&P.minFilter!==Ru||P.type===nl&&!1===e.has("OES_texture_float_linear"))return;if(P.anisotropy>1||i.get(P).__currentAnisotropy){const ae=e.get("EXT_texture_filter_anisotropic");n.texParameterf(V,ae.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(P.anisotropy,r.getMaxAnisotropy())),i.get(P).__currentAnisotropy=P.anisotropy}}}function wt(V,P){let ae=!1;void 0===V.__webglInit&&(V.__webglInit=!0,P.addEventListener("dispose",E));const we=P.source;let Ie=h.get(we);void 0===Ie&&(Ie={},h.set(we,Ie));const _e=function le(V){const P=[];return P.push(V.wrapS),P.push(V.wrapT),P.push(V.wrapR||0),P.push(V.magFilter),P.push(V.minFilter),P.push(V.anisotropy),P.push(V.internalFormat),P.push(V.format),P.push(V.type),P.push(V.generateMipmaps),P.push(V.premultiplyAlpha),P.push(V.flipY),P.push(V.unpackAlignment),P.push(V.colorSpace),P.join()}(P);if(_e!==V.__cacheKey){void 0===Ie[_e]&&(Ie[_e]={texture:n.createTexture(),usedTimes:0},s.memory.textures++,ae=!0),Ie[_e].usedTimes++;const It=Ie[V.__cacheKey];void 0!==It&&(Ie[V.__cacheKey].usedTimes--,0===It.usedTimes&&S(P)),V.__cacheKey=_e,V.__webglTexture=Ie[_e].texture}return ae}function ue(V,P,ae){let we=n.TEXTURE_2D;(P.isDataArrayTexture||P.isCompressedArrayTexture)&&(we=n.TEXTURE_2D_ARRAY),P.isData3DTexture&&(we=n.TEXTURE_3D);const Ie=wt(V,P),_e=P.source;t.bindTexture(we,V.__webglTexture,n.TEXTURE0+ae);const It=i.get(_e);if(_e.version!==It.__version||!0===Ie){t.activeTexture(n.TEXTURE0+ae);const ot=bn.getPrimaries(bn.workingColorSpace),Ht=""===P.colorSpace?null:bn.getPrimaries(P.colorSpace),nn=""===P.colorSpace||ot===Ht?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,P.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,P.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,P.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,nn);let Ge=v(P.image,!1,r.maxTextureSize);Ge=Ot(P,Ge);const bt=o.convert(P.format,P.colorSpace),en=o.convert(P.type);let Tt,gn=x(P.internalFormat,bt,en,P.colorSpace,P.isVideoTexture);vt(we,P);const ri=P.mipmaps,Fn=!0!==P.isVideoTexture,ir=void 0===It.__version||!0===Ie,Q=_e.dataReady,ht=D(P,Ge);if(P.isDepthTexture)gn=M(P.format===Bw,P.type),ir&&(Fn?t.texStorage2D(n.TEXTURE_2D,1,gn,Ge.width,Ge.height):t.texImage2D(n.TEXTURE_2D,0,gn,Ge.width,Ge.height,0,bt,en,null));else if(P.isDataTexture)if(ri.length>0){Fn&&ir&&t.texStorage2D(n.TEXTURE_2D,ht,gn,ri[0].width,ri[0].height);for(let ve=0,De=ri.length;ve<De;ve++)Tt=ri[ve],Fn?Q&&t.texSubImage2D(n.TEXTURE_2D,ve,0,0,Tt.width,Tt.height,bt,en,Tt.data):t.texImage2D(n.TEXTURE_2D,ve,gn,Tt.width,Tt.height,0,bt,en,Tt.data);P.generateMipmaps=!1}else Fn?(ir&&t.texStorage2D(n.TEXTURE_2D,ht,gn,Ge.width,Ge.height),Q&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ge.width,Ge.height,bt,en,Ge.data)):t.texImage2D(n.TEXTURE_2D,0,gn,Ge.width,Ge.height,0,bt,en,Ge.data);else if(P.isCompressedTexture)if(P.isCompressedArrayTexture){Fn&&ir&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ht,gn,ri[0].width,ri[0].height,Ge.depth);for(let ve=0,De=ri.length;ve<De;ve++)if(Tt=ri[ve],P.format!==Da)if(null!==bt)if(Fn){if(Q)if(P.layerUpdates.size>0){const yt=yF(Tt.width,Tt.height,P.format,P.type);for(const pt of P.layerUpdates){const Pn=Tt.data.subarray(pt*yt/Tt.data.BYTES_PER_ELEMENT,(pt+1)*yt/Tt.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,ve,0,0,pt,Tt.width,Tt.height,1,bt,Pn)}P.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,ve,0,0,0,Tt.width,Tt.height,Ge.depth,bt,Tt.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,ve,gn,Tt.width,Tt.height,Ge.depth,0,Tt.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Fn?Q&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,ve,0,0,0,Tt.width,Tt.height,Ge.depth,bt,en,Tt.data):t.texImage3D(n.TEXTURE_2D_ARRAY,ve,gn,Tt.width,Tt.height,Ge.depth,0,bt,en,Tt.data)}else{Fn&&ir&&t.texStorage2D(n.TEXTURE_2D,ht,gn,ri[0].width,ri[0].height);for(let ve=0,De=ri.length;ve<De;ve++)Tt=ri[ve],P.format!==Da?null!==bt?Fn?Q&&t.compressedTexSubImage2D(n.TEXTURE_2D,ve,0,0,Tt.width,Tt.height,bt,Tt.data):t.compressedTexImage2D(n.TEXTURE_2D,ve,gn,Tt.width,Tt.height,0,Tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Fn?Q&&t.texSubImage2D(n.TEXTURE_2D,ve,0,0,Tt.width,Tt.height,bt,en,Tt.data):t.texImage2D(n.TEXTURE_2D,ve,gn,Tt.width,Tt.height,0,bt,en,Tt.data)}else if(P.isDataArrayTexture)if(Fn){if(ir&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ht,gn,Ge.width,Ge.height,Ge.depth),Q)if(P.layerUpdates.size>0){const ve=yF(Ge.width,Ge.height,P.format,P.type);for(const De of P.layerUpdates){const yt=Ge.data.subarray(De*ve/Ge.data.BYTES_PER_ELEMENT,(De+1)*ve/Ge.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,De,Ge.width,Ge.height,1,bt,en,yt)}P.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Ge.width,Ge.height,Ge.depth,bt,en,Ge.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,gn,Ge.width,Ge.height,Ge.depth,0,bt,en,Ge.data);else if(P.isData3DTexture)Fn?(ir&&t.texStorage3D(n.TEXTURE_3D,ht,gn,Ge.width,Ge.height,Ge.depth),Q&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Ge.width,Ge.height,Ge.depth,bt,en,Ge.data)):t.texImage3D(n.TEXTURE_3D,0,gn,Ge.width,Ge.height,Ge.depth,0,bt,en,Ge.data);else if(P.isFramebufferTexture){if(ir)if(Fn)t.texStorage2D(n.TEXTURE_2D,ht,gn,Ge.width,Ge.height);else{let ve=Ge.width,De=Ge.height;for(let yt=0;yt<ht;yt++)t.texImage2D(n.TEXTURE_2D,yt,gn,ve,De,0,bt,en,null),ve>>=1,De>>=1}}else if(ri.length>0){if(Fn&&ir){const ve=Ue(ri[0]);t.texStorage2D(n.TEXTURE_2D,ht,gn,ve.width,ve.height)}for(let ve=0,De=ri.length;ve<De;ve++)Tt=ri[ve],Fn?Q&&t.texSubImage2D(n.TEXTURE_2D,ve,0,0,bt,en,Tt):t.texImage2D(n.TEXTURE_2D,ve,gn,bt,en,Tt);P.generateMipmaps=!1}else if(Fn){if(ir){const ve=Ue(Ge);t.texStorage2D(n.TEXTURE_2D,ht,gn,ve.width,ve.height)}Q&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,bt,en,Ge)}else t.texImage2D(n.TEXTURE_2D,0,gn,bt,en,Ge);_(P)&&y(we),It.__version=_e.version,P.onUpdate&&P.onUpdate(P)}V.__version=P.version}function Qe(V,P,ae,we,Ie,_e){const It=o.convert(ae.format,ae.colorSpace),ot=o.convert(ae.type),Ht=x(ae.internalFormat,It,ot,ae.colorSpace),nn=i.get(P),Ge=i.get(ae);if(Ge.__renderTarget=P,!nn.__hasExternalTextures){const bt=Math.max(1,P.width>>_e),en=Math.max(1,P.height>>_e);Ie===n.TEXTURE_3D||Ie===n.TEXTURE_2D_ARRAY?t.texImage3D(Ie,_e,Ht,bt,en,P.depth,0,It,ot,null):t.texImage2D(Ie,_e,Ht,bt,en,0,It,ot,null)}t.bindFramebuffer(n.FRAMEBUFFER,V),Xe(P)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,we,Ie,Ge.__webglTexture,0,ke(P)):(Ie===n.TEXTURE_2D||Ie>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Ie<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,we,Ie,Ge.__webglTexture,_e),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Ne(V,P,ae){if(n.bindRenderbuffer(n.RENDERBUFFER,V),P.depthBuffer){const we=P.depthTexture,_e=M(P.stencilBuffer,we&&we.isDepthTexture?we.type:null),It=P.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ot=ke(P);Xe(P)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ot,_e,P.width,P.height):ae?n.renderbufferStorageMultisample(n.RENDERBUFFER,ot,_e,P.width,P.height):n.renderbufferStorage(n.RENDERBUFFER,_e,P.width,P.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,It,n.RENDERBUFFER,V)}else{const we=P.textures;for(let Ie=0;Ie<we.length;Ie++){const _e=we[Ie],It=o.convert(_e.format,_e.colorSpace),ot=o.convert(_e.type),Ht=x(_e.internalFormat,It,ot,_e.colorSpace),nn=ke(P);ae&&!1===Xe(P)?n.renderbufferStorageMultisample(n.RENDERBUFFER,nn,Ht,P.width,P.height):Xe(P)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,nn,Ht,P.width,P.height):n.renderbufferStorage(n.RENDERBUFFER,Ht,P.width,P.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function At(V){const P=i.get(V),ae=!0===V.isWebGLCubeRenderTarget;if(P.__boundDepthTexture!==V.depthTexture){const we=V.depthTexture;if(P.__depthDisposeCallback&&P.__depthDisposeCallback(),we){const Ie=()=>{delete P.__boundDepthTexture,delete P.__depthDisposeCallback,we.removeEventListener("dispose",Ie)};we.addEventListener("dispose",Ie),P.__depthDisposeCallback=Ie}P.__boundDepthTexture=we}if(V.depthTexture&&!P.__autoAllocateDepthBuffer){if(ae)throw new Error("target.depthTexture not supported in Cube render targets");const we=V.texture.mipmaps;!function ct(V,P){if(P&&P.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,V),!P.depthTexture||!P.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const we=i.get(P.depthTexture);we.__renderTarget=P,(!we.__webglTexture||P.depthTexture.image.width!==P.width||P.depthTexture.image.height!==P.height)&&(P.depthTexture.image.width=P.width,P.depthTexture.image.height=P.height,P.depthTexture.needsUpdate=!0),fe(P.depthTexture,0);const Ie=we.__webglTexture,_e=ke(P);if(P.depthTexture.format===kw)Xe(P)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Ie,0,_e):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Ie,0);else{if(P.depthTexture.format!==Bw)throw new Error("Unknown depthTexture format");Xe(P)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Ie,0,_e):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Ie,0)}}(we&&we.length>0?P.__webglFramebuffer[0]:P.__webglFramebuffer,V)}else if(ae){P.__webglDepthbuffer=[];for(let we=0;we<6;we++)if(t.bindFramebuffer(n.FRAMEBUFFER,P.__webglFramebuffer[we]),void 0===P.__webglDepthbuffer[we])P.__webglDepthbuffer[we]=n.createRenderbuffer(),Ne(P.__webglDepthbuffer[we],V,!1);else{const Ie=V.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,_e=P.__webglDepthbuffer[we];n.bindRenderbuffer(n.RENDERBUFFER,_e),n.framebufferRenderbuffer(n.FRAMEBUFFER,Ie,n.RENDERBUFFER,_e)}}else{const we=V.texture.mipmaps;if(t.bindFramebuffer(n.FRAMEBUFFER,we&&we.length>0?P.__webglFramebuffer[0]:P.__webglFramebuffer),void 0===P.__webglDepthbuffer)P.__webglDepthbuffer=n.createRenderbuffer(),Ne(P.__webglDepthbuffer,V,!1);else{const Ie=V.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,_e=P.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,_e),n.framebufferRenderbuffer(n.FRAMEBUFFER,Ie,n.RENDERBUFFER,_e)}}t.bindFramebuffer(n.FRAMEBUFFER,null)}const qt=[],H=[];function ke(V){return Math.min(r.maxSamples,V.samples)}function Xe(V){const P=i.get(V);return V.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==P.__useRenderToTexture}function Ot(V,P){const ae=V.colorSpace,we=V.format,Ie=V.type;return!0===V.isCompressedTexture||!0===V.isVideoTexture||ae!==Js&&""!==ae&&(bn.getTransfer(ae)===ki?(we!==Da||Ie!==Ic)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ae)),P}function Ue(V){return typeof HTMLImageElement<"u"&&V instanceof HTMLImageElement?(u.width=V.naturalWidth||V.width,u.height=V.naturalHeight||V.height):typeof VideoFrame<"u"&&V instanceof VideoFrame?(u.width=V.displayWidth,u.height=V.displayHeight):(u.width=V.width,u.height=V.height),u}this.allocateTextureUnit=function J(){const V=z;return V>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+V+" texture units while this GPU supports only "+r.maxTextures),z+=1,V},this.resetTextureUnits=function Z(){z=0},this.setTexture2D=fe,this.setTexture2DArray=function W(V,P){const ae=i.get(V);V.version>0&&ae.__version!==V.version?ue(ae,V,P):t.bindTexture(n.TEXTURE_2D_ARRAY,ae.__webglTexture,n.TEXTURE0+P)},this.setTexture3D=function ie(V,P){const ae=i.get(V);V.version>0&&ae.__version!==V.version?ue(ae,V,P):t.bindTexture(n.TEXTURE_3D,ae.__webglTexture,n.TEXTURE0+P)},this.setTextureCube=function Y(V,P){const ae=i.get(V);V.version>0&&ae.__version!==V.version?function Ce(V,P,ae){if(6!==P.image.length)return;const we=wt(V,P),Ie=P.source;t.bindTexture(n.TEXTURE_CUBE_MAP,V.__webglTexture,n.TEXTURE0+ae);const _e=i.get(Ie);if(Ie.version!==_e.__version||!0===we){t.activeTexture(n.TEXTURE0+ae);const It=bn.getPrimaries(bn.workingColorSpace),ot=""===P.colorSpace?null:bn.getPrimaries(P.colorSpace),Ht=""===P.colorSpace||It===ot?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,P.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,P.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,P.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ht);const nn=P.isCompressedTexture||P.image[0].isCompressedTexture,Ge=P.image[0]&&P.image[0].isDataTexture,bt=[];for(let De=0;De<6;De++)bt[De]=nn||Ge?Ge?P.image[De].image:P.image[De]:v(P.image[De],!0,r.maxCubemapSize),bt[De]=Ot(P,bt[De]);const en=bt[0],gn=o.convert(P.format,P.colorSpace),Tt=o.convert(P.type),ri=x(P.internalFormat,gn,Tt,P.colorSpace),Fn=!0!==P.isVideoTexture,ir=void 0===_e.__version||!0===we,Q=Ie.dataReady;let ve,ht=D(P,en);if(vt(n.TEXTURE_CUBE_MAP,P),nn){Fn&&ir&&t.texStorage2D(n.TEXTURE_CUBE_MAP,ht,ri,en.width,en.height);for(let De=0;De<6;De++){ve=bt[De].mipmaps;for(let yt=0;yt<ve.length;yt++){const pt=ve[yt];P.format!==Da?null!==gn?Fn?Q&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,yt,0,0,pt.width,pt.height,gn,pt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,yt,ri,pt.width,pt.height,0,pt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Fn?Q&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,yt,0,0,pt.width,pt.height,gn,Tt,pt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,yt,ri,pt.width,pt.height,0,gn,Tt,pt.data)}}}else{if(ve=P.mipmaps,Fn&&ir){ve.length>0&&ht++;const De=Ue(bt[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,ht,ri,De.width,De.height)}for(let De=0;De<6;De++)if(Ge){Fn?Q&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,0,0,bt[De].width,bt[De].height,gn,Tt,bt[De].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,ri,bt[De].width,bt[De].height,0,gn,Tt,bt[De].data);for(let yt=0;yt<ve.length;yt++){const Pn=ve[yt].image[De].image;Fn?Q&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,yt+1,0,0,Pn.width,Pn.height,gn,Tt,Pn.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,yt+1,ri,Pn.width,Pn.height,0,gn,Tt,Pn.data)}}else{Fn?Q&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,0,0,gn,Tt,bt[De]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,ri,gn,Tt,bt[De]);for(let yt=0;yt<ve.length;yt++){const pt=ve[yt];Fn?Q&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,yt+1,0,0,gn,Tt,pt.image[De]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,yt+1,ri,gn,Tt,pt.image[De])}}}_(P)&&y(n.TEXTURE_CUBE_MAP),_e.__version=Ie.version,P.onUpdate&&P.onUpdate(P)}V.__version=P.version}(ae,V,P):t.bindTexture(n.TEXTURE_CUBE_MAP,ae.__webglTexture,n.TEXTURE0+P)},this.rebindTextures=function ft(V,P,ae){const we=i.get(V);void 0!==P&&Qe(we.__webglFramebuffer,V,V.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),void 0!==ae&&At(V)},this.setupRenderTarget=function Xn(V){const P=V.texture,ae=i.get(V),we=i.get(P);V.addEventListener("dispose",I);const Ie=V.textures,_e=!0===V.isWebGLCubeRenderTarget,It=Ie.length>1;if(It||(void 0===we.__webglTexture&&(we.__webglTexture=n.createTexture()),we.__version=P.version,s.memory.textures++),_e){ae.__webglFramebuffer=[];for(let ot=0;ot<6;ot++)if(P.mipmaps&&P.mipmaps.length>0){ae.__webglFramebuffer[ot]=[];for(let Ht=0;Ht<P.mipmaps.length;Ht++)ae.__webglFramebuffer[ot][Ht]=n.createFramebuffer()}else ae.__webglFramebuffer[ot]=n.createFramebuffer()}else{if(P.mipmaps&&P.mipmaps.length>0){ae.__webglFramebuffer=[];for(let ot=0;ot<P.mipmaps.length;ot++)ae.__webglFramebuffer[ot]=n.createFramebuffer()}else ae.__webglFramebuffer=n.createFramebuffer();if(It)for(let ot=0,Ht=Ie.length;ot<Ht;ot++){const nn=i.get(Ie[ot]);void 0===nn.__webglTexture&&(nn.__webglTexture=n.createTexture(),s.memory.textures++)}if(V.samples>0&&!1===Xe(V)){ae.__webglMultisampledFramebuffer=n.createFramebuffer(),ae.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,ae.__webglMultisampledFramebuffer);for(let ot=0;ot<Ie.length;ot++){const Ht=Ie[ot];ae.__webglColorRenderbuffer[ot]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,ae.__webglColorRenderbuffer[ot]);const nn=o.convert(Ht.format,Ht.colorSpace),Ge=o.convert(Ht.type),bt=x(Ht.internalFormat,nn,Ge,Ht.colorSpace,!0===V.isXRRenderTarget),en=ke(V);n.renderbufferStorageMultisample(n.RENDERBUFFER,en,bt,V.width,V.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ot,n.RENDERBUFFER,ae.__webglColorRenderbuffer[ot])}n.bindRenderbuffer(n.RENDERBUFFER,null),V.depthBuffer&&(ae.__webglDepthRenderbuffer=n.createRenderbuffer(),Ne(ae.__webglDepthRenderbuffer,V,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(_e){t.bindTexture(n.TEXTURE_CUBE_MAP,we.__webglTexture),vt(n.TEXTURE_CUBE_MAP,P);for(let ot=0;ot<6;ot++)if(P.mipmaps&&P.mipmaps.length>0)for(let Ht=0;Ht<P.mipmaps.length;Ht++)Qe(ae.__webglFramebuffer[ot][Ht],V,P,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ot,Ht);else Qe(ae.__webglFramebuffer[ot],V,P,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ot,0);_(P)&&y(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(It){for(let ot=0,Ht=Ie.length;ot<Ht;ot++){const nn=Ie[ot],Ge=i.get(nn);t.bindTexture(n.TEXTURE_2D,Ge.__webglTexture),vt(n.TEXTURE_2D,nn),Qe(ae.__webglFramebuffer,V,nn,n.COLOR_ATTACHMENT0+ot,n.TEXTURE_2D,0),_(nn)&&y(n.TEXTURE_2D)}t.unbindTexture()}else{let ot=n.TEXTURE_2D;if((V.isWebGL3DRenderTarget||V.isWebGLArrayRenderTarget)&&(ot=V.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(ot,we.__webglTexture),vt(ot,P),P.mipmaps&&P.mipmaps.length>0)for(let Ht=0;Ht<P.mipmaps.length;Ht++)Qe(ae.__webglFramebuffer[Ht],V,P,n.COLOR_ATTACHMENT0,ot,Ht);else Qe(ae.__webglFramebuffer,V,P,n.COLOR_ATTACHMENT0,ot,0);_(P)&&y(ot),t.unbindTexture()}V.depthBuffer&&At(V)},this.updateRenderTargetMipmap=function kn(V){const P=V.textures;for(let ae=0,we=P.length;ae<we;ae++){const Ie=P[ae];if(_(Ie)){const _e=w(V),It=i.get(Ie).__webglTexture;t.bindTexture(_e,It),y(_e),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function tt(V){if(V.samples>0)if(!1===Xe(V)){const P=V.textures,ae=V.width,we=V.height;let Ie=n.COLOR_BUFFER_BIT;const _e=V.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,It=i.get(V),ot=P.length>1;if(ot)for(let nn=0;nn<P.length;nn++)t.bindFramebuffer(n.FRAMEBUFFER,It.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+nn,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,It.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+nn,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,It.__webglMultisampledFramebuffer);const Ht=V.texture.mipmaps;t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ht&&Ht.length>0?It.__webglFramebuffer[0]:It.__webglFramebuffer);for(let nn=0;nn<P.length;nn++){if(V.resolveDepthBuffer&&(V.depthBuffer&&(Ie|=n.DEPTH_BUFFER_BIT),V.stencilBuffer&&V.resolveStencilBuffer&&(Ie|=n.STENCIL_BUFFER_BIT)),ot){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,It.__webglColorRenderbuffer[nn]);const Ge=i.get(P[nn]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Ge,0)}n.blitFramebuffer(0,0,ae,we,0,0,ae,we,Ie,n.NEAREST),!0===l&&(qt.length=0,H.length=0,qt.push(n.COLOR_ATTACHMENT0+nn),V.depthBuffer&&!1===V.resolveDepthBuffer&&(qt.push(_e),H.push(_e),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,H)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,qt))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),ot)for(let nn=0;nn<P.length;nn++){t.bindFramebuffer(n.FRAMEBUFFER,It.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+nn,n.RENDERBUFFER,It.__webglColorRenderbuffer[nn]);const Ge=i.get(P[nn]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,It.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+nn,n.TEXTURE_2D,Ge,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,It.__webglMultisampledFramebuffer)}else V.depthBuffer&&!1===V.resolveDepthBuffer&&l&&n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[V.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT])},this.setupDepthRenderbuffer=At,this.setupFrameBufferTexture=Qe,this.useMultisampledRTT=Xe}function fve(n,e){return{convert:function t(i,r=""){let o;const s=bn.getTransfer(r);if(i===Ic)return n.UNSIGNED_BYTE;if(1017===i)return n.UNSIGNED_SHORT_4_4_4_4;if(1018===i)return n.UNSIGNED_SHORT_5_5_5_1;if(35902===i)return n.UNSIGNED_INT_5_9_9_9_REV;if(1010===i)return n.BYTE;if(1011===i)return n.SHORT;if(i===Nw)return n.UNSIGNED_SHORT;if(1013===i)return n.INT;if(i===xh)return n.UNSIGNED_INT;if(i===nl)return n.FLOAT;if(i===Fw)return n.HALF_FLOAT;if(1021===i)return n.ALPHA;if(1022===i)return n.RGB;if(i===Da)return n.RGBA;if(i===kw)return n.DEPTH_COMPONENT;if(i===Bw)return n.DEPTH_STENCIL;if(1028===i)return n.RED;if(1029===i)return n.RED_INTEGER;if(1030===i)return n.RG;if(1031===i)return n.RG_INTEGER;if(1033===i)return n.RGBA_INTEGER;if(i===yT||i===vT||i===bT||i===wT)if(s===ki){if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===o)return null;if(i===yT)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===vT)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===bT)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===wT)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(o=e.get("WEBGL_compressed_texture_s3tc"),null===o)return null;if(i===yT)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===vT)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===bT)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===wT)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===i||35841===i||35842===i||35843===i){if(o=e.get("WEBGL_compressed_texture_pvrtc"),null===o)return null;if(35840===i)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===i)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===i)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===i)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===i||37492===i||37496===i){if(o=e.get("WEBGL_compressed_texture_etc"),null===o)return null;if(36196===i||37492===i)return s===ki?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(37496===i)return s===ki?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}if(37808===i||37809===i||37810===i||37811===i||37812===i||37813===i||37814===i||37815===i||37816===i||37817===i||37818===i||37819===i||37820===i||37821===i){if(o=e.get("WEBGL_compressed_texture_astc"),null===o)return null;if(37808===i)return s===ki?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===i)return s===ki?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===i)return s===ki?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===i)return s===ki?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===i)return s===ki?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===i)return s===ki?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===i)return s===ki?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===i)return s===ki?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===i)return s===ki?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===i)return s===ki?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===i)return s===ki?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===i)return s===ki?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===i)return s===ki?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===i)return s===ki?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}if(i===xT||36494===i||36495===i){if(o=e.get("EXT_texture_compression_bptc"),null===o)return null;if(i===xT)return s===ki?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===i)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===i)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===i||36284===i||36285===i||36286===i){if(o=e.get("EXT_texture_compression_rgtc"),null===o)return null;if(i===xT)return o.COMPRESSED_RED_RGTC1_EXT;if(36284===i)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===i)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===i)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return i===Lw?n.UNSIGNED_INT_24_8:void 0!==n[i]?n[i]:null}}}class gve{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,i){if(null===this.texture){const r=new Jo;e.properties.get(r).__webglTexture=t.texture,(t.depthNear!==i.depthNear||t.depthFar!==i.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,i=new Rc({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new yr(new dx(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class mve extends Id{constructor(e,t){super();const i=this;let r=null,o=1,s=null,a="local-floor",l=1,u=null,c=null,f=null,h=null,g=null,m=null;const v=new gve,_=t.getContextAttributes();let y=null,w=null;const x=[],M=[],D=new xe;let E=null;const I=new bo;I.viewport=new $n;const R=new bo;R.viewport=new $n;const S=[I,R],T=new Xge;let z=null,Z=null;function J(ue){const Ce=M.indexOf(ue.inputSource);if(-1===Ce)return;const Qe=x[Ce];void 0!==Qe&&(Qe.update(ue.inputSource,ue.frame,u||s),Qe.dispatchEvent({type:ue.type,data:ue.inputSource}))}function le(){r.removeEventListener("select",J),r.removeEventListener("selectstart",J),r.removeEventListener("selectend",J),r.removeEventListener("squeeze",J),r.removeEventListener("squeezestart",J),r.removeEventListener("squeezeend",J),r.removeEventListener("end",le),r.removeEventListener("inputsourceschange",fe);for(let ue=0;ue<x.length;ue++){const Ce=M[ue];null!==Ce&&(M[ue]=null,x[ue].disconnect(Ce))}z=null,Z=null,v.reset(),e.setRenderTarget(y),g=null,h=null,f=null,r=null,w=null,wt.stop(),i.isPresenting=!1,e.setPixelRatio(E),e.setSize(D.width,D.height,!1),i.dispatchEvent({type:"sessionend"})}function fe(ue){for(let Ce=0;Ce<ue.removed.length;Ce++){const Qe=ue.removed[Ce],Ne=M.indexOf(Qe);Ne>=0&&(M[Ne]=null,x[Ne].disconnect(Qe))}for(let Ce=0;Ce<ue.added.length;Ce++){const Qe=ue.added[Ce];let Ne=M.indexOf(Qe);if(-1===Ne){for(let At=0;At<x.length;At++){if(At>=M.length){M.push(Qe),Ne=At;break}if(null===M[At]){M[At]=Qe,Ne=At;break}}if(-1===Ne)break}const ct=x[Ne];ct&&ct.connect(Qe)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ue){let Ce=x[ue];return void 0===Ce&&(Ce=new CN,x[ue]=Ce),Ce.getTargetRaySpace()},this.getControllerGrip=function(ue){let Ce=x[ue];return void 0===Ce&&(Ce=new CN,x[ue]=Ce),Ce.getGripSpace()},this.getHand=function(ue){let Ce=x[ue];return void 0===Ce&&(Ce=new CN,x[ue]=Ce),Ce.getHandSpace()},this.setFramebufferScaleFactor=function(ue){o=ue,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ue){a=ue,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||s},this.setReferenceSpace=function(ue){u=ue},this.getBaseLayer=function(){return null!==h?h:g},this.getBinding=function(){return f},this.getFrame=function(){return m},this.getSession=function(){return r},this.setSession=function(){var ue=N(function*(Ce){if(r=Ce,null!==r){if(y=e.getRenderTarget(),r.addEventListener("select",J),r.addEventListener("selectstart",J),r.addEventListener("selectend",J),r.addEventListener("squeeze",J),r.addEventListener("squeezestart",J),r.addEventListener("squeezeend",J),r.addEventListener("end",le),r.addEventListener("inputsourceschange",fe),!0!==_.xrCompatible&&(yield t.makeXRCompatible()),E=e.getPixelRatio(),e.getSize(D),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let Ne=null,ct=null,At=null;_.depth&&(At=_.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Ne=_.stencil?Bw:kw,ct=_.stencil?Lw:xh);const ft={colorFormat:t.RGBA8,depthFormat:At,scaleFactor:o};f=new XRWebGLBinding(r,t),h=f.createProjectionLayer(ft),r.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),w=new Pd(h.textureWidth,h.textureHeight,{format:Da,type:Ic,depthTexture:new BN(h.textureWidth,h.textureHeight,ct,void 0,void 0,void 0,void 0,void 0,void 0,Ne),stencilBuffer:_.stencil,colorSpace:e.outputColorSpace,samples:_.antialias?4:0,resolveDepthBuffer:!1===h.ignoreDepthValues,resolveStencilBuffer:!1===h.ignoreDepthValues})}else g=new XRWebGLLayer(r,t,{antialias:_.antialias,alpha:!0,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:o}),r.updateRenderState({baseLayer:g}),e.setPixelRatio(1),e.setSize(g.framebufferWidth,g.framebufferHeight,!1),w=new Pd(g.framebufferWidth,g.framebufferHeight,{format:Da,type:Ic,colorSpace:e.outputColorSpace,stencilBuffer:_.stencil,resolveDepthBuffer:!1===g.ignoreDepthValues,resolveStencilBuffer:!1===g.ignoreDepthValues});w.isXRRenderTarget=!0,this.setFoveation(l),u=null,s=yield r.requestReferenceSpace(a),wt.setContext(r),wt.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(Ce){return ue.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode},this.getDepthTexture=function(){return v.getDepthTexture()};const W=new U,ie=new U;function ge(ue,Ce){null===Ce?ue.matrixWorld.copy(ue.matrix):ue.matrixWorld.multiplyMatrices(Ce.matrixWorld,ue.matrix),ue.matrixWorldInverse.copy(ue.matrixWorld).invert()}this.updateCamera=function(ue){if(null===r)return;let Ce=ue.near,Qe=ue.far;null!==v.texture&&(v.depthNear>0&&(Ce=v.depthNear),v.depthFar>0&&(Qe=v.depthFar)),T.near=R.near=I.near=Ce,T.far=R.far=I.far=Qe,(z!==T.near||Z!==T.far)&&(r.updateRenderState({depthNear:T.near,depthFar:T.far}),z=T.near,Z=T.far),I.layers.mask=2|ue.layers.mask,R.layers.mask=4|ue.layers.mask,T.layers.mask=I.layers.mask|R.layers.mask;const Ne=ue.parent,ct=T.cameras;ge(T,Ne);for(let At=0;At<ct.length;At++)ge(ct[At],Ne);2===ct.length?function Y(ue,Ce,Qe){W.setFromMatrixPosition(Ce.matrixWorld),ie.setFromMatrixPosition(Qe.matrixWorld);const Ne=W.distanceTo(ie),ct=Ce.projectionMatrix.elements,At=Qe.projectionMatrix.elements,ft=ct[14]/(ct[10]-1),Xn=ct[14]/(ct[10]+1),kn=(ct[9]+1)/ct[5],qt=(ct[9]-1)/ct[5],H=(ct[8]-1)/ct[0],tt=(At[8]+1)/At[0],ke=ft*H,Xe=ft*tt,Ae=Ne/(-H+tt),Ot=Ae*-H;if(Ce.matrixWorld.decompose(ue.position,ue.quaternion,ue.scale),ue.translateX(Ot),ue.translateZ(Ae),ue.matrixWorld.compose(ue.position,ue.quaternion,ue.scale),ue.matrixWorldInverse.copy(ue.matrixWorld).invert(),-1===ct[10])ue.projectionMatrix.copy(Ce.projectionMatrix),ue.projectionMatrixInverse.copy(Ce.projectionMatrixInverse);else{const Ue=ft+Ae,V=Xn+Ae;ue.projectionMatrix.makePerspective(ke-Ot,Xe+(Ne-Ot),kn*Xn/V*Ue,qt*Xn/V*Ue,Ue,V),ue.projectionMatrixInverse.copy(ue.projectionMatrix).invert()}}(T,I,R):T.projectionMatrix.copy(I.projectionMatrix),function Le(ue,Ce,Qe){null===Qe?ue.matrix.copy(Ce.matrixWorld):(ue.matrix.copy(Qe.matrixWorld),ue.matrix.invert(),ue.matrix.multiply(Ce.matrixWorld)),ue.matrix.decompose(ue.position,ue.quaternion,ue.scale),ue.updateMatrixWorld(!0),ue.projectionMatrix.copy(Ce.projectionMatrix),ue.projectionMatrixInverse.copy(Ce.projectionMatrixInverse),ue.isPerspectiveCamera&&(ue.fov=2*D_*Math.atan(1/ue.projectionMatrix.elements[5]),ue.zoom=1)}(ue,T,Ne)},this.getCamera=function(){return T},this.getFoveation=function(){if(null!==h||null!==g)return l},this.setFoveation=function(ue){l=ue,null!==h&&(h.fixedFoveation=ue),null!==g&&void 0!==g.fixedFoveation&&(g.fixedFoveation=ue)},this.hasDepthSensing=function(){return null!==v.texture},this.getDepthSensingMesh=function(){return v.getMesh(T)};let We=null;const wt=new FW;wt.setAnimationLoop(function vt(ue,Ce){if(c=Ce.getViewerPose(u||s),m=Ce,null!==c){const Qe=c.views;null!==g&&(e.setRenderTargetFramebuffer(w,g.framebuffer),e.setRenderTarget(w));let Ne=!1;Qe.length!==T.cameras.length&&(T.cameras.length=0,Ne=!0);for(let ft=0;ft<Qe.length;ft++){const Xn=Qe[ft];let kn=null;if(null!==g)kn=g.getViewport(Xn);else{const H=f.getViewSubImage(h,Xn);kn=H.viewport,0===ft&&(e.setRenderTargetTextures(w,H.colorTexture,H.depthStencilTexture),e.setRenderTarget(w))}let qt=S[ft];void 0===qt&&(qt=new bo,qt.layers.enable(ft),qt.viewport=new $n,S[ft]=qt),qt.matrix.fromArray(Xn.transform.matrix),qt.matrix.decompose(qt.position,qt.quaternion,qt.scale),qt.projectionMatrix.fromArray(Xn.projectionMatrix),qt.projectionMatrixInverse.copy(qt.projectionMatrix).invert(),qt.viewport.set(kn.x,kn.y,kn.width,kn.height),0===ft&&(T.matrix.copy(qt.matrix),T.matrix.decompose(T.position,T.quaternion,T.scale)),!0===Ne&&T.cameras.push(qt)}const ct=r.enabledFeatures;if(ct&&ct.includes("depth-sensing")&&"gpu-optimized"==r.depthUsage&&f){const ft=f.getDepthInformation(Qe[0]);ft&&ft.isValid&&ft.texture&&v.init(e,ft,r.renderState)}}for(let Qe=0;Qe<x.length;Qe++){const Ne=M[Qe],ct=x[Qe];null!==Ne&&void 0!==ct&&ct.update(Ne,Ce,u||s)}We&&We(ue,Ce),Ce.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:Ce}),m=null}),this.setAnimationLoop=function(ue){We=ue},this.dispose=function(){}}}const qg=new As,_ve=new at;function yve(n,e){function t(_,y){!0===_.matrixAutoUpdate&&_.updateMatrix(),y.value.copy(_.matrix)}function o(_,y){_.opacity.value=y.opacity,y.color&&_.diffuse.value.copy(y.color),y.emissive&&_.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(_.map.value=y.map,t(y.map,_.mapTransform)),y.alphaMap&&(_.alphaMap.value=y.alphaMap,t(y.alphaMap,_.alphaMapTransform)),y.bumpMap&&(_.bumpMap.value=y.bumpMap,t(y.bumpMap,_.bumpMapTransform),_.bumpScale.value=y.bumpScale,1===y.side&&(_.bumpScale.value*=-1)),y.normalMap&&(_.normalMap.value=y.normalMap,t(y.normalMap,_.normalMapTransform),_.normalScale.value.copy(y.normalScale),1===y.side&&_.normalScale.value.negate()),y.displacementMap&&(_.displacementMap.value=y.displacementMap,t(y.displacementMap,_.displacementMapTransform),_.displacementScale.value=y.displacementScale,_.displacementBias.value=y.displacementBias),y.emissiveMap&&(_.emissiveMap.value=y.emissiveMap,t(y.emissiveMap,_.emissiveMapTransform)),y.specularMap&&(_.specularMap.value=y.specularMap,t(y.specularMap,_.specularMapTransform)),y.alphaTest>0&&(_.alphaTest.value=y.alphaTest);const w=e.get(y),x=w.envMap,M=w.envMapRotation;x&&(_.envMap.value=x,qg.copy(M),qg.x*=-1,qg.y*=-1,qg.z*=-1,x.isCubeTexture&&!1===x.isRenderTargetTexture&&(qg.y*=-1,qg.z*=-1),_.envMapRotation.value.setFromMatrix4(_ve.makeRotationFromEuler(qg)),_.flipEnvMap.value=x.isCubeTexture&&!1===x.isRenderTargetTexture?-1:1,_.reflectivity.value=y.reflectivity,_.ior.value=y.ior,_.refractionRatio.value=y.refractionRatio),y.lightMap&&(_.lightMap.value=y.lightMap,_.lightMapIntensity.value=y.lightMapIntensity,t(y.lightMap,_.lightMapTransform)),y.aoMap&&(_.aoMap.value=y.aoMap,_.aoMapIntensity.value=y.aoMapIntensity,t(y.aoMap,_.aoMapTransform))}return{refreshFogUniforms:function i(_,y){y.color.getRGB(_.fogColor.value,d6(n)),y.isFog?(_.fogNear.value=y.near,_.fogFar.value=y.far):y.isFogExp2&&(_.fogDensity.value=y.density)},refreshMaterialUniforms:function r(_,y,w,x,M){y.isMeshBasicMaterial||y.isMeshLambertMaterial?o(_,y):y.isMeshToonMaterial?(o(_,y),function f(_,y){y.gradientMap&&(_.gradientMap.value=y.gradientMap)}(_,y)):y.isMeshPhongMaterial?(o(_,y),function c(_,y){_.specular.value.copy(y.specular),_.shininess.value=Math.max(y.shininess,1e-4)}(_,y)):y.isMeshStandardMaterial?(o(_,y),function h(_,y){_.metalness.value=y.metalness,y.metalnessMap&&(_.metalnessMap.value=y.metalnessMap,t(y.metalnessMap,_.metalnessMapTransform)),_.roughness.value=y.roughness,y.roughnessMap&&(_.roughnessMap.value=y.roughnessMap,t(y.roughnessMap,_.roughnessMapTransform)),y.envMap&&(_.envMapIntensity.value=y.envMapIntensity)}(_,y),y.isMeshPhysicalMaterial&&function g(_,y,w){_.ior.value=y.ior,y.sheen>0&&(_.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),_.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(_.sheenColorMap.value=y.sheenColorMap,t(y.sheenColorMap,_.sheenColorMapTransform)),y.sheenRoughnessMap&&(_.sheenRoughnessMap.value=y.sheenRoughnessMap,t(y.sheenRoughnessMap,_.sheenRoughnessMapTransform))),y.clearcoat>0&&(_.clearcoat.value=y.clearcoat,_.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(_.clearcoatMap.value=y.clearcoatMap,t(y.clearcoatMap,_.clearcoatMapTransform)),y.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap,t(y.clearcoatRoughnessMap,_.clearcoatRoughnessMapTransform)),y.clearcoatNormalMap&&(_.clearcoatNormalMap.value=y.clearcoatNormalMap,t(y.clearcoatNormalMap,_.clearcoatNormalMapTransform),_.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),1===y.side&&_.clearcoatNormalScale.value.negate())),y.dispersion>0&&(_.dispersion.value=y.dispersion),y.iridescence>0&&(_.iridescence.value=y.iridescence,_.iridescenceIOR.value=y.iridescenceIOR,_.iridescenceThicknessMinimum.value=y.iridescenceThicknessRange[0],_.iridescenceThicknessMaximum.value=y.iridescenceThicknessRange[1],y.iridescenceMap&&(_.iridescenceMap.value=y.iridescenceMap,t(y.iridescenceMap,_.iridescenceMapTransform)),y.iridescenceThicknessMap&&(_.iridescenceThicknessMap.value=y.iridescenceThicknessMap,t(y.iridescenceThicknessMap,_.iridescenceThicknessMapTransform))),y.transmission>0&&(_.transmission.value=y.transmission,_.transmissionSamplerMap.value=w.texture,_.transmissionSamplerSize.value.set(w.width,w.height),y.transmissionMap&&(_.transmissionMap.value=y.transmissionMap,t(y.transmissionMap,_.transmissionMapTransform)),_.thickness.value=y.thickness,y.thicknessMap&&(_.thicknessMap.value=y.thicknessMap,t(y.thicknessMap,_.thicknessMapTransform)),_.attenuationDistance.value=y.attenuationDistance,_.attenuationColor.value.copy(y.attenuationColor)),y.anisotropy>0&&(_.anisotropyVector.value.set(y.anisotropy*Math.cos(y.anisotropyRotation),y.anisotropy*Math.sin(y.anisotropyRotation)),y.anisotropyMap&&(_.anisotropyMap.value=y.anisotropyMap,t(y.anisotropyMap,_.anisotropyMapTransform))),_.specularIntensity.value=y.specularIntensity,_.specularColor.value.copy(y.specularColor),y.specularColorMap&&(_.specularColorMap.value=y.specularColorMap,t(y.specularColorMap,_.specularColorMapTransform)),y.specularIntensityMap&&(_.specularIntensityMap.value=y.specularIntensityMap,t(y.specularIntensityMap,_.specularIntensityMapTransform))}(_,y,M)):y.isMeshMatcapMaterial?(o(_,y),function m(_,y){y.matcap&&(_.matcap.value=y.matcap)}(_,y)):y.isMeshDepthMaterial?o(_,y):y.isMeshDistanceMaterial?(o(_,y),function v(_,y){const w=e.get(y).light;_.referencePosition.value.setFromMatrixPosition(w.matrixWorld),_.nearDistance.value=w.shadow.camera.near,_.farDistance.value=w.shadow.camera.far}(_,y)):y.isMeshNormalMaterial?o(_,y):y.isLineBasicMaterial?(function s(_,y){_.diffuse.value.copy(y.color),_.opacity.value=y.opacity,y.map&&(_.map.value=y.map,t(y.map,_.mapTransform))}(_,y),y.isLineDashedMaterial&&function a(_,y){_.dashSize.value=y.dashSize,_.totalSize.value=y.dashSize+y.gapSize,_.scale.value=y.scale}(_,y)):y.isPointsMaterial?function l(_,y,w,x){_.diffuse.value.copy(y.color),_.opacity.value=y.opacity,_.size.value=y.size*w,_.scale.value=.5*x,y.map&&(_.map.value=y.map,t(y.map,_.uvTransform)),y.alphaMap&&(_.alphaMap.value=y.alphaMap,t(y.alphaMap,_.alphaMapTransform)),y.alphaTest>0&&(_.alphaTest.value=y.alphaTest)}(_,y,w,x):y.isSpriteMaterial?function u(_,y){_.diffuse.value.copy(y.color),_.opacity.value=y.opacity,_.rotation.value=y.rotation,y.map&&(_.map.value=y.map,t(y.map,_.mapTransform)),y.alphaMap&&(_.alphaMap.value=y.alphaMap,t(y.alphaMap,_.alphaMapTransform)),y.alphaTest>0&&(_.alphaTest.value=y.alphaTest)}(_,y):y.isShadowMaterial?(_.color.value.copy(y.color),_.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}}}function vve(n,e,t,i){let r={},o={},s=[];const a=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function g(w,x,M,D){const E=w.value,I=x+"_"+M;if(void 0===D[I])return D[I]="number"==typeof E||"boolean"==typeof E?E:E.clone(),!0;{const R=D[I];if("number"==typeof E||"boolean"==typeof E){if(R!==E)return D[I]=E,!0}else if(!1===R.equals(E))return R.copy(E),!0}return!1}function v(w){const x={boundary:0,storage:0};return"number"==typeof w||"boolean"==typeof w?(x.boundary=4,x.storage=4):w.isVector2?(x.boundary=8,x.storage=8):w.isVector3||w.isColor?(x.boundary=16,x.storage=12):w.isVector4?(x.boundary=16,x.storage=16):w.isMatrix3?(x.boundary=48,x.storage=48):w.isMatrix4?(x.boundary=64,x.storage=64):w.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",w),x}function _(w){const x=w.target;x.removeEventListener("dispose",_);const M=s.indexOf(x.__bindingPointIndex);s.splice(M,1),n.deleteBuffer(r[x.id]),delete r[x.id],delete o[x.id]}return{bind:function l(w,x){i.uniformBlockBinding(w,x.program)},update:function u(w,x){let M=r[w.id];void 0===M&&(function m(w){const x=w.uniforms;let M=0;for(let I=0,R=x.length;I<R;I++){const S=Array.isArray(x[I])?x[I]:[x[I]];for(let T=0,z=S.length;T<z;T++){const Z=S[T],J=Array.isArray(Z.value)?Z.value:[Z.value];for(let le=0,fe=J.length;le<fe;le++){const ie=v(J[le]),Y=M%16,ge=Y%ie.boundary,Le=Y+ge;M+=ge,0!==Le&&16-Le<ie.storage&&(M+=16-Le),Z.__data=new Float32Array(ie.storage/Float32Array.BYTES_PER_ELEMENT),Z.__offset=M,M+=ie.storage}}}const E=M%16;E>0&&(M+=16-E),w.__size=M,w.__cache={}}(w),M=function c(w){const x=function f(){for(let w=0;w<a;w++)if(-1===s.indexOf(w))return s.push(w),w;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();w.__bindingPointIndex=x;const M=n.createBuffer(),D=w.__size,E=w.usage;return n.bindBuffer(n.UNIFORM_BUFFER,M),n.bufferData(n.UNIFORM_BUFFER,D,E),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,x,M),M}(w),r[w.id]=M,w.addEventListener("dispose",_)),i.updateUBOMapping(w,x.program);const E=e.render.frame;o[w.id]!==E&&(function h(w){const M=w.uniforms,D=w.__cache;n.bindBuffer(n.UNIFORM_BUFFER,r[w.id]);for(let E=0,I=M.length;E<I;E++){const R=Array.isArray(M[E])?M[E]:[M[E]];for(let S=0,T=R.length;S<T;S++){const z=R[S];if(!0===g(z,E,S,D)){const Z=z.__offset,J=Array.isArray(z.value)?z.value:[z.value];let le=0;for(let fe=0;fe<J.length;fe++){const W=J[fe],ie=v(W);"number"==typeof W||"boolean"==typeof W?(z.__data[0]=W,n.bufferSubData(n.UNIFORM_BUFFER,Z+le,z.__data)):W.isMatrix3?(z.__data[0]=W.elements[0],z.__data[1]=W.elements[1],z.__data[2]=W.elements[2],z.__data[3]=0,z.__data[4]=W.elements[3],z.__data[5]=W.elements[4],z.__data[6]=W.elements[5],z.__data[7]=0,z.__data[8]=W.elements[6],z.__data[9]=W.elements[7],z.__data[10]=W.elements[8],z.__data[11]=0):(W.toArray(z.__data,le),le+=ie.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,Z,z.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}(w),o[w.id]=E)},dispose:function y(){for(const w in r)n.deleteBuffer(r[w]);s=[],r={},o={}}}}class bve{constructor(e={}){const{canvas:t=Qhe(),context:i=null,depth:r=!0,stencil:o=!1,alpha:s=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:f=!1,reverseDepthBuffer:h=!1}=e;let g;if(this.isWebGLRenderer=!0,null!==i){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");g=i.getContextAttributes().alpha}else g=s;const m=new Uint32Array(4),v=new Int32Array(4);let _=null,y=null;const w=[],x=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=0,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const M=this;let D=!1;this._outputColorSpace=fi;let E=0,I=0,R=null,S=-1,T=null;const z=new $n,Z=new $n;let J=null;const le=new Ke(0);let fe=0,W=t.width,ie=t.height,Y=1,ge=null,Le=null;const We=new $n(0,0,W,ie),vt=new $n(0,0,W,ie);let wt=!1;const ue=new tx;let Ce=!1,Qe=!1;const Ne=new at,ct=new at,At=new U,ft=new $n,Xn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let kn=!1;function qt(){return null===R?Y:1}let ke,Xe,Ae,Ot,Ue,V,P,ae,we,Ie,_e,It,ot,Ht,nn,Ge,bt,en,gn,Tt,ri,Fn,ir,Q,H=i;function tt(B,ne){return t.getContext(B,ne)}try{const B={alpha:!0,depth:r,stencil:o,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r176"),t.addEventListener("webglcontextlost",De,!1),t.addEventListener("webglcontextrestored",yt,!1),t.addEventListener("webglcontextcreationerror",pt,!1),null===H){const ne="webgl2";if(H=tt(ne,B),null===H)throw tt(ne)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(B){throw console.error("THREE.WebGLRenderer: "+B.message),B}function ht(){ke=new I_e(H),ke.init(),Fn=new fve(H,ke),Xe=new M_e(H,ke,e,Fn),Ae=new cve(H,ke),Xe.reverseDepthBuffer&&h&&Ae.buffers.depth.setReversed(!0),Ot=new O_e(H),Ue=new Kye,V=new dve(H,ke,Ae,Ue,Xe,Fn,Ot),P=new S_e(M),ae=new D_e(M),we=new vme(H),ir=new w_e(H,we),Ie=new R_e(H,we,Ot,ir),_e=new F_e(H,Ie,we,Ot),gn=new N_e(H,Xe,V),Ge=new C_e(Ue),It=new Zye(M,P,ae,ke,Xe,ir,Ge),ot=new yve(M,Ue),Ht=new Qye,nn=new ove(ke),en=new b_e(M,P,ae,Ae,_e,g,l),bt=new lve(M,_e,Xe),Q=new vve(H,Ot,Xe,Ae),Tt=new x_e(H,ke,Ot),ri=new P_e(H,ke,Ot),Ot.programs=It.programs,M.capabilities=Xe,M.extensions=ke,M.properties=Ue,M.renderLists=Ht,M.shadowMap=bt,M.state=Ae,M.info=Ot}ht();const ve=new mve(M,H);function De(B){B.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),D=!0}function yt(){console.log("THREE.WebGLRenderer: Context Restored."),D=!1;const B=Ot.autoReset,ne=bt.enabled,he=bt.autoUpdate,pe=bt.needsUpdate,oe=bt.type;ht(),Ot.autoReset=B,bt.enabled=ne,bt.autoUpdate=he,bt.needsUpdate=pe,bt.type=oe}function pt(B){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",B.statusMessage)}function Pn(B){const ne=B.target;ne.removeEventListener("dispose",Pn),function Nr(B){(function Ps(B){const ne=Ue.get(B).programs;void 0!==ne&&(ne.forEach(function(he){It.releaseProgram(he)}),B.isShaderMaterial&&It.releaseShaderCache(B))})(B),Ue.remove(B)}(ne)}function Ai(B,ne,he){!0===B.transparent&&2===B.side&&!1===B.forceSinglePass?(B.side=1,B.needsUpdate=!0,wA(B,ne,he),B.side=0,B.needsUpdate=!0,wA(B,ne,he),B.side=2):wA(B,ne,he)}this.xr=ve,this.getContext=function(){return H},this.getContextAttributes=function(){return H.getContextAttributes()},this.forceContextLoss=function(){const B=ke.get("WEBGL_lose_context");B&&B.loseContext()},this.forceContextRestore=function(){const B=ke.get("WEBGL_lose_context");B&&B.restoreContext()},this.getPixelRatio=function(){return Y},this.setPixelRatio=function(B){void 0!==B&&(Y=B,this.setSize(W,ie,!1))},this.getSize=function(B){return B.set(W,ie)},this.setSize=function(B,ne,he=!0){ve.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(W=B,ie=ne,t.width=Math.floor(B*Y),t.height=Math.floor(ne*Y),!0===he&&(t.style.width=B+"px",t.style.height=ne+"px"),this.setViewport(0,0,B,ne))},this.getDrawingBufferSize=function(B){return B.set(W*Y,ie*Y).floor()},this.setDrawingBufferSize=function(B,ne,he){W=B,ie=ne,Y=he,t.width=Math.floor(B*he),t.height=Math.floor(ne*he),this.setViewport(0,0,B,ne)},this.getCurrentViewport=function(B){return B.copy(z)},this.getViewport=function(B){return B.copy(We)},this.setViewport=function(B,ne,he,pe){B.isVector4?We.set(B.x,B.y,B.z,B.w):We.set(B,ne,he,pe),Ae.viewport(z.copy(We).multiplyScalar(Y).round())},this.getScissor=function(B){return B.copy(vt)},this.setScissor=function(B,ne,he,pe){B.isVector4?vt.set(B.x,B.y,B.z,B.w):vt.set(B,ne,he,pe),Ae.scissor(Z.copy(vt).multiplyScalar(Y).round())},this.getScissorTest=function(){return wt},this.setScissorTest=function(B){Ae.setScissorTest(wt=B)},this.setOpaqueSort=function(B){ge=B},this.setTransparentSort=function(B){Le=B},this.getClearColor=function(B){return B.copy(en.getClearColor())},this.setClearColor=function(){en.setClearColor(...arguments)},this.getClearAlpha=function(){return en.getClearAlpha()},this.setClearAlpha=function(){en.setClearAlpha(...arguments)},this.clear=function(B=!0,ne=!0,he=!0){let pe=0;if(B){let oe=!1;if(null!==R){const $e=R.texture.format;oe=1033===$e||1031===$e||1029===$e}if(oe){const $e=R.texture.type,st=$e===Ic||$e===xh||$e===Nw||$e===Lw||1017===$e||1018===$e,Et=en.getClearColor(),xt=en.getClearAlpha(),mn=Et.r,fn=Et.g,Xt=Et.b;st?(m[0]=mn,m[1]=fn,m[2]=Xt,m[3]=xt,H.clearBufferuiv(H.COLOR,0,m)):(v[0]=mn,v[1]=fn,v[2]=Xt,v[3]=xt,H.clearBufferiv(H.COLOR,0,v))}else pe|=H.COLOR_BUFFER_BIT}ne&&(pe|=H.DEPTH_BUFFER_BIT),he&&(pe|=H.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),H.clear(pe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",De,!1),t.removeEventListener("webglcontextrestored",yt,!1),t.removeEventListener("webglcontextcreationerror",pt,!1),en.dispose(),Ht.dispose(),nn.dispose(),Ue.dispose(),P.dispose(),ae.dispose(),_e.dispose(),ir.dispose(),Q.dispose(),It.dispose(),ve.dispose(),ve.removeEventListener("sessionstart",Y7),ve.removeEventListener("sessionend",Z7),cm.stop()},this.renderBufferDirect=function(B,ne,he,pe,oe,$e){null===ne&&(ne=Xn);const st=oe.isMesh&&oe.matrixWorld.determinant()<0,Et=function oSe(B,ne,he,pe,oe){!0!==ne.isScene&&(ne=Xn),V.resetTextureUnits();const $e=ne.fog,Et=null===R?M.outputColorSpace:!0===R.isXRRenderTarget?R.texture.colorSpace:Js,xt=(pe.isMeshStandardMaterial?ae:P).get(pe.envMap||(pe.isMeshStandardMaterial?ne.environment:null)),mn=!0===pe.vertexColors&&!!he.attributes.color&&4===he.attributes.color.itemSize,fn=!!he.attributes.tangent&&(!!pe.normalMap||pe.anisotropy>0),Xt=!!he.morphAttributes.position,ti=!!he.morphAttributes.normal,Di=!!he.morphAttributes.color;let Er=0;pe.toneMapped&&(null===R||!0===R.isXRRenderTarget)&&(Er=M.toneMapping);const Fr=he.morphAttributes.position||he.morphAttributes.normal||he.morphAttributes.color,hi=void 0!==Fr?Fr.length:0,Yt=Ue.get(pe),ss=y.state.lights;!0!==Ce||!0!==Qe&&B===T||Ge.setState(pe,B,B===T&&pe.id===S);let xi=!1;pe.version===Yt.__version?(Yt.needsLights&&Yt.lightsStateVersion!==ss.state.version||Yt.outputColorSpace!==Et||oe.isBatchedMesh&&!1===Yt.batching||!oe.isBatchedMesh&&!0===Yt.batching||oe.isBatchedMesh&&!0===Yt.batchingColor&&null===oe.colorTexture||oe.isBatchedMesh&&!1===Yt.batchingColor&&null!==oe.colorTexture||oe.isInstancedMesh&&!1===Yt.instancing||!oe.isInstancedMesh&&!0===Yt.instancing||oe.isSkinnedMesh&&!1===Yt.skinning||!oe.isSkinnedMesh&&!0===Yt.skinning||oe.isInstancedMesh&&!0===Yt.instancingColor&&null===oe.instanceColor||oe.isInstancedMesh&&!1===Yt.instancingColor&&null!==oe.instanceColor||oe.isInstancedMesh&&!0===Yt.instancingMorph&&null===oe.morphTexture||oe.isInstancedMesh&&!1===Yt.instancingMorph&&null!==oe.morphTexture||Yt.envMap!==xt||!0===pe.fog&&Yt.fog!==$e||void 0!==Yt.numClippingPlanes&&(Yt.numClippingPlanes!==Ge.numPlanes||Yt.numIntersection!==Ge.numIntersection)||Yt.vertexAlphas!==mn||Yt.vertexTangents!==fn||Yt.morphTargets!==Xt||Yt.morphNormals!==ti||Yt.morphColors!==Di||Yt.toneMapping!==Er||Yt.morphTargetsCount!==hi)&&(xi=!0):(xi=!0,Yt.__version=pe.version);let $u=Yt.currentProgram;!0===xi&&($u=wA(pe,ne,oe));let vy=!1,dl=!1,Hx=!1;const br=$u.getUniforms(),Wl=Yt.uniforms;if(Ae.useProgram($u.program)&&(vy=!0,dl=!0,Hx=!0),pe.id!==S&&(S=pe.id,dl=!0),vy||T!==B){Ae.buffers.depth.getReversed()?(Ne.copy(B.projectionMatrix),function tpe(n){const e=n.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}(Ne),function npe(n){const e=n.elements;-1===e[11]?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=1-e[14])}(Ne),br.setValue(H,"projectionMatrix",Ne)):br.setValue(H,"projectionMatrix",B.projectionMatrix),br.setValue(H,"viewMatrix",B.matrixWorldInverse);const Fa=br.map.cameraPosition;void 0!==Fa&&Fa.setValue(H,At.setFromMatrixPosition(B.matrixWorld)),Xe.logarithmicDepthBuffer&&br.setValue(H,"logDepthBufFC",2/(Math.log(B.far+1)/Math.LN2)),(pe.isMeshPhongMaterial||pe.isMeshToonMaterial||pe.isMeshLambertMaterial||pe.isMeshBasicMaterial||pe.isMeshStandardMaterial||pe.isShaderMaterial)&&br.setValue(H,"isOrthographic",!0===B.isOrthographicCamera),T!==B&&(T=B,dl=!0,Hx=!0)}if(oe.isSkinnedMesh){br.setOptional(H,oe,"bindMatrix"),br.setOptional(H,oe,"bindMatrixInverse");const aa=oe.skeleton;aa&&(null===aa.boneTexture&&aa.computeBoneTexture(),br.setValue(H,"boneTexture",aa.boneTexture,V))}oe.isBatchedMesh&&(br.setOptional(H,oe,"batchingTexture"),br.setValue(H,"batchingTexture",oe._matricesTexture,V),br.setOptional(H,oe,"batchingIdTexture"),br.setValue(H,"batchingIdTexture",oe._indirectTexture,V),br.setOptional(H,oe,"batchingColorTexture"),null!==oe._colorsTexture&&br.setValue(H,"batchingColorTexture",oe._colorsTexture,V));const $l=he.morphAttributes;if((void 0!==$l.position||void 0!==$l.normal||void 0!==$l.color)&&gn.update(oe,he,$u),(dl||Yt.receiveShadow!==oe.receiveShadow)&&(Yt.receiveShadow=oe.receiveShadow,br.setValue(H,"receiveShadow",oe.receiveShadow)),pe.isMeshGouraudMaterial&&null!==pe.envMap&&(Wl.envMap.value=xt,Wl.flipEnvMap.value=xt.isCubeTexture&&!1===xt.isRenderTargetTexture?-1:1),pe.isMeshStandardMaterial&&null===pe.envMap&&null!==ne.environment&&(Wl.envMapIntensity.value=ne.environmentIntensity),dl&&(br.setValue(H,"toneMappingExposure",M.toneMappingExposure),Yt.needsLights&&function sSe(B,ne){B.ambientLightColor.needsUpdate=ne,B.lightProbe.needsUpdate=ne,B.directionalLights.needsUpdate=ne,B.directionalLightShadows.needsUpdate=ne,B.pointLights.needsUpdate=ne,B.pointLightShadows.needsUpdate=ne,B.spotLights.needsUpdate=ne,B.spotLightShadows.needsUpdate=ne,B.rectAreaLights.needsUpdate=ne,B.hemisphereLights.needsUpdate=ne}(Wl,Hx),$e&&!0===pe.fog&&ot.refreshFogUniforms(Wl,$e),ot.refreshMaterialUniforms(Wl,pe,Y,ie,y.state.transmissionRenderTarget[B.id]),F1.upload(H,e9(Yt),Wl,V)),pe.isShaderMaterial&&!0===pe.uniformsNeedUpdate&&(F1.upload(H,e9(Yt),Wl,V),pe.uniformsNeedUpdate=!1),pe.isSpriteMaterial&&br.setValue(H,"center",oe.center),br.setValue(H,"modelViewMatrix",oe.modelViewMatrix),br.setValue(H,"normalMatrix",oe.normalMatrix),br.setValue(H,"modelMatrix",oe.matrixWorld),pe.isShaderMaterial||pe.isRawShaderMaterial){const aa=pe.uniformsGroups;for(let Fa=0,V2=aa.length;Fa<V2;Fa++){const dm=aa[Fa];Q.update(dm,$u),Q.bind(dm,$u)}}return $u}(B,ne,he,pe,oe);Ae.setMaterial(pe,st);let xt=he.index,mn=1;if(!0===pe.wireframe){if(xt=Ie.getWireframeAttribute(he),void 0===xt)return;mn=2}const fn=he.drawRange,Xt=he.attributes.position;let ti=fn.start*mn,Di=(fn.start+fn.count)*mn;null!==$e&&(ti=Math.max(ti,$e.start*mn),Di=Math.min(Di,($e.start+$e.count)*mn)),null!==xt?(ti=Math.max(ti,0),Di=Math.min(Di,xt.count)):null!=Xt&&(ti=Math.max(ti,0),Di=Math.min(Di,Xt.count));const Er=Di-ti;if(Er<0||Er===1/0)return;ir.setup(oe,pe,Et,he,xt);let Fr,hi=Tt;if(null!==xt&&(Fr=we.get(xt),hi=ri,hi.setIndex(Fr)),oe.isMesh)!0===pe.wireframe?(Ae.setLineWidth(pe.wireframeLinewidth*qt()),hi.setMode(H.LINES)):hi.setMode(H.TRIANGLES);else if(oe.isLine){let Yt=pe.linewidth;void 0===Yt&&(Yt=1),Ae.setLineWidth(Yt*qt()),hi.setMode(oe.isLineSegments?H.LINES:oe.isLineLoop?H.LINE_LOOP:H.LINE_STRIP)}else oe.isPoints?hi.setMode(H.POINTS):oe.isSprite&&hi.setMode(H.TRIANGLES);if(oe.isBatchedMesh)if(null!==oe._multiDrawInstances)TT("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),hi.renderMultiDrawInstances(oe._multiDrawStarts,oe._multiDrawCounts,oe._multiDrawCount,oe._multiDrawInstances);else if(ke.get("WEBGL_multi_draw"))hi.renderMultiDraw(oe._multiDrawStarts,oe._multiDrawCounts,oe._multiDrawCount);else{const Yt=oe._multiDrawStarts,ss=oe._multiDrawCounts,xi=oe._multiDrawCount,$u=xt?we.get(xt).bytesPerElement:1,vy=Ue.get(pe).currentProgram.getUniforms();for(let dl=0;dl<xi;dl++)vy.setValue(H,"_gl_DrawID",dl),hi.render(Yt[dl]/$u,ss[dl])}else if(oe.isInstancedMesh)hi.renderInstances(ti,Er,oe.count);else if(he.isInstancedBufferGeometry){const ss=Math.min(he.instanceCount,void 0!==he._maxInstanceCount?he._maxInstanceCount:1/0);hi.renderInstances(ti,Er,ss)}else hi.render(ti,Er)},this.compile=function(B,ne,he=null){null===he&&(he=B),y=nn.get(he),y.init(ne),x.push(y),he.traverseVisible(function(oe){oe.isLight&&oe.layers.test(ne.layers)&&(y.pushLight(oe),oe.castShadow&&y.pushShadow(oe))}),B!==he&&B.traverseVisible(function(oe){oe.isLight&&oe.layers.test(ne.layers)&&(y.pushLight(oe),oe.castShadow&&y.pushShadow(oe))}),y.setupLights();const pe=new Set;return B.traverse(function(oe){if(!(oe.isMesh||oe.isPoints||oe.isLine||oe.isSprite))return;const $e=oe.material;if($e)if(Array.isArray($e))for(let st=0;st<$e.length;st++){const Et=$e[st];Ai(Et,he,oe),pe.add(Et)}else Ai($e,he,oe),pe.add($e)}),y=x.pop(),pe},this.compileAsync=function(B,ne,he=null){const pe=this.compile(B,ne,he);return new Promise(oe=>{function $e(){pe.forEach(function(st){Ue.get(st).currentProgram.isReady()&&pe.delete(st)}),0!==pe.size?setTimeout($e,10):oe(B)}null!==ke.get("KHR_parallel_shader_compile")?$e():setTimeout($e,10)})};let Wu=null;function Y7(){cm.stop()}function Z7(){cm.start()}const cm=new FW;function U2(B,ne,he,pe){if(!1===B.visible)return;if(B.layers.test(ne.layers))if(B.isGroup)he=B.renderOrder;else if(B.isLOD)!0===B.autoUpdate&&B.update(ne);else if(B.isLight)y.pushLight(B),B.castShadow&&y.pushShadow(B);else if(B.isSprite){if(!B.frustumCulled||ue.intersectsSprite(B)){pe&&ft.setFromMatrixPosition(B.matrixWorld).applyMatrix4(ct);const st=_e.update(B),Et=B.material;Et.visible&&_.push(B,st,Et,he,ft.z,null)}}else if((B.isMesh||B.isLine||B.isPoints)&&(!B.frustumCulled||ue.intersectsObject(B))){const st=_e.update(B),Et=B.material;if(pe&&(void 0!==B.boundingSphere?(null===B.boundingSphere&&B.computeBoundingSphere(),ft.copy(B.boundingSphere.center)):(null===st.boundingSphere&&st.computeBoundingSphere(),ft.copy(st.boundingSphere.center)),ft.applyMatrix4(B.matrixWorld).applyMatrix4(ct)),Array.isArray(Et)){const xt=st.groups;for(let mn=0,fn=xt.length;mn<fn;mn++){const Xt=xt[mn],ti=Et[Xt.materialIndex];ti&&ti.visible&&_.push(B,st,ti,he,ft.z,Xt)}}else Et.visible&&_.push(B,st,Et,he,ft.z,null)}const $e=B.children;for(let st=0,Et=$e.length;st<Et;st++)U2($e[st],ne,he,pe)}function K7(B,ne,he,pe){const oe=B.opaque,$e=B.transmissive,st=B.transparent;y.setupLightsView(he),!0===Ce&&Ge.setGlobalState(M.clippingPlanes,he),pe&&Ae.viewport(z.copy(pe)),oe.length>0&&bA(oe,ne,he),$e.length>0&&bA($e,ne,he),st.length>0&&bA(st,ne,he),Ae.buffers.depth.setTest(!0),Ae.buffers.depth.setMask(!0),Ae.buffers.color.setMask(!0),Ae.setPolygonOffset(!1)}function J7(B,ne,he,pe){if(null!==(!0===he.isScene?he.overrideMaterial:null))return;void 0===y.state.transmissionRenderTarget[pe.id]&&(y.state.transmissionRenderTarget[pe.id]=new Pd(1,1,{generateMipmaps:!0,type:ke.has("EXT_color_buffer_half_float")||ke.has("EXT_color_buffer_float")?Fw:Ic,minFilter:Ru,samples:4,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:bn.workingColorSpace}));const $e=y.state.transmissionRenderTarget[pe.id],st=pe.viewport||z;$e.setSize(st.z*M.transmissionResolutionScale,st.w*M.transmissionResolutionScale);const Et=M.getRenderTarget();M.setRenderTarget($e),M.getClearColor(le),fe=M.getClearAlpha(),fe<1&&M.setClearColor(16777215,.5),M.clear(),kn&&en.render(he);const xt=M.toneMapping;M.toneMapping=0;const mn=pe.viewport;if(void 0!==pe.viewport&&(pe.viewport=void 0),y.setupLightsView(pe),!0===Ce&&Ge.setGlobalState(M.clippingPlanes,pe),bA(B,he,pe),V.updateMultisampleRenderTarget($e),V.updateRenderTargetMipmap($e),!1===ke.has("WEBGL_multisampled_render_to_texture")){let fn=!1;for(let Xt=0,ti=ne.length;Xt<ti;Xt++){const Di=ne[Xt],Er=Di.object,Fr=Di.geometry,hi=Di.material,Yt=Di.group;if(2===hi.side&&Er.layers.test(pe.layers)){const ss=hi.side;hi.side=1,hi.needsUpdate=!0,Q7(Er,he,pe,Fr,hi,Yt),hi.side=ss,hi.needsUpdate=!0,fn=!0}}!0===fn&&(V.updateMultisampleRenderTarget($e),V.updateRenderTargetMipmap($e))}M.setRenderTarget(Et),M.setClearColor(le,fe),void 0!==mn&&(pe.viewport=mn),M.toneMapping=xt}function bA(B,ne,he){const pe=!0===ne.isScene?ne.overrideMaterial:null;for(let oe=0,$e=B.length;oe<$e;oe++){const st=B[oe],Et=st.object,xt=st.geometry,mn=st.group;let fn=st.material;!0===fn.allowOverride&&null!==pe&&(fn=pe),Et.layers.test(he.layers)&&Q7(Et,ne,he,xt,fn,mn)}}function Q7(B,ne,he,pe,oe,$e){B.onBeforeRender(M,ne,he,pe,oe,$e),B.modelViewMatrix.multiplyMatrices(he.matrixWorldInverse,B.matrixWorld),B.normalMatrix.getNormalMatrix(B.modelViewMatrix),oe.onBeforeRender(M,ne,he,pe,B,$e),!0===oe.transparent&&2===oe.side&&!1===oe.forceSinglePass?(oe.side=1,oe.needsUpdate=!0,M.renderBufferDirect(he,ne,pe,oe,B,$e),oe.side=0,oe.needsUpdate=!0,M.renderBufferDirect(he,ne,pe,oe,B,$e),oe.side=2):M.renderBufferDirect(he,ne,pe,oe,B,$e),B.onAfterRender(M,ne,he,pe,oe,$e)}function wA(B,ne,he){!0!==ne.isScene&&(ne=Xn);const pe=Ue.get(B),oe=y.state.lights,st=oe.state.version,Et=It.getParameters(B,oe.state,y.state.shadowsArray,ne,he),xt=It.getProgramCacheKey(Et);let mn=pe.programs;pe.environment=B.isMeshStandardMaterial?ne.environment:null,pe.fog=ne.fog,pe.envMap=(B.isMeshStandardMaterial?ae:P).get(B.envMap||pe.environment),pe.envMapRotation=null!==pe.environment&&null===B.envMap?ne.environmentRotation:B.envMapRotation,void 0===mn&&(B.addEventListener("dispose",Pn),mn=new Map,pe.programs=mn);let fn=mn.get(xt);if(void 0!==fn){if(pe.currentProgram===fn&&pe.lightsStateVersion===st)return t9(B,Et),fn}else Et.uniforms=It.getUniforms(B),B.onBeforeCompile(Et,M),fn=It.acquireProgram(Et,xt),mn.set(xt,fn),pe.uniforms=Et.uniforms;const Xt=pe.uniforms;return(!B.isShaderMaterial&&!B.isRawShaderMaterial||!0===B.clipping)&&(Xt.clippingPlanes=Ge.uniform),t9(B,Et),pe.needsLights=function aSe(B){return B.isMeshLambertMaterial||B.isMeshToonMaterial||B.isMeshPhongMaterial||B.isMeshStandardMaterial||B.isShadowMaterial||B.isShaderMaterial&&!0===B.lights}(B),pe.lightsStateVersion=st,pe.needsLights&&(Xt.ambientLightColor.value=oe.state.ambient,Xt.lightProbe.value=oe.state.probe,Xt.directionalLights.value=oe.state.directional,Xt.directionalLightShadows.value=oe.state.directionalShadow,Xt.spotLights.value=oe.state.spot,Xt.spotLightShadows.value=oe.state.spotShadow,Xt.rectAreaLights.value=oe.state.rectArea,Xt.ltc_1.value=oe.state.rectAreaLTC1,Xt.ltc_2.value=oe.state.rectAreaLTC2,Xt.pointLights.value=oe.state.point,Xt.pointLightShadows.value=oe.state.pointShadow,Xt.hemisphereLights.value=oe.state.hemi,Xt.directionalShadowMap.value=oe.state.directionalShadowMap,Xt.directionalShadowMatrix.value=oe.state.directionalShadowMatrix,Xt.spotShadowMap.value=oe.state.spotShadowMap,Xt.spotLightMatrix.value=oe.state.spotLightMatrix,Xt.spotLightMap.value=oe.state.spotLightMap,Xt.pointShadowMap.value=oe.state.pointShadowMap,Xt.pointShadowMatrix.value=oe.state.pointShadowMatrix),pe.currentProgram=fn,pe.uniformsList=null,fn}function e9(B){if(null===B.uniformsList){const ne=B.currentProgram.getUniforms();B.uniformsList=F1.seqWithValue(ne.seq,B.uniforms)}return B.uniformsList}function t9(B,ne){const he=Ue.get(B);he.outputColorSpace=ne.outputColorSpace,he.batching=ne.batching,he.batchingColor=ne.batchingColor,he.instancing=ne.instancing,he.instancingColor=ne.instancingColor,he.instancingMorph=ne.instancingMorph,he.skinning=ne.skinning,he.morphTargets=ne.morphTargets,he.morphNormals=ne.morphNormals,he.morphColors=ne.morphColors,he.morphTargetsCount=ne.morphTargetsCount,he.numClippingPlanes=ne.numClippingPlanes,he.numIntersection=ne.numClipIntersection,he.vertexAlphas=ne.vertexAlphas,he.vertexTangents=ne.vertexTangents,he.toneMapping=ne.toneMapping}cm.setAnimationLoop(function ef(B){Wu&&Wu(B)}),typeof self<"u"&&cm.setContext(self),this.setAnimationLoop=function(B){Wu=B,ve.setAnimationLoop(B),null===B?cm.stop():cm.start()},ve.addEventListener("sessionstart",Y7),ve.addEventListener("sessionend",Z7),this.render=function(B,ne){if(void 0!==ne&&!0!==ne.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===D)return;if(!0===B.matrixWorldAutoUpdate&&B.updateMatrixWorld(),null===ne.parent&&!0===ne.matrixWorldAutoUpdate&&ne.updateMatrixWorld(),!0===ve.enabled&&!0===ve.isPresenting&&(!0===ve.cameraAutoUpdate&&ve.updateCamera(ne),ne=ve.getCamera()),!0===B.isScene&&B.onBeforeRender(M,B,ne,R),y=nn.get(B,x.length),y.init(ne),x.push(y),ct.multiplyMatrices(ne.projectionMatrix,ne.matrixWorldInverse),ue.setFromProjectionMatrix(ct),Qe=this.localClippingEnabled,Ce=Ge.init(this.clippingPlanes,Qe),_=Ht.get(B,w.length),_.init(),w.push(_),!0===ve.enabled&&!0===ve.isPresenting){const $e=M.xr.getDepthSensingMesh();null!==$e&&U2($e,ne,-1/0,M.sortObjects)}U2(B,ne,0,M.sortObjects),_.finish(),!0===M.sortObjects&&_.sort(ge,Le),kn=!1===ve.enabled||!1===ve.isPresenting||!1===ve.hasDepthSensing(),kn&&en.addToRenderList(_,B),this.info.render.frame++,!0===Ce&&Ge.beginShadows(),bt.render(y.state.shadowsArray,B,ne),!0===Ce&&Ge.endShadows(),!0===this.info.autoReset&&this.info.reset();const pe=_.opaque,oe=_.transmissive;if(y.setupLights(),ne.isArrayCamera){const $e=ne.cameras;if(oe.length>0)for(let st=0,Et=$e.length;st<Et;st++)J7(pe,oe,B,$e[st]);kn&&en.render(B);for(let st=0,Et=$e.length;st<Et;st++){const xt=$e[st];K7(_,B,xt,xt.viewport)}}else oe.length>0&&J7(pe,oe,B,ne),kn&&en.render(B),K7(_,B,ne);null!==R&&0===I&&(V.updateMultisampleRenderTarget(R),V.updateRenderTargetMipmap(R)),!0===B.isScene&&B.onAfterRender(M,B,ne),ir.resetDefaultState(),S=-1,T=null,x.pop(),x.length>0?(y=x[x.length-1],!0===Ce&&Ge.setGlobalState(M.clippingPlanes,y.state.camera)):y=null,w.pop(),_=w.length>0?w[w.length-1]:null},this.getActiveCubeFace=function(){return E},this.getActiveMipmapLevel=function(){return I},this.getRenderTarget=function(){return R},this.setRenderTargetTextures=function(B,ne,he){const pe=Ue.get(B);pe.__autoAllocateDepthBuffer=!1===B.resolveDepthBuffer,!1===pe.__autoAllocateDepthBuffer&&(pe.__useRenderToTexture=!1),Ue.get(B.texture).__webglTexture=ne,Ue.get(B.depthTexture).__webglTexture=pe.__autoAllocateDepthBuffer?void 0:he,pe.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(B,ne){const he=Ue.get(B);he.__webglFramebuffer=ne,he.__useDefaultFramebuffer=void 0===ne};const lSe=H.createFramebuffer();this.setRenderTarget=function(B,ne=0,he=0){R=B,E=ne,I=he;let pe=!0,oe=null,$e=!1,st=!1;if(B){const xt=Ue.get(B);if(void 0!==xt.__useDefaultFramebuffer)Ae.bindFramebuffer(H.FRAMEBUFFER,null),pe=!1;else if(void 0===xt.__webglFramebuffer)V.setupRenderTarget(B);else if(xt.__hasExternalTextures)V.rebindTextures(B,Ue.get(B.texture).__webglTexture,Ue.get(B.depthTexture).__webglTexture);else if(B.depthBuffer){const Xt=B.depthTexture;if(xt.__boundDepthTexture!==Xt){if(null!==Xt&&Ue.has(Xt)&&(B.width!==Xt.image.width||B.height!==Xt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");V.setupDepthRenderbuffer(B)}}const mn=B.texture;(mn.isData3DTexture||mn.isDataArrayTexture||mn.isCompressedArrayTexture)&&(st=!0);const fn=Ue.get(B).__webglFramebuffer;B.isWebGLCubeRenderTarget?(oe=Array.isArray(fn[ne])?fn[ne][he]:fn[ne],$e=!0):oe=B.samples>0&&!1===V.useMultisampledRTT(B)?Ue.get(B).__webglMultisampledFramebuffer:Array.isArray(fn)?fn[he]:fn,z.copy(B.viewport),Z.copy(B.scissor),J=B.scissorTest}else z.copy(We).multiplyScalar(Y).floor(),Z.copy(vt).multiplyScalar(Y).floor(),J=wt;if(0!==he&&(oe=lSe),Ae.bindFramebuffer(H.FRAMEBUFFER,oe)&&pe&&Ae.drawBuffers(B,oe),Ae.viewport(z),Ae.scissor(Z),Ae.setScissorTest(J),$e){const xt=Ue.get(B.texture);H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_CUBE_MAP_POSITIVE_X+ne,xt.__webglTexture,he)}else if(st){const xt=Ue.get(B.texture);H.framebufferTextureLayer(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,xt.__webglTexture,he,ne)}else if(null!==B&&0!==he){const xt=Ue.get(B.texture);H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_2D,xt.__webglTexture,he)}S=-1},this.readRenderTargetPixels=function(B,ne,he,pe,oe,$e,st){if(!B||!B.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Et=Ue.get(B).__webglFramebuffer;if(B.isWebGLCubeRenderTarget&&void 0!==st&&(Et=Et[st]),Et){Ae.bindFramebuffer(H.FRAMEBUFFER,Et);try{const xt=B.texture,mn=xt.format,fn=xt.type;if(!Xe.textureFormatReadable(mn))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!Xe.textureTypeReadable(fn))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");ne>=0&&ne<=B.width-pe&&he>=0&&he<=B.height-oe&&H.readPixels(ne,he,pe,oe,Fn.convert(mn),Fn.convert(fn),$e)}finally{const xt=null!==R?Ue.get(R).__webglFramebuffer:null;Ae.bindFramebuffer(H.FRAMEBUFFER,xt)}}},this.readRenderTargetPixelsAsync=function(){var B=N(function*(ne,he,pe,oe,$e,st,Et){if(!ne||!ne.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let xt=Ue.get(ne).__webglFramebuffer;if(ne.isWebGLCubeRenderTarget&&void 0!==Et&&(xt=xt[Et]),xt){if(he>=0&&he<=ne.width-oe&&pe>=0&&pe<=ne.height-$e){Ae.bindFramebuffer(H.FRAMEBUFFER,xt);const mn=ne.texture,fn=mn.format,Xt=mn.type;if(!Xe.textureFormatReadable(fn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Xe.textureTypeReadable(Xt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const ti=H.createBuffer();H.bindBuffer(H.PIXEL_PACK_BUFFER,ti),H.bufferData(H.PIXEL_PACK_BUFFER,st.byteLength,H.STREAM_READ),H.readPixels(he,pe,oe,$e,Fn.convert(fn),Fn.convert(Xt),0);const Di=null!==R?Ue.get(R).__webglFramebuffer:null;Ae.bindFramebuffer(H.FRAMEBUFFER,Di);const Er=H.fenceSync(H.SYNC_GPU_COMMANDS_COMPLETE,0);return H.flush(),yield function epe(n,e,t){return new Promise(function(i,r){setTimeout(function o(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:r();break;case n.TIMEOUT_EXPIRED:setTimeout(o,t);break;default:i()}},t)})}(H,Er,4),H.bindBuffer(H.PIXEL_PACK_BUFFER,ti),H.getBufferSubData(H.PIXEL_PACK_BUFFER,0,st),H.deleteBuffer(ti),H.deleteSync(Er),st}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}});return function(ne,he,pe,oe,$e,st,Et){return B.apply(this,arguments)}}(),this.copyFramebufferToTexture=function(B,ne=null,he=0){const pe=Math.pow(2,-he),oe=Math.floor(B.image.width*pe),$e=Math.floor(B.image.height*pe),st=null!==ne?ne.x:0,Et=null!==ne?ne.y:0;V.setTexture2D(B,0),H.copyTexSubImage2D(H.TEXTURE_2D,he,0,0,st,Et,oe,$e),Ae.unbindTexture()};const uSe=H.createFramebuffer(),cSe=H.createFramebuffer();this.copyTextureToTexture=function(B,ne,he=null,pe=null,oe=0,$e=null){let st,Et,xt,mn,fn,Xt,ti,Di,Er;null===$e&&(0!==oe?(TT("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),$e=oe,oe=0):$e=0);const Fr=B.isCompressedTexture?B.mipmaps[$e]:B.image;if(null!==he)st=he.max.x-he.min.x,Et=he.max.y-he.min.y,xt=he.isBox3?he.max.z-he.min.z:1,mn=he.min.x,fn=he.min.y,Xt=he.isBox3?he.min.z:0;else{const $l=Math.pow(2,-oe);st=Math.floor(Fr.width*$l),Et=Math.floor(Fr.height*$l),xt=B.isDataArrayTexture?Fr.depth:B.isData3DTexture?Math.floor(Fr.depth*$l):1,mn=0,fn=0,Xt=0}null!==pe?(ti=pe.x,Di=pe.y,Er=pe.z):(ti=0,Di=0,Er=0);const hi=Fn.convert(ne.format),Yt=Fn.convert(ne.type);let ss;ne.isData3DTexture?(V.setTexture3D(ne,0),ss=H.TEXTURE_3D):ne.isDataArrayTexture||ne.isCompressedArrayTexture?(V.setTexture2DArray(ne,0),ss=H.TEXTURE_2D_ARRAY):(V.setTexture2D(ne,0),ss=H.TEXTURE_2D),H.pixelStorei(H.UNPACK_FLIP_Y_WEBGL,ne.flipY),H.pixelStorei(H.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ne.premultiplyAlpha),H.pixelStorei(H.UNPACK_ALIGNMENT,ne.unpackAlignment);const xi=H.getParameter(H.UNPACK_ROW_LENGTH),$u=H.getParameter(H.UNPACK_IMAGE_HEIGHT),vy=H.getParameter(H.UNPACK_SKIP_PIXELS),dl=H.getParameter(H.UNPACK_SKIP_ROWS),Hx=H.getParameter(H.UNPACK_SKIP_IMAGES);H.pixelStorei(H.UNPACK_ROW_LENGTH,Fr.width),H.pixelStorei(H.UNPACK_IMAGE_HEIGHT,Fr.height),H.pixelStorei(H.UNPACK_SKIP_PIXELS,mn),H.pixelStorei(H.UNPACK_SKIP_ROWS,fn),H.pixelStorei(H.UNPACK_SKIP_IMAGES,Xt);const br=B.isDataArrayTexture||B.isData3DTexture,Wl=ne.isDataArrayTexture||ne.isData3DTexture;if(B.isDepthTexture){const $l=Ue.get(B),aa=Ue.get(ne),Fa=Ue.get($l.__renderTarget),V2=Ue.get(aa.__renderTarget);Ae.bindFramebuffer(H.READ_FRAMEBUFFER,Fa.__webglFramebuffer),Ae.bindFramebuffer(H.DRAW_FRAMEBUFFER,V2.__webglFramebuffer);for(let dm=0;dm<xt;dm++)br&&(H.framebufferTextureLayer(H.READ_FRAMEBUFFER,H.COLOR_ATTACHMENT0,Ue.get(B).__webglTexture,oe,Xt+dm),H.framebufferTextureLayer(H.DRAW_FRAMEBUFFER,H.COLOR_ATTACHMENT0,Ue.get(ne).__webglTexture,$e,Er+dm)),H.blitFramebuffer(mn,fn,st,Et,ti,Di,st,Et,H.DEPTH_BUFFER_BIT,H.NEAREST);Ae.bindFramebuffer(H.READ_FRAMEBUFFER,null),Ae.bindFramebuffer(H.DRAW_FRAMEBUFFER,null)}else if(0!==oe||B.isRenderTargetTexture||Ue.has(B)){const $l=Ue.get(B),aa=Ue.get(ne);Ae.bindFramebuffer(H.READ_FRAMEBUFFER,uSe),Ae.bindFramebuffer(H.DRAW_FRAMEBUFFER,cSe);for(let Fa=0;Fa<xt;Fa++)br?H.framebufferTextureLayer(H.READ_FRAMEBUFFER,H.COLOR_ATTACHMENT0,$l.__webglTexture,oe,Xt+Fa):H.framebufferTexture2D(H.READ_FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_2D,$l.__webglTexture,oe),Wl?H.framebufferTextureLayer(H.DRAW_FRAMEBUFFER,H.COLOR_ATTACHMENT0,aa.__webglTexture,$e,Er+Fa):H.framebufferTexture2D(H.DRAW_FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_2D,aa.__webglTexture,$e),0!==oe?H.blitFramebuffer(mn,fn,st,Et,ti,Di,st,Et,H.COLOR_BUFFER_BIT,H.NEAREST):Wl?H.copyTexSubImage3D(ss,$e,ti,Di,Er+Fa,mn,fn,st,Et):H.copyTexSubImage2D(ss,$e,ti,Di,mn,fn,st,Et);Ae.bindFramebuffer(H.READ_FRAMEBUFFER,null),Ae.bindFramebuffer(H.DRAW_FRAMEBUFFER,null)}else Wl?B.isDataTexture||B.isData3DTexture?H.texSubImage3D(ss,$e,ti,Di,Er,st,Et,xt,hi,Yt,Fr.data):ne.isCompressedArrayTexture?H.compressedTexSubImage3D(ss,$e,ti,Di,Er,st,Et,xt,hi,Fr.data):H.texSubImage3D(ss,$e,ti,Di,Er,st,Et,xt,hi,Yt,Fr):B.isDataTexture?H.texSubImage2D(H.TEXTURE_2D,$e,ti,Di,st,Et,hi,Yt,Fr.data):B.isCompressedTexture?H.compressedTexSubImage2D(H.TEXTURE_2D,$e,ti,Di,Fr.width,Fr.height,hi,Fr.data):H.texSubImage2D(H.TEXTURE_2D,$e,ti,Di,st,Et,hi,Yt,Fr);H.pixelStorei(H.UNPACK_ROW_LENGTH,xi),H.pixelStorei(H.UNPACK_IMAGE_HEIGHT,$u),H.pixelStorei(H.UNPACK_SKIP_PIXELS,vy),H.pixelStorei(H.UNPACK_SKIP_ROWS,dl),H.pixelStorei(H.UNPACK_SKIP_IMAGES,Hx),0===$e&&ne.generateMipmaps&&H.generateMipmap(ss),Ae.unbindTexture()},this.copyTextureToTexture3D=function(B,ne,he=null,pe=null,oe=0){return TT('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(B,ne,he,pe,oe)},this.initRenderTarget=function(B){void 0===Ue.get(B).__webglFramebuffer&&V.setupRenderTarget(B)},this.initTexture=function(B){B.isCubeTexture?V.setTextureCube(B,0):B.isData3DTexture?V.setTexture3D(B,0):B.isDataArrayTexture||B.isCompressedArrayTexture?V.setTexture2DArray(B,0):V.setTexture2D(B,0),Ae.unbindTexture()},this.resetState=function(){E=0,I=0,R=null,Ae.reset(),ir.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Pu}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=bn._getDrawingBufferColorSpace(e),t.unpackColorSpace=bn._getUnpackColorSpace()}}const c$={type:"change"},TF={type:"start"},d$={type:"end"},k1=new L_,f$=new Ih,wve=Math.cos(70*Pr_DEG2RAD),Co=new U,Pa=2*Math.PI,AF=1e-6;class xve extends pme{constructor(e,t=null){super(e,t),this.state=-1,this.target=new U,this.cursor=new U,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new U,this._lastQuaternion=new hr,this._lastTargetPosition=new U,this._quat=(new hr).setFromUnitVectors(e.up,new U(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new CW,this._sphericalDelta=new CW,this._scale=1,this._panOffset=new U,this._rotateStart=new xe,this._rotateEnd=new xe,this._rotateDelta=new xe,this._panStart=new xe,this._panEnd=new xe,this._panDelta=new xe,this._dollyStart=new xe,this._dollyEnd=new xe,this._dollyDelta=new xe,this._dollyDirection=new U,this._mouse=new xe,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=Cve.bind(this),this._onPointerDown=Mve.bind(this),this._onPointerUp=Sve.bind(this),this._onContextMenu=Pve.bind(this),this._onMouseWheel=Ave.bind(this),this._onKeyDown=Dve.bind(this),this._onTouchStart=Ive.bind(this),this._onTouchMove=Rve.bind(this),this._onMouseDown=Eve.bind(this),this._onMouseMove=Tve.bind(this),this._interceptControlDown=Ove.bind(this),this._interceptControlUp=Nve.bind(this),null!==this.domElement&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){null!==this._domElementKeyEvents&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(c$),this.update(),this.state=-1}update(e=null){const t=this.object.position;Co.copy(t).sub(this.target),Co.applyQuaternion(this._quat),this._spherical.setFromVector3(Co),this.autoRotate&&-1===this.state&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let i=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(i)&&isFinite(r)&&(i<-Math.PI?i+=Pa:i>Math.PI&&(i-=Pa),r<-Math.PI?r+=Pa:r>Math.PI&&(r-=Pa),this._spherical.theta=i<=r?Math.max(i,Math.min(r,this._spherical.theta)):this._spherical.theta>(i+r)/2?Math.max(i,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),!0===this.enableDamping?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let o=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const s=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),o=s!=this._spherical.radius}if(Co.setFromSpherical(this._spherical),Co.applyQuaternion(this._quatInverse),t.copy(this.target).add(Co),this.object.lookAt(this.target),!0===this.enableDamping?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let s=null;if(this.object.isPerspectiveCamera){const a=Co.length();s=this._clampDistance(a*this._scale);const l=a-s;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),o=!!l}else if(this.object.isOrthographicCamera){const a=new U(this._mouse.x,this._mouse.y,0);a.unproject(this.object);const l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),o=l!==this.object.zoom;const u=new U(this._mouse.x,this._mouse.y,0);u.unproject(this.object),this.object.position.sub(u).add(a),this.object.updateMatrixWorld(),s=Co.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;null!==s&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(s).add(this.object.position):(k1.origin.copy(this.object.position),k1.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(k1.direction))<wve?this.object.lookAt(this.target):(f$.setFromNormalAndCoplanarPoint(this.object.up,this.target),k1.intersectPlane(f$,this.target))))}else if(this.object.isOrthographicCamera){const s=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),s!==this.object.zoom&&(this.object.updateProjectionMatrix(),o=!0)}return this._scale=1,this._performCursorZoom=!1,!!(o||this._lastPosition.distanceToSquared(this.object.position)>AF||8*(1-this._lastQuaternion.dot(this.object.quaternion))>AF||this._lastTargetPosition.distanceToSquared(this.target)>AF)&&(this.dispatchEvent(c$),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0)}_getAutoRotationAngle(e){return null!==e?Pa/60*this.autoRotateSpeed*e:Pa/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(.01*e);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){Co.setFromMatrixColumn(t,0),Co.multiplyScalar(-e),this._panOffset.add(Co)}_panUp(e,t){!0===this.screenSpacePanning?Co.setFromMatrixColumn(t,1):(Co.setFromMatrixColumn(t,0),Co.crossVectors(this.object.up,Co)),Co.multiplyScalar(e),this._panOffset.add(Co)}_pan(e,t){const i=this.domElement;if(this.object.isPerspectiveCamera){Co.copy(this.object.position).sub(this.target);let o=Co.length();o*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*o/i.clientHeight,this.object.matrix),this._panUp(2*t*o/i.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const i=this.domElement.getBoundingClientRect(),o=t-i.top,a=i.height;this._mouse.x=(e-i.left)/i.width*2-1,this._mouse.y=-o/a*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Pa*this._rotateDelta.x/t.clientHeight),this._rotateUp(Pa*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(Pa*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-Pa*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(Pa*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-Pa*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(1===this._pointers.length)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e);this._rotateStart.set(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}}_handleTouchStartPan(e){if(1===this._pointers.length)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e);this._panStart.set(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),i=e.pageX-t.x,r=e.pageY-t.y,o=Math.sqrt(i*i+r*r);this._dollyStart.set(0,o)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(1==this._pointers.length)this._rotateEnd.set(e.pageX,e.pageY);else{const i=this._getSecondPointerPosition(e);this._rotateEnd.set(.5*(e.pageX+i.x),.5*(e.pageY+i.y))}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Pa*this._rotateDelta.x/t.clientHeight),this._rotateUp(Pa*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(1===this._pointers.length)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e);this._panEnd.set(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),i=e.pageX-t.x,r=e.pageY-t.y,o=Math.sqrt(i*i+r*r);this._dollyEnd.set(0,o),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd),this._updateZoomParameters(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return void this._pointers.splice(t,1)}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];void 0===t&&(t=new xe,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){return this._pointerPositions[e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0]]}_customWheelEvent(e){const i={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(e.deltaMode){case 1:i.deltaY*=16;break;case 2:i.deltaY*=100}return e.ctrlKey&&!this._controlActive&&(i.deltaY*=10),i}}function Mve(n){!1!==this.enabled&&(0===this._pointers.length&&(this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(n)&&(this._addPointer(n),"touch"===n.pointerType?this._onTouchStart(n):this._onMouseDown(n)))}function Cve(n){!1!==this.enabled&&("touch"===n.pointerType?this._onTouchMove(n):this._onMouseMove(n))}function Sve(n){switch(this._removePointer(n),this._pointers.length){case 0:this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(d$),this.state=-1;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y})}}function Eve(n){let e;switch(n.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case 1:if(!1===this.enableZoom)return;this._handleMouseDownDolly(n),this.state=1;break;case 0:if(n.ctrlKey||n.metaKey||n.shiftKey){if(!1===this.enablePan)return;this._handleMouseDownPan(n),this.state=2}else{if(!1===this.enableRotate)return;this._handleMouseDownRotate(n),this.state=0}break;case 2:if(n.ctrlKey||n.metaKey||n.shiftKey){if(!1===this.enableRotate)return;this._handleMouseDownRotate(n),this.state=0}else{if(!1===this.enablePan)return;this._handleMouseDownPan(n),this.state=2}break;default:this.state=-1}-1!==this.state&&this.dispatchEvent(TF)}function Tve(n){switch(this.state){case 0:if(!1===this.enableRotate)return;this._handleMouseMoveRotate(n);break;case 1:if(!1===this.enableZoom)return;this._handleMouseMoveDolly(n);break;case 2:if(!1===this.enablePan)return;this._handleMouseMovePan(n)}}function Ave(n){!1===this.enabled||!1===this.enableZoom||-1!==this.state||(n.preventDefault(),this.dispatchEvent(TF),this._handleMouseWheel(this._customWheelEvent(n)),this.dispatchEvent(d$))}function Dve(n){!1!==this.enabled&&this._handleKeyDown(n)}function Ive(n){switch(this._trackPointer(n),this._pointers.length){case 1:switch(this.touches.ONE){case 0:if(!1===this.enableRotate)return;this._handleTouchStartRotate(n),this.state=3;break;case 1:if(!1===this.enablePan)return;this._handleTouchStartPan(n),this.state=4;break;default:this.state=-1}break;case 2:switch(this.touches.TWO){case 2:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchStartDollyPan(n),this.state=5;break;case 3:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchStartDollyRotate(n),this.state=6;break;default:this.state=-1}break;default:this.state=-1}-1!==this.state&&this.dispatchEvent(TF)}function Rve(n){switch(this._trackPointer(n),this.state){case 3:if(!1===this.enableRotate)return;this._handleTouchMoveRotate(n),this.update();break;case 4:if(!1===this.enablePan)return;this._handleTouchMovePan(n),this.update();break;case 5:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchMoveDollyPan(n),this.update();break;case 6:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchMoveDollyRotate(n),this.update();break;default:this.state=-1}}function Pve(n){!1!==this.enabled&&n.preventDefault()}function Ove(n){"Control"===n.key&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function Nve(n){"Control"===n.key&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function p$(n,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(2===e||1===e){let t=n.getIndex();if(null===t){const s=[],a=n.getAttribute("position");if(void 0===a)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let l=0;l<a.count;l++)s.push(l);n.setIndex(s),t=n.getIndex()}const i=t.count-2,r=[];if(2===e)for(let s=1;s<=i;s++)r.push(t.getX(0)),r.push(t.getX(s)),r.push(t.getX(s+1));else for(let s=0;s<i;s++)s%2==0?(r.push(t.getX(s)),r.push(t.getX(s+1)),r.push(t.getX(s+2))):(r.push(t.getX(s+2)),r.push(t.getX(s+1)),r.push(t.getX(s)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=n.clone();return o.setIndex(r),o.clearGroups(),o}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class Fve extends ts{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Vve(t)}),this.register(function(t){return new Hve(t)}),this.register(function(t){return new Zve(t)}),this.register(function(t){return new Kve(t)}),this.register(function(t){return new Jve(t)}),this.register(function(t){return new Gve(t)}),this.register(function(t){return new jve(t)}),this.register(function(t){return new Wve(t)}),this.register(function(t){return new $ve(t)}),this.register(function(t){return new Uve(t)}),this.register(function(t){return new qve(t)}),this.register(function(t){return new zve(t)}),this.register(function(t){return new Yve(t)}),this.register(function(t){return new Xve(t)}),this.register(function(t){return new kve(t)}),this.register(function(t){return new Qve(t)}),this.register(function(t){return new ebe(t)})}load(e,t,i,r){const o=this;let s;if(""!==this.resourcePath)s=this.resourcePath;else if(""!==this.path){const u=Oh.extractUrlBase(e);s=Oh.resolveURL(u,this.path)}else s=Oh.extractUrlBase(e);this.manager.itemStart(e);const a=function(u){r?r(u):console.error(u),o.manager.itemError(e),o.manager.itemEnd(e)},l=new Vl(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(u){try{o.parse(u,s,function(c){t(c),o.manager.itemEnd(e)},a)}catch(c){a(c)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let o;const s={},a={},l=new TextDecoder;if("string"==typeof e)o=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===g$){try{s[qn.KHR_BINARY_GLTF]=new tbe(e)}catch(f){return void(r&&r(f))}o=JSON.parse(s[qn.KHR_BINARY_GLTF].content)}else o=JSON.parse(l.decode(e));else o=e;if(void 0===o.asset||o.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const u=new pbe(o,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const f=this.pluginCallbacks[c](u);f.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[f.name]=f,s[f.name]=!0}if(o.extensionsUsed)for(let c=0;c<o.extensionsUsed.length;++c){const f=o.extensionsUsed[c],h=o.extensionsRequired||[];switch(f){case qn.KHR_MATERIALS_UNLIT:s[f]=new Bve;break;case qn.KHR_DRACO_MESH_COMPRESSION:s[f]=new nbe(o,this.dracoLoader);break;case qn.KHR_TEXTURE_TRANSFORM:s[f]=new ibe;break;case qn.KHR_MESH_QUANTIZATION:s[f]=new rbe;break;default:h.indexOf(f)>=0&&void 0===a[f]&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}u.setExtensions(s),u.setPlugins(a),u.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,o){i.parse(e,t,r,o)})}}function Lve(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const qn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class kve{constructor(e){this.parser=e,this.name=qn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const o=t[i];o.extensions&&o.extensions[this.name]&&void 0!==o.extensions[this.name].light&&e._addNodeRef(this.cache,o.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const o=t.json,l=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e];let u;const c=new Ke(16777215);void 0!==l.color&&c.setRGB(l.color[0],l.color[1],l.color[2],Js);const f=void 0!==l.range?l.range:0;switch(l.type){case"directional":u=new dF(c),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new M1(c),u.distance=f;break;case"spot":u=new uF(c),u.distance=f,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,u.angle=l.spot.outerConeAngle,u.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return u.position.set(0,0,0),zd(u,l),void 0!==l.intensity&&(u.intensity=l.intensity),u.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(u),t.cache.add(i,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,o=i.json.nodes[e],a=(o.extensions&&o.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(l){return i._getNodeRef(t.cache,a,l)})}}class Bve{constructor(){this.name=qn.KHR_MATERIALS_UNLIT}getMaterialType(){return sl}extendParams(e,t,i){const r=[];e.color=new Ke(1,1,1),e.opacity=1;const o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){const s=o.baseColorFactor;e.color.setRGB(s[0],s[1],s[2],Js),e.opacity=s[3]}void 0!==o.baseColorTexture&&r.push(i.assignTexture(e,"map",o.baseColorTexture,fi))}return Promise.all(r)}}class Uve{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=r.extensions[this.name].emissiveStrength;return void 0!==o&&(t.emissiveIntensity=o),Promise.resolve()}}class Vve{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Uu:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],s=r.extensions[this.name];if(void 0!==s.clearcoatFactor&&(t.clearcoat=s.clearcoatFactor),void 0!==s.clearcoatTexture&&o.push(i.assignTexture(t,"clearcoatMap",s.clearcoatTexture)),void 0!==s.clearcoatRoughnessFactor&&(t.clearcoatRoughness=s.clearcoatRoughnessFactor),void 0!==s.clearcoatRoughnessTexture&&o.push(i.assignTexture(t,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),void 0!==s.clearcoatNormalTexture&&(o.push(i.assignTexture(t,"clearcoatNormalMap",s.clearcoatNormalTexture)),void 0!==s.clearcoatNormalTexture.scale)){const a=s.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new xe(a,a)}return Promise.all(o)}}class Hve{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_DISPERSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Uu:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=r.extensions[this.name];return t.dispersion=void 0!==o.dispersion?o.dispersion:0,Promise.resolve()}}class zve{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Uu:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],s=r.extensions[this.name];return void 0!==s.iridescenceFactor&&(t.iridescence=s.iridescenceFactor),void 0!==s.iridescenceTexture&&o.push(i.assignTexture(t,"iridescenceMap",s.iridescenceTexture)),void 0!==s.iridescenceIor&&(t.iridescenceIOR=s.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==s.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=s.iridescenceThicknessMinimum),void 0!==s.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=s.iridescenceThicknessMaximum),void 0!==s.iridescenceThicknessTexture&&o.push(i.assignTexture(t,"iridescenceThicknessMap",s.iridescenceThicknessTexture)),Promise.all(o)}}class Gve{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Uu:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[];t.sheenColor=new Ke(0,0,0),t.sheenRoughness=0,t.sheen=1;const s=r.extensions[this.name];if(void 0!==s.sheenColorFactor){const a=s.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Js)}return void 0!==s.sheenRoughnessFactor&&(t.sheenRoughness=s.sheenRoughnessFactor),void 0!==s.sheenColorTexture&&o.push(i.assignTexture(t,"sheenColorMap",s.sheenColorTexture,fi)),void 0!==s.sheenRoughnessTexture&&o.push(i.assignTexture(t,"sheenRoughnessMap",s.sheenRoughnessTexture)),Promise.all(o)}}class jve{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Uu:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],s=r.extensions[this.name];return void 0!==s.transmissionFactor&&(t.transmission=s.transmissionFactor),void 0!==s.transmissionTexture&&o.push(i.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(o)}}class Wve{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Uu:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],s=r.extensions[this.name];t.thickness=void 0!==s.thicknessFactor?s.thicknessFactor:0,void 0!==s.thicknessTexture&&o.push(i.assignTexture(t,"thicknessMap",s.thicknessTexture)),t.attenuationDistance=s.attenuationDistance||1/0;const a=s.attenuationColor||[1,1,1];return t.attenuationColor=(new Ke).setRGB(a[0],a[1],a[2],Js),Promise.all(o)}}class $ve{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Uu:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=r.extensions[this.name];return t.ior=void 0!==o.ior?o.ior:1.5,Promise.resolve()}}class qve{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Uu:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],s=r.extensions[this.name];t.specularIntensity=void 0!==s.specularFactor?s.specularFactor:1,void 0!==s.specularTexture&&o.push(i.assignTexture(t,"specularIntensityMap",s.specularTexture));const a=s.specularColorFactor||[1,1,1];return t.specularColor=(new Ke).setRGB(a[0],a[1],a[2],Js),void 0!==s.specularColorTexture&&o.push(i.assignTexture(t,"specularColorMap",s.specularColorTexture,fi)),Promise.all(o)}}class Xve{constructor(e){this.parser=e,this.name=qn.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Uu:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],s=r.extensions[this.name];return t.bumpScale=void 0!==s.bumpFactor?s.bumpFactor:1,void 0!==s.bumpTexture&&o.push(i.assignTexture(t,"bumpMap",s.bumpTexture)),Promise.all(o)}}class Yve{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Uu:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],s=r.extensions[this.name];return void 0!==s.anisotropyStrength&&(t.anisotropy=s.anisotropyStrength),void 0!==s.anisotropyRotation&&(t.anisotropyRotation=s.anisotropyRotation),void 0!==s.anisotropyTexture&&o.push(i.assignTexture(t,"anisotropyMap",s.anisotropyTexture)),Promise.all(o)}}class Zve{constructor(e){this.parser=e,this.name=qn.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const o=r.extensions[this.name],s=t.options.ktx2Loader;if(!s){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o.source,s)}}class Kve{constructor(e){this.parser=e,this.name=qn.EXT_TEXTURE_WEBP}loadTexture(e){const t=this.name,i=this.parser,r=i.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;const s=o.extensions[t],a=r.images[s.source];let l=i.textureLoader;if(a.uri){const u=i.options.manager.getHandler(a.uri);null!==u&&(l=u)}return i.loadTextureImage(e,s.source,l)}}class Jve{constructor(e){this.parser=e,this.name=qn.EXT_TEXTURE_AVIF}loadTexture(e){const t=this.name,i=this.parser,r=i.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;const s=o.extensions[t],a=r.images[s.source];let l=i.textureLoader;if(a.uri){const u=i.options.manager.getHandler(a.uri);null!==u&&(l=u)}return i.loadTextureImage(e,s.source,l)}}class Qve{constructor(e){this.name=qn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],o=this.parser.getDependency("buffer",r.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return o.then(function(a){const c=r.count,f=r.byteStride,h=new Uint8Array(a,r.byteOffset||0,r.byteLength||0);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(c,f,h,r.mode,r.filter).then(function(g){return g.buffer}):s.ready.then(function(){const g=new ArrayBuffer(c*f);return s.decodeGltfBuffer(new Uint8Array(g),c,f,h,r.mode,r.filter),g})})}return null}}class ebe{constructor(e){this.name=qn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const r=t.meshes[i.mesh];for(const u of r.primitives)if(u.mode!==Hl.TRIANGLES&&u.mode!==Hl.TRIANGLE_STRIP&&u.mode!==Hl.TRIANGLE_FAN&&void 0!==u.mode)return null;const s=i.extensions[this.name].attributes,a=[],l={};for(const u in s)a.push(this.parser.getDependency("accessor",s[u]).then(c=>(l[u]=c,l[u])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(u=>{const c=u.pop(),f=c.isGroup?c.children:[c],h=u[0].count,g=[];for(const m of f){const v=new at,_=new U,y=new hr,w=new U(1,1,1),x=new A6(m.geometry,m.material,h);for(let M=0;M<h;M++)l.TRANSLATION&&_.fromBufferAttribute(l.TRANSLATION,M),l.ROTATION&&y.fromBufferAttribute(l.ROTATION,M),l.SCALE&&w.fromBufferAttribute(l.SCALE,M),x.setMatrixAt(M,v.compose(_,y,w));for(const M in l)if("_COLOR_0"===M){const D=l[M];x.instanceColor=new K_(D.array,D.itemSize,D.normalized)}else"TRANSLATION"!==M&&"ROTATION"!==M&&"SCALE"!==M&&m.geometry.setAttribute(M,l[M]);mi.prototype.copy.call(x,m),this.parser.assignFinalMaterial(x),g.push(x)}return c.isGroup?(c.clear(),c.add(...g),c):g[0]}))}}const g$="glTF";class tbe{constructor(e){this.name=qn.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==g$)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,o=new DataView(e,12);let s=0;for(;s<r;){const a=o.getUint32(s,!0);s+=4;const l=o.getUint32(s,!0);if(s+=4,1313821514===l){const u=new Uint8Array(e,12+s,a);this.content=i.decode(u)}else if(5130562===l){const u=12+s;this.body=e.slice(u,u+a)}s+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class nbe{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=qn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,o=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,a={},l={},u={};for(const c in s){const f=RF[c]||c.toLowerCase();a[f]=s[c]}for(const c in e.attributes){const f=RF[c]||c.toLowerCase();if(void 0!==s[c]){const h=i.accessors[e.attributes[c]];u[f]=ay[h.componentType].name,l[f]=!0===h.normalized}}return t.getDependency("bufferView",o).then(function(c){return new Promise(function(f,h){r.decodeDracoFile(c,function(g){for(const m in g.attributes){const _=l[m];void 0!==_&&(g.attributes[m].normalized=_)}f(g)},a,u,Js,h)})})}}class ibe{constructor(){this.name=qn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class rbe{constructor(){this.name=qn.KHR_MESH_QUANTIZATION}}class _$ extends fx{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,o=e*r*3+r;for(let s=0;s!==r;s++)t[s]=i[o+s];return t}interpolate_(e,t,i,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=2*a,u=3*a,c=r-t,f=(i-t)/c,h=f*f,g=h*f,m=e*u,v=m-u,_=-2*g+3*h,y=g-h,w=1-_,x=y-h+f;for(let M=0;M!==a;M++)o[M]=w*s[v+M+a]+x*(s[v+M+l]*c)+_*s[m+M+a]+y*(s[m+M]*c);return o}}const obe=new hr;class sbe extends _${interpolate_(e,t,i,r){const o=super.interpolate_(e,t,i,r);return obe.fromArray(o).normalize().toArray(o),o}}const Hl={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},ay={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},y$={9728:Fo,9729:zr,9984:1004,9985:1007,9986:S_,9987:Ru},v$={33071:Aa,33648:1002,10497:Dd},IF={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},RF={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Fh={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},abe={CUBICSPLINE:void 0,LINEAR:Vw,STEP:Uw};function Xg(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function zd(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function cbe(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function dbe(n){let e;const t=n.extensions&&n.extensions[qn.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+OF(t.attributes):n.indices+":"+OF(n.attributes)+":"+n.mode,void 0!==n.targets)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+OF(n.targets[i]);return e}function OF(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function NF(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const hbe=new at;class pbe{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Lve,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=-1,o=!1,s=-1;if(typeof navigator<"u"){const a=navigator.userAgent;i=!0===/^((?!chrome|android).)*safari/i.test(a);const l=a.match(/Version\/(\d+)/);r=i&&l?parseInt(l[1],10):-1,o=a.indexOf("Firefox")>-1,s=o?a.match(/Firefox\/([0-9]+)\./)[1]:-1}this.textureLoader=typeof createImageBitmap>"u"||i&&r<17||o&&s<98?new aW(this.options.manager):new qge(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Vl(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,o=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(s){return s._markDefs&&s._markDefs()}),Promise.all(this._invokeAll(function(s){return s.beforeRoot&&s.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(s){const a={scene:s[0][r.scene||0],scenes:s[0],animations:s[1],cameras:s[2],asset:r.asset,parser:i,userData:{}};return Xg(o,a,r),zd(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){for(const l of a.scenes)l.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,o=t.length;r<o;r++){const s=t[r].joints;for(let a=0,l=s.length;a<l;a++)e[s[a]].isBone=!0}for(let r=0,o=e.length;r<o;r++){const s=e[r];void 0!==s.mesh&&(this._addNodeRef(this.meshCache,s.mesh),void 0!==s.skin&&(i[s.mesh].isSkinnedMesh=!0)),void 0!==s.camera&&this._addNodeRef(this.cameraCache,s.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),o=(s,a)=>{const l=this.associations.get(s);null!=l&&this.associations.set(a,l);for(const[u,c]of s.children.entries())o(c,a.children[u])};return o(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const o=e(t[r]);o&&i.push(o)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(o){return o.loadNode&&o.loadNode(t)});break;case"mesh":r=this._invokeOne(function(o){return o.loadMesh&&o.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(o){return o.loadBufferView&&o.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(o){return o.loadMaterial&&o.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(o){return o.loadTexture&&o.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(o){return o.loadAnimation&&o.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(o){return o!=this&&o.getDependency&&o.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(o,s){return i.getDependency(e,s)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[qn.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(o,s){i.load(Oh.resolveURL(t.uri,r.path),o,void 0,function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const o=t.byteOffset||0;return i.slice(o,o+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const s=IF[r.type],l=!0===r.normalized,u=new(0,ay[r.componentType])(r.count*s);return Promise.resolve(new bi(u,s,l))}const o=[];return o.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(o.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(o).then(function(s){const a=s[0],l=IF[r.type],u=ay[r.componentType],c=u.BYTES_PER_ELEMENT,h=r.byteOffset||0,g=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,m=!0===r.normalized;let v,_;if(g&&g!==c*l){const y=Math.floor(h/g),w="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+y+":"+r.count;let x=t.cache.get(w);x||(v=new u(a,y*g,r.count*g/c),x=new $T(v,g/c),t.cache.add(w,x)),_=new Tg(x,l,h%g/c,m)}else v=null===a?new u(r.count*l):new u(a,h,r.count*l),_=new bi(v,l,m);if(void 0!==r.sparse){const M=r.sparse.values.byteOffset||0,D=new(0,ay[r.sparse.indices.componentType])(s[1],r.sparse.indices.byteOffset||0,r.sparse.count*IF.SCALAR),E=new u(s[2],M,r.sparse.count*l);null!==a&&(_=new bi(_.array.slice(),_.itemSize,_.normalized)),_.normalized=!1;for(let I=0,R=D.length;I<R;I++){const S=D[I];if(_.setX(S,E[I*l]),l>=2&&_.setY(S,E[I*l+1]),l>=3&&_.setZ(S,E[I*l+2]),l>=4&&_.setW(S,E[I*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}_.normalized=m}return _})}loadTexture(e){const t=this.json,o=t.textures[e].source,s=t.images[o];let a=this.textureLoader;if(s.uri){const l=this.options.manager.getHandler(s.uri);null!==l&&(a=l)}return this.loadTextureImage(e,o,a)}loadTextureImage(e,t,i){const r=this,o=this.json,s=o.textures[e],a=o.images[t],l=(a.uri||a.bufferView)+":"+s.sampler;if(this.textureCache[l])return this.textureCache[l];const u=this.loadImageSource(t,i).then(function(c){c.flipY=!1,c.name=s.name||a.name||"",""===c.name&&"string"==typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(c.name=a.uri);const h=(o.samplers||{})[s.sampler]||{};return c.magFilter=y$[h.magFilter]||zr,c.minFilter=y$[h.minFilter]||Ru,c.wrapS=v$[h.wrapS]||Dd,c.wrapT=v$[h.wrapT]||Dd,c.generateMipmaps=!c.isCompressedTexture&&c.minFilter!==Fo&&c.minFilter!==zr,r.associations.set(c,{textures:e}),c}).catch(function(){return null});return this.textureCache[l]=u,u}loadImageSource(e,t){const r=this.json,o=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(f=>f.clone());const s=r.images[e],a=self.URL||self.webkitURL;let l=s.uri||"",u=!1;if(void 0!==s.bufferView)l=this.getDependency("bufferView",s.bufferView).then(function(f){u=!0;const h=new Blob([f],{type:s.mimeType});return l=a.createObjectURL(h),l});else if(void 0===s.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const c=Promise.resolve(l).then(function(f){return new Promise(function(h,g){let m=h;!0===t.isImageBitmapLoader&&(m=function(v){const _=new Jo(v);_.needsUpdate=!0,h(_)}),t.load(Oh.resolveURL(f,o.path),m,void 0,g)})}).then(function(f){return!0===u&&a.revokeObjectURL(l),zd(f,s),f.userData.mimeType=s.mimeType||function fbe(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":n.search(/\.ktx2($|\?)/i)>0||0===n.search(/^data\:image\/ktx2/)?"image/ktx2":"image/png"}(s.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),f});return this.sourceCache[e]=c,c}assignTexture(e,t,i,r){const o=this;return this.getDependency("texture",i.index).then(function(s){if(!s)return null;if(void 0!==i.texCoord&&i.texCoord>0&&((s=s.clone()).channel=i.texCoord),o.extensions[qn.KHR_TEXTURE_TRANSFORM]){const a=void 0!==i.extensions?i.extensions[qn.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=o.associations.get(s);s=o.extensions[qn.KHR_TEXTURE_TRANSFORM].extendTexture(s,a),o.associations.set(s,l)}}return void 0!==r&&(s.colorSpace=r),e[t]=s,s})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,o=void 0!==t.attributes.color,s=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new Rg,lo.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new wo,lo.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(a,l)),i=l}if(r||o||s){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),o&&(a+="vertex-colors:"),s&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),o&&(l.vertexColors=!0),s&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return w1}loadMaterial(e){const t=this,r=this.extensions,o=this.json.materials[e];let s;const a={},u=[];if((o.extensions||{})[qn.KHR_MATERIALS_UNLIT]){const f=r[qn.KHR_MATERIALS_UNLIT];s=f.getMaterialType(),u.push(f.extendParams(a,o,t))}else{const f=o.pbrMetallicRoughness||{};if(a.color=new Ke(1,1,1),a.opacity=1,Array.isArray(f.baseColorFactor)){const h=f.baseColorFactor;a.color.setRGB(h[0],h[1],h[2],Js),a.opacity=h[3]}void 0!==f.baseColorTexture&&u.push(t.assignTexture(a,"map",f.baseColorTexture,fi)),a.metalness=void 0!==f.metallicFactor?f.metallicFactor:1,a.roughness=void 0!==f.roughnessFactor?f.roughnessFactor:1,void 0!==f.metallicRoughnessTexture&&(u.push(t.assignTexture(a,"metalnessMap",f.metallicRoughnessTexture)),u.push(t.assignTexture(a,"roughnessMap",f.metallicRoughnessTexture))),s=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,a)})))}!0===o.doubleSided&&(a.side=2);const c=o.alphaMode||"OPAQUE";if("BLEND"===c?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===c&&(a.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&s!==sl&&(u.push(t.assignTexture(a,"normalMap",o.normalTexture)),a.normalScale=new xe(1,1),void 0!==o.normalTexture.scale)){const f=o.normalTexture.scale;a.normalScale.set(f,f)}if(void 0!==o.occlusionTexture&&s!==sl&&(u.push(t.assignTexture(a,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(a.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&s!==sl){const f=o.emissiveFactor;a.emissive=(new Ke).setRGB(f[0],f[1],f[2],Js)}return void 0!==o.emissiveTexture&&s!==sl&&u.push(t.assignTexture(a,"emissiveMap",o.emissiveTexture,fi)),Promise.all(u).then(function(){const f=new s(a);return o.name&&(f.name=o.name),zd(f,o),t.associations.set(f,{materials:e}),o.extensions&&Xg(r,f,o),f})}createUniqueName(e){const t=wi.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function o(a){return i[qn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return b$(l,a,t)})}const s=[];for(let a=0,l=e.length;a<l;a++){const u=e[a],c=dbe(u),f=r[c];if(f)s.push(f.promise);else{let h;h=u.extensions&&u.extensions[qn.KHR_DRACO_MESH_COMPRESSION]?o(u):b$(new cn,u,t),r[c]={primitive:u,promise:h},s.push(h)}}return Promise.all(s)}loadMesh(e){const t=this,r=this.extensions,o=this.json.meshes[e],s=o.primitives,a=[];for(let l=0,u=s.length;l<u;l++){const c=void 0===s[l].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new w1({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),n.DefaultMaterial):this.getDependency("material",s[l].material);a.push(c)}var n;return a.push(t.loadGeometries(s)),Promise.all(a).then(function(l){const u=l.slice(0,l.length-1),c=l[l.length-1],f=[];for(let g=0,m=c.length;g<m;g++){const v=c[g],_=s[g];let y;const w=u[g];if(_.mode===Hl.TRIANGLES||_.mode===Hl.TRIANGLE_STRIP||_.mode===Hl.TRIANGLE_FAN||void 0===_.mode)y=!0===o.isSkinnedMesh?new IN(v,w):new yr(v,w),!0===y.isSkinnedMesh&&y.normalizeSkinWeights(),_.mode===Hl.TRIANGLE_STRIP?y.geometry=p$(y.geometry,1):_.mode===Hl.TRIANGLE_FAN&&(y.geometry=p$(y.geometry,2));else if(_.mode===Hl.LINES)y=new Ul(v,w);else if(_.mode===Hl.LINE_STRIP)y=new Vd(v,w);else if(_.mode===Hl.LINE_LOOP)y=new F6(v,w);else{if(_.mode!==Hl.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+_.mode);y=new rx(v,w)}Object.keys(y.geometry.morphAttributes).length>0&&cbe(y,o),y.name=t.createUniqueName(o.name||"mesh_"+e),zd(y,o),_.extensions&&Xg(r,y,_),t.assignFinalMaterial(y),f.push(y)}for(let g=0,m=f.length;g<m;g++)t.associations.set(f[g],{meshes:e,primitives:g});if(1===f.length)return o.extensions&&Xg(r,f[0],o),f[0];const h=new Lu;o.extensions&&Xg(r,h,o),t.associations.set(h,{meshes:e});for(let g=0,m=f.length;g<m;g++)h.add(f[g]);return h})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new bo(Pr_radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new C1(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),zd(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,o=t.joints.length;r<o;r++)i.push(this._loadNodeShallow(t.joints[r]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(r){const o=r.pop(),s=r,a=[],l=[];for(let u=0,c=s.length;u<c;u++){const f=s[u];if(f){a.push(f);const h=new at;null!==o&&h.fromArray(o.array,16*u),l.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[u])}return new Jw(a,l)})}loadAnimation(e){const i=this,r=this.json.animations[e],o=r.name?r.name:"animation_"+e,s=[],a=[],l=[],u=[],c=[];for(let f=0,h=r.channels.length;f<h;f++){const g=r.channels[f],m=r.samplers[g.sampler],v=g.target,y=void 0!==r.parameters?r.parameters[m.input]:m.input,w=void 0!==r.parameters?r.parameters[m.output]:m.output;void 0!==v.node&&(s.push(this.getDependency("node",v.node)),a.push(this.getDependency("accessor",y)),l.push(this.getDependency("accessor",w)),u.push(m),c.push(v))}return Promise.all([Promise.all(s),Promise.all(a),Promise.all(l),Promise.all(u),Promise.all(c)]).then(function(f){const h=f[0],g=f[1],m=f[2],v=f[3],_=f[4],y=[];for(let w=0,x=h.length;w<x;w++){const M=h[w],D=g[w],E=m[w],I=v[w],R=_[w];if(void 0===M)continue;M.updateMatrix&&M.updateMatrix();const S=i._createAnimationTracks(M,D,E,I,R);if(S)for(let T=0;T<S.length;T++)y.push(S[T])}return new iy(o,void 0,y)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(o){const s=i._getNodeRef(i.meshCache,r.mesh,o);return void 0!==r.weights&&s.traverse(function(a){if(a.isMesh)for(let l=0,u=r.weights.length;l<u;l++)a.morphTargetInfluences[l]=r.weights[l]}),s})}loadNode(e){const i=this,r=this.json.nodes[e],o=i._loadNodeShallow(e),s=[],a=r.children||[];for(let u=0,c=a.length;u<c;u++)s.push(i.getDependency("node",a[u]));const l=void 0===r.skin?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([o,Promise.all(s),l]).then(function(u){const c=u[0],f=u[1],h=u[2];null!==h&&c.traverse(function(g){g.isSkinnedMesh&&g.bind(h,hbe)});for(let g=0,m=f.length;g<m;g++)c.add(f[g]);return c})}_loadNodeShallow(e){const i=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const o=this.json.nodes[e],s=o.name?r.createUniqueName(o.name):"",a=[],l=r._invokeOne(function(u){return u.createNodeMesh&&u.createNodeMesh(e)});return l&&a.push(l),void 0!==o.camera&&a.push(r.getDependency("camera",o.camera).then(function(u){return r._getNodeRef(r.cameraCache,o.camera,u)})),r._invokeAll(function(u){return u.createNodeAttachment&&u.createNodeAttachment(e)}).forEach(function(u){a.push(u)}),this.nodeCache[e]=Promise.all(a).then(function(u){let c;if(c=!0===o.isBone?new Kw:u.length>1?new Lu:1===u.length?u[0]:new mi,c!==u[0])for(let f=0,h=u.length;f<h;f++)c.add(u[f]);if(o.name&&(c.userData.name=o.name,c.name=s),zd(c,o),o.extensions&&Xg(i,c,o),void 0!==o.matrix){const f=new at;f.fromArray(o.matrix),c.applyMatrix4(f)}else void 0!==o.translation&&c.position.fromArray(o.translation),void 0!==o.rotation&&c.quaternion.fromArray(o.rotation),void 0!==o.scale&&c.scale.fromArray(o.scale);return r.associations.has(c)||r.associations.set(c,{}),r.associations.get(c).nodes=e,c}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,o=new Lu;i.name&&(o.name=r.createUniqueName(i.name)),zd(o,i),i.extensions&&Xg(t,o,i);const s=i.nodes||[],a=[];for(let l=0,u=s.length;l<u;l++)a.push(r.getDependency("node",s[l]));return Promise.all(a).then(function(l){for(let c=0,f=l.length;c<f;c++)o.add(l[c]);return r.associations=(c=>{const f=new Map;for(const[h,g]of r.associations)(h instanceof lo||h instanceof Jo)&&f.set(h,g);return c.traverse(h=>{const g=r.associations.get(h);null!=g&&f.set(h,g)}),f})(o),o})}_createAnimationTracks(e,t,i,r,o){const s=[],a=e.name?e.name:e.uuid,l=[];let u;switch(Fh[o.path]===Fh.weights?e.traverse(function(h){h.morphTargetInfluences&&l.push(h.name?h.name:h.uuid)}):l.push(a),Fh[o.path]){case Fh.weights:u=Lg;break;case Fh.rotation:u=Rh;break;case Fh.translation:case Fh.scale:u=kg;break;default:u=1===i.itemSize?Lg:kg}const c=void 0!==r.interpolation?abe[r.interpolation]:Vw,f=this._getArrayFromAccessor(i);for(let h=0,g=l.length;h<g;h++){const m=new u(l[h]+"."+Fh[o.path],t.array,f,c);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(m),s.push(m)}return s}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=NF(t.constructor),r=new Float32Array(t.length);for(let o=0,s=t.length;o<s;o++)r[o]=t[o]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){return new(this instanceof Rh?sbe:_$)(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function b$(n,e,t){const i=e.attributes,r=[];function o(s,a){return t.getDependency("accessor",s).then(function(l){n.setAttribute(a,l)})}for(const s in i){const a=RF[s]||s.toLowerCase();a in n.attributes||r.push(o(i[s],a))}if(void 0!==e.indices&&!n.index){const s=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(s)}return bn.workingColorSpace!==Js&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${bn.workingColorSpace}" not supported.`),zd(n,e),function gbe(n,e,t){const i=e.attributes,r=new Qo;if(void 0===i.POSITION)return;{const a=t.json.accessors[i.POSITION],l=a.min,u=a.max;if(void 0===l||void 0===u)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new U(l[0],l[1],l[2]),new U(u[0],u[1],u[2])),a.normalized){const c=NF(ay[a.componentType]);r.min.multiplyScalar(c),r.max.multiplyScalar(c)}}const o=e.targets;if(void 0!==o){const a=new U,l=new U;for(let u=0,c=o.length;u<c;u++){const f=o[u];if(void 0!==f.POSITION){const h=t.json.accessors[f.POSITION],g=h.min,m=h.max;if(void 0!==g&&void 0!==m){if(l.setX(Math.max(Math.abs(g[0]),Math.abs(m[0]))),l.setY(Math.max(Math.abs(g[1]),Math.abs(m[1]))),l.setZ(Math.max(Math.abs(g[2]),Math.abs(m[2]))),h.normalized){const v=NF(ay[h.componentType]);l.multiplyScalar(v)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const s=new es;r.getCenter(s.center),s.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=s}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function ube(n,e,t){let i=!1,r=!1,o=!1;for(let u=0,c=e.length;u<c;u++){const f=e[u];if(void 0!==f.POSITION&&(i=!0),void 0!==f.NORMAL&&(r=!0),void 0!==f.COLOR_0&&(o=!0),i&&r&&o)break}if(!i&&!r&&!o)return Promise.resolve(n);const s=[],a=[],l=[];for(let u=0,c=e.length;u<c;u++){const f=e[u];if(i){const h=void 0!==f.POSITION?t.getDependency("accessor",f.POSITION):n.attributes.position;s.push(h)}if(r){const h=void 0!==f.NORMAL?t.getDependency("accessor",f.NORMAL):n.attributes.normal;a.push(h)}if(o){const h=void 0!==f.COLOR_0?t.getDependency("accessor",f.COLOR_0):n.attributes.color;l.push(h)}}return Promise.all([Promise.all(s),Promise.all(a),Promise.all(l)]).then(function(u){const f=u[1],h=u[2];return i&&(n.morphAttributes.position=u[0]),r&&(n.morphAttributes.normal=f),o&&(n.morphAttributes.color=h),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}var Ti=Uint8Array,na=Uint16Array,mx=Int32Array,ly=new Ti([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),uy=new Ti([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),_x=new Ti([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),x$=function(n,e){for(var t=new na(31),i=0;i<31;++i)t[i]=e+=1<<n[i-1];var r=new mx(t[30]);for(i=1;i<30;++i)for(var o=t[i];o<t[i+1];++o)r[o]=o-t[i]<<5|i;return{b:t,r}},M$=x$(ly,2),FF=M$.b,B1=M$.r;FF[28]=258,B1[258]=28;for(var S$=x$(uy,0).b,yx=new na(32768),pr=0;pr<32768;++pr){var Lh=(43690&pr)>>1|(21845&pr)<<1;yx[pr]=((65280&(Lh=(61680&(Lh=(52428&Lh)>>2|(13107&Lh)<<2))>>4|(3855&Lh)<<4))>>8|(255&Lh)<<8)>>1}var Fc=function(n,e,t){for(var i=n.length,r=0,o=new na(e);r<i;++r)n[r]&&++o[n[r]-1];var a,s=new na(e);for(r=1;r<e;++r)s[r]=s[r-1]+o[r-1]<<1;if(t){a=new na(1<<e);var l=15-e;for(r=0;r<i;++r)if(n[r])for(var u=r<<4|n[r],c=e-n[r],f=s[n[r]-1]++<<c,h=f|(1<<c)-1;f<=h;++f)a[yx[f]>>l]=u}else for(a=new na(i),r=0;r<i;++r)n[r]&&(a[r]=yx[s[n[r]-1]++]>>15-n[r]);return a},kh=new Ti(288);for(pr=0;pr<144;++pr)kh[pr]=8;for(pr=144;pr<256;++pr)kh[pr]=9;for(pr=256;pr<280;++pr)kh[pr]=7;for(pr=280;pr<288;++pr)kh[pr]=8;var vx=new Ti(32);for(pr=0;pr<32;++pr)vx[pr]=5;var T$=Fc(kh,9,1),D$=Fc(vx,5,1),U1=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},zl=function(n,e,t){var i=e/8|0;return(n[i]|n[i+1]<<8)>>(7&e)&t},V1=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(7&e)},bx=function(n){return(n+7)/8|0},I$=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ii=function(n,e,t){var i=new Error(e||I$[n]);if(i.code=n,Error.captureStackTrace&&Error.captureStackTrace(i,ii),!t)throw i;return i},H1=function(n,e,t,i){var r=n.length,o=i?i.length:0;if(!r||e.f&&!e.l)return t||new Ti(0);var s=!t,a=s||2!=e.i,l=e.i;s&&(t=new Ti(3*r));var u=function(Xn){var kn=t.length;if(Xn>kn){var qt=new Ti(Math.max(2*kn,Xn));qt.set(t),t=qt}},c=e.f||0,f=e.p||0,h=e.b||0,g=e.l,m=e.d,v=e.m,_=e.n,y=8*r;do{if(!g){c=zl(n,f,1);var w=zl(n,f+1,3);if(f+=3,!w){var M=n[(x=bx(f)+4)-4]|n[x-3]<<8,D=x+M;if(D>r){l&&ii(0);break}a&&u(h+M),t.set(n.subarray(x,D),h),e.b=h+=M,e.p=f=8*D,e.f=c;continue}if(1==w)g=T$,m=D$,v=9,_=5;else if(2==w){var E=zl(n,f,31)+257,I=zl(n,f+10,15)+4,R=E+zl(n,f+5,31)+1;f+=14;for(var S=new Ti(R),T=new Ti(19),z=0;z<I;++z)T[_x[z]]=zl(n,f+3*z,7);f+=3*I;var Z=U1(T),J=(1<<Z)-1,le=Fc(T,Z,1);for(z=0;z<R;){var x,fe=le[zl(n,f,J)];if(f+=15&fe,(x=fe>>4)<16)S[z++]=x;else{var W=0,ie=0;for(16==x?(ie=3+zl(n,f,3),f+=2,W=S[z-1]):17==x?(ie=3+zl(n,f,7),f+=3):18==x&&(ie=11+zl(n,f,127),f+=7);ie--;)S[z++]=W}}var Y=S.subarray(0,E),ge=S.subarray(E);v=U1(Y),_=U1(ge),g=Fc(Y,v,1),m=Fc(ge,_,1)}else ii(1);if(f>y){l&&ii(0);break}}a&&u(h+131072);for(var Le=(1<<v)-1,We=(1<<_)-1,vt=f;;vt=f){var wt=(W=g[V1(n,f)&Le])>>4;if((f+=15&W)>y){l&&ii(0);break}if(W||ii(2),wt<256)t[h++]=wt;else{if(256==wt){vt=f,g=null;break}var ue=wt-254;wt>264&&(ue=zl(n,f,(1<<(Ce=ly[z=wt-257]))-1)+FF[z],f+=Ce);var Qe=m[V1(n,f)&We],Ne=Qe>>4;if(Qe||ii(3),f+=15&Qe,ge=S$[Ne],Ne>3){var Ce=uy[Ne];ge+=V1(n,f)&(1<<Ce)-1,f+=Ce}if(f>y){l&&ii(0);break}a&&u(h+131072);var ct=h+ue;if(h<ge){var At=o-ge,ft=Math.min(ge,ct);for(At+h<0&&ii(3);h<ft;++h)t[h]=i[At+h]}for(;h<ct;++h)t[h]=t[h-ge]}}e.l=g,e.p=vt,e.b=h,e.f=c,g&&(c=1,e.m=v,e.d=m,e.n=_)}while(!c);return h!=t.length&&s?function(n,e,t){return(null==e||e<0)&&(e=0),(null==t||t>n.length)&&(t=n.length),new Ti(n.subarray(e,t))}(t,0,h):t.subarray(0,h)},VF=new Ti(0);function Y1(n,e){return H1(n.subarray(function(n,e){return(8!=(15&n[0])||n[0]>>4>7||(n[0]<<8|n[1])%31)&&ii(6,"invalid zlib data"),(n[1]>>5&1)==+!e&&ii(6,"invalid zlib data: "+(32&n[1]?"need":"unexpected")+" dictionary"),2+(n[1]>>3&4)}(n,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}var XF=typeof TextDecoder<"u"&&new TextDecoder;try{XF.decode(VF,{stream:!0})}catch{}function Yg(n,e,t){const i=t.length-n-1;if(e>=t[i])return i-1;if(e<=t[n])return n;let r=n,o=i,s=Math.floor((r+o)/2);for(;e<t[s]||e>=t[s+1];)e<t[s]?o=s:r=s,s=Math.floor((r+o)/2);return s}function Obe(n,e){let t=1;for(let r=2;r<=n;++r)t*=r;let i=1;for(let r=2;r<=e;++r)i*=r;for(let r=2;r<=n-e;++r)i*=r;return t/i}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;class Lbe extends ku{constructor(e,t,i,r,o){super();const s=t?t.length-1:0,a=i?i.length:0;this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=r||0,this.endKnot=o||s;for(let l=0;l<a;++l){const u=i[l];this.controlPoints[l]=new $n(u.x,u.y,u.z,u.w)}}getPoint(e,t=new U){const i=t,o=function Ibe(n,e,t,i){const r=Yg(n,i,e),o=function hy(n,e,t,i){const r=[],o=[],s=[];r[0]=1;for(let a=1;a<=t;++a){o[a]=e-i[n+1-a],s[a]=i[n+a]-e;let l=0;for(let u=0;u<a;++u){const c=s[u+1],f=o[a-u],h=r[u]/(c+f);r[u]=l+c*h,l=f*h}r[a]=l}return r}(r,i,n,e),s=new $n(0,0,0,0);for(let a=0;a<=n;++a){const l=t[r-n+a],u=o[a],c=l.w*u;s.x+=l.x*c,s.y+=l.y*c,s.z+=l.z*c,s.w+=l.w*u}return s}(this.degree,this.knots,this.controlPoints,this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]));return 1!==o.w&&o.divideScalar(o.w),i.set(o.x,o.y,o.z)}getTangent(e,t=new U){const i=t,o=function Fbe(n,e,t,i,r){const o=function Pbe(n,e,t,i,r){const o=r<n?r:n,s=[],a=Yg(n,i,e),l=function Rbe(n,e,t,i,r){const o=[];for(let f=0;f<=t;++f)o[f]=0;const s=[];for(let f=0;f<=i;++f)s[f]=o.slice(0);const a=[];for(let f=0;f<=t;++f)a[f]=o.slice(0);a[0][0]=1;const l=o.slice(0),u=o.slice(0);for(let f=1;f<=t;++f){l[f]=e-r[n+1-f],u[f]=r[n+f]-e;let h=0;for(let g=0;g<f;++g){const m=u[g+1],v=l[f-g];a[f][g]=m+v;const _=a[g][f-1]/a[f][g];a[g][f]=h+m*_,h=v*_}a[f][f]=h}for(let f=0;f<=t;++f)s[0][f]=a[f][t];for(let f=0;f<=t;++f){let h=0,g=1;const m=[];for(let v=0;v<=t;++v)m[v]=o.slice(0);m[0][0]=1;for(let v=1;v<=i;++v){let _=0;const y=f-v,w=t-v;f>=v&&(m[g][0]=m[h][0]/a[w+1][y],_=m[g][0]*a[y][w]);const M=f-1<=w?v-1:t-f;for(let E=y>=-1?1:-y;E<=M;++E)m[g][E]=(m[h][E]-m[h][E-1])/a[w+1][y+E],_+=m[g][E]*a[y+E][w];f<=w&&(m[g][v]=-m[h][v-1]/a[w+1][f],_+=m[g][v]*a[f][w]),s[v][f]=_;const D=h;h=g,g=D}}let c=t;for(let f=1;f<=i;++f){for(let h=0;h<=t;++h)s[f][h]*=c;c*=t-f}return s}(a,i,n,o,e),u=[];for(let c=0;c<t.length;++c){const f=t[c].clone(),h=f.w;f.x*=h,f.y*=h,f.z*=h,u[c]=f}for(let c=0;c<=o;++c){const f=u[a-n].clone().multiplyScalar(l[c][0]);for(let h=1;h<=n;++h)f.add(u[a-n+h].clone().multiplyScalar(l[c][h]));s[c]=f}for(let c=o+1;c<=r+1;++c)s[c]=new $n(0,0,0);return s}(n,e,t,i,r);return function Nbe(n){const e=n.length,t=[],i=[];for(let o=0;o<e;++o){const s=n[o];t[o]=new U(s.x,s.y,s.z),i[o]=s.w}const r=[];for(let o=0;o<e;++o){const s=t[o].clone();for(let a=1;a<=o;++a)s.sub(r[o-a].clone().multiplyScalar(Obe(o,a)*i[a]));r[o]=s.divideScalar(i[0])}return r}(o)}(this.degree,this.knots,this.controlPoints,this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),1);return i.copy(o[1]).normalize(),i}toJSON(){const e=super.toJSON();return e.degree=this.degree,e.knots=[...this.knots],e.controlPoints=this.controlPoints.map(t=>t.toArray()),e.startKnot=this.startKnot,e.endKnot=this.endKnot,e}fromJSON(e){return super.fromJSON(e),this.degree=e.degree,this.knots=[...e.knots],this.controlPoints=e.controlPoints.map(t=>new $n(t[0],t[1],t[2],t[3])),this.startKnot=e.startKnot,this.endKnot=e.endKnot,this}}let Ln,jr,ia;class kbe extends ts{constructor(e){super(e)}load(e,t,i,r){const o=this,s=""===o.path?Oh.extractUrlBase(e):o.path,a=new Vl(this.manager);a.setPath(o.path),a.setResponseType("arraybuffer"),a.setRequestHeader(o.requestHeader),a.setWithCredentials(o.withCredentials),a.load(e,function(l){try{t(o.parse(l,s))}catch(u){r?r(u):console.error(u),o.manager.itemError(e)}},i,r)}parse(e,t){if(function Gbe(n){const e="Kaydara FBX Binary  \0";return n.byteLength>=21&&e===Q$(n,0,21)}(e))Ln=(new zbe).parse(e);else{const r=Q$(e);if(!function jbe(n){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let t=0;function i(r){const o=n[r-1];return n=n.slice(t+r),t++,o}for(let r=0;r<e.length;++r)if(i(1)===e[r])return!1;return!0}(r))throw new Error("THREE.FBXLoader: Unknown format.");if(K$(r)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+K$(r));Ln=(new Hbe).parse(r)}const i=new aW(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new Bbe(i,this.manager).parse(Ln)}}class Bbe{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){jr=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),i=this.parseMaterials(t),r=this.parseDeformers(),o=(new Ube).parse(r);return this.parseScene(r,o,i),ia}parseConnections(){const e=new Map;return"Connections"in Ln&&Ln.Connections.connections.forEach(function(i){const r=i[0],o=i[1],s=i[2];e.has(r)||e.set(r,{parents:[],children:[]});const a={ID:o,relationship:s};e.get(r).parents.push(a),e.has(o)||e.set(o,{parents:[],children:[]});const l={ID:r,relationship:s};e.get(o).children.push(l)}),e}parseImages(){const e={},t={};if("Video"in Ln.Objects){const i=Ln.Objects.Video;for(const r in i){const o=i[r];if(e[parseInt(r)]=o.RelativeFilename||o.Filename,"Content"in o&&(o.Content instanceof ArrayBuffer&&o.Content.byteLength>0||"string"==typeof o.Content&&""!==o.Content)){const u=this.parseImage(i[r]);t[o.RelativeFilename||o.Filename]=u}}}for(const i in e){const r=e[i];e[i]=void 0!==t[r]?t[r]:e[i].split("\\").pop()}return e}parseImage(e){const t=e.Content,i=e.RelativeFilename||e.Filename,r=i.slice(i.lastIndexOf(".")+1).toLowerCase();let o;switch(r){case"bmp":o="image/bmp";break;case"jpg":case"jpeg":o="image/jpeg";break;case"png":o="image/png";break;case"tif":o="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",i),o="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+r+'" is not supported.')}if("string"==typeof t)return"data:"+o+";base64,"+t;{const s=new Uint8Array(t);return window.URL.createObjectURL(new Blob([s],{type:o}))}}parseTextures(e){const t=new Map;if("Texture"in Ln.Objects){const i=Ln.Objects.Texture;for(const r in i){const o=this.parseTexture(i[r],e);t.set(parseInt(r),o)}}return t}parseTexture(e,t){const i=this.loadTexture(e,t);i.ID=e.id,i.name=e.attrName;const r=e.WrapModeU,o=e.WrapModeV,a=void 0!==o?o.value:0;if(i.wrapS=0===(void 0!==r?r.value:0)?Dd:Aa,i.wrapT=0===a?Dd:Aa,"Scaling"in e){const l=e.Scaling.value;i.repeat.x=l[0],i.repeat.y=l[1]}if("Translation"in e){const l=e.Translation.value;i.offset.x=l[0],i.offset.y=l[1]}return i}loadTexture(e,t){const i=new Set(["tga","tif","tiff","exr","dds","hdr","ktx2"]),r=e.FileName.split(".").pop().toLowerCase(),o=i.has(r)?this.manager.getHandler(`.${r}`):this.textureLoader;if(!o)return console.warn(`FBXLoader: ${r.toUpperCase()} loader not found, creating placeholder texture for`,e.RelativeFilename),new Jo;const s=o.path;s||o.setPath(this.textureLoader.path);const a=jr.get(e.id).children;let l;void 0!==a&&a.length>0&&void 0!==t[a[0].ID]&&(l=t[a[0].ID],(0===l.indexOf("blob:")||0===l.indexOf("data:"))&&o.setPath(void 0));const u=o.load(l);return o.setPath(s),u}parseMaterials(e){const t=new Map;if("Material"in Ln.Objects){const i=Ln.Objects.Material;for(const r in i){const o=this.parseMaterial(i[r],e);null!==o&&t.set(parseInt(r),o)}}return t}parseMaterial(e,t){const i=e.id,r=e.attrName;let o=e.ShadingModel;if("object"==typeof o&&(o=o.value),!jr.has(i))return null;const s=this.parseParameters(e,t,i);let a;switch(o.toLowerCase()){case"phong":a=new ey;break;case"lambert":a=new Q6;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),a=new ey}return a.setValues(s),a.name=r,a}parseParameters(e,t,i){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=bn.toWorkingColorSpace((new Ke).fromArray(e.Diffuse.value),fi):e.DiffuseColor&&("Color"===e.DiffuseColor.type||"ColorRGB"===e.DiffuseColor.type)&&(r.color=bn.toWorkingColorSpace((new Ke).fromArray(e.DiffuseColor.value),fi)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=bn.toWorkingColorSpace((new Ke).fromArray(e.Emissive.value),fi):e.EmissiveColor&&("Color"===e.EmissiveColor.type||"ColorRGB"===e.EmissiveColor.type)&&(r.emissive=bn.toWorkingColorSpace((new Ke).fromArray(e.EmissiveColor.value),fi)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),r.opacity=1-(e.TransparencyFactor?parseFloat(e.TransparencyFactor.value):0),(1===r.opacity||0===r.opacity)&&(r.opacity=e.Opacity?parseFloat(e.Opacity.value):null,null===r.opacity&&(r.opacity=1-(e.TransparentColor?parseFloat(e.TransparentColor.value[0]):0))),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=bn.toWorkingColorSpace((new Ke).fromArray(e.Specular.value),fi):e.SpecularColor&&"Color"===e.SpecularColor.type&&(r.specular=bn.toWorkingColorSpace((new Ke).fromArray(e.SpecularColor.value),fi));const o=this;return jr.get(i).children.forEach(function(s){const a=s.relationship;switch(a){case"Bump":r.bumpMap=o.getTexture(t,s.ID);break;case"Maya|TEX_ao_map":r.aoMap=o.getTexture(t,s.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=o.getTexture(t,s.ID),void 0!==r.map&&(r.map.colorSpace=fi);break;case"DisplacementColor":r.displacementMap=o.getTexture(t,s.ID);break;case"EmissiveColor":r.emissiveMap=o.getTexture(t,s.ID),void 0!==r.emissiveMap&&(r.emissiveMap.colorSpace=fi);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=o.getTexture(t,s.ID);break;case"ReflectionColor":r.envMap=o.getTexture(t,s.ID),void 0!==r.envMap&&(r.envMap.mapping=303,r.envMap.colorSpace=fi);break;case"SpecularColor":r.specularMap=o.getTexture(t,s.ID),void 0!==r.specularMap&&(r.specularMap.colorSpace=fi);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=o.getTexture(t,s.ID),r.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",a)}}),r}getTexture(e,t){return"LayeredTexture"in Ln.Objects&&t in Ln.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=jr.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in Ln.Objects){const i=Ln.Objects.Deformer;for(const r in i){const o=i[r],s=jr.get(parseInt(r));if("Skin"===o.attrType){const a=this.parseSkeleton(s,i);a.ID=r,s.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),a.geometryID=s.parents[0].ID,e[r]=a}else if("BlendShape"===o.attrType){const a={id:r};a.rawTargets=this.parseMorphTargets(s,i),a.id=r,s.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=a}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const i=[];return e.children.forEach(function(r){const o=t[r.ID];if("Cluster"!==o.attrType)return;const s={ID:r.ID,indices:[],weights:[],transformLink:(new at).fromArray(o.TransformLink.a)};"Indexes"in o&&(s.indices=o.Indexes.a,s.weights=o.Weights.a),i.push(s)}),{rawBones:i,bones:[]}}parseMorphTargets(e,t){const i=[];for(let r=0;r<e.children.length;r++){const o=e.children[r],s=t[o.ID],a={name:s.attrName,initialWeight:s.DeformPercent,id:s.id,fullWeights:s.FullWeights.a};if("BlendShapeChannel"!==s.attrType)return;a.geoID=jr.get(parseInt(o.ID)).children.filter(function(l){return void 0===l.relationship})[0].ID,i.push(a)}return i}parseScene(e,t,i){ia=new Lu;const r=this.parseModels(e.skeletons,t,i),o=Ln.Objects.Model,s=this;r.forEach(function(l){s.setLookAtProperties(l,o[l.ID]),jr.get(l.ID).parents.forEach(function(f){const h=r.get(f.ID);void 0!==h&&h.add(l)}),null===l.parent&&ia.add(l)}),this.bindSkeleton(e.skeletons,t,r),this.addGlobalSceneSettings(),ia.traverse(function(l){if(l.userData.transformData){l.parent&&(l.userData.transformData.parentMatrix=l.parent.matrix,l.userData.transformData.parentMatrixWorld=l.parent.matrixWorld);const u=J$(l.userData.transformData);l.applyMatrix4(u),l.updateWorldMatrix()}});const a=(new Vbe).parse();1===ia.children.length&&ia.children[0].isGroup&&(ia.children[0].animations=a,ia=ia.children[0]),ia.animations=a}parseModels(e,t,i){const r=new Map,o=Ln.Objects.Model;for(const s in o){const a=parseInt(s),l=o[s],u=jr.get(a);let c=this.buildSkeleton(u,e,a,l.attrName);if(!c){switch(l.attrType){case"Camera":c=this.createCamera(u);break;case"Light":c=this.createLight(u);break;case"Mesh":c=this.createMesh(u,t,i);break;case"NurbsCurve":c=this.createCurve(u,t);break;case"LimbNode":case"Root":c=new Kw;break;default:c=new Lu}c.name=l.attrName?wi.sanitizeNodeName(l.attrName):"",c.userData.originalName=l.attrName,c.ID=a}this.getTransformData(c,l),r.set(a,c)}return r}buildSkeleton(e,t,i,r){let o=null;return e.parents.forEach(function(s){for(const a in t){const l=t[a];l.rawBones.forEach(function(u,c){if(u.ID===s.ID){const f=o;o=new Kw,o.matrixWorld.copy(u.transformLink),o.name=r?wi.sanitizeNodeName(r):"",o.userData.originalName=r,o.ID=i,l.bones[c]=o,null!==f&&o.add(f)}})}}),o}createCamera(e){let t,i;if(e.children.forEach(function(r){const o=Ln.Objects.NodeAttribute[r.ID];void 0!==o&&(i=o)}),void 0===i)t=new mi;else{let r=0;void 0!==i.CameraProjectionType&&1===i.CameraProjectionType.value&&(r=1);let o=1;void 0!==i.NearPlane&&(o=i.NearPlane.value/1e3);let s=1e3;void 0!==i.FarPlane&&(s=i.FarPlane.value/1e3);let a=window.innerWidth,l=window.innerHeight;void 0!==i.AspectWidth&&void 0!==i.AspectHeight&&(a=i.AspectWidth.value,l=i.AspectHeight.value);const u=a/l;let c=45;void 0!==i.FieldOfView&&(c=i.FieldOfView.value);const f=i.FocalLength?i.FocalLength.value:null;switch(r){case 0:t=new bo(c,u,o,s),null!==f&&t.setFocalLength(f);break;case 1:console.warn("THREE.FBXLoader: Orthographic cameras not supported yet."),t=new mi;break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),t=new mi}}return t}createLight(e){let t,i;if(e.children.forEach(function(r){const o=Ln.Objects.NodeAttribute[r.ID];void 0!==o&&(i=o)}),void 0===i)t=new mi;else{let r;r=void 0===i.LightType?0:i.LightType.value;let o=16777215;void 0!==i.Color&&(o=bn.toWorkingColorSpace((new Ke).fromArray(i.Color.value),fi));let s=void 0===i.Intensity?1:i.Intensity.value/100;void 0!==i.CastLightOnObject&&0===i.CastLightOnObject.value&&(s=0);let a=0;void 0!==i.FarAttenuationEnd&&(a=void 0!==i.EnableFarAttenuation&&0===i.EnableFarAttenuation.value?0:i.FarAttenuationEnd.value);const l=1;switch(r){case 0:t=new M1(o,s,a,l);break;case 1:t=new dF(o,s);break;case 2:let u=Math.PI/3;void 0!==i.InnerAngle&&(u=Pr_degToRad(i.InnerAngle.value));let c=0;void 0!==i.OuterAngle&&(c=Pr_degToRad(i.OuterAngle.value),c=Math.max(c,1)),t=new uF(o,s,a,u,c,l);break;default:console.warn("THREE.FBXLoader: Unknown light type "+i.LightType.value+", defaulting to a PointLight."),t=new M1(o,s)}void 0!==i.CastShadows&&1===i.CastShadows.value&&(t.castShadow=!0)}return t}createMesh(e,t,i){let r,o=null,s=null;const a=[];if(e.children.forEach(function(l){t.has(l.ID)&&(o=t.get(l.ID)),i.has(l.ID)&&a.push(i.get(l.ID))}),a.length>1?s=a:a.length>0?s=a[0]:(s=new ey({name:ts.DEFAULT_MATERIAL_NAME,color:13421772}),a.push(s)),"color"in o.attributes&&a.forEach(function(l){l.vertexColors=!0}),o.groups.length>0){let l=!1;for(let u=0,c=o.groups.length;u<c;u++){const f=o.groups[u];(f.materialIndex<0||f.materialIndex>=a.length)&&(f.materialIndex=a.length,l=!0)}if(l){const u=new ey;a.push(u)}}return o.FBX_Deformer?(r=new IN(o,s),r.normalizeSkinWeights()):r=new yr(o,s),r}createCurve(e,t){const i=e.children.reduce(function(o,s){return t.has(s.ID)&&(o=t.get(s.ID)),o},null),r=new wo({name:ts.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new Vd(i,r)}getTransformData(e,t){const i={};"InheritType"in t&&(i.inheritType=parseInt(t.InheritType.value)),i.eulerOrder=Mx("RotationOrder"in t?t.RotationOrder.value:0),"Lcl_Translation"in t&&(i.translation=t.Lcl_Translation.value),"PreRotation"in t&&(i.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(i.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(i.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(i.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(i.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(i.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(i.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(i.rotationPivot=t.RotationPivot.value),e.userData.transformData=i}setLookAtProperties(e,t){"LookAtProperty"in t&&jr.get(e.ID).children.forEach(function(r){if("LookAtProperty"===r.relationship){const o=Ln.Objects.Model[r.ID];if("Lcl_Translation"in o){const s=o.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(s),ia.add(e.target)):e.lookAt((new U).fromArray(s))}}})}bindSkeleton(e,t,i){const r=this.parsePoseNodes();for(const o in e){const s=e[o];jr.get(parseInt(s.ID)).parents.forEach(function(l){t.has(l.ID)&&jr.get(l.ID).parents.forEach(function(f){i.has(f.ID)&&i.get(f.ID).bind(new Jw(s.bones),r[f.ID])})})}}parsePoseNodes(){const e={};if("Pose"in Ln.Objects){const t=Ln.Objects.Pose;for(const i in t)if("BindPose"===t[i].attrType&&t[i].NbPoseNodes>0){const r=t[i].PoseNode;Array.isArray(r)?r.forEach(function(o){e[o.Node]=(new at).fromArray(o.Matrix.a)}):e[r.Node]=(new at).fromArray(r.Matrix.a)}}return e}addGlobalSceneSettings(){if("GlobalSettings"in Ln){if("AmbientColor"in Ln.GlobalSettings){const e=Ln.GlobalSettings.AmbientColor.value,t=e[0],i=e[1],r=e[2];if(0!==t||0!==i||0!==r){const o=(new Ke).setRGB(t,i,r,fi);ia.add(new fW(o,1))}}"UnitScaleFactor"in Ln.GlobalSettings&&(ia.userData.unitScaleFactor=Ln.GlobalSettings.UnitScaleFactor.value)}}}class Ube{constructor(){this.negativeMaterialIndices=!1}parse(e){const t=new Map;if("Geometry"in Ln.Objects){const i=Ln.Objects.Geometry;for(const r in i){const o=jr.get(parseInt(r)),s=this.parseGeometry(o,i[r],e);t.set(parseInt(r),s)}}return!0===this.negativeMaterialIndices&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),t}parseGeometry(e,t,i){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,i);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,i){const r=i.skeletons,o=[],s=e.parents.map(function(f){return Ln.Objects.Model[f.ID]});if(0===s.length)return;const a=e.children.reduce(function(f,h){return void 0!==r[h.ID]&&(f=r[h.ID]),f},null);e.children.forEach(function(f){void 0!==i.morphTargets[f.ID]&&o.push(i.morphTargets[f.ID])});const l=s[0],u={};"RotationOrder"in l&&(u.eulerOrder=Mx(l.RotationOrder.value)),"InheritType"in l&&(u.inheritType=parseInt(l.InheritType.value)),"GeometricTranslation"in l&&(u.translation=l.GeometricTranslation.value),"GeometricRotation"in l&&(u.rotation=l.GeometricRotation.value),"GeometricScaling"in l&&(u.scale=l.GeometricScaling.value);const c=J$(u);return this.genGeometry(t,a,o,c)}genGeometry(e,t,i,r){const o=new cn;e.attrName&&(o.name=e.attrName);const s=this.parseGeoNode(e,t),a=this.genBuffers(s),l=new it(a.vertex,3);if(l.applyMatrix4(r),o.setAttribute("position",l),a.colors.length>0&&o.setAttribute("color",new it(a.colors,3)),t&&(o.setAttribute("skinIndex",new bN(a.weightsIndices,4)),o.setAttribute("skinWeight",new it(a.vertexWeights,4)),o.FBX_Deformer=t),a.normal.length>0){const u=(new vn).getNormalMatrix(r),c=new it(a.normal,3);c.applyNormalMatrix(u),o.setAttribute("normal",c)}if(a.uvs.forEach(function(u,c){o.setAttribute(0===c?"uv":`uv${c}`,new it(a.uvs[c],2))}),s.material&&"AllSame"!==s.material.mappingType){let u=a.materialIndex[0],c=0;if(a.materialIndex.forEach(function(f,h){f!==u&&(o.addGroup(c,h-c,u),u=f,c=h)}),o.groups.length>0){const f=o.groups[o.groups.length-1],h=f.start+f.count;h!==a.materialIndex.length&&o.addGroup(h,a.materialIndex.length-h,u)}0===o.groups.length&&o.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(o,e,i,r),o}parseGeoNode(e,t){const i={};if(i.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],i.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(i.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(i.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(i.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){i.uv=[];let r=0;for(;e.LayerElementUV[r];)e.LayerElementUV[r].UV&&i.uv.push(this.parseUVs(e.LayerElementUV[r])),r++}return i.weightTable={},null!==t&&(i.skeleton=t,t.rawBones.forEach(function(r,o){r.indices.forEach(function(s,a){void 0===i.weightTable[s]&&(i.weightTable[s]=[]),i.weightTable[s].push({id:o,weight:r.weights[a]})})})),i}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let i=0,r=0,o=!1,s=[],a=[],l=[],u=[],c=[],f=[];const h=this;return e.vertexIndices.forEach(function(g,m){let v,_=!1;g<0&&(g=~g,_=!0);let y=[],w=[];if(s.push(3*g,3*g+1,3*g+2),e.color){const x=Q1(m,i,g,e.color);l.push(x[0],x[1],x[2])}if(e.skeleton){if(void 0!==e.weightTable[g]&&e.weightTable[g].forEach(function(x){w.push(x.weight),y.push(x.id)}),w.length>4){o||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),o=!0);const x=[0,0,0,0],M=[0,0,0,0];w.forEach(function(D,E){let I=D,R=y[E];M.forEach(function(S,T,z){if(I>S){z[T]=I,I=S;const Z=x[T];x[T]=R,R=Z}})}),y=x,w=M}for(;w.length<4;)w.push(0),y.push(0);for(let x=0;x<4;++x)c.push(w[x]),f.push(y[x])}if(e.normal){const x=Q1(m,i,g,e.normal);a.push(x[0],x[1],x[2])}e.material&&"AllSame"!==e.material.mappingType&&(v=Q1(m,i,g,e.material)[0],v<0&&(h.negativeMaterialIndices=!0,v=0)),e.uv&&e.uv.forEach(function(x,M){const D=Q1(m,i,g,x);void 0===u[M]&&(u[M]=[]),u[M].push(D[0]),u[M].push(D[1])}),r++,_&&(h.genFace(t,e,s,v,a,l,u,c,f,r),i++,r=0,s=[],a=[],l=[],u=[],c=[],f=[])}),t}getNormalNewell(e){const t=new U(0,0,0);for(let i=0;i<e.length;i++){const r=e[i],o=e[(i+1)%e.length];t.x+=(r.y-o.y)*(r.z+o.z),t.y+=(r.z-o.z)*(r.x+o.x),t.z+=(r.x-o.x)*(r.y+o.y)}return t.normalize(),t}getNormalTangentAndBitangent(e){const t=this.getNormalNewell(e),r=(Math.abs(t.z)>.5?new U(0,1,0):new U(0,0,1)).cross(t).normalize(),o=t.clone().cross(r).normalize();return{normal:t,tangent:r,bitangent:o}}flattenVertex(e,t,i){return new xe(e.dot(t),e.dot(i))}genFace(e,t,i,r,o,s,a,l,u,c){let f;if(c>3){const h=[],g=t.baseVertexPositions||t.vertexPositions;for(let y=0;y<i.length;y+=3)h.push(new U(g[i[y]],g[i[y+1]],g[i[y+2]]));const{tangent:m,bitangent:v}=this.getNormalTangentAndBitangent(h),_=[];for(const y of h)_.push(this.flattenVertex(y,m,v));f=Bu.triangulateShape(_,[])}else f=[[0,1,2]];for(const[h,g,m]of f)e.vertex.push(t.vertexPositions[i[3*h]]),e.vertex.push(t.vertexPositions[i[3*h+1]]),e.vertex.push(t.vertexPositions[i[3*h+2]]),e.vertex.push(t.vertexPositions[i[3*g]]),e.vertex.push(t.vertexPositions[i[3*g+1]]),e.vertex.push(t.vertexPositions[i[3*g+2]]),e.vertex.push(t.vertexPositions[i[3*m]]),e.vertex.push(t.vertexPositions[i[3*m+1]]),e.vertex.push(t.vertexPositions[i[3*m+2]]),t.skeleton&&(e.vertexWeights.push(l[4*h]),e.vertexWeights.push(l[4*h+1]),e.vertexWeights.push(l[4*h+2]),e.vertexWeights.push(l[4*h+3]),e.vertexWeights.push(l[4*g]),e.vertexWeights.push(l[4*g+1]),e.vertexWeights.push(l[4*g+2]),e.vertexWeights.push(l[4*g+3]),e.vertexWeights.push(l[4*m]),e.vertexWeights.push(l[4*m+1]),e.vertexWeights.push(l[4*m+2]),e.vertexWeights.push(l[4*m+3]),e.weightsIndices.push(u[4*h]),e.weightsIndices.push(u[4*h+1]),e.weightsIndices.push(u[4*h+2]),e.weightsIndices.push(u[4*h+3]),e.weightsIndices.push(u[4*g]),e.weightsIndices.push(u[4*g+1]),e.weightsIndices.push(u[4*g+2]),e.weightsIndices.push(u[4*g+3]),e.weightsIndices.push(u[4*m]),e.weightsIndices.push(u[4*m+1]),e.weightsIndices.push(u[4*m+2]),e.weightsIndices.push(u[4*m+3])),t.color&&(e.colors.push(s[3*h]),e.colors.push(s[3*h+1]),e.colors.push(s[3*h+2]),e.colors.push(s[3*g]),e.colors.push(s[3*g+1]),e.colors.push(s[3*g+2]),e.colors.push(s[3*m]),e.colors.push(s[3*m+1]),e.colors.push(s[3*m+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(o[3*h]),e.normal.push(o[3*h+1]),e.normal.push(o[3*h+2]),e.normal.push(o[3*g]),e.normal.push(o[3*g+1]),e.normal.push(o[3*g+2]),e.normal.push(o[3*m]),e.normal.push(o[3*m+1]),e.normal.push(o[3*m+2])),t.uv&&t.uv.forEach(function(v,_){void 0===e.uvs[_]&&(e.uvs[_]=[]),e.uvs[_].push(a[_][2*h]),e.uvs[_].push(a[_][2*h+1]),e.uvs[_].push(a[_][2*g]),e.uvs[_].push(a[_][2*g+1]),e.uvs[_].push(a[_][2*m]),e.uvs[_].push(a[_][2*m+1])})}addMorphTargets(e,t,i,r){if(0===i.length)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const o=this;i.forEach(function(s){s.rawTargets.forEach(function(a){const l=Ln.Objects.Geometry[a.geoID];void 0!==l&&o.genMorphGeometry(e,t,l,r,a.name)})})}genMorphGeometry(e,t,i,r,o){const s=void 0!==t.Vertices?t.Vertices.a:[],a=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],l=void 0!==i.Vertices?i.Vertices.a:[],u=void 0!==i.Indexes?i.Indexes.a:[],f=new Float32Array(3*e.attributes.position.count);for(let v=0;v<u.length;v++){const _=3*u[v];f[_]=l[3*v],f[_+1]=l[3*v+1],f[_+2]=l[3*v+2]}const g=this.genBuffers({vertexIndices:a,vertexPositions:f,baseVertexPositions:s}),m=new it(g.vertex,3);m.name=o||i.attrName,m.applyMatrix4(r),e.morphAttributes.position.push(m)}parseNormals(e){const i=e.ReferenceInformationType;let o=[];return"IndexToDirect"===i&&("NormalIndex"in e?o=e.NormalIndex.a:"NormalsIndex"in e&&(o=e.NormalsIndex.a)),{dataSize:3,buffer:e.Normals.a,indices:o,mappingType:e.MappingInformationType,referenceType:i}}parseUVs(e){const i=e.ReferenceInformationType;let o=[];return"IndexToDirect"===i&&(o=e.UVIndex.a),{dataSize:2,buffer:e.UV.a,indices:o,mappingType:e.MappingInformationType,referenceType:i}}parseVertexColors(e){const t=e.MappingInformationType,i=e.ReferenceInformationType,r=e.Colors.a;let o=[];"IndexToDirect"===i&&(o=e.ColorIndex.a);for(let s=0,a=new Ke;s<r.length;s+=4)a.fromArray(r,s),bn.toWorkingColorSpace(a,fi),a.toArray(r,s);return{dataSize:4,buffer:r,indices:o,mappingType:t,referenceType:i}}parseMaterialIndices(e){const t=e.MappingInformationType,i=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:i};const r=e.Materials.a,o=[];for(let s=0;s<r.length;++s)o.push(s);return{dataSize:1,buffer:r,indices:o,mappingType:t,referenceType:i}}parseNurbsGeometry(e){const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new cn;const i=t-1,r=e.KnotVector.a,o=[],s=e.Points.a;for(let f=0,h=s.length;f<h;f+=4)o.push((new $n).fromArray(s,f));let a,l;if("Closed"===e.Form)o.push(o[0]);else if("Periodic"===e.Form){a=i,l=r.length-1-a;for(let f=0;f<i;++f)o.push(o[f])}const c=new Lbe(i,r,o,a,l).getPoints(12*o.length);return(new cn).setFromPoints(c)}}class Vbe{parse(){const e=[],t=this.parseClips();if(void 0!==t)for(const i in t){const o=this.addClip(t[i]);e.push(o)}return e}parseClips(){if(void 0===Ln.Objects.AnimationCurve)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=Ln.Objects.AnimationCurveNode,t=new Map;for(const i in e){const r=e[i];if(null!==r.attrName.match(/S|R|T|DeformPercent/)){const o={id:r.id,attr:r.attrName,curves:{}};t.set(o.id,o)}}return t}parseAnimationCurves(e){const t=Ln.Objects.AnimationCurve;for(const i in t){const r={id:t[i].id,times:t[i].KeyTime.a.map(Wbe),values:t[i].KeyValueFloat.a},o=jr.get(r.id);if(void 0!==o){const s=o.parents[0].ID,a=o.parents[0].relationship;a.match(/X/)?e.get(s).curves.x=r:a.match(/Y/)?e.get(s).curves.y=r:a.match(/Z/)?e.get(s).curves.z=r:a.match(/DeformPercent/)&&e.has(s)&&(e.get(s).curves.morph=r)}}}parseAnimationLayers(e){const t=Ln.Objects.AnimationLayer,i=new Map;for(const r in t){const o=[],s=jr.get(parseInt(r));void 0!==s&&(s.children.forEach(function(l,u){if(e.has(l.ID)){const c=e.get(l.ID);if(void 0!==c.curves.x||void 0!==c.curves.y||void 0!==c.curves.z){if(void 0===o[u]){const f=jr.get(l.ID).parents.filter(function(h){return void 0!==h.relationship})[0].ID;if(void 0!==f){const h=Ln.Objects.Model[f.toString()];if(void 0===h)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",l);const g={modelName:h.attrName?wi.sanitizeNodeName(h.attrName):"",ID:h.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};ia.traverse(function(m){m.ID===h.id&&(g.transform=m.matrix,m.userData.transformData&&(g.eulerOrder=m.userData.transformData.eulerOrder))}),g.transform||(g.transform=new at),"PreRotation"in h&&(g.preRotation=h.PreRotation.value),"PostRotation"in h&&(g.postRotation=h.PostRotation.value),o[u]=g}}o[u]&&(o[u][c.attr]=c)}else if(void 0!==c.curves.morph){if(void 0===o[u]){const f=jr.get(l.ID).parents.filter(function(y){return void 0!==y.relationship})[0].ID,h=jr.get(f).parents[0].ID,g=jr.get(h).parents[0].ID,m=jr.get(g).parents[0].ID,v=Ln.Objects.Model[m],_={modelName:v.attrName?wi.sanitizeNodeName(v.attrName):"",morphName:Ln.Objects.Deformer[f].attrName};o[u]=_}o[u][c.attr]=c}}}),i.set(parseInt(r),o))}return i}parseAnimStacks(e){const t=Ln.Objects.AnimationStack,i={};for(const r in t){const o=jr.get(parseInt(r)).children;o.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const s=e.get(o[0].ID);i[r]={name:t[r].attrName,layer:s}}return i}addClip(e){let t=[];const i=this;return e.layer.forEach(function(r){t=t.concat(i.generateTracks(r))}),new iy(e.name,-1,t)}generateTracks(e){const t=[];let i=new U,r=new U;if(e.transform&&e.transform.decompose(i,new hr,r),i=i.toArray(),r=r.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.T.curves,i,"position");void 0!==o&&t.push(o)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){const o=this.generateRotationTrack(e.modelName,e.R.curves,e.preRotation,e.postRotation,e.eulerOrder);void 0!==o&&t.push(o)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.S.curves,r,"scale");void 0!==o&&t.push(o)}if(void 0!==e.DeformPercent){const o=this.generateMorphTrack(e);void 0!==o&&t.push(o)}return t}generateVectorTrack(e,t,i,r){const o=this.getTimesForAllAxes(t),s=this.getKeyframeTrackValues(o,t,i);return new kg(e+"."+r,o,s)}generateRotationTrack(e,t,i,r,o){let s,a;if(void 0!==t.x&&void 0!==t.y&&void 0!==t.z){const h=this.interpolateRotations(t.x,t.y,t.z,o);s=h[0],a=h[1]}const l=Mx(0);void 0!==i&&((i=i.map(Pr_degToRad)).push(l),i=(new As).fromArray(i),i=(new hr).setFromEuler(i)),void 0!==r&&((r=r.map(Pr_degToRad)).push(l),r=(new As).fromArray(r),r=(new hr).setFromEuler(r).invert());const u=new hr,c=new As,f=[];if(!a||!s)return new Rh(e+".quaternion",[0],[0]);for(let h=0;h<a.length;h+=3)c.set(a[h],a[h+1],a[h+2],o),u.setFromEuler(c),void 0!==i&&u.premultiply(i),void 0!==r&&u.multiply(r),h>2&&(new hr).fromArray(f,(h-3)/3*4).dot(u)<0&&u.set(-u.x,-u.y,-u.z,-u.w),u.toArray(f,h/3*4);return new Rh(e+".quaternion",s,f)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,i=t.values.map(function(o){return o/100}),r=ia.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new Lg(e.modelName+".morphTargetInfluences["+r+"]",t.times,i)}getTimesForAllAxes(e){let t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(i,r){return i-r}),t.length>1){let i=1,r=t[0];for(let o=1;o<t.length;o++){const s=t[o];s!==r&&(t[i]=s,r=s,i++)}t=t.slice(0,i)}return t}getKeyframeTrackValues(e,t,i){const r=i,o=[];let s=-1,a=-1,l=-1;return e.forEach(function(u){if(t.x&&(s=t.x.times.indexOf(u)),t.y&&(a=t.y.times.indexOf(u)),t.z&&(l=t.z.times.indexOf(u)),-1!==s){const c=t.x.values[s];o.push(c),r[0]=c}else o.push(r[0]);if(-1!==a){const c=t.y.values[a];o.push(c),r[1]=c}else o.push(r[1]);if(-1!==l){const c=t.z.values[l];o.push(c),r[2]=c}else o.push(r[2])}),o}interpolateRotations(e,t,i,r){const o=[],s=[];o.push(e.times[0]),s.push(Pr_degToRad(e.values[0])),s.push(Pr_degToRad(t.values[0])),s.push(Pr_degToRad(i.values[0]));for(let a=1;a<e.values.length;a++){const l=[e.values[a-1],t.values[a-1],i.values[a-1]];if(isNaN(l[0])||isNaN(l[1])||isNaN(l[2]))continue;const u=l.map(Pr_degToRad),c=[e.values[a],t.values[a],i.values[a]];if(isNaN(c[0])||isNaN(c[1])||isNaN(c[2]))continue;const f=c.map(Pr_degToRad),h=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],g=[Math.abs(h[0]),Math.abs(h[1]),Math.abs(h[2])];if(g[0]>=180||g[1]>=180||g[2]>=180){const v=Math.max(...g)/180,_=new As(...u,r),y=new As(...f,r),w=(new hr).setFromEuler(_),x=(new hr).setFromEuler(y);w.dot(x)&&x.set(-x.x,-x.y,-x.z,-x.w);const M=e.times[a-1],D=e.times[a]-M,E=new hr,I=new As;for(let R=0;R<1;R+=1/v)E.copy(w.clone().slerp(x.clone(),R)),o.push(M+R*D),I.setFromQuaternion(E,r),s.push(I.x),s.push(I.y),s.push(I.z)}else o.push(e.times[a]),s.push(Pr_degToRad(e.values[a])),s.push(Pr_degToRad(t.values[a])),s.push(Pr_degToRad(i.values[a]))}return[o,s]}}class Hbe{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new Z$,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,i=e.split(/[\r\n]+/);return i.forEach(function(r,o){const s=r.match(/^[\s\t]*;/),a=r.match(/^[\s\t]*$/);if(s||a)return;const l=r.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),u=r.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),c=r.match("^\\t{"+(t.currentIndent-1)+"}}");l?t.parseNodeBegin(r,l):u?t.parseNodeProperty(r,u,i[++o]):c?t.popStack():r.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(r)}),this.allNodes}parseNodeBegin(e,t){const i=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map(function(l){return l.trim().replace(/^"/,"").replace(/"$/,"")}),o={name:i},s=this.parseNodeAttr(r),a=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(i,o):i in a?("PoseNode"===i?a.PoseNode.push(o):void 0!==a[i].id&&(a[i]={},a[i][a[i].id]=a[i]),""!==s.id&&(a[i][s.id]=o)):"number"==typeof s.id?(a[i]={},a[i][s.id]=o):"Properties70"!==i&&(a[i]="PoseNode"===i?[o]:o),"number"==typeof s.id&&(o.id=s.id),""!==s.name&&(o.attrName=s.name),""!==s.type&&(o.attrType=s.type),this.pushStack(o)}parseNodeAttr(e){let t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let i="",r="";return e.length>1&&(i=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:i,type:r}}parseNodeProperty(e,t,i){let r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),o=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===r&&","===o&&(o=i.replace(/"/g,"").replace(/,$/,"").trim());const s=this.getCurrentNode();if("Properties70"!==s.name){if("C"===r){const l=o.split(",").slice(1),u=parseInt(l[0]),c=parseInt(l[1]);let f=o.split(",").slice(3);f=f.map(function(h){return h.trim().replace(/^"/,"")}),r="connections",o=[u,c],function qbe(n,e){for(let t=0,i=n.length,r=e.length;t<r;t++,i++)n[i]=e[t]}(o,f),void 0===s[r]&&(s[r]=[])}"Node"===r&&(s.id=o),r in s&&Array.isArray(s[r])?s[r].push(o):"a"!==r?s[r]=o:s.a=o,this.setCurrentProp(s,r),"a"===r&&","!==o.slice(-1)&&(s.a=ZF(o))}else this.parseNodeSpecialProperty(e,r,o)}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=ZF(t.a))}parseNodeSpecialProperty(e,t,i){const r=i.split('",').map(function(c){return c.trim().replace(/^\"/,"").replace(/\s/,"_")}),o=r[0],s=r[1],a=r[2],l=r[3];let u=r[4];switch(s){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":u=parseFloat(u);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":u=ZF(u)}this.getPrevNode()[o]={type:s,type2:a,flag:l,value:u},this.setCurrentProp(this.getPrevNode(),o)}}class zbe{parse(e){const t=new Y$(e);t.skip(23);const i=t.getUint32();if(i<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+i);const r=new Z$;for(;!this.endOfContent(t);){const o=this.parseNode(t,i);null!==o&&r.add(o.name,o)}return r}endOfContent(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const i={},r=t>=7500?e.getUint64():e.getUint32(),o=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const s=e.getUint8(),a=e.getString(s);if(0===r)return null;const l=[];for(let h=0;h<o;h++)l.push(this.parseProperty(e));const u=l.length>0?l[0]:"",c=l.length>1?l[1]:"",f=l.length>2?l[2]:"";for(i.singleProperty=1===o&&e.getOffset()===r;r>e.getOffset();){const h=this.parseNode(e,t);null!==h&&this.parseSubNode(a,i,h)}return i.propertyList=l,"number"==typeof u&&(i.id=u),""!==c&&(i.attrName=c),""!==f&&(i.attrType=f),""!==a&&(i.name=a),i}parseSubNode(e,t,i){if(!0===i.singleProperty){const r=i.propertyList[0];Array.isArray(r)?(t[i.name]=i,i.a=r):t[i.name]=r}else if("Connections"===e&&"C"===i.name){const r=[];i.propertyList.forEach(function(o,s){0!==s&&r.push(o)}),void 0===t.connections&&(t.connections=[]),t.connections.push(r)}else if("Properties70"===i.name)Object.keys(i).forEach(function(o){t[o]=i[o]});else if("Properties70"===e&&"P"===i.name){let r=i.propertyList[0],o=i.propertyList[1];const s=i.propertyList[2],a=i.propertyList[3];let l;0===r.indexOf("Lcl ")&&(r=r.replace("Lcl ","Lcl_")),0===o.indexOf("Lcl ")&&(o=o.replace("Lcl ","Lcl_")),l="Color"===o||"ColorRGB"===o||"Vector"===o||"Vector3D"===o||0===o.indexOf("Lcl_")?[i.propertyList[4],i.propertyList[5],i.propertyList[6]]:i.propertyList[4],t[r]={type:o,type2:s,flag:a,value:l}}else void 0===t[i.name]?"number"==typeof i.id?(t[i.name]={},t[i.name][i.id]=i):t[i.name]=i:"PoseNode"===i.name?(Array.isArray(t[i.name])||(t[i.name]=[t[i.name]]),t[i.name].push(i)):void 0===t[i.name][i.id]&&(t[i.name][i.id]=i)}parseProperty(e){const t=e.getString(1);let i;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return i=e.getUint32(),e.getArrayBuffer(i);case"S":return i=e.getUint32(),e.getString(i);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=e.getUint32(),o=e.getUint32(),s=e.getUint32();if(0===o)switch(t){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}const a=Y1(new Uint8Array(e.getArrayBuffer(s))),l=new Y$(a.buffer);switch(t){case"b":case"c":return l.getBooleanArray(r);case"d":return l.getFloat64Array(r);case"f":return l.getFloat32Array(r);case"i":return l.getInt32Array(r);case"l":return l.getInt64Array(r)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class Y${constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return!(1&~this.getUint8())}getBooleanArray(e){const t=[];for(let i=0;i<e;i++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,e=4294967295&~e,4294967295===e&&(t=t+1&4294967295),e=e+1&4294967295,-(4294967296*t+e)):4294967296*t+e}getInt64Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){const t=this.offset;let i=new Uint8Array(this.dv.buffer,t,e);this.skip(e);const r=i.indexOf(0);return r>=0&&(i=new Uint8Array(this.dv.buffer,t,r)),this._textDecoder.decode(i)}}class Z${add(e,t){this[e]=t}}function K$(n){const t=n.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function Wbe(n){return n/46186158e3}const $be=[];function Q1(n,e,t,i){let r;switch(i.mappingType){case"ByPolygonVertex":r=n;break;case"ByPolygon":r=e;break;case"ByVertice":r=t;break;case"AllSame":r=i.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+i.mappingType)}"IndexToDirect"===i.referenceType&&(r=i.indices[r]);const o=r*i.dataSize;return function Xbe(n,e,t,i){for(let r=t,o=0;r<i;r++,o++)n[o]=e[r];return n}($be,i.buffer,o,o+i.dataSize)}const YF=new As,py=new U;function J$(n){const e=new at,t=new at,i=new at,r=new at,o=new at,s=new at,a=new at,l=new at,u=new at,c=new at,f=new at,h=new at,g=n.inheritType?n.inheritType:0;n.translation&&e.setPosition(py.fromArray(n.translation));const m=Mx(0);if(n.preRotation){const z=n.preRotation.map(Pr_degToRad);z.push(m),t.makeRotationFromEuler(YF.fromArray(z))}if(n.rotation){const z=n.rotation.map(Pr_degToRad);z.push(n.eulerOrder||m),i.makeRotationFromEuler(YF.fromArray(z))}if(n.postRotation){const z=n.postRotation.map(Pr_degToRad);z.push(m),r.makeRotationFromEuler(YF.fromArray(z)),r.invert()}n.scale&&o.scale(py.fromArray(n.scale)),n.scalingOffset&&a.setPosition(py.fromArray(n.scalingOffset)),n.scalingPivot&&s.setPosition(py.fromArray(n.scalingPivot)),n.rotationOffset&&l.setPosition(py.fromArray(n.rotationOffset)),n.rotationPivot&&u.setPosition(py.fromArray(n.rotationPivot)),n.parentMatrixWorld&&(f.copy(n.parentMatrix),c.copy(n.parentMatrixWorld));const v=t.clone().multiply(i).multiply(r),_=new at;_.extractRotation(c);const y=new at;y.copyPosition(c);const w=y.clone().invert().multiply(c),x=_.clone().invert().multiply(w),M=o,D=new at;if(0===g)D.copy(_).multiply(v).multiply(x).multiply(M);else if(1===g)D.copy(_).multiply(x).multiply(v).multiply(M);else{const Z=(new at).scale((new U).setFromMatrixScale(f)).clone().invert(),J=x.clone().multiply(Z);D.copy(_).multiply(v).multiply(J).multiply(M)}const E=u.clone().invert(),I=s.clone().invert();let R=e.clone().multiply(l).multiply(u).multiply(t).multiply(i).multiply(r).multiply(E).multiply(a).multiply(s).multiply(o).multiply(I);const S=(new at).copyPosition(R),T=c.clone().multiply(S);return h.copyPosition(T),R=h.clone().multiply(D),R.premultiply(c.invert()),R}function Mx(n){const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(n=n||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[n]}function ZF(n){return n.split(",").map(function(t){return parseFloat(t)})}function Q$(n,e,t){return void 0===e&&(e=0),void 0===t&&(t=n.byteLength),(new TextDecoder).decode(new Uint8Array(n,e,t))}const Zbe=/^[og]\s*(.+)?/,Kbe=/^mtllib /,Jbe=/^usemtl /,Qbe=/^usemap /,e7=/\s+/,t7=new U,KF=new U,n7=new U,i7=new U,Gl=new U,eA=new Ke;function ewe(){const n={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);const i=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(r,o){const s=this._finalize(!1);s&&(s.inherited||s.groupCount<=0)&&this.materials.splice(s.index,1);const a={index:this.materials.length,name:r||"",mtllib:Array.isArray(o)&&o.length>0?o[o.length-1]:"",smooth:void 0!==s?s.smooth:this.smooth,groupStart:void 0!==s?s.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(l){const u={index:"number"==typeof l?l:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return u.clone=this.clone.bind(u),u}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(r){const o=this.currentMaterial();if(o&&-1===o.groupEnd&&(o.groupEnd=this.geometry.vertices.length/3,o.groupCount=o.groupEnd-o.groupStart,o.inherited=!1),r&&this.materials.length>1)for(let s=this.materials.length-1;s>=0;s--)this.materials[s].groupCount<=0&&this.materials.splice(s,1);return r&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),o}},i&&i.name&&"function"==typeof i.clone){const r=i.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseNormalIndex:function(e,t){const i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseUVIndex:function(e,t){const i=parseInt(e,10);return 2*(i>=0?i-1:i+t/2)},addVertex:function(e,t,i){const r=this.vertices,o=this.object.geometry.vertices;o.push(r[e+0],r[e+1],r[e+2]),o.push(r[t+0],r[t+1],r[t+2]),o.push(r[i+0],r[i+1],r[i+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,i){const r=this.normals,o=this.object.geometry.normals;o.push(r[e+0],r[e+1],r[e+2]),o.push(r[t+0],r[t+1],r[t+2]),o.push(r[i+0],r[i+1],r[i+2])},addFaceNormal:function(e,t,i){const r=this.vertices,o=this.object.geometry.normals;t7.fromArray(r,e),KF.fromArray(r,t),n7.fromArray(r,i),Gl.subVectors(n7,KF),i7.subVectors(t7,KF),Gl.cross(i7),Gl.normalize(),o.push(Gl.x,Gl.y,Gl.z),o.push(Gl.x,Gl.y,Gl.z),o.push(Gl.x,Gl.y,Gl.z)},addColor:function(e,t,i){const r=this.colors,o=this.object.geometry.colors;void 0!==r[e]&&o.push(r[e+0],r[e+1],r[e+2]),void 0!==r[t]&&o.push(r[t+0],r[t+1],r[t+2]),void 0!==r[i]&&o.push(r[i+0],r[i+1],r[i+2])},addUV:function(e,t,i){const r=this.uvs,o=this.object.geometry.uvs;o.push(r[e+0],r[e+1]),o.push(r[t+0],r[t+1]),o.push(r[i+0],r[i+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,i,r,o,s,a,l,u){const c=this.vertices.length;let f=this.parseVertexIndex(e,c),h=this.parseVertexIndex(t,c),g=this.parseVertexIndex(i,c);if(this.addVertex(f,h,g),this.addColor(f,h,g),void 0!==a&&""!==a){const m=this.normals.length;f=this.parseNormalIndex(a,m),h=this.parseNormalIndex(l,m),g=this.parseNormalIndex(u,m),this.addNormal(f,h,g)}else this.addFaceNormal(f,h,g);if(void 0!==r&&""!==r){const m=this.uvs.length;f=this.parseUVIndex(r,m),h=this.parseUVIndex(o,m),g=this.parseUVIndex(s,m),this.addUV(f,h,g),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let i=0,r=e.length;i<r;i++){const o=this.parseVertexIndex(e[i],t);this.addVertexPoint(o),this.addColor(o)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const i=this.vertices.length,r=this.uvs.length;for(let o=0,s=e.length;o<s;o++)this.addVertexLine(this.parseVertexIndex(e[o],i));for(let o=0,s=t.length;o<s;o++)this.addUVLine(this.parseUVIndex(t[o],r))}};return n.startObject("",!1),n}class twe extends ts{constructor(e){super(e),this.materials=null}load(e,t,i,r){const o=this,s=new Vl(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(a){try{t(o.parse(a))}catch(l){r?r(l):console.error(l),o.manager.itemError(e)}},i,r)}setMaterials(e){return this.materials=e,this}parse(e){const t=new ewe;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));const i=e.split("\n");let r=[];for(let a=0,l=i.length;a<l;a++){const u=i[a].trimStart();if(0===u.length)continue;const c=u.charAt(0);if("#"!==c)if("v"===c){const f=u.split(e7);switch(f[0]){case"v":t.vertices.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3])),f.length>=7?(eA.setRGB(parseFloat(f[4]),parseFloat(f[5]),parseFloat(f[6]),fi),t.colors.push(eA.r,eA.g,eA.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]));break;case"vt":t.uvs.push(parseFloat(f[1]),parseFloat(f[2]))}}else if("f"===c){const h=u.slice(1).trim().split(e7),g=[];for(let v=0,_=h.length;v<_;v++){const y=h[v];if(y.length>0){const w=y.split("/");g.push(w)}}const m=g[0];for(let v=1,_=g.length-1;v<_;v++){const y=g[v],w=g[v+1];t.addFace(m[0],y[0],w[0],m[1],y[1],w[1],m[2],y[2],w[2])}}else if("l"===c){const f=u.substring(1).trim().split(" ");let h=[];const g=[];if(-1===u.indexOf("/"))h=f;else for(let m=0,v=f.length;m<v;m++){const _=f[m].split("/");""!==_[0]&&h.push(_[0]),""!==_[1]&&g.push(_[1])}t.addLineGeometry(h,g)}else if("p"===c){const h=u.slice(1).trim().split(" ");t.addPointGeometry(h)}else if(null!==(r=Zbe.exec(u))){const f=(" "+r[0].slice(1).trim()).slice(1);t.startObject(f)}else if(Jbe.test(u))t.object.startMaterial(u.substring(7).trim(),t.materialLibraries);else if(Kbe.test(u))t.materialLibraries.push(u.substring(7).trim());else if(Qbe.test(u))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===c){if(r=u.split(" "),r.length>1){const h=r[1].trim().toLowerCase();t.object.smooth="0"!==h&&"off"!==h}else t.object.smooth=!0;const f=t.object.currentMaterial();f&&(f.smooth=t.object.smooth)}else{if("\0"===u)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+u+'"')}}t.finalize();const o=new Lu;if(o.materialLibraries=[].concat(t.materialLibraries),1==!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length))for(let a=0,l=t.objects.length;a<l;a++){const u=t.objects[a],c=u.geometry,f=u.materials,h="Line"===c.type,g="Points"===c.type;let m=!1;if(0===c.vertices.length)continue;const v=new cn;v.setAttribute("position",new it(c.vertices,3)),c.normals.length>0&&v.setAttribute("normal",new it(c.normals,3)),c.colors.length>0&&(m=!0,v.setAttribute("color",new it(c.colors,3))),!0===c.hasUVIndices&&v.setAttribute("uv",new it(c.uvs,2));const _=[];for(let w=0,x=f.length;w<x;w++){const M=f[w],D=M.name+"_"+M.smooth+"_"+m;let E=t.materials[D];if(null!==this.materials)if(E=this.materials.create(M.name),!h||!E||E instanceof wo){if(g&&E&&!(E instanceof Rg)){const I=new Rg({size:10,sizeAttenuation:!1});lo.prototype.copy.call(I,E),I.color.copy(E.color),I.map=E.map,E=I}}else{const I=new wo;lo.prototype.copy.call(I,E),I.color.copy(E.color),E=I}void 0===E&&(E=h?new wo:g?new Rg({size:1,sizeAttenuation:!1}):new ey,E.name=M.name,E.flatShading=!M.smooth,E.vertexColors=m,t.materials[D]=E),_.push(E)}let y;if(_.length>1){for(let w=0,x=f.length;w<x;w++){const M=f[w];v.addGroup(M.groupStart,M.groupCount,w)}y=h?new Ul(v,_):g?new rx(v,_):new yr(v,_)}else y=h?new Ul(v,_[0]):g?new rx(v,_[0]):new yr(v,_[0]);y.name=u.name,o.add(y)}else if(t.vertices.length>0){const a=new Rg({size:1,sizeAttenuation:!1}),l=new cn;l.setAttribute("position",new it(t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(l.setAttribute("color",new it(t.colors,3)),a.vertexColors=!0);const u=new rx(l,a);o.add(u)}return o}}function JF(){return(JF=N(function*(n,e){const t=new twe(e);try{return yield new Promise((r,o)=>{t.load(n,s=>{r(s)},void 0,s=>{s instanceof Error?o(s):o(new Error("An unknown error occurred"))})})}catch(i){throw console.error("Error loading OBJ model:",i),i}})).apply(this,arguments)}function QF(){return QF=N(function*(n,e){const t=n.type;let i;if(t.includes("gltf")||t.includes("glb")?i="gltf":t.includes("fbx")?i="fbx":t.includes("obj")&&(i="obj"),!i)throw new Error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u0442\u0438\u043f \u043c\u043e\u0434\u0435\u043b\u0438 \u043f\u043e MIME-\u0442\u0438\u043f\u0443.");const r=URL.createObjectURL(n);try{switch(i){case"gltf":case"glb":return yield function mbe(n,e){const t=new Fve(e);return new Promise((i,r)=>{t.load(n,o=>{i(o.scene)},void 0,o=>{o instanceof Error?r(o):r(new Error("An unknown error occurred"))})})}(r,e);case"fbx":return yield function Ybe(n,e){const t=new kbe(e);return new Promise((i,r)=>{t.load(n,o=>{i(o)},void 0,o=>{o instanceof Error?r(o):r(new Error("An unknown error occurred"))})})}(r,e);case"obj":return yield function nwe(n,e){return JF.apply(this,arguments)}(r,e);default:throw new Error("\u041d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u043c\u043e\u0434\u0435\u043b\u0438: "+i)}}catch(o){return o instanceof Error?o:new Error(String(o))}finally{URL.revokeObjectURL(r)}}),QF.apply(this,arguments)}function tA(n,e){if(!{}.hasOwnProperty.call(n,e))throw new TypeError("attempted to use private field on non-instance");return n}var rwe=0;function r7(n){return"__private_"+rwe+++"_"+n}function owe(n,e,t){const i=[];return n.forEach(r=>"string"!=typeof r?i.push(r):e[Symbol.split](r).forEach((o,s,a)=>{""!==o&&i.push(o),s<a.length-1&&i.push(t)})),i}function o7(n,e){const t=/\$/g;let r=[n];if(null==e)return r;for(const o of Object.keys(e))if("_"!==o){let s=e[o];"string"==typeof s&&(s=t[Symbol.replace](s,"$$$$")),r=owe(r,new RegExp(`%\\{${o}\\}`,"g"),s)}return r}const swe=n=>{throw new Error(`missing string: ${n}`)};var Cx=r7("onMissingKey"),Sx=r7("apply");class s7{constructor(e,t){let{onMissingKey:i=swe}=void 0===t?{}:t;Object.defineProperty(this,Sx,{value:awe}),Object.defineProperty(this,Cx,{writable:!0,value:void 0}),this.locale={strings:{},pluralize:r=>1===r?0:1},Array.isArray(e)?e.forEach(tA(this,Sx)[Sx],this):tA(this,Sx)[Sx](e),tA(this,Cx)[Cx]=i}translate(e,t){return this.translateArray(e,t).join("")}translateArray(e,t){let i=this.locale.strings[e];if(null==i&&(tA(this,Cx)[Cx](e),i=e),"object"==typeof i){if(t&&typeof t.smart_count<"u")return o7(i[this.locale.pluralize(t.smart_count)],t);throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}if("string"!=typeof i)throw new Error("string was not a string");return o7(i,t)}}function awe(n){if(null==n||!n.strings)return;const e=this.locale;Object.assign(this.locale,{strings:{...e.strings,...n.strings},pluralize:n.pluralize||e.pluralize})}var lwe=je(906),dwe=je(595);function nA(n,e){if(!{}.hasOwnProperty.call(n,e))throw new TypeError("attempted to use private field on non-instance");return n}var fwe=0;function a7(n){return"__private_"+fwe+++"_"+n}var Zg=a7("callbacks"),e2=a7("publish");class l7{constructor(){Object.defineProperty(this,e2,{value:pwe}),this.state={},Object.defineProperty(this,Zg,{writable:!0,value:new Set})}getState(){return this.state}setState(e){const t={...this.state},i={...this.state,...e};this.state=i,nA(this,e2)[e2](t,i,e)}subscribe(e){return nA(this,Zg)[Zg].add(e),()=>{nA(this,Zg)[Zg].delete(e)}}}function pwe(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];nA(this,Zg)[Zg].forEach(i=>{i(...e)})}l7.VERSION="4.2.0";const gwe=l7;function u7(n){const e=n.lastIndexOf(".");return-1===e||e===n.length-1?{name:n,extension:void 0}:{name:n.slice(0,e),extension:n.slice(e+1)}}const c7={__proto__:null,md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",msg:"application/vnd.ms-outlook",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function d7(n){var e;if(n.type)return n.type;const t=n.name?null==(e=u7(n.name).extension)?void 0:e.toLowerCase():null;return t&&t in c7?c7[t]:"application/octet-stream"}function f7(n){let e="";return n.replace(/[^A-Z0-9]/gi,t=>(e+=`-${function mwe(n){return n.charCodeAt(0).toString(32)}(t)}`,"/"))+e}function bwe(n){if(null==n&&typeof navigator<"u"&&(n=navigator.userAgent),!n)return!0;const e=/Edge\/(\d+\.\d+)/.exec(n);if(!e)return!0;const i=e[1].split(".",2),r=parseInt(i[0],10),o=parseInt(i[1],10);return r<15||15===r&&o<15063||r>18||18===r&&o>=18218}function t2(n){return n<10?`0${n}`:n.toString()}function iA(){const n=new Date;return`${t2(n.getHours())}:${t2(n.getMinutes())}:${t2(n.getSeconds())}`}const xwe={debug:()=>{},warn:()=>{},error:function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return console.error(`[Uppy] [${iA()}]`,...e)}},Mwe={debug:function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return console.debug(`[Uppy] [${iA()}]`,...e)},warn:function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return console.warn(`[Uppy] [${iA()}]`,...e)},error:function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return console.error(`[Uppy] [${iA()}]`,...e)}};var rA=je(794),Cwe=je(982);const Swe={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]};class zu extends Error{constructor(e,t){var i;super(e),this.isRestriction=!0,this.isUserFacing=null==(i=t?.isUserFacing)||i,null!=t&&t.file&&(this.file=t.file)}}class Ewe{constructor(e,t){this.getI18n=t,this.getOpts=()=>{var i;const r=e();if(null!=(null==(i=r.restrictions)?void 0:i.allowedFileTypes)&&!Array.isArray(r.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return r}}validateAggregateRestrictions(e,t){const{maxTotalFileSize:i,maxNumberOfFiles:r}=this.getOpts().restrictions;if(r&&e.filter(s=>!s.isGhost).length+t.length>r)throw new zu(`${this.getI18n()("youCanOnlyUploadX",{smart_count:r})}`);if(i){const o=[...e,...t].reduce((s,a)=>{var l;return s+(null!=(l=a.size)?l:0)},0);if(o>i)throw new zu(this.getI18n()("aggregateExceedsSize",{sizeAllowed:rA(i),size:rA(o)}))}}validateSingleFile(e){const{maxFileSize:t,minFileSize:i,allowedFileTypes:r}=this.getOpts().restrictions;if(r&&!r.some(a=>a.includes("/")?!!e.type&&Cwe(e.type.replace(/;.*?$/,""),a):!("."!==a[0]||!e.extension)&&e.extension.toLowerCase()===a.slice(1).toLowerCase())){const a=r.join(", ");throw new zu(this.getI18n()("youCanOnlyUploadFileTypes",{types:a}),{file:e})}var o;if(t&&null!=e.size&&e.size>t)throw new zu(this.getI18n()("exceedsSize",{size:rA(t),file:null!=(o=e.name)?o:this.getI18n()("unnamed")}),{file:e});if(i&&null!=e.size&&e.size<i)throw new zu(this.getI18n()("inferiorSize",{size:rA(i)}),{file:e})}validate(e,t){t.forEach(i=>{this.validateSingleFile(i)}),this.validateAggregateRestrictions(e,t)}validateMinNumberOfFiles(e){const{minNumberOfFiles:t}=this.getOpts().restrictions;if(t&&Object.keys(e).length<t)throw new zu(this.getI18n()("youHaveToAtLeastSelectX",{smart_count:t}))}getMissingRequiredMetaFields(e){var t;const i=new zu(this.getI18n()("missingRequiredMetaFieldOnFile",{fileName:null!=(t=e.name)?t:this.getI18n()("unnamed")})),{requiredMetaFields:r}=this.getOpts().restrictions,o=[];for(const s of r)(!Object.hasOwn(e.meta,s)||""===e.meta[s])&&o.push(s);return{missingFields:o,error:i}}}const Twe={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},aggregateExceedsSize:"You selected %{size} of files, but maximum allowed size is %{sizeAllowed}",exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",logIn:"Log in",pickFiles:"Pick files",pickPhotos:"Pick photos",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled",unnamed:"Unnamed",pleaseWait:"Please wait"}};function Je(n,e){if(!{}.hasOwnProperty.call(n,e))throw new TypeError("attempted to use private field on non-instance");return n}var Awe=0;function Wi(n){return"__private_"+Awe+++"_"+n}const oA={totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null};var is=Wi("plugins"),rs=Wi("restricter"),Ex=Wi("storeUnsubscribe"),Gd=Wi("emitter"),Kg=Wi("preProcessors"),Jg=Wi("uploaders"),jd=Wi("postProcessors"),ll=Wi("informAndEmit"),Tx=Wi("checkRequiredMetaFieldsOnFile"),n2=Wi("checkRequiredMetaFields"),Ax=Wi("assertNewUploadAllowed"),r2=Wi("transformFile"),Dx=Wi("startIfAutoProceed"),Ix=Wi("checkAndUpdateFileState"),Rx=Wi("getFilesToRetry"),Px=Wi("doRetryAll"),o2=Wi("handleUploadProgress"),Ox=Wi("updateTotalProgress"),Wd=Wi("updateTotalProgressThrottled"),s2=Wi("calculateTotalProgress"),a2=Wi("addListeners"),Gu=Wi("updateOnlineStatus"),Nx=Wi("requestClientById"),$d=Wi("createUpload"),l2=Wi("getUpload"),Qg=Wi("removeUpload"),qd=Wi("runUpload");class sA{constructor(e){Object.defineProperty(this,qd,{value:Wwe}),Object.defineProperty(this,Qg,{value:jwe}),Object.defineProperty(this,l2,{value:Gwe}),Object.defineProperty(this,$d,{value:zwe}),Object.defineProperty(this,a2,{value:Hwe}),Object.defineProperty(this,s2,{value:Vwe}),Object.defineProperty(this,Ox,{value:Uwe}),Object.defineProperty(this,Px,{value:Bwe}),Object.defineProperty(this,Rx,{value:kwe}),Object.defineProperty(this,Ix,{value:Lwe}),Object.defineProperty(this,Dx,{value:Fwe}),Object.defineProperty(this,r2,{value:Nwe}),Object.defineProperty(this,Ax,{value:Owe}),Object.defineProperty(this,n2,{value:Pwe}),Object.defineProperty(this,Tx,{value:Rwe}),Object.defineProperty(this,ll,{value:Iwe}),Object.defineProperty(this,is,{writable:!0,value:Object.create(null)}),Object.defineProperty(this,rs,{writable:!0,value:void 0}),Object.defineProperty(this,Ex,{writable:!0,value:void 0}),Object.defineProperty(this,Gd,{writable:!0,value:lwe()}),Object.defineProperty(this,Kg,{writable:!0,value:new Set}),Object.defineProperty(this,Jg,{writable:!0,value:new Set}),Object.defineProperty(this,jd,{writable:!0,value:new Set}),this.scheduledAutoProceed=null,this.wasOffline=!1,Object.defineProperty(this,o2,{writable:!0,value:(r,o)=>{const s=r?this.getFile(r.id):void 0;if(null==r||!s)return void this.log(`Not setting progress for a file that has been removed: ${r?.id}`);if(100===s.progress.percentage)return void this.log(`Not setting progress for a file that has been already uploaded: ${r.id}`);const a={bytesTotal:o.bytesTotal,percentage:null!=o.bytesTotal&&Number.isFinite(o.bytesTotal)&&o.bytesTotal>0?Math.round(o.bytesUploaded/o.bytesTotal*100):void 0};this.setFileState(r.id,null!=s.progress.uploadStarted?{progress:{...s.progress,...a,bytesUploaded:o.bytesUploaded}}:{progress:{...s.progress,...a}}),Je(this,Wd)[Wd]()}}),Object.defineProperty(this,Wd,{writable:!0,value:dwe(()=>Je(this,Ox)[Ox](),500,{leading:!0,trailing:!0})}),Object.defineProperty(this,Gu,{writable:!0,value:this.updateOnlineStatus.bind(this)}),Object.defineProperty(this,Nx,{writable:!0,value:new Map}),this.defaultLocale=Twe;const t={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:Swe,meta:{},onBeforeFileAdded:(r,o)=>!Object.hasOwn(o,r.id),onBeforeUpload:r=>r,store:new gwe,logger:xwe,infoTimeout:5e3},i={...t,...e};this.opts={...i,restrictions:{...t.restrictions,...e&&e.restrictions}},e&&e.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e&&e.debug&&(this.opts.logger=Mwe),this.log(`Using Core v${sA.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState({...oA,plugins:{},files:{},currentUploads:{},capabilities:{uploadProgress:bwe(),individualCancellation:!0,resumableUploads:!1},meta:{...this.opts.meta},info:[]}),Je(this,rs)[rs]=new Ewe(()=>this.opts,()=>this.i18n),Je(this,Ex)[Ex]=this.store.subscribe((r,o,s)=>{this.emit("state-update",r,o,s),this.updateAll(o)}),this.opts.debug&&typeof window<"u"&&(window[this.opts.id]=this),Je(this,a2)[a2]()}emit(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];Je(this,Gd)[Gd].emit(e,...i)}on(e,t){return Je(this,Gd)[Gd].on(e,t),this}once(e,t){return Je(this,Gd)[Gd].once(e,t),this}off(e,t){return Je(this,Gd)[Gd].off(e,t),this}updateAll(e){this.iteratePlugins(t=>{t.update(e)})}setState(e){this.store.setState(e)}getState(){return this.store.getState()}patchFilesState(e){const t=this.getState().files;this.setState({files:{...t,...Object.fromEntries(Object.entries(e).map(i=>{let[r,o]=i;return[r,{...t[r],...o}]}))}})}setFileState(e,t){if(!this.getState().files[e])throw new Error(`Can\u2019t set state for ${e} (the file could have been removed)`);this.patchFilesState({[e]:t})}i18nInit(){const t=new s7([this.defaultLocale,this.opts.locale],{onMissingKey:i=>this.log(`Missing i18n string: ${i}`,"error")});this.i18n=t.translate.bind(t),this.i18nArray=t.translateArray.bind(t),this.locale=t.locale}setOptions(e){this.opts={...this.opts,...e,restrictions:{...this.opts.restrictions,...e?.restrictions}},e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins(t=>{t.setOptions(e)}),this.setState(void 0)}resetProgress(){const e={percentage:0,bytesUploaded:!1,uploadComplete:!1,uploadStarted:null},t={...this.getState().files},i=Object.create(null);Object.keys(t).forEach(r=>{i[r]={...t[r],progress:{...t[r].progress,...e},tus:void 0,transloadit:void 0}}),this.setState({files:i,...oA})}clear(){const{capabilities:e,currentUploads:t}=this.getState();if(Object.keys(t).length>0&&!e.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");this.setState({...oA,files:{}})}addPreProcessor(e){Je(this,Kg)[Kg].add(e)}removePreProcessor(e){return Je(this,Kg)[Kg].delete(e)}addPostProcessor(e){Je(this,jd)[jd].add(e)}removePostProcessor(e){return Je(this,jd)[jd].delete(e)}addUploader(e){Je(this,Jg)[Jg].add(e)}removeUploader(e){return Je(this,Jg)[Jg].delete(e)}setMeta(e){const t={...this.getState().meta,...e},i={...this.getState().files};Object.keys(i).forEach(r=>{i[r]={...i[r],meta:{...i[r].meta,...e}}}),this.log("Adding metadata:"),this.log(e),this.setState({meta:t,files:i})}setFileMeta(e,t){const i={...this.getState().files};if(!i[e])return void this.log(`Was trying to set metadata for a file that has been removed: ${e}`);const r={...i[e].meta,...t};i[e]={...i[e],meta:r},this.setState({files:i})}getFile(e){return this.getState().files[e]}getFiles(){const{files:e}=this.getState();return Object.values(e)}getFilesByIds(e){return e.map(t=>this.getFile(t))}getObjectOfFilesPerState(){const{files:e,totalProgress:t,error:i}=this.getState(),r=Object.values(e),o=[],s=[],a=[],l=[],u=[],c=[],f=[],h=[],g=[];for(const m of r){const{progress:v}=m;!v.uploadComplete&&v.uploadStarted&&(o.push(m),m.isPaused||h.push(m)),v.uploadStarted||s.push(m),(v.uploadStarted||v.preprocess||v.postprocess)&&a.push(m),v.uploadStarted&&l.push(m),m.isPaused&&u.push(m),v.uploadComplete&&c.push(m),m.error&&f.push(m),(v.preprocess||v.postprocess)&&g.push(m)}return{newFiles:s,startedFiles:a,uploadStartedFiles:l,pausedFiles:u,completeFiles:c,erroredFiles:f,inProgressFiles:o,inProgressNotPausedFiles:h,processingFiles:g,isUploadStarted:l.length>0,isAllComplete:100===t&&c.length===r.length&&0===g.length,isAllErrored:!!i&&f.length===r.length,isAllPaused:0!==o.length&&u.length===o.length,isUploadInProgress:o.length>0,isSomeGhost:r.some(m=>m.isGhost)}}validateRestrictions(e,t){void 0===t&&(t=this.getFiles());try{Je(this,rs)[rs].validate(t,[e])}catch(i){return i}return null}validateSingleFile(e){try{Je(this,rs)[rs].validateSingleFile(e)}catch(t){return t.message}return null}validateAggregateRestrictions(e){const t=this.getFiles();try{Je(this,rs)[rs].validateAggregateRestrictions(t,e)}catch(i){return i.message}return null}checkIfFileAlreadyExists(e){const{files:t}=this.getState();return!(!t[e]||t[e].isGhost)}addFile(e){Je(this,Ax)[Ax](e);const{nextFilesState:t,validFilesToAdd:i,errors:r}=Je(this,Ix)[Ix]([e]),o=r.filter(a=>a.isRestriction);if(Je(this,ll)[ll](o),r.length>0)throw r[0];this.setState({files:t});const[s]=i;return this.emit("file-added",s),this.emit("files-added",i),this.log(`Added file: ${s.name}, ${s.id}, mime type: ${s.type}`),Je(this,Dx)[Dx](),s.id}addFiles(e){Je(this,Ax)[Ax]();const{nextFilesState:t,validFilesToAdd:i,errors:r}=Je(this,Ix)[Ix](e),o=r.filter(a=>a.isRestriction);Je(this,ll)[ll](o);const s=r.filter(a=>!a.isRestriction);if(s.length>0){let a="Multiple errors occurred while adding files:\n";if(s.forEach(l=>{a+=`\n * ${l.message}`}),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:s.length}),details:a},"error",this.opts.infoTimeout),"function"==typeof AggregateError)throw new AggregateError(s,a);{const l=new Error(a);throw l.errors=s,l}}this.setState({files:t}),i.forEach(a=>{this.emit("file-added",a)}),this.emit("files-added",i),i.length>5?this.log(`Added batch of ${i.length} files`):Object.values(i).forEach(a=>{this.log(`Added file: ${a.name}\n id: ${a.id}\n type: ${a.type}`)}),i.length>0&&Je(this,Dx)[Dx]()}removeFiles(e){const{files:t,currentUploads:i}=this.getState(),r={...t},o={...i},s=Object.create(null);function a(c){return void 0===s[c]}e.forEach(c=>{t[c]&&(s[c]=t[c],delete r[c])}),Object.keys(o).forEach(c=>{const f=i[c].fileIDs.filter(a);if(0===f.length)return void delete o[c];const{capabilities:h}=this.getState();if(f.length!==i[c].fileIDs.length&&!h.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");o[c]={...i[c],fileIDs:f}});const l={currentUploads:o,files:r};0===Object.keys(r).length&&(l.allowNewUpload=!0,l.error=null,l.recoveredState=null),this.setState(l),Je(this,Wd)[Wd]();const u=Object.keys(s);u.forEach(c=>{this.emit("file-removed",s[c])}),this.log(u.length>5?`Removed ${u.length} files`:`Removed files: ${u.join(", ")}`)}removeFile(e){this.removeFiles([e])}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).progress.uploadComplete)return;const t=this.getFile(e),r=!t.isPaused;return this.setFileState(e,{isPaused:r}),this.emit("upload-pause",t,r),r}pauseAll(){const e={...this.getState().files};Object.keys(e).filter(i=>!e[i].progress.uploadComplete&&e[i].progress.uploadStarted).forEach(i=>{const r={...e[i],isPaused:!0};e[i]=r}),this.setState({files:e}),this.emit("pause-all")}resumeAll(){const e={...this.getState().files};Object.keys(e).filter(i=>!e[i].progress.uploadComplete&&e[i].progress.uploadStarted).forEach(i=>{const r={...e[i],isPaused:!1,error:null};e[i]=r}),this.setState({files:e}),this.emit("resume-all")}retryAll(){var e=this;return N(function*(){const t=yield Je(e,Px)[Px]();return e.emit("complete",t),t})()}cancelAll(){this.emit("cancel-all");const{files:e}=this.getState(),t=Object.keys(e);t.length&&this.removeFiles(t),this.setState(oA)}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",this.getFile(e));const t=Je(this,$d)[$d]([e],{forceAllowNewUpload:!0});return Je(this,qd)[qd](t)}logout(){this.iteratePlugins(e=>{var t;null==(t=e.provider)||null==t.logout||t.logout()})}[Symbol.for("uppy test: updateTotalProgress")](){return Je(this,Ox)[Ox]()}updateOnlineStatus(){var e;null==(e=window.navigator.onLine)||e?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}getID(){return this.opts.id}use(e){if("function"!=typeof e)throw new TypeError(`Expected a plugin class, but got ${null===e?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`);for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];const o=new e(this,...i),s=o.id;if(!s)throw new Error("Your plugin must have an id");if(!o.type)throw new Error("Your plugin must have a type");const a=this.getPlugin(s);if(a)throw new Error(`Already found a plugin named '${a.id}'. Tried to use: '${s}'.\nUppy plugins must have unique \`id\` options.`);return e.VERSION&&this.log(`Using ${s} v${e.VERSION}`),o.type in Je(this,is)[is]?Je(this,is)[is][o.type].push(o):Je(this,is)[is][o.type]=[o],o.install(),this.emit("plugin-added",o),this}getPlugin(e){for(const t of Object.values(Je(this,is)[is])){const i=t.find(r=>r.id===e);if(null!=i)return i}}[Symbol.for("uppy test: getPlugins")](e){return Je(this,is)[is][e]}iteratePlugins(e){Object.values(Je(this,is)[is]).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();const t=Je(this,is)[is][e.type],i=t.findIndex(s=>s.id===e.id);-1!==i&&t.splice(i,1);const o={plugins:{...this.getState().plugins,[e.id]:void 0}};this.setState(o)}destroy(){this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll(),Je(this,Ex)[Ex](),this.iteratePlugins(e=>{this.removePlugin(e)}),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("online",Je(this,Gu)[Gu]),window.removeEventListener("offline",Je(this,Gu)[Gu]))}hideInfo(){const{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,t,i){void 0===t&&(t="info"),void 0===i&&(i=3e3);const r="object"==typeof e;this.setState({info:[...this.getState().info,{type:t,message:r?e.message:e,details:r?e.details:null}]}),setTimeout(()=>this.hideInfo(),i),this.emit("info-visible")}log(e,t){const{logger:i}=this.opts;switch(t){case"error":i.error(e);break;case"warning":i.warn(e);break;default:i.debug(e)}}registerRequestClient(e,t){Je(this,Nx)[Nx].set(e,t)}getRequestClientForFile(e){if(!e.remote)throw new Error(`Tried to get RequestClient for a non-remote file ${e.id}`);const t=Je(this,Nx)[Nx].get(e.remote.requestClientId);if(null==t)throw new Error(`requestClientId "${e.remote.requestClientId}" not registered for file "${e.id}"`);return t}restore(e){return this.log(`Core: attempting to restore upload "${e}"`),this.getState().currentUploads[e]?Je(this,qd)[qd](e):(Je(this,Qg)[Qg](e),Promise.reject(new Error("Nonexistent upload")))}[Symbol.for("uppy test: createUpload")](){return Je(this,$d)[$d](...arguments)}addResultData(e,t){if(!Je(this,l2)[l2](e))return void this.log(`Not setting result for an upload that has been removed: ${e}`);const{currentUploads:i}=this.getState(),r={...i[e],result:{...i[e].result,...t}};this.setState({currentUploads:{...i,[e]:r}})}upload(){var e=this;return N(function*(){var t;null!=(t=Je(e,is)[is].uploader)&&t.length||e.log("No uploader type plugins are used","warning");let{files:i}=e.getState();if(Je(e,Rx)[Rx]().length>0){const s=yield Je(e,Px)[Px]();if(!(e.getFiles().filter(l=>null==l.progress.uploadStarted).length>0))return e.emit("complete",s),s;({files:i}=e.getState())}const o=e.opts.onBeforeUpload(i);return!1===o?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(o&&"object"==typeof o&&(i=o,e.setState({files:i})),Promise.resolve().then(()=>Je(e,rs)[rs].validateMinNumberOfFiles(i)).catch(s=>{throw Je(e,ll)[ll]([s]),s}).then(()=>{if(!Je(e,n2)[n2](i))throw new zu(e.i18n("missingRequiredMetaField"))}).catch(s=>{throw s}).then(N(function*(){const{currentUploads:s}=e.getState(),a=Object.values(s).flatMap(f=>f.fileIDs),l=[];Object.keys(i).forEach(f=>{const h=e.getFile(f);!h.progress.uploadStarted&&-1===a.indexOf(f)&&l.push(h.id)});const u=Je(e,$d)[$d](l),c=yield Je(e,qd)[qd](u);return e.emit("complete",c),c})).catch(s=>{throw e.emit("error",s),e.log(s,"error"),s}))})()}}function Iwe(n){for(const o of n)o.isRestriction?this.emit("restriction-failed",o.file,o):this.emit("error",o,o.file),this.log(o,"warning");const e=n.filter(o=>o.isUserFacing),i=e.slice(0,4),r=e.slice(4);i.forEach(o=>{let{message:s,details:a=""}=o;this.info({message:s,details:a},"error",this.opts.infoTimeout)}),r.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:r.length})})}function Rwe(n){const{missingFields:e,error:t}=Je(this,rs)[rs].getMissingRequiredMetaFields(n);return!(e.length>0&&(this.setFileState(n.id,{missingRequiredMetaFields:e}),this.log(t.message),this.emit("restriction-failed",n,t),1))}function Pwe(n){let e=!0;for(const t of Object.values(n))Je(this,Tx)[Tx](t)||(e=!1);return e}function Owe(n){const{allowNewUpload:e}=this.getState();if(!1===e){const t=new zu(this.i18n("noMoreFilesAllowed"),{file:n});throw Je(this,ll)[ll]([t]),t}}function Nwe(n){const e=n instanceof File?{name:n.name,type:n.type,size:n.size,data:n}:n,t=d7(e),i=function wwe(n,e){return e.name?e.name:"image"===n.split("/")[0]?`${n.split("/")[0]}.${n.split("/")[1]}`:"noname"}(t,e),r=u7(i).extension,o=function vwe(n,e){if(function ywe(n){return!(!n.isRemote||!n.remote)&&new Set(["box","dropbox","drive","facebook","unsplash"]).has(n.remote.provider)}(n))return n.id;const t=d7(n);return function _we(n,e){let t=e||"uppy";return"string"==typeof n.name&&(t+=`-${f7(n.name.toLowerCase())}`),void 0!==n.type&&(t+=`-${n.type}`),n.meta&&"string"==typeof n.meta.relativePath&&(t+=`-${f7(n.meta.relativePath.toLowerCase())}`),void 0!==n.data.size&&(t+=`-${n.data.size}`),void 0!==n.data.lastModified&&(t+=`-${n.data.lastModified}`),t}({...n,type:t},e)}(e,this.getID()),s=e.meta||{};s.name=i,s.type=t;const a=Number.isFinite(e.data.size)?e.data.size:null;return{source:e.source||"",id:o,name:i,extension:r||"",meta:{...this.getState().meta,...s},type:t,data:e.data,progress:{percentage:0,bytesUploaded:!1,bytesTotal:a,uploadComplete:!1,uploadStarted:null},size:a,isGhost:!1,isRemote:e.isRemote||!1,remote:e.remote,preview:e.preview}}function Fwe(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(()=>{this.scheduledAutoProceed=null,this.upload().catch(n=>{n.isRestriction||this.log(n.stack||n.message||n)})},4))}function Lwe(n){const{files:e}=this.getState(),t={...e},i=[],r=[];for(const a of n)try{var o;let l=Je(this,r2)[r2](a);const u=null==(o=e[l.id])?void 0:o.isGhost;u&&(l={...e[l.id],isGhost:!1,data:a.data},this.log(`Replaced the blob in the restored ghost file: ${l.name}, ${l.id}`));const c=this.opts.onBeforeFileAdded(l,t);var s;if(!c&&this.checkIfFileAlreadyExists(l.id))throw new zu(this.i18n("noDuplicates",{fileName:null!=(s=l.name)?s:this.i18n("unnamed")}),{file:a});if(!1===c&&!u)throw new zu("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:a});"object"==typeof c&&null!==c&&(l=c),Je(this,rs)[rs].validateSingleFile(l),t[l.id]=l,i.push(l)}catch(l){r.push(l)}try{Je(this,rs)[rs].validateAggregateRestrictions(Object.values(e),i)}catch(a){return r.push(a),{nextFilesState:e,validFilesToAdd:[],errors:r}}return{nextFilesState:t,validFilesToAdd:i,errors:r}}function kwe(){const{files:n}=this.getState();return Object.keys(n).filter(e=>n[e].error)}function Bwe(){return u2.apply(this,arguments)}function u2(){return(u2=N(function*(){const n=Je(this,Rx)[Rx](),e={...this.getState().files};if(n.forEach(i=>{e[i]={...e[i],isPaused:!1,error:null}}),this.setState({files:e,error:null}),this.emit("retry-all",this.getFilesByIds(n)),0===n.length)return{successful:[],failed:[]};const t=Je(this,$d)[$d](n,{forceAllowNewUpload:!0});return Je(this,qd)[qd](t)})).apply(this,arguments)}function Uwe(){var n,e;const t=Je(this,s2)[s2]();let i=null;null!=t&&(i=Math.round(100*t),i>100?i=100:i<0&&(i=0)),this.emit("progress",null!=(n=i)?n:0),this.setState({totalProgress:null!=(e=i)?e:0})}function Vwe(){const e=this.getFiles().filter(a=>a.progress.uploadStarted||a.progress.preprocess||a.progress.postprocess);if(0===e.length)return 0;if(e.every(a=>a.progress.uploadComplete))return 1;const t=a=>null!=a.progress.bytesTotal&&0!==a.progress.bytesTotal,i=e.filter(t),r=e.filter(a=>!t(a));if(i.every(a=>a.progress.uploadComplete)&&r.length>0&&!r.every(a=>a.progress.uploadComplete))return null;const o=i.reduce((a,l)=>{var u;return a+(null!=(u=l.progress.bytesTotal)?u:0)},0),s=i.reduce((a,l)=>a+(l.progress.bytesUploaded||0),0);return 0===o?0:s/o}function Hwe(){const n=(i,r,o)=>{let s=i.message||"Unknown error";i.details&&(s+=` ${i.details}`),this.setState({error:s}),null!=r&&r.id in this.getState().files&&this.setFileState(r.id,{error:s,response:o})};this.on("error",n),this.on("upload-error",(i,r,o)=>{if(n(r,i,o),"object"==typeof r&&r.message){var s;this.log(r.message,"error");const a=new Error(this.i18n("failedToUpload",{file:null!=(s=i?.name)?s:""}));a.isUserFacing=!0,a.details=r.message,r.details&&(a.details+=` ${r.details}`),Je(this,ll)[ll]([a])}else Je(this,ll)[ll]([r])});let e=null;this.on("upload-stalled",(i,r)=>{const{message:o}=i,s=r.map(a=>a.meta.name).join(", ");e||(this.info({message:o,details:s},"warning",this.opts.infoTimeout),e=setTimeout(()=>{e=null},this.opts.infoTimeout)),this.log(`${o} ${s}`.trim(),"warning")}),this.on("upload",()=>{this.setState({error:null})}),this.on("upload-start",i=>{const r=i.filter(s=>{const a=null!=s&&this.getFile(s.id);return a||this.log(`Not setting progress for a file that has been removed: ${s?.id}`),a}),o=Object.fromEntries(r.map(s=>[s.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,bytesUploaded:0,bytesTotal:s.size}}]));this.patchFilesState(o)}),this.on("upload-progress",Je(this,o2)[o2]),this.on("upload-success",(i,r)=>{if(null==i||!this.getFile(i.id))return void this.log(`Not setting progress for a file that has been removed: ${i?.id}`);const o=this.getFile(i.id).progress;this.setFileState(i.id,{progress:{...o,postprocess:Je(this,jd)[jd].size>0?{mode:"indeterminate"}:void 0,uploadComplete:!0,percentage:100,bytesUploaded:o.bytesTotal},response:r,uploadURL:r.uploadURL,isPaused:!1}),null==i.size&&this.setFileState(i.id,{size:r.bytesUploaded||o.bytesTotal}),Je(this,Wd)[Wd]()}),this.on("preprocess-progress",(i,r)=>{null!=i&&this.getFile(i.id)?this.setFileState(i.id,{progress:{...this.getFile(i.id).progress,preprocess:r}}):this.log(`Not setting progress for a file that has been removed: ${i?.id}`)}),this.on("preprocess-complete",i=>{if(null==i||!this.getFile(i.id))return void this.log(`Not setting progress for a file that has been removed: ${i?.id}`);const r={...this.getState().files};r[i.id]={...r[i.id],progress:{...r[i.id].progress}},delete r[i.id].progress.preprocess,this.setState({files:r})}),this.on("postprocess-progress",(i,r)=>{null!=i&&this.getFile(i.id)?this.setFileState(i.id,{progress:{...this.getState().files[i.id].progress,postprocess:r}}):this.log(`Not setting progress for a file that has been removed: ${i?.id}`)}),this.on("postprocess-complete",i=>{if(null==i||!this.getFile(i.id))return void this.log(`Not setting progress for a file that has been removed: ${i?.id}`);const r={...this.getState().files};r[i.id]={...r[i.id],progress:{...r[i.id].progress}},delete r[i.id].progress.postprocess,this.setState({files:r})}),this.on("restored",()=>{Je(this,Wd)[Wd]()}),this.on("dashboard:file-edit-complete",i=>{i&&Je(this,Tx)[Tx](i)}),typeof window<"u"&&window.addEventListener&&(window.addEventListener("online",Je(this,Gu)[Gu]),window.addEventListener("offline",Je(this,Gu)[Gu]),setTimeout(Je(this,Gu)[Gu],3e3))}function zwe(n,e){void 0===e&&(e={});const{forceAllowNewUpload:t=!1}=e,{allowNewUpload:i,currentUploads:r}=this.getState();if(!i&&!t)throw new Error("Cannot create a new upload: already uploading.");const o=((n=21)=>{let e="",t=0|n;for(;t--;)e+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return e})();return this.emit("upload",o,this.getFilesByIds(n)),this.setState({allowNewUpload:!1!==this.opts.allowMultipleUploadBatches&&!1!==this.opts.allowMultipleUploads,currentUploads:{...r,[o]:{fileIDs:n,step:0,result:{}}}}),o}function Gwe(n){const{currentUploads:e}=this.getState();return e[n]}function jwe(n){const e={...this.getState().currentUploads};delete e[n],this.setState({currentUploads:e})}function Wwe(n){return c2.apply(this,arguments)}function c2(){return(c2=N(function*(n){const e=()=>{const{currentUploads:o}=this.getState();return o[n]};let t=e();const i=[...Je(this,Kg)[Kg],...Je(this,Jg)[Jg],...Je(this,jd)[jd]];try{for(let o=t.step||0;o<i.length&&t;o++){const s=i[o];this.setState({currentUploads:{...this.getState().currentUploads,[n]:{...t,step:o}}});const{fileIDs:a}=t;yield s(a,n),t=e()}}catch(o){throw Je(this,Qg)[Qg](n),o}if(t){t.fileIDs.forEach(l=>{const u=this.getFile(l);u&&u.progress.postprocess&&this.emit("postprocess-complete",u)});const o=t.fileIDs.map(l=>this.getFile(l)),s=o.filter(l=>!l.error),a=o.filter(l=>l.error);this.addResultData(n,{successful:s,failed:a,uploadID:n}),t=e()}let r;return t&&(r=t.result,Je(this,Qg)[Qg](n)),null==r&&(this.log(`Not setting result for an upload that has been removed: ${n}`),r={successful:[],failed:[],uploadID:n}),r})).apply(this,arguments)}sA.VERSION="4.4.5";const $we=sA;class qwe{constructor(e,t){this.uppy=e,this.opts=t??{}}getPluginState(){const{plugins:e}=this.uppy.getState();return e?.[this.id]||{}}setPluginState(e){const{plugins:t}=this.uppy.getState();this.uppy.setState({plugins:{...t,[this.id]:{...t[this.id],...e}}})}setOptions(e){this.opts={...this.opts,...e},this.setPluginState(void 0),this.i18nInit()}i18nInit(){const e=new s7([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState(void 0)}addTarget(e){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}update(e){}afterUpdate(){}}function Xd(n,e){if(!{}.hasOwnProperty.call(n,e))throw new TypeError("attempted to use private field on non-instance");return n}var Xwe=0;function h7(n){return"__private_"+Xwe+++"_"+n}var ra=h7("uppy"),Fx=h7("events");class Ywe{constructor(e){Object.defineProperty(this,ra,{writable:!0,value:void 0}),Object.defineProperty(this,Fx,{writable:!0,value:[]}),Xd(this,ra)[ra]=e}on(e,t){return Xd(this,Fx)[Fx].push([e,t]),Xd(this,ra)[ra].on(e,t)}remove(){for(const[e,t]of Xd(this,Fx)[Fx].splice(0))Xd(this,ra)[ra].off(e,t)}onFilePause(e,t){this.on("upload-pause",(i,r)=>{e===i?.id&&t(r)})}onFileRemove(e,t){this.on("file-removed",i=>{e===i.id&&t(i.id)})}onPause(e,t){this.on("upload-pause",(i,r)=>{e===i?.id&&t(r)})}onRetry(e,t){this.on("upload-retry",i=>{e===i?.id&&t()})}onRetryAll(e,t){this.on("retry-all",()=>{Xd(this,ra)[ra].getFile(e)&&t()})}onPauseAll(e,t){this.on("pause-all",()=>{Xd(this,ra)[ra].getFile(e)&&t()})}onCancelAll(e,t){var i=this;this.on("cancel-all",function(){Xd(i,ra)[ra].getFile(e)&&t(...arguments)})}onResumeAll(e,t){this.on("resume-all",()=>{Xd(this,ra)[ra].getFile(e)&&t()})}}function tn(n,e){if(!{}.hasOwnProperty.call(n,e))throw new TypeError("attempted to use private field on non-instance");return n}var Zwe=0;function Oa(n){return"__private_"+Zwe+++"_"+n}function p7(n){if(null!=n){var e;const t=()=>this.abort(n.reason);n.addEventListener("abort",t,{once:!0});const i=()=>{n.removeEventListener("abort",t)};null==(e=this.then)||e.call(this,i,i)}return this}var ul=Oa("activeRequests"),oa=Oa("queuedHandlers"),cl=Oa("paused"),em=Oa("pauseTimer"),sa=Oa("downLimit"),tm=Oa("upperLimit"),Yd=Oa("rateLimitingTimer"),Lx=Oa("call"),Zd=Oa("queueNext"),d2=Oa("next"),f2=Oa("queue"),h2=Oa("dequeue"),p2=Oa("resume"),nm=Oa("increaseLimit");class Jwe{constructor(e){Object.defineProperty(this,h2,{value:ixe}),Object.defineProperty(this,f2,{value:nxe}),Object.defineProperty(this,d2,{value:txe}),Object.defineProperty(this,Zd,{value:exe}),Object.defineProperty(this,Lx,{value:Qwe}),Object.defineProperty(this,ul,{writable:!0,value:0}),Object.defineProperty(this,oa,{writable:!0,value:[]}),Object.defineProperty(this,cl,{writable:!0,value:!1}),Object.defineProperty(this,em,{writable:!0,value:void 0}),Object.defineProperty(this,sa,{writable:!0,value:1}),Object.defineProperty(this,tm,{writable:!0,value:void 0}),Object.defineProperty(this,Yd,{writable:!0,value:void 0}),Object.defineProperty(this,p2,{writable:!0,value:()=>this.resume()}),Object.defineProperty(this,nm,{writable:!0,value:()=>{if(tn(this,cl)[cl])tn(this,Yd)[Yd]=setTimeout(tn(this,nm)[nm],0);else{tn(this,sa)[sa]=this.limit,this.limit=Math.ceil((tn(this,tm)[tm]+tn(this,sa)[sa])/2);for(let t=tn(this,sa)[sa];t<=this.limit;t++)tn(this,Zd)[Zd]();tn(this,tm)[tm]-tn(this,sa)[sa]>3?tn(this,Yd)[Yd]=setTimeout(tn(this,nm)[nm],2e3):tn(this,sa)[sa]=Math.floor(tn(this,sa)[sa]/2)}}}),this.limit="number"!=typeof e||0===e?1/0:e}run(e,t){return!tn(this,cl)[cl]&&tn(this,ul)[ul]<this.limit?tn(this,Lx)[Lx](e):tn(this,f2)[f2](e,t)}wrapSyncFunction(e,t){var i=this;return function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];const a=i.run(()=>(e(...o),queueMicrotask(()=>a.done()),()=>{}),t);return{abortOn:p7,abort(){a.abort()}}}}wrapPromiseFunction(e,t){var i=this;return function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];let a;const l=new Promise((u,c)=>{a=i.run(()=>{let f,h;try{h=Promise.resolve(e(...o))}catch(g){h=Promise.reject(g)}return h.then(g=>{f?c(f):(a.done(),u(g))},g=>{f?c(f):(a.done(),c(g))}),g=>{f=function Kwe(n){return new Error("Cancelled",{cause:n})}(g)}},t)});return l.abort=u=>{a.abort(u)},l.abortOn=p7,l}}resume(){tn(this,cl)[cl]=!1,clearTimeout(tn(this,em)[em]);for(let e=0;e<this.limit;e++)tn(this,Zd)[Zd]()}pause(e){void 0===e&&(e=null),tn(this,cl)[cl]=!0,clearTimeout(tn(this,em)[em]),null!=e&&(tn(this,em)[em]=setTimeout(tn(this,p2)[p2],e))}rateLimit(e){clearTimeout(tn(this,Yd)[Yd]),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(tn(this,tm)[tm]=this.limit-1,this.limit=tn(this,sa)[sa],tn(this,Yd)[Yd]=setTimeout(tn(this,nm)[nm],e))}get isPaused(){return tn(this,cl)[cl]}}function Qwe(n){tn(this,ul)[ul]+=1;let t,e=!1;try{t=n()}catch(i){throw tn(this,ul)[ul]-=1,i}return{abort:i=>{e||(e=!0,tn(this,ul)[ul]-=1,t?.(i),tn(this,Zd)[Zd]())},done:()=>{e||(e=!0,tn(this,ul)[ul]-=1,tn(this,Zd)[Zd]())}}}function exe(){queueMicrotask(()=>tn(this,d2)[d2]())}function txe(){if(tn(this,cl)[cl]||tn(this,ul)[ul]>=this.limit||0===tn(this,oa)[oa].length)return;const n=tn(this,oa)[oa].shift();if(null==n)throw new Error("Invariant violation: next is null");const e=tn(this,Lx)[Lx](n.fn);n.abort=e.abort,n.done=e.done}function nxe(n,e){const t={fn:n,priority:e?.priority||0,abort:()=>{tn(this,h2)[h2](t)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},i=tn(this,oa)[oa].findIndex(r=>t.priority>r.priority);return-1===i?tn(this,oa)[oa].push(t):tn(this,oa)[oa].splice(i,0,t),t}function ixe(n){const e=tn(this,oa)[oa].indexOf(n);-1!==e&&tn(this,oa)[oa].splice(e,1)}const g2=Symbol("__queue");class rxe extends Error{constructor(e,t){void 0===t&&(t=null),super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=t}}const m2=rxe;function jl(n,e){if(!{}.hasOwnProperty.call(n,e))throw new TypeError("attempted to use private field on non-instance");return n}var axe=0;function aA(n){return"__private_"+axe+++"_"+n}var Kd=aA("aliveTimer"),im=aA("isDone"),kx=aA("onTimedOut"),rm=aA("timeout");const uxe=class lxe{constructor(e,t){Object.defineProperty(this,Kd,{writable:!0,value:void 0}),Object.defineProperty(this,im,{writable:!0,value:!1}),Object.defineProperty(this,kx,{writable:!0,value:void 0}),Object.defineProperty(this,rm,{writable:!0,value:void 0}),jl(this,rm)[rm]=e,jl(this,kx)[kx]=()=>t(e)}progress(){jl(this,im)[im]||jl(this,rm)[rm]>0&&(clearTimeout(jl(this,Kd)[Kd]),jl(this,Kd)[Kd]=setTimeout(jl(this,kx)[kx],jl(this,rm)[rm]))}done(){jl(this,im)[im]||(clearTimeout(jl(this,Kd)[Kd]),jl(this,Kd)[Kd]=void 0,jl(this,im)[im]=!0)}},lA=()=>{};function g7(n,e){return!0===n?Object.keys(e):Array.isArray(n)?n:[]}const hxe={strings:{uploadStalled:"Upload has not made any progress for %{seconds} seconds. You may want to retry it."}};function Jd(n,e){if(!{}.hasOwnProperty.call(n,e))throw new TypeError("attempted to use private field on non-instance");return n}var pxe=0;function gy(n){return"__private_"+pxe+++"_"+n}function mxe(n,e){let t=e;return t||(t=new Error("Upload error")),"string"==typeof t&&(t=new Error(t)),t instanceof Error||(t=Object.assign(new Error("Upload error"),{data:t})),function oxe(n){return!!n&&(0!==n.readyState&&4!==n.readyState||0===n.status)}(n)?(t=new m2(t,n),t):(t.request=n,t)}function m7(n){return n.data.slice(0,n.data.size,n.meta.type)}const _xe={formData:!0,fieldName:"file",method:"post",allowedMetaFields:!0,bundle:!1,headers:{},timeout:3e4,limit:5,withCredentials:!1,responseType:""};var om=gy("getFetcher"),_2=gy("uploadLocalFile"),y2=gy("uploadBundle"),v2=gy("getCompanionClientArgs"),b2=gy("uploadFiles"),Bx=gy("handleUpload");class _7 extends qwe{constructor(e,t){var i,r;if(super(e,{..._xe,fieldName:t.bundle?"files[]":"file",...t}),i=this,Object.defineProperty(this,b2,{value:wxe}),Object.defineProperty(this,v2,{value:bxe}),Object.defineProperty(this,y2,{value:vxe}),Object.defineProperty(this,_2,{value:yxe}),Object.defineProperty(this,om,{writable:!0,value:void 0}),Object.defineProperty(this,Bx,{writable:!0,value:(r=N(function*(o){if(0===o.length)return void i.uppy.log("[XHRUpload] No files to upload!");0===i.opts.limit&&!i.opts[g2]&&i.uppy.log("[XHRUpload] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/xhr-upload/#limit-0","warning"),i.uppy.log("[XHRUpload] Uploading...");const a=function dxe(n){return n.filter(t=>!(t=>"error"in t&&!!t.error)(t))}(i.uppy.getFilesByIds(o)),l=function fxe(n){return n.filter(e=>{var t;return!(null!=(t=e.progress)&&t.uploadStarted&&e.isRestored)})}(a);if(i.uppy.emit("upload-start",l),i.opts.bundle){if(a.some(c=>c.isRemote))throw new Error("Can\u2019t upload remote files when the `bundle: true` option is set");if("function"==typeof i.opts.headers)throw new TypeError("`headers` may not be a function when the `bundle: true` option is set");yield Jd(i,y2)[y2](a)}else yield Jd(i,b2)[b2](a)}),function(s){return r.apply(this,arguments)})}),this.type="uploader",this.id=this.opts.id||"XHRUpload",this.defaultLocale=hxe,this.i18nInit(),this.requests=g2 in this.opts?this.opts[g2]:new Jwe(this.opts.limit),this.opts.bundle&&!this.opts.formData)throw new Error("`opts.formData` must be true when `opts.bundle` is enabled.");if(this.opts.bundle&&"function"==typeof this.opts.headers)throw new Error("`opts.headers` can not be a function when the `bundle: true` option is set.");if(void 0===t?.allowedMetaFields&&"metaFields"in this.opts)throw new Error("The `metaFields` option has been renamed to `allowedMetaFields`.");this.uploaderEvents=Object.create(null),Jd(this,om)[om]=r=>function(){var o=N(function*(s,a){try{var l,u,c;const g=yield function cxe(n,e){void 0===e&&(e={});const{body:t=null,headers:i={},method:r="GET",onBeforeRequest:o=lA,onUploadProgress:s=lA,shouldRetry:a=()=>!0,onAfterResponse:l=lA,onTimeout:u=lA,responseType:c,retries:f=3,signal:h=null,timeout:g=3e4,withCredentials:m=!1}=e,v=w=>.3*2**(w-1)*1e3,_=new uxe(g,u);return function y(w){return void 0===w&&(w=0),new Promise(function(){var x=N(function*(M,D){const E=new XMLHttpRequest,I=R=>{a(E)&&w<f?setTimeout(()=>{y(w+1).then(M,D)},v(w)):(_.done(),D(R))};E.open(r,n,!0),E.withCredentials=m,c&&(E.responseType=c),h?.addEventListener("abort",()=>{E.abort(),D(new DOMException("Aborted","AbortError"))}),E.onload=N(function*(){try{yield l(E,w)}catch(R){return R.request=E,void I(R)}E.status>=200&&E.status<300?(_.done(),M(E)):a(E)&&w<f?setTimeout(()=>{y(w+1).then(M,D)},v(w)):(_.done(),D(new m2(E.statusText,E)))}),E.onerror=()=>I(new m2(E.statusText,E)),E.upload.onprogress=R=>{_.progress(),s(R)},i&&Object.keys(i).forEach(R=>{E.setRequestHeader(R,i[R])}),yield o(E,w),E.send(t)});return function(M,D){return x.apply(this,arguments)}}())}()}(s,{...a,onBeforeRequest:(_,y)=>{var w,x;return null==(w=(x=i.opts).onBeforeRequest)?void 0:w.call(x,_,y,r)},shouldRetry:i.opts.shouldRetry,onAfterResponse:i.opts.onAfterResponse,onTimeout:_=>{const y=Math.ceil(_/1e3),w=new Error(i.i18n("uploadStalled",{seconds:y}));i.uppy.emit("upload-stalled",w,r)},onUploadProgress:_=>{if(_.lengthComputable)for(const{id:w}of r){var y;const x=i.uppy.getFile(w);i.uppy.emit("upload-progress",x,{uploadStarted:null!=(y=x.progress.uploadStarted)?y:0,bytesUploaded:_.loaded/_.total*x.size,bytesTotal:x.size})}}});let m=yield null==(l=(u=i.opts).getResponseData)?void 0:l.call(u,g);if("json"===g.responseType)null!=m||(m=g.response);else try{null!=m||(m=JSON.parse(g.responseText))}catch(_){throw new Error("@uppy/xhr-upload expects a JSON response (with a `url` property). To parse non-JSON responses, use `getResponseData` to turn your response into JSON.",{cause:_})}const v="string"==typeof(null==(c=m)?void 0:c.url)?m.url:void 0;for(const{id:_}of r)i.uppy.emit("upload-success",i.uppy.getFile(_),{status:g.status,body:m,uploadURL:v});return g}catch(g){if("AbortError"===g.name)return;const m=g.request;for(const v of r)i.uppy.emit("upload-error",i.uppy.getFile(v.id),mxe(m,g),m);throw g}});return function(s,a){return o.apply(this,arguments)}}()}getOptions(e){const t=this.uppy.getState().xhrUpload,{headers:i}=this.opts,r={...this.opts,...t||{},...e.xhrUpload||{},headers:{}};return"function"==typeof i?r.headers=i(e):Object.assign(r.headers,this.opts.headers),t&&Object.assign(r.headers,t.headers),e.xhrUpload&&Object.assign(r.headers,e.xhrUpload.headers),r}addMetadata(e,t,i){g7(i.allowedMetaFields,t).forEach(o=>{const s=t[o];Array.isArray(s)?s.forEach(a=>e.append(o,a)):e.append(o,s)})}createFormDataUpload(e,t){const i=new FormData;this.addMetadata(i,e.meta,t);const r=m7(e);return e.name?i.append(t.fieldName,r,e.meta.name):i.append(t.fieldName,r),i}createBundledUpload(e,t){const i=new FormData,{meta:r}=this.uppy.getState();return this.addMetadata(i,r,t),e.forEach(o=>{const s=this.getOptions(o),a=m7(o);o.name?i.append(s.fieldName,a,o.name):i.append(s.fieldName,a)}),i}install(){if(this.opts.bundle){const{capabilities:e}=this.uppy.getState();this.uppy.setState({capabilities:{...e,individualCancellation:!1}})}this.uppy.addUploader(Jd(this,Bx)[Bx])}uninstall(){if(this.opts.bundle){const{capabilities:e}=this.uppy.getState();this.uppy.setState({capabilities:{...e,individualCancellation:!0}})}this.uppy.removeUploader(Jd(this,Bx)[Bx])}}function yxe(n){return w2.apply(this,arguments)}function w2(){return(w2=N(function*(n){var e=this;const t=new Ywe(this.uppy),i=new AbortController,r=this.requests.wrapPromiseFunction(N(function*(){const o=e.getOptions(n),s=Jd(e,om)[om]([n]),a=o.formData?e.createFormDataUpload(n,o):n.data;return s(o.endpoint,{...o,body:a,signal:i.signal})}));t.onFileRemove(n.id,()=>i.abort()),t.onCancelAll(n.id,()=>{i.abort()});try{yield r().abortOn(i.signal)}catch(o){if("Cancelled"!==o.message)throw o}finally{t.remove()}})).apply(this,arguments)}function vxe(n){return x2.apply(this,arguments)}function x2(){return(x2=N(function*(n){var e=this;const t=new AbortController,i=this.requests.wrapPromiseFunction(N(function*(){var o;const s=null!=(o=e.uppy.getState().xhrUpload)?o:{},a=Jd(e,om)[om](n),l=e.createBundledUpload(n,{...e.opts,...s});return a(e.opts.endpoint,{...e.opts,body:l,signal:t.signal})}));function r(){t.abort()}this.uppy.once("cancel-all",r);try{yield i().abortOn(t.signal)}catch(o){if("Cancelled"!==o.message)throw o}finally{this.uppy.off("cancel-all",r)}})).apply(this,arguments)}function bxe(n){var e;const t=this.getOptions(n),i=g7(t.allowedMetaFields,n.meta);return{...null==(e=n.remote)?void 0:e.body,protocol:"multipart",endpoint:t.endpoint,size:n.data.size,fieldname:t.fieldName,metadata:Object.fromEntries(i.map(r=>[r,n.meta[r]])),httpMethod:t.method,useFormData:t.formData,headers:t.headers}}function wxe(n){return M2.apply(this,arguments)}function M2(){return(M2=N(function*(n){yield Promise.allSettled(n.map(e=>{if(e.isRemote){const t=()=>this.requests,i=new AbortController,r=s=>{s.id===e.id&&i.abort()};this.uppy.on("file-removed",r);const o=this.uppy.getRequestClientForFile(e).uploadRemoteFile(e,Jd(this,v2)[v2](e),{signal:i.signal,getQueue:t});return this.requests.wrapSyncFunction(()=>{this.uppy.off("file-removed",r)},{priority:-1})(),o}return Jd(this,_2)[_2](e)}))})).apply(this,arguments)}_7.VERSION="4.3.3";let Ux=(()=>{class n{httpModule;baseServiceUrl=Es+"furniture/images/";constructor(t){this.httpModule=t}GETaccountAvatar(t){return`${Es}account/avatar?jwt=${t}`}POSTuploadUserAvatar(t,i){const r=new FormData;r.append("image",t);const o=(new di).set("jwt",i);return nr(this.httpModule.post(`${Es}account/avatar`,r,{params:o}))}POSTuploadProjectImages(t,i,r,o){const s=new FormData;i.images.forEach(l=>s.append("images",l));const a=(new di).set("furnitureCardId",o).set("color",t).set("idMainImage",i.idMainImage).set("jwt",r);return nr(this.httpModule.post(this.baseServiceUrl+"upload",s,{params:a}))}DELETEprojectColor(t,i,r){const o=(new di).set("jwt",t).set("furnitureCardId",i).set("color",r);return nr(this.httpModule.delete(this.baseServiceUrl+"delete/color",{params:o}))}DELETEproject(t,i){const r=(new di).set("jwt",t).set("furnitureCardId",i);return nr(this.httpModule.delete(this.baseServiceUrl+"delete/project",{params:r}))}GETallProjectImages(t,i){const r=(new di).set("furnitureCardId",t).set("color",i);return nr(this.httpModule.get(this.baseServiceUrl+"all",{params:r}))}GETmainImage(t,i){return`${this.baseServiceUrl}main?furnitureCardId=${t}&color=${i}`}static \u0275fac=function(i){return new(i||n)(Ze(Mu))};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),xxe=(()=>{class n{constructor(t,i){this.document=t,this.platformId=i,this.documentIsAccessible=zH(this.platformId)}static getCookieRegExp(t){const i=t.replace(/([\[\]{}()|=;+?,.*^$])/gi,"\\$1");return new RegExp("(?:^"+i+"|;\\s*"+i+")=(.*?)(?:;|$)","g")}static safeDecodeURIComponent(t){try{return decodeURIComponent(t)}catch{return t}}check(t){return!!this.documentIsAccessible&&(t=encodeURIComponent(t),n.getCookieRegExp(t).test(this.document.cookie))}get(t){if(this.check(t)){t=encodeURIComponent(t);const r=n.getCookieRegExp(t).exec(this.document.cookie);return r&&r[1]?n.safeDecodeURIComponent(r[1]):""}return""}getAll(){if(!this.documentIsAccessible)return{};const t={},i=this.document;return i.cookie&&""!==i.cookie&&i.cookie.split(";").forEach(r=>{const[o,s]=r.split("=");t[n.safeDecodeURIComponent(o.replace(/^ /,""))]=n.safeDecodeURIComponent(s)}),t}set(t,i,r,o,s,a,l,u){if(!this.documentIsAccessible)return;if("number"==typeof r||r instanceof Date||o||s||a||l)return void this.set(t,i,{expires:r,path:o,domain:s,secure:a,sameSite:l||"Lax",partitioned:u});let c=encodeURIComponent(t)+"="+encodeURIComponent(i)+";";const f=r||{};f.expires&&(c+="number"==typeof f.expires?"expires="+new Date((new Date).getTime()+1e3*f.expires*60*60*24).toUTCString()+";":"expires="+f.expires.toUTCString()+";"),f.path&&(c+="path="+f.path+";"),f.domain&&(c+="domain="+f.domain+";"),!1===f.secure&&"None"===f.sameSite&&(f.secure=!0,console.warn(`[ngx-cookie-service] Cookie ${t} was forced with secure flag because sameSite=None.More details : https://github.com/stevermeister/ngx-cookie-service/issues/86#issuecomment-597720130`)),f.secure&&(c+="secure;"),f.sameSite||(f.sameSite="Lax"),c+="sameSite="+f.sameSite+";",f.partitioned&&(c+="Partitioned;"),this.document.cookie=c}delete(t,i,r,o,s="Lax"){this.documentIsAccessible&&this.set(t,"",{expires:new Date("Thu, 01 Jan 1970 00:00:01 GMT"),path:i,domain:r,secure:o,sameSite:s})}deleteAll(t,i,r,o="Lax"){if(!this.documentIsAccessible)return;const s=this.getAll();for(const a in s)s.hasOwnProperty(a)&&this.delete(a,t,i,r,o)}static{this.\u0275fac=function(i){return new(i||n)(Ze(fr),Ze(Vf))}}static{this.\u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),ju=(()=>{class n{cookieService;constructor(t){this.cookieService=t}setJwt(t,i){const r=new Date;"long"===i?r.setDate(r.getDate()+7):r.setMinutes(r.getMinutes()+10),this.cookieService.set("jwt",t,{expires:r,path:"/",sameSite:"Strict"})}deleteJwt(){this.cookieService.delete("jwt","/")}setGuideRule(){const t=new Date;t.setDate(t.getDate()+7),this.cookieService.set("guideInclude","false",{expires:t,path:"/",sameSite:"Strict"})}getGuideRule(){return this.cookieService.get("guideInclude")}deleteGuideRule(){this.cookieService.delete("guideInclude","/")}getJwt(){return this.cookieService.get("jwt")}setUserType(t){const i=new Date;i.setDate(i.getDate()+7),this.cookieService.set("accountType",t,{expires:i,path:"/",sameSite:"Strict"})}getUserType(){return this.cookieService.get("accountType")}deleteAccountType(){this.cookieService.delete("accountType","/")}static \u0275fac=function(i){return new(i||n)(Ze(xxe))};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),y7=(()=>{class n{furnitureCardService;serverImageControl;accountCookieService;notification;uppy;uploads$=new Lr([]);baseServiceUrl=Es+"furniture/model";constructor(t,i,r,o){this.furnitureCardService=t,this.serverImageControl=i,this.accountCookieService=r,this.notification=o,this.uppy=new $we({autoProceed:!0}),this.uppy.use(_7,{endpoint:this.baseServiceUrl,fieldName:"file",formData:!0,getResponseError:(s,a)=>new Error(`\u041e\u0448\u0438\u0431\u043a\u0430: ${a.statusText}`)}),this.uppy.on("upload-progress",(s,a)=>{if(void 0===s||void 0===s.meta.name)return;const l=s.data instanceof File?s.data.name:"file";this.updateUpload(s.id,l,s.progress.percentage??50,"uploading")}),this.uppy.on("upload-success",s=>{if(void 0===s||void 0===s.meta.name)return;const a=s.data instanceof File?s.data.name:"file";this.updateUpload(s.id,a,100,"success"),this.notification.setSuccess("\u041c\u043e\u0434\u0435\u043b\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430",2500)}),this.uppy.on("upload-error",(s,a)=>{if(void 0===s||void 0===s.meta.name)return;const l=s.data instanceof File?s.data.name:"file";this.updateUpload(s.id,l,100,"error"),this.cancelUpload(s.id)})}addFile(t,i,r,o){const s=Date.now().toString();this.uppy.addFile({name:s+this.getFileExtension(t.name),type:t.type,data:t,meta:{furnitureCardId:r,jwt:i,uploadType:o}})}cancelUpload(t){var i=this;return N(function*(){const r=i.uppy.getFile(t);if(r){i.uppy.removeFile(t);const o=i.accountCookieService.getJwt(),s=r.meta.furnitureCardId;o&&s&&"create"===r.meta.uploadType&&(yield i.serverImageControl.DELETEproject(o,s),i.furnitureCardService.DELETEfurnitureCard(o,s))}})()}getFileExtension(t){const i=t.split(".");return`.${i.length>1?i.pop()?.toLowerCase():"obj"}`}removeFileFromQueue(t){const i=this.uploads$.value.filter(r=>r.id!==t);this.uploads$.next(i)}updateUpload(t,i,r,o){const s=this.uploads$.value.filter(a=>a.id!==t);this.uploads$.next([...s,{id:t,name:i,progress:r,status:o}])}static \u0275fac=function(i){return new(i||n)(Ze(Dw),Ze(Ux),Ze(ju),Ze(kl))};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),C2=(()=>{class n{httpModule;uploadService;baseServiceUrl=Es+"furniture/model";constructor(t,i){this.httpModule=t,this.uploadService=i}GETfurnitureModel(t,i,r){const o=new URL(this.baseServiceUrl);return o.searchParams.set("jwt",t),o.searchParams.set("furnitureCardId",i),fetch(o.toString(),{method:"GET",signal:r.signal}).then(s=>{if(!s.ok)throw new Error("\u041e\u0442\u043c\u0435\u043d\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438");return s.blob()})}POSTuploadFurnitureModel(t,i,r,o){this.uploadService.addFile(t,i,r,o)}DELETEfurnitureModel(t,i){const r=(new di).set("jwt",t).set("furnitureCardId",i);return nr(this.httpModule.delete(this.baseServiceUrl,{params:r}))}static \u0275fac=function(i){return new(i||n)(Ze(Mu),Ze(y7))};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Mxe=(()=>{class n{constructor(){}createReport(t,i){this.createReportHTML(t,i)}createReportHTML(t,i){const r=new FileReader;r.onload=()=>{const s=this.generateHtmlContent(t,r.result);this.openHtmlInNewTab(t.name,s)},r.readAsDataURL(i)}generateHtmlContent(t,i){return`\n      <!DOCTYPE html>\n<html>\n\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u043a\u043e\u043c\u043d\u0430\u0442\u0435 ${t.name}</title>\n    <style>\n        @font-face {\n            font-family: 'Calypso';\n            src: url('${Aw}assets/fonts/Calypso.ttf') format('truetype');\n        }\n\n        @font-face {\n            font-family: 'Courier New';\n            src: url('${Aw}assets/fonts/Courier New.ttf') format('truetype');\n        }\n\n        body {\n            margin: 0;\n            padding: 40px;\n            background-color: black;\n            color: #DAD7CD;\n            font-family: 'Courier New', monospace;\n            line-height: 1.6;\n            display: flex;\n            flex-direction: column;\n        }\n\n        .title {\n            font-family: 'Calypso', 'Courier New', monospace;\n            text-align: center;\n            font-size: 3rem;\n            margin-bottom: 40px;\n            color: #A3B18A;\n            text-transform: uppercase;\n            letter-spacing: 2px;\n        }\n\n        .renderTitle {\n            font-family: 'Courier New', 'Courier New', monospace;\n            font-weight: 400;\n            font-size: 1.5rem;\n            margin: 30px 0 15px;\n            color: #A3B18A;\n            border-bottom: 2px solid #A3B18A;\n            padding-bottom: 8px;\n            width:fit-content;\n            align-self: center;\n        }\n\n        .furnituresSpanTitle {\n            font-family: 'Calypso', 'Courier New', monospace;\n            font-size: 2rem;\n            margin: 40px 0 20px;\n            color: #A3B18A;\n            display: block;\n            text-align: center;\n        }\n\n        .furniture {\n            display: flex;\n            flex-direction: column;\n            border-radius: 15px;\n            padding: 25px;\n            margin-bottom: 30px;\n            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);\n            transition: transform 0.3s ease;\n        }\n\n        .furnitureTitle {\n            font-family: 'Courier New', monospace;\n            font-weight: 400;\n            margin: 0 auto 15px;\n            font-size: 1.3rem;\n            color: #DAD7CD;\n        }\n\n        .furnitureImage {\n            margin: 0 auto;\n            max-width: 100%;\n            border-radius: 10px;\n            margin-bottom: 20px;\n        }\n\n        .furnitureFooter {\n            display: flex;\n            gap: 30px;\n            flex-direction: row;\n            justify-content: center;\n            flex-wrap: wrap;\n        }\n\n        .paramsTitle,\n        .shopsTitle {\n            font-family: 'Calypso', 'Courier New', monospace;\n            font-size: 1.2rem;\n            color: #A3B18A;\n            margin-bottom: 15px;\n        }\n\n        .paramsSpan {\n            width: fit-content;\n        }\n\n        .paramsList {\n            list-style-type: none;\n            padding: 0;\n            margin: 0;\n        }\n\n        .paramsItem {\n            margin-bottom: 8px;\n            position: relative;\n            padding-left: 20px;\n        }\n\n\n        a {\n            display: inline-block;\n            background-color: white;\n            color: black;\n            text-decoration: none;\n            border-radius: 10px;\n            transition: all 0.3s ease;\n            border: 2px solid transparent;\n            width:250px;\n            max-width: 250px;\n            text-align: center;\n            font-family: 'Courier New', monospace;\n            font-weight: 400;\n            font-size: 0.8rem;\n            height:40px;\n            align-content:center;\n            box-sizing:border-box;\n        }\n\n        a:hover {\n            background-color: transparent;\n            color: white;\n            border-color: white;\n        }\n\n        img {\n            width: 100%;\n            max-height: 500px;\n            object-fit: contain;\n            border-radius: 10px;\n            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);\n            margin-bottom: 30px;\n        }\n\n        .openLink {\n            width:250px;\n            max-width: 250px;\n            margin: 0 auto;\n            margin-top: 20px;\n        }\n        .furnitureLink{\n            background-color: #A3B18A;\n            color:white;\n            &:hover{\n                background-color: #344E41;\n                border: 2px solid #344E41;\n            }\n        }\n\n        @media (max-width: 768px) {\n            .furnitureFooter {\n                flex-direction: column;\n                align-items: center;\n                gap: 20px;\n                width: 100%;\n            }\n\n            .paramsSpan,\n            .shopsSpan {\n                width: 90%;\n            }\n\n            .openLink,.shopLink {\n                width: 100%;\n            }\n\n            .title {\n                font-size: 2rem;\n            }\n\n            body {\n                padding: 20px;\n            }\n            .paramsItem{\n                padding-left:0;\n            }\n                \n        }\n    </style>\n</head>\n<h1 class="title">\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u043a\u043e\u043c\u043d\u0430\u0442\u0435<br>${t.name}</h1>\n<h2 class="renderTitle">\u0412\u0438\u0434 \u0441\u0432\u0435\u0440\u0445\u0443</h2>\n<img src="${i}"\n    alt="Room render">\n\n<h2 style="display:${0===t.furnitures.length?"none":"block"}" class="furnituresSpanTitle">\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u0430\u044f \u043c\u0435\u0431\u0435\u043b\u044c</h2>\n${t.furnitures.map(r=>`\n    <span class="furniture">\n    <h3 class="furnitureTitle">${r.name}</h3>\n    <img class= "furnitureImage"\n        src = "${r.previewUrl}"\n        alt = "preview" loading = "lazy">\n    <span class="furnitureFooter" >\n    <span class="paramsSpan" >\n    <p class="paramsTitle"> \u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b </p>\n    <ul class= "paramsList">\n    <li class="paramsItem"> \u0428\u0438\u0440\u0438\u043d\u0430: ${r.proportions.width}c\u043c </li>\n    <li class= "paramsItem"> \u0412\u044b\u0441\u043e\u0442\u0430: ${r.proportions.height}c\u043c </li>\n    <li class= "paramsItem"> \u0414\u043b\u0438\u043d\u0430: ${r.proportions.length}c\u043c </li>\n    </ul>\n    </span>\n    <span class= "shopsSpan" >\n    ${r.shops.map(o=>`\n        <p class="shopsTitle"> \u041c\u0430\u0433\u0430\u0437\u0438\u043d\u044b </p>\n        <span >\n      <a class="shopLink" href = "${o.url}">\n      ${this.costPipe(o.cost)}\n      </a>\n      </span>\n      `).join("")}\n    </span>\n    </span>\n    <a class= "openLink furnitureLink" href = "${Aw}shop/${r.category}/${r.furnitureCardId}"> \u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043c\u0435\u0431\u0435\u043b\u044c </a>\n    </span>\n    `).join("")}\n<a class="openLink planLink" href="${Aw}plan">\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043f\u0440\u043e\u0435\u043a\u0442</a>\n\n</html>\n    `}costPipe(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}openHtmlInNewTab(t,i){const r=new Blob([i],{type:"text/html"}),o=URL.createObjectURL(r);window.open(o,"_blank"),this.downloadHtml(t,o)}downloadHtml(t,i){const r=document.createElement("a");r.href=i,r.download=`${t}-report.html`,r.click(),URL.revokeObjectURL(i)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),S2=(()=>{class n{httpModule;reportService;baseServiceUrl=Es+"project";constructor(t,i){this.httpModule=t,this.reportService=i}POSTcreateProject(t,i){const r=(new di).set("jwt",t).set("name",i);return nr(this.httpModule.post(this.baseServiceUrl,r))}DELETEdeleteProject(t,i){const r=(new di).set("jwt",t).set("projectId",i);return nr(this.httpModule.delete(this.baseServiceUrl,{params:r}))}GETgetProject(t,i){const r=(new di).set("jwt",t).set("projectId",i);return nr(this.httpModule.get(this.baseServiceUrl,{params:r}))}PUTupdateProject(t,i,r){const o=(new di).set("jwt",t).set("projectId",i);return nr(this.httpModule.put(this.baseServiceUrl,r,{params:o}))}GETgetReportOfRoom(t,i,r){var o=this;return N(function*(){const s=(new di).set("jwt",t).set("roomId",i),a=yield nr(o.httpModule.get(o.baseServiceUrl+"/room",{params:s}));a.furnitures=a.furnitures.map(l=>(l.previewUrl=Es+l.previewUrl,l)),o.reportService.createReport(a,r)})()}static \u0275fac=function(i){return new(i||n)(Ze(Mu),Ze(Mxe))};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Cxe(n,e){if(1&n){const t=rn();L(0,"button",6),Oe("click",function(){return qe(t),He(me().deleteModel())}),L(1,"p"),re(2,"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"),k(),Te(3,"img",7),k()}}function Sxe(n,e){if(1&n){const t=rn();L(0,"button",8),Oe("click",function(){return qe(t),He(me().getReport())}),L(1,"p"),re(2,"\u041e\u0442\u0447\u0435\u0442"),k(),Te(3,"img",9),k()}}function Exe(n,e){if(1&n){const t=rn();L(0,"div",10)(1,"span",11)(2,"span",12),Te(3,"div",13),L(4,"button",14),Oe("click",function(){return qe(t),He(me().abortLoadRoom())}),Te(5,"img",15),k()(),L(6,"p",16),re(7,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043c\u043e\u0434\u0435\u043b\u0435\u0439..."),k(),L(8,"p",17),re(9,"\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u044b \u043f\u043e\u0434\u0432\u0438\u0441\u0430\u043d\u0438\u044f"),k()()()}}let v7=(()=>{class n{elementRef;furnitureModelService;furnitureCardService;accountCookieService;projectService;route;notification;location;planHouseComponent;router;constructor(t,i,r,o,s,a,l,u,c,f){this.elementRef=t,this.furnitureModelService=i,this.furnitureCardService=r,this.accountCookieService=o,this.projectService=s,this.route=a,this.notification=l,this.location=u,this.planHouseComponent=c,this.router=f}roomData;saveObjectsEmitter=new Oi;renderer;camera;scene;controls;animationFrameId=null;canvasRatioOfWindow=1.5;roomProportions;raycaster=new fme;mouse=new xe;rectangleMesh;abortConroller=new AbortController;targetobject=void 0;isShowLoader=!1;hasBeenChanged=!1;ngAfterViewInit(){this.initThreeJs()}ngOnChanges(t){if(this.roomData=t.roomData.currentValue,!this.roomData||void 0===this.scene||(void 0!==t.roomData.previousValue&&this.clearRoom(),this.camera.position.set(0,5,0),this.camera.rotation.set(Pr_degToRad(-90),0,0),this.roomProportions=this.roomData.roomProportions,this.createRoom(),this.rectangleMesh.rotation.x=Pr_degToRad(-90),0===this.getObjectSize(this.rectangleMesh).width))return;if(!this.planHouseComponent.sceneOpenToggle)return void(this.hasBeenChanged=!0);this.loadRoom();const i=this.route.snapshot.params.furnitureCardId;!i||t.roomData.previousValue||(this.fixPath(),this.addModel(i,!0,this.abortConroller))}loadFurnitureModel(t,i,r,o,s){var a=this;return N(function*(){try{const l=yield function iwe(n,e){return QF.apply(this,arguments)}(t);if(l instanceof Error)return void a.notification.setError("\u041c\u043e\u0434\u0435\u043b\u044c \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f",5e3);s?a.addObjectToScene(l,i,r,s):a.addObjectToScene(l,i,r),o&&(a.saveRoom(),a.closeLoader())}catch{}})()}addModel(t,i,r,o){var s=this;return N(function*(){const a=s.accountCookieService.getJwt();if(a)try{i&&s.showLoader();const l=(yield s.furnitureCardService.GETfurnitureCard(t)).furnitureCard.proportions,u=yield s.furnitureModelService.GETfurnitureModel(a,t,r);yield s.loadFurnitureModel(u,l,t,i,o)}catch(l){s.notification.setError("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043c\u043e\u0434\u0435\u043b\u0438",5e3),console.log(l)}})()}fixPath(){const t=this.location.path().split("/").slice(0,-1).join("/");this.location.replaceState(t)}initThreeJs(){this.scene=new p6,this.camera=new bo(75,window.innerWidth/window.innerHeight,.1,1e3);const t=new lW(11184810,0,2);this.scene.add(t),this.renderer=new bve({antialias:!0,alpha:!1});const i=this.elementRef.nativeElement.querySelector("#canvasContainer");this.camera.position.z=5,this.renderer.setSize(window.innerWidth/this.canvasRatioOfWindow,window.innerHeight/this.canvasRatioOfWindow),i.appendChild(this.renderer.domElement),this.animationFrameId=requestAnimationFrame(()=>this.animate()),this.renderer.render(this.scene,this.camera)}animate(){this.animationFrameId=requestAnimationFrame(()=>this.animate()),this.renderer.render(this.scene,this.camera)}createRoundedRectangleGeometry(t,i,r,o){const s=new Og;return s.moveTo(-t/2+r,-i/2),s.lineTo(t/2-r,-i/2),s.quadraticCurveTo(t/2,-i/2,t/2,-i/2+r),s.lineTo(t/2,i/2-r),s.quadraticCurveTo(t/2,i/2,t/2-r,i/2),s.lineTo(-t/2+r,i/2),s.quadraticCurveTo(-t/2,i/2,-t/2,i/2-r),s.lineTo(-t/2,-i/2+r),s.quadraticCurveTo(-t/2,-i/2,-t/2+r,-i/2),new v1(s,o)}createRoom(){if(!this.roomData)return;const t=this.roomData.roomProportions;this.controls=new xve(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.15,this.controls.enableZoom=!0,this.controls.minDistance=1,this.controls.maxDistance=10,this.controls.maxPolarAngle=Pr_degToRad(85),this.createRoomShape(t.width,t.length,.1),this.rectangleMesh.name="roomFloorBase"}calculateObjectSaveData(t){const i=this.getObjectSize(this.rectangleMesh),r=t.position;return{objectId:t.userData.id,xMetersDistance:r.x/i.width*this.roomProportions.width,zMetersDistance:r.z/i.length*this.roomProportions.length,yRotate:t.rotation.y}}calculateMoveObjectData(t){const i=this.getObjectSize(this.rectangleMesh);return{xDistance:t.xMetersDistance*i.width/this.roomProportions.width,zDistance:t.zMetersDistance*i.length/this.roomProportions.length,yRotate:t.yRotate}}createRoomShape(t,i,r){const o=this.calculateFrustumBounds(),s=t/i;let a,l;s<=1?(a=o.height*s,l=o.height):(a=o.width,l=o.width/s);const c=this.createRoundedRectangleGeometry(.9*a,.9*l,r,10),f=new sl({color:3427905});this.rectangleMesh=new yr(c,f),this.scene.add(this.rectangleMesh),this.renderer.render(this.scene,this.camera),this.rectangleMesh.updateMatrixWorld(!0)}calculateFrustumBounds(){const t=this.camera.position.y,i=Pr_degToRad(this.camera.fov),r=2*Math.tan(i/2)*Math.abs(t);return{width:r*this.camera.aspect,height:r}}addObjectToScene(t,i,r,o){t.userData={id:r},this.scaleImportModel(t,i),this.scene.add(t),this.renderer.render(this.scene,this.camera),o&&(t.position.set(o.xDistance,0,o.zDistance),t.rotation.y=o.yRotate)}getObjectSize(t){const r=(new Qo).setFromObject(t).getSize(new U);return{width:r.x,length:r.z,height:r.y}}scaleImportModel(t,i){let{width:r,length:o,height:s}=i;r/=100,o/=100,s/=100;const l=s/this.getObjectSize(t).height;t.scale.set(l,l,l)}loadRoom(){var t=this;return N(function*(){if(!t.accountCookieService.getJwt()||!t.roomData)return;const r={objects:t.roomData.objects,...t.roomData.roomProportions};t.showLoader();for(const o of r.objects)yield t.addModel(o.objectId,!1,t.abortConroller,t.calculateMoveObjectData(o));t.closeLoader(),t.hasBeenChanged=!1})()}showLoader(){this.isShowLoader=!0}closeLoader(){this.isShowLoader=!1}clearRoom(){for(let t=this.scene.children.length-1;t>=0;t--){const i=this.scene.children[t];"Scene"!==i.type&&"HemisphereLight"!==i.type&&this.scene.remove(i)}}onResize(t){this.renderer.setSize(window.innerWidth/this.canvasRatioOfWindow,window.innerHeight/this.canvasRatioOfWindow),this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.render(this.scene,this.camera)}onMouseClick(t){if(this.targetobject)return void(this.targetobject=void 0);const i=t.target.getBoundingClientRect(),o=-(t.clientY-i.top)/i.height*2+1;this.mouse.x=(t.clientX-i.left)/i.width*2-1,this.mouse.y=o,this.raycaster.setFromCamera(this.mouse,this.camera);const a=this.raycaster.intersectObjects(this.scene.children).find(l=>"roomFloorBase"!==l.object.name&&"Scene"!==l.object.type&&"HemisphereLight"!==l.object.type)?.object;a&&(this.targetobject=a.parent?a.parent:a)}rotateTargetObject(t){if(this.targetobject)switch(t.key){case"q":case"\u0439":this.targetobject.rotation.y-=-.05;break;case"e":case"\u0443":this.targetobject.rotation.y+=-.05}}onMousemove(t){if(!this.targetobject)return;const i=t.target.getBoundingClientRect(),o=-(t.clientY-i.top)/i.height*2+1;this.mouse.x=(t.clientX-i.left)/i.width*2-1,this.mouse.y=o,this.raycaster.setFromCamera(this.mouse,this.camera);const s=this.raycaster.intersectObject(this.rectangleMesh);if(0===s.length)return;const a=s[0].point.x,l=s[0].point.z,u=this.getObjectSize(this.rectangleMesh),c=this.getObjectSize(this.targetobject),f=-u.width/2+c.width/2,h=u.width/2-c.width/2;let g=a;g<f?g=f:g>h&&(g=h);const m=-u.length/2+c.length/2,v=u.length/2-c.length/2;let _=l;_<m?_=m:_>v&&(_=v),this.targetobject.position.set(g,0,_)}abortLoadRoom(){this.abortConroller.abort(),this.abortConroller=new AbortController,this.planHouseComponent.sceneOpenToggle=!1,this.planHouseComponent.closeViewRoom(),this.router.navigateByUrl("/plan/"+this.route.snapshot.params.planId)}getReport(){var t=this;return N(function*(){const i=t.accountCookieService.getJwt();if(!i||!t.roomData?._id)return;const r=t.camera.position.clone(),o=t.camera.rotation.clone();t.camera.position.set(0,7,0),t.camera.rotation.set(Pr_degToRad(-90),0,0),t.renderer.render(t.scene,t.camera);const s=t.renderer.domElement.toDataURL("image/png"),a=yield fetch(s);t.camera.position.copy(r),t.camera.rotation.copy(o),a.ok||t.notification.setError("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0440\u0435\u043d\u0434\u0435\u0440\u0435",5e3);const l=yield a.blob();t.projectService.GETgetReportOfRoom(i,t.roomData?._id,l)})()}deleteModel(){this.targetobject&&(this.scene.remove(this.targetobject),this.saveRoom())}saveRoom(){if(!this.roomData)return;const t=this.scene.children.filter(r=>"roomFloorBase"!==r.name&&"Scene"!==r.type&&"HemisphereLight"!==r.type).map(r=>this.calculateObjectSaveData(r)),i=t;this.roomData.objects=t,this.saveObjectsEmitter.emit(i)}static \u0275fac=function(i){return new(i||n)(se(gi),se(C2),se(Dw),se(ju),se(S2),se(Eu),se(kl),se(bd),se(uA),se(Ea))};static \u0275cmp=mo({type:n,selectors:[["app-scene"]],hostBindings:function(i,r){1&i&&Oe("resize",function(s){return r.onResize(s)},0,Zf)("click",function(s){return r.onMouseClick(s)})("keydown",function(s){return r.rotateTargetObject(s)},!1,Zf)("mousemove",function(s){return r.onMousemove(s)})},inputs:{roomData:"roomData"},outputs:{saveObjectsEmitter:"saveObjectsEmitter"},features:[as],decls:9,vars:3,consts:[["id","canvasContainer"],[1,"functionalsBtnsTemplate"],["title","\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043a\u043e\u043c\u043d\u0430\u0442\u0443",3,"click"],["title","\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043c\u0435\u0431\u0435\u043b\u044c",3,"click",4,"ngIf"],["title","\u0421\u043a\u0430\u0447\u0430\u0442\u044c \u043e\u0442\u0447\u0435\u0442 \u043f\u043e \u043a\u043e\u043c\u043d\u0430\u0442\u0435",3,"click",4,"ngIf"],["class","loader",4,"ngIf"],["title","\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043c\u0435\u0431\u0435\u043b\u044c",3,"click"],["src","/assets/images/deleteIcon.svg","alt",""],["title","\u0421\u043a\u0430\u0447\u0430\u0442\u044c \u043e\u0442\u0447\u0435\u0442 \u043f\u043e \u043a\u043e\u043c\u043d\u0430\u0442\u0435",3,"click"],["src","/assets/images/uploadIcon.png","alt",""],[1,"loader"],[1,"loaderSpan"],[1,"spinnerSpan"],[1,"spinner"],["title","\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0443",3,"click"],["src","/assets/images/addIcon.svg","alt",""],[1,"loadingModelsAlert"],[1,"freezeBrowserAlert"]],template:function(i,r){1&i&&(L(0,"div",0)(1,"span",1)(2,"button",2),Oe("click",function(){return r.saveRoom()}),L(3,"p"),re(4,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),k()(),L(5,"span"),ze(6,Cxe,4,0,"button",3)(7,Sxe,4,0,"button",4),k()()(),ze(8,Exe,10,0,"div",5)),2&i&&(q(6),ee("ngIf",void 0!==r.targetobject),q(),ee("ngIf",void 0===r.targetobject),q(),ee("ngIf",r.isShowLoader))},dependencies:[Cs],styles:['.Loader[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;width:100%;max-width:14.6rem;margin-top:7.3rem;margin-bottom:7.3rem}.Loader[_ngcontent-%COMP%]:before, .Loader[_ngcontent-%COMP%]:after{content:"";position:absolute;border-radius:50%;animation-duration:1.8s;animation-iteration-count:infinite;animation-timing-function:ease-in-out;filter:drop-shadow(0 0 .7555555556rem rgba(255,255,255,.75))}.Loader[_ngcontent-%COMP%]:before{width:100%;padding-bottom:100%;box-shadow:inset 0 0 0 1.7rem #fff;animation-name:_ngcontent-%COMP%_pulsA}.Loader[_ngcontent-%COMP%]:after{width:calc(100% - 3.4rem);padding-bottom:calc(100% - 3.4rem);box-shadow:0 0 #fff;animation-name:_ngcontent-%COMP%_pulsB}@keyframes _ngcontent-%COMP%_pulsA{0%{box-shadow:inset 0 0 0 1.7rem #fff;opacity:1}50%,to{box-shadow:inset 0 0 #fff;opacity:0}}@keyframes _ngcontent-%COMP%_pulsB{0%,50%{box-shadow:0 0 #fff;opacity:0}to{box-shadow:0 0 0 1.7rem #fff;opacity:1}}@font-face{font-family:Calypso;src:url(/assets/fonts/Calypso.ttf) format("truetype");font-weight:400}@font-face{font-family:Courier New;src:url(/assets/fonts/Courier\\ New.ttf) format("truetype");font-weight:400}*[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}html[_ngcontent-%COMP%]{scroll-behavior:smooth}img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}[_nghost-%COMP%]{display:block;height:100%}.funcBtnsSpan[_ngcontent-%COMP%]{position:absolute;left:50%;transform:translate(-50%);bottom:50px;display:flex;gap:10px}.funcBtn[_ngcontent-%COMP%]{background-color:#000;color:#fff;padding:15px;border-radius:10px;border:none;font-family:arial;font-weight:1000;width:25vw;cursor:pointer}#canvasContainer[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:calc(100% - 55px) 50px;gap:5px}.functionalsBtnsTemplate[_ngcontent-%COMP%]{grid-area:2/1/3/2;width:410px;height:50px;justify-self:center;overflow:hidden;display:flex;gap:10px}.functionalsBtnsTemplate[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:200px;height:100%;justify-content:center;background-color:#000;border-radius:10px;border:2px solid rgba(163,177,138,.5);cursor:pointer;transition:border .3s ease-in-out;display:flex;gap:10px;align-items:center}.functionalsBtnsTemplate[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff;font-size:18px}.functionalsBtnsTemplate[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:27px;margin-bottom:3px}.functionalsBtnsTemplate[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{border:2px solid rgba(163,177,138,.8)}@media (max-width: 450px){.functionalsBtnsTemplate[_ngcontent-%COMP%]{display:none}}.loader[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000000b3;display:flex;justify-content:center;align-items:center;z-index:1000;color:#fff}.loader[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-family:Courier New;font-size:16px}.loader[_ngcontent-%COMP%]   .loadingModelsAlert[_ngcontent-%COMP%]{color:#fff}.loader[_ngcontent-%COMP%]   .freezeBrowserAlert[_ngcontent-%COMP%]{color:tomato;margin-top:-10px;animation:_ngcontent-%COMP%_pulse 2s linear infinite}.loaderSpan[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:20px}.spinnerSpan[_ngcontent-%COMP%]{position:relative;width:60px;aspect-ratio:1;display:grid;grid-template-columns:1fr;grid-template-rows:1fr;place-items:center}.spinnerSpan[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{grid-area:1/1/2/2;background:transparent;border:none;cursor:pointer;padding:0;width:20px;aspect-ratio:1;animation:_ngcontent-%COMP%_pulse 1s ease-in-out infinite}.spinnerSpan[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{animation:none;opacity:1}.spinnerSpan[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{rotate:45deg}.spinnerSpan[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{grid-area:1/1/2/2;width:100%;aspect-ratio:1;border:5px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:#fff;animation:_ngcontent-%COMP%_spin 1s linear infinite;box-sizing:border-box}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:0}50%{opacity:1}}']})}return n})();const Txe=["scene"],Axe=["roomsGuideTemplate1"],Dxe=["roomsGuideTemplate2"],Ixe=["roomGuideTemplate"];function Rxe(n,e){1&n&&(L(0,"span",30),re(1," \u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0447\u0438\u0441\u043b\u043e \u043e\u0442 0.1 \u0434\u043e 10 "),k())}function Pxe(n,e){1&n&&(L(0,"span",30),re(1," \u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0447\u0438\u0441\u043b\u043e \u043e\u0442 0.1 \u0434\u043e 10 "),k())}function Oxe(n,e){1&n&&(L(0,"span",30),re(1," \u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0447\u0438\u0441\u043b\u043e \u043e\u0442 0.1 \u0434\u043e 10 "),k())}function Nxe(n,e){1&n&&(L(0,"span",30),re(1," \u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043c\u043d\u0430\u0442\u044b (\u0434\u043e 20) "),k())}function Fxe(n,e){if(1&n){const t=rn();L(0,"button",31),Oe("click",function(){return qe(t),He(me().deleteRoom())}),Te(1,"img",32),k()}}function Lxe(n,e){if(1&n){const t=rn();L(0,"button",33),Oe("touchstart",function(r){const o=qe(t).index,s=me();return He(void 0===s.currentViewRoom?s.clickRoom(r,o):s.openScene())})("keydown.enter",function(r){const o=qe(t).index,s=me();return He(void 0===s.currentViewRoom?s.clickRoom(r,o):s.openScene())})("mousedown",function(r){const o=qe(t).index,s=me();return He(void 0===s.currentViewRoom?s.clickRoom(r,o):s.openScene())}),re(1),k()}if(2&n){const t=e.$implicit,i=e.index,r=me();oo("grid-area",t.gridArea)("display",r.currentViewRoom!==i&&void 0!==r.currentViewRoom||r.sceneOpenToggle?"none":"block"),$s("data-index",i),q(),Ca(" ",t.name," ")}}function kxe(n,e){if(1&n&&(L(0,"a",37),re(1),k()),2&n){const t=e.$implicit;ee("href","/shop/"+t.name,mc),q(),Ca(" ",t.translateMany," ")}}function Bxe(n,e){if(1&n&&(L(0,"span",34)(1,"h3"),re(2,"\u041c\u043e\u0436\u0435\u0442\u0435 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),k(),L(3,"span",35),ze(4,kxe,2,2,"a",36),k()()),2&n){const t=me();q(4),ee("ngForOf",t.categoryArray)}}function Uxe(n,e){if(1&n){const t=rn();L(0,"div",38)(1,"div",39),Te(2,"span",40),L(3,"img",41),Oe("click",function(){return qe(t),He(me().closeGuide())}),k()()()}if(2&n){const t=me();q(2),ee("ngTemplateOutlet",t.guideTemplate)}}function Vxe(n,e){1&n&&(L(0,"div",42)(1,"div",43)(2,"p",44),re(3,"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u043e\u0434\u0438\u043d \u0440\u0430\u0437 \u041b\u041a\u041c \u043d\u0430 \u043a\u043e\u043c\u043d\u0430\u0442e \u0434\u043b\u044f \u0441\u043c\u0435\u043d\u044b \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f"),k(),L(4,"div",45),Te(5,"img",46),k()(),L(6,"div",47),Te(7,"div",48),k(),L(8,"div",43)(9,"p",44),re(10,"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u0434\u0432\u0430 \u0440\u0430\u0437\u0430 \u041b\u041a\u041c \u043d\u0430 \u043a\u043e\u043c\u043d\u0430\u0442e \u0434\u043b\u044f \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043c\u0435\u0431\u0435\u043b\u0438"),k(),L(11,"div",45),Te(12,"img",49),k()()())}function Hxe(n,e){1&n&&(L(0,"div",42)(1,"div",43)(2,"p",44),re(3,"\u0417\u0430\u0436\u043c\u0438\u0442\u0435 \u041b\u041a\u041c \u043d\u0430 \u043a\u043e\u043c\u043d\u0430\u0442\u0435 \u0438 \u043f\u0435\u0440\u0435\u0442\u0430\u0441\u043a\u0438\u0432\u0430\u0439\u0442\u0435"),k(),L(4,"div",50),Te(5,"img",51),k()(),L(6,"div",47),Te(7,"div",48),L(8,"span",52),re(9,"\u0418\u041b\u0418"),k(),Te(10,"div",48),k(),L(11,"div",43)(12,"p",44),re(13,"\u041d\u0430\u0432\u0435\u0434\u0438\u0442\u0435\u0441\u044c \u043d\u0430 TAB \u0438 \u0441 \u0437\u0430\u0436\u0430\u0442\u044b\u043c ENTER \u043d\u0430\u0436\u0438\u043c\u0430\u0439\u0442\u0435 \u0441\u0442\u0440\u0435\u043b\u043e\u0447\u043a\u0438"),k(),L(14,"div",53),Te(15,"img",54),L(16,"div",55),Te(17,"img",56),L(18,"div",57),Te(19,"img",58)(20,"img",59)(21,"img",60),k()()()()())}function zxe(n,e){1&n&&(L(0,"div",42)(1,"div",43)(2,"p",44),re(3,"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u041b\u041a\u041c \u043d\u0430 \u043c\u0435\u0431\u0435\u043b\u0438 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0442\u0430\u0441\u043a\u0438\u0432\u0430\u043d\u0438\u044f \u0438 \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437 \u0434\u043b\u044f \u043e\u0442\u043c\u0435\u043d\u044b"),k(),L(4,"div",45),Te(5,"img",46),k()(),L(6,"div",47),Te(7,"div",48),k(),L(8,"div",43)(9,"p",44),re(10,"\u0412 \u0440\u0435\u0436\u0438\u043c\u0435 \u043f\u0435\u0440\u0435\u0442\u0430\u0441\u043a\u0438\u0432\u0430\u043d\u0438\u044f \u043d\u0430\u0436\u0438\u043c\u0430\u0439\u0442\u0435 Q \u0438 E \u0434\u043b\u044f \u043f\u043e\u0432\u043e\u0440\u043e\u0442\u0430 \u043c\u0435\u0431\u0435\u043b\u0438"),k(),L(11,"div",53)(12,"div",55)(13,"div",57),Te(14,"img",61)(15,"img",62),k()()()()())}let uA=(()=>{class n{renderer;elementRef;categoryService;location;notification;cdr;accountCookieService;constructor(t,i,r,o,s,a,l){this.renderer=t,this.elementRef=i,this.categoryService=r,this.location=o,this.notification=s,this.cdr=a,this.accountCookieService=l}previousGridArea;roomSpan;roomSpanSettings;isDragging=!1;isClick=!1;clickTimer;isDoubleClick=!1;toggleModuleButton;formElement;oldSizeViewRoom=void 0;lastPlanHouse=void 0;categoryArray=[];isGuideIncluded=!1;isGuideVisible=!0;currentViewRoom=void 0;sceneOpenToggle=!1;currentIdClickedRoom=void 0;guideTemplate;planHouse;sceneComponent;initialized=new Oi;planHouseEmitter=new Oi;callSaveEmitter=new Oi;roomsGuideTemplate1;roomsGuideTemplate2;roomGuideTemplate;ngOnInit(){this.checkGuideInclude(),this.initCategories()}ngAfterViewInit(){this.elementRef.nativeElement.parentElement.classList.contains("projectPreviewSpan")&&(this.isGuideIncluded=!1),this.guideTemplate=this.roomsGuideTemplate1,this.cdr.detectChanges(),this.roomSpan=this.elementRef.nativeElement.querySelector(".roomSpan"),this.calculateRoomSpanSettings(),this.formElement=this.elementRef.nativeElement.querySelector("form"),this.toggleModuleButton=this.elementRef.nativeElement.querySelector(".addModuleBtn"),this.initialized.emit()}initCategories(){var t=this;return N(function*(){t.categoryArray=(yield t.categoryService.GETgetAllCategories()).categoryArray})()}showGuide(){this.isGuideVisible=!0}checkGuideInclude(){this.isGuideIncluded="false"!==this.accountCookieService.getGuideRule(),this.isGuideVisible=this.isGuideIncluded}emitPlanHouse(){this.planHouseEmitter.emit(this.planHouse)}saveHouse(){this.callSaveEmitter.emit()}findFreeSpace(t){const r=Array.from({length:10},()=>Array(10).fill(!1));this.planHouse.forEach(o=>{const[s,a,l,u]=o.gridArea.split("/").map(Number);for(let c=s-1;c<l-1;c++)for(let f=a-1;f<u-1;f++)r[c][f]=!0});for(let o=0;o<=10-t.length;o++)for(let s=0;s<=10-t.width;s++){let a=!0;for(let l=o;l<o+t.length;l++){for(let u=s;u<s+t.width;u++)if(r[l][u]){a=!1;break}if(!a)break}if(a){for(let l=o;l<o+t.length;l++)for(let u=s;u<s+t.width;u++)r[l][u]=!0;return`${o+1} / ${s+1} / ${o+t.length+1} / ${s+t.width+1}`}}return this.notification.setError("\u041d\u0435\u0442 \u043c\u0435\u0441\u0442\u0430",15e3),!1}calculateRoomSpanSettings(){const t=this.roomSpan.getBoundingClientRect();this.roomSpanSettings={startX:t.left,startY:t.top-document.documentElement.scrollTop,endX:t.width+t.left,endY:t.height+t.top,gap:+window.getComputedStyle(this.roomSpan).getPropertyValue("gap").slice(0,-2)}}isAreaOccupied(t,i){const[r,o,s,a]=t.split("/").map(Number);for(let l=0;l<this.planHouse.length;l++){if(l===i)continue;const[u,c,f,h]=this.planHouse[l].gridArea.split("/").map(Number);if(r<f&&s>u&&o<h&&a>c)return!0}return!1}calculateGridArea(t,i){if(void 0===this.currentIdClickedRoom)return;const r=this.planHouse[this.currentIdClickedRoom].roomProportions,s=i-this.roomSpanSettings.startY-document.documentElement.scrollTop,a=(this.roomSpanSettings.endX-this.roomSpanSettings.startX)/10+this.roomSpanSettings.gap,l=Math.floor((t-this.roomSpanSettings.startX)/a)+1,u=Math.floor(s/a)+1,c=l+Math.round(r.width)-1,f=u+Math.round(r.length)-1;return c>10||f>10?void 0:`${u} / ${l} / ${f+1} / ${c+1}`}resetRoomPosition(t,i){const r=this.roomSpan.querySelector(`[data-index="${this.currentIdClickedRoom}"]`);if(r){const o=this.calculateGridArea(t,i);o&&!this.isAreaOccupied(o,this.currentIdClickedRoom)?(this.renderer.setStyle(r,"grid-area",o),this.planHouse[this.currentIdClickedRoom].gridArea=o):this.renderer.setStyle(r,"grid-area",this.previousGridArea),this.renderer.removeStyle(r,"background-color"),this.renderer.removeStyle(r,"z-index"),this.currentIdClickedRoom=void 0}}onMouseLeave(t){this.isDragging&&void 0!==this.currentIdClickedRoom&&this.onMouseUp(t)}onMouseUp(t){if(!0!==this.sceneOpenToggle&&void 0===this.currentViewRoom){if(this.isDragging&&void 0!==this.currentIdClickedRoom){if(this.isDragging=!1,t instanceof MouseEvent&&this.resetRoomPosition(t.clientX,t.clientY),typeof TouchEvent<"u"&&t instanceof TouchEvent){const r=t.changedTouches[0];this.resetRoomPosition(r.clientX,r.clientY)}const i=this.elementRef.nativeElement.querySelector('[style*="cursor: grabbing"]');i&&(this.renderer.removeStyle(i,"cursor"),this.renderer.removeStyle(i,"background-color")),this.currentIdClickedRoom=void 0,this.emitPlanHouse()}this.clickTimer=setTimeout(()=>{if(this.isClick&&!this.isDragging){if(null==this.currentIdClickedRoom)return;this.toggleOpenRoomModule(this.currentIdClickedRoom)}this.isClick=!1,this.isDoubleClick=!1,this.isDragging=!1,clearTimeout(this.clickTimer)},250)}}onMouseMove(t){if(t.preventDefault(),this.isDragging&&void 0!==this.currentIdClickedRoom){const i=this.roomSpan.querySelector(`[data-index="${this.currentIdClickedRoom}"]`);if(!i)return;const r=t instanceof MouseEvent?this.calculateGridArea(t.clientX,t.clientY):this.calculateGridArea(t.changedTouches[0].clientX,t.changedTouches[0].clientY);this.renderer.setStyle(i,"z-index","4"),r&&(this.renderer.setStyle(i,"grid-area",r),this.isAreaOccupied(r,this.currentIdClickedRoom)?this.renderer.setStyle(i,"background-color","#F18DC4"):this.renderer.setStyle(i,"background-color","#A3B18A"))}}moveRoom(t){if(void 0===this.currentIdClickedRoom||!this.isDragging)return;const i=this.elementRef.nativeElement.querySelector(`[data-index="${this.currentIdClickedRoom}"]`);let[r,o,s,a]=this.planHouse[this.currentIdClickedRoom].gridArea.split("/").map(Number);switch(t.key){case"ArrowUp":r-=1,s-=1;break;case"ArrowDown":r+=1,s+=1;break;case"ArrowRight":o+=1,a+=1;break;case"ArrowLeft":o-=1,a-=1}if(r<1||o<1||s>11||a>11)return;const l=`${r} / ${o} / ${s} / ${a}`;this.isAreaOccupied(l,this.currentIdClickedRoom)||(this.renderer.setStyle(i,"grid-area",l),this.planHouse[this.currentIdClickedRoom].gridArea=l)}onContextMenu(t){t.preventDefault()}onScroll=(0,Cj.throttle)(()=>{void 0!==this.currentIdClickedRoom&&this.calculateRoomSpanSettings()},100);escapeDraggingMode(){const t=this.elementRef.nativeElement.querySelector('[style*="cursor: grabbing"]');void 0!==this.currentIdClickedRoom&&this.isAreaOccupied(t.style.gridArea,this.currentIdClickedRoom)||(this.isDragging=!1,this.currentIdClickedRoom=void 0,t&&(this.renderer.removeStyle(t,"background-color"),this.renderer.removeStyle(t,"cursor")))}clickRoom(t,i){if(void 0!==this.currentViewRoom)return;this.currentIdClickedRoom=i;const r=t.target;this.previousGridArea=window.getComputedStyle(r).getPropertyValue("grid-area"),this.isClick&&!this.isDragging?(this.isDoubleClick=!0,this.isClick=!1,this.openViewRoom(this.currentIdClickedRoom)):this.isClick=!0,setTimeout(()=>{this.isDoubleClick||!this.isClick||(this.calculateRoomSpanSettings(),this.renderer.setStyle(r,"cursor","grabbing"),this.isDragging=!0,this.renderer.setStyle(r,"background-color","#A3B18A"),this.currentIdClickedRoom=i,this.isClick=!1)},350)}closeGuide(){this.accountCookieService.setGuideRule(),this.isGuideVisible=!1,this.guideTemplate==this.roomsGuideTemplate1&&(this.guideTemplate=this.roomsGuideTemplate2,this.showGuide())}turnoffGuides(t){t?(this.accountCookieService.setGuideRule(),this.guideTemplate=!0===this.sceneOpenToggle&&void 0!==this.currentViewRoom?this.roomGuideTemplate:this.roomsGuideTemplate1):this.accountCookieService.deleteGuideRule(),this.checkGuideInclude()}updateRoomObjects(t){void 0!==this.currentViewRoom&&(this.planHouse[this.currentViewRoom].objects=t,this.emitPlanHouse(),this.saveHouse())}openScene(){this.isGuideIncluded&&(this.guideTemplate=this.roomGuideTemplate,this.showGuide());const t=this.location.path()+"/"+this.currentViewRoom;this.location.replaceState(t),this.sceneOpenToggle=!0,this.sceneComponent.hasBeenChanged&&this.sceneComponent.loadRoom()}closeScene(){const t=this.location.path().split("/").slice(0,-1).join("/");this.location.replaceState(t),this.sceneComponent.saveRoom(),this.sceneOpenToggle=!1}updateRoom(){if(void 0!==this.currentIdClickedRoom&&this.roomForm.value.name){if(this.roomForm.value.name===this.planHouse[this.currentIdClickedRoom].name)return void this.toggleOpenRoomModule();this.planHouse[this.currentIdClickedRoom].name=this.roomForm.value.name,this.roomForm.patchValue({width:null,height:null,length:null,name:""}),this.emitPlanHouse(),this.toggleOpenRoomModule(),this.saveHouse()}}addRoom(){const{width:t,length:i,height:r,name:o}=this.roomForm.value;this.toggleOpenRoomModule();const s={name:o,roomProportions:{width:+t,height:+r,length:+i},objects:[],gridArea:""},a=this.findFreeSpace(s.roomProportions);a&&(s.gridArea=a,this.planHouse=[...this.planHouse,s],this.emitPlanHouse(),this.saveHouse())}deleteRoom(){void 0!==this.currentIdClickedRoom&&(this.planHouse.splice(this.currentIdClickedRoom,1),this.currentIdClickedRoom=void 0,this.toggleOpenRoomModule(),this.emitPlanHouse(),this.saveHouse(),this.toggleControls(!0))}toggleControls(t){t?(this.roomForm.get("width")?.enable(),this.roomForm.get("height")?.enable(),this.roomForm.get("length")?.enable()):(this.roomForm.get("width")?.disable(),this.roomForm.get("height")?.disable(),this.roomForm.get("length")?.disable())}toggleOpenRoomModule(t){if(this.toggleModuleButton){if(void 0!==t){const{width:i,height:r,length:o}=this.planHouse[t].roomProportions;return this.roomForm.patchValue({width:i,height:r,length:o,name:this.planHouse[t].name}),this.toggleControls(!1),this.formElement.classList.add("openAddModule"),void this.renderer.setStyle(this.toggleModuleButton,"rotate","135deg")}this.formElement.classList.contains("openAddModule")?(this.formElement.classList.remove("openAddModule"),this.renderer.setStyle(this.toggleModuleButton,"rotate","0deg"),this.currentIdClickedRoom=void 0,this.roomForm.patchValue({width:null,height:null,length:null,name:""}),this.toggleControls(!0)):(this.formElement.classList.add("openAddModule"),this.renderer.setStyle(this.toggleModuleButton,"rotate","135deg"))}}closeViewRoom(){const t=this.roomSpan.querySelector(`[data-index="${this.currentViewRoom}"]`);!t||!this.oldSizeViewRoom||(this.currentViewRoom=void 0,this.currentIdClickedRoom=void 0,this.renderer.setStyle(t,"width",this.oldSizeViewRoom.width+"px"),this.renderer.setStyle(t,"height",this.oldSizeViewRoom.height+"px"),this.renderer.removeStyle(t,"border"),this.renderer.removeClass(t,"roomView"),this.renderer.setStyle(this.roomSpan,"display","grid"),setTimeout(()=>{this.renderer.removeStyle(t,"width"),this.renderer.removeStyle(t,"height")},768))}openViewRoom(t){this.formElement.classList.remove("openAddModule"),this.currentViewRoom=t,this.lastPlanHouse=this.planHouse[t];const i=this.roomSpan.querySelector(`[data-index="${t}"]`),{width:r,height:o}=i.getBoundingClientRect(),{width:s,height:a}=this.roomSpan.getBoundingClientRect();this.oldSizeViewRoom={height:o,width:r},this.renderer.setStyle(i,"width",r+"px"),this.renderer.setStyle(i,"height",o+"px"),setTimeout(()=>{const l=r>o?s/2/r:a/2/o;this.renderer.setStyle(i,"width",r*l+"px"),this.renderer.setStyle(i,"height",o*l+"px"),this.renderer.setStyle(i,"border","white 3px dashed"),this.renderer.addClass(i,"roomView"),this.renderer.setStyle(this.roomSpan,"display","flex")},0)}roomForm=new Ko({width:new Li(null,[pn.required,pn.min(.1),pn.max(10),pn.pattern(/^\d*\.?\d+$/)]),height:new Li(null,[pn.required,pn.min(.1),pn.max(10),pn.pattern(/^\d*\.?\d+$/)]),length:new Li(null,[pn.required,pn.min(.1),pn.max(10),pn.pattern(/^\d*\.?\d+$/)]),name:new Li("",[pn.required,pn.maxLength(20)])});static \u0275fac=function(i){return new(i||n)(se(Dl),se(gi),se(rO),se(bd),se(kl),se(wu),se(ju))};static \u0275cmp=mo({type:n,selectors:[["app-plan-house"]],viewQuery:function(i,r){if(1&i&&(ys(Txe,5),ys(Axe,7),ys(Dxe,7),ys(Ixe,7)),2&i){let o;Po(o=Oo())&&(r.sceneComponent=o.first),Po(o=Oo())&&(r.roomsGuideTemplate1=o.first),Po(o=Oo())&&(r.roomsGuideTemplate2=o.first),Po(o=Oo())&&(r.roomGuideTemplate=o.first)}},hostBindings:function(i,r){1&i&&Oe("mouseleave",function(s){return r.onMouseLeave(s)},0,ba)("touchend",function(s){return r.onMouseUp(s)},!1,ba)("keyup.Enter",function(s){return r.onMouseUp(s)},!1,ba)("mouseup",function(s){return r.onMouseUp(s)},!1,ba)("mousemove",function(s){return r.onMouseMove(s)},!1,ba)("touchmove",function(s){return r.onMouseMove(s)},!1,ba)("keydown.ArrowUp",function(s){return r.moveRoom(s)},!1,ba)("keydown.ArrowDown",function(s){return r.moveRoom(s)},!1,ba)("keydown.ArrowRight",function(s){return r.moveRoom(s)},!1,ba)("keydown.ArrowLeft",function(s){return r.moveRoom(s)},!1,ba)("contextmenu",function(s){return r.onContextMenu(s)},!1,ba)("scroll",function(){return r.onScroll()},!1,Zf)("keydown.Escape",function(){return r.escapeDraggingMode()},!1,ba)},inputs:{planHouse:"planHouse"},outputs:{initialized:"initialized",planHouseEmitter:"planHouseEmitter",callSaveEmitter:"callSaveEmitter"},decls:46,vars:23,consts:[["scene",""],["roomsGuideTemplate1",""],["roomsGuideTemplate2",""],["roomGuideTemplate",""],[1,"planHouseModule"],[1,"addModuleSpan"],["type","button","tabindex","0",1,"addModuleBtn",3,"click"],["loading","lazy","src","/assets/images/addIcon.svg","alt","",2,"transition","all 0.5s","pointer-events","none"],[1,"addModuleFormContent",3,"ngSubmit","formGroup"],[1,"addModuleTitle"],[1,"addModuleInputSpan"],["for","width",1,"inputLabel"],["placeholder","5","formControlName","width","max","10","min","0.1","id","width","type","number","step","0.01",1,"addModuleInput"],["class","validation-error",4,"ngIf"],["for","length",1,"inputLabel"],["placeholder","3","formControlName","length","max","10","min","0.1","id","length","type","number","step","0.01",1,"addModuleInput"],["for","height",1,"inputLabel"],["placeholder","2.5","formControlName","height","max","10","min","0.1","id","height","type","number","step","0.01",1,"addModuleInput"],["for","name",1,"inputLabel"],["placeholder","\u0413\u043e\u0441\u0442\u0438\u043d\u0430\u044f","formControlName","name","id","name","type","text",1,"addModuleInput"],[1,"functionShopsModuleBtns"],["type","submit",1,"submitAddModuleFormBtn",3,"disabled"],["class","deleteItemAddModuleBtn",3,"click",4,"ngIf"],[1,"workArea"],[1,"guideSwitcher",3,"click","title"],[3,"saveObjectsEmitter","roomData"],[1,"roomSpan"],["class","room",3,"grid-area","display","touchstart","keydown.enter","mousedown",4,"ngFor","ngForOf"],["class","categoriesSpan",4,"ngIf"],["class","guideOverlay",4,"ngIf"],[1,"validation-error"],[1,"deleteItemAddModuleBtn",3,"click"],["loading","lazy","src","/assets/images/deleteIcon.svg","alt",""],[1,"room",3,"touchstart","keydown.enter","mousedown"],[1,"categoriesSpan"],[1,"furnitureCategoriesButtonsSpan"],["class","furnitureCategoryButton",3,"href",4,"ngFor","ngForOf"],[1,"furnitureCategoryButton",3,"href"],[1,"guideOverlay"],[1,"guideSpan"],[1,"guideWindow",3,"ngTemplateOutlet"],["src","assets/images/addIcon.svg","alt","Close",1,"closeIcon",3,"click"],[1,"guideContainer"],[1,"guideSection"],[1,"guideText"],[1,"animationContainer",2,"display","flex","justify-content","center"],["src","assets/images/mouse.svg","alt","Mouse",1,"mouse","pressMouse"],[1,"dividerWithText"],[1,"dividerLine"],["src","assets/images/mouse.svg","alt","Mouse",1,"mouse","pressMousetwice"],[1,"animationContainer"],["src","assets/images/mouse.svg","alt","Mouse",1,"mouse","xMouse"],[1,"dividerText"],[1,"keyboardHint"],["src","assets/images/enter.svg","alt","Enter",1,"enterKey"],[1,"arrowsWrapper"],["src","assets/images/arrowLeft.svg","alt","<--",1,"arrowKey","top",2,"rotate","90deg"],[1,"middleArrows"],["src","assets/images/arrowLeft.svg","alt","<--",1,"arrowKey","left"],["src","assets/images/arrowLeft.svg","alt","<--",1,"arrowKey","bottom",2,"rotate","270deg"],["src","assets/images/arrowLeft.svg","alt","<--",1,"arrowKey","right",2,"rotate","180deg"],["src","assets/images/qButton.svg","alt","q",1,"arrowKey","left",2,"width","50px"],["src","assets/images/eButton.svg","alt","e",1,"arrowKey","right",2,"width","50px"]],template:function(i,r){if(1&i){const o=rn();L(0,"span",4)(1,"span",5)(2,"button",6),Oe("click",function(){return qe(o),He(void 0===r.currentViewRoom?r.toggleOpenRoomModule():!0===r.sceneOpenToggle?r.closeScene():r.closeViewRoom())}),Te(3,"img",7),k(),L(4,"form",8),Oe("ngSubmit",function(){return qe(o),He(void 0===r.currentIdClickedRoom?r.addRoom():r.updateRoom())}),L(5,"h2",9),re(6,"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043a\u043e\u043c\u043d\u0430\u0442\u044b"),k(),L(7,"span",10)(8,"label",11),re(9,"\u0428\u0438\u0440\u0438\u043d\u0430(\u043c)"),k(),Te(10,"input",12),ze(11,Rxe,2,0,"span",13),k(),L(12,"span",10)(13,"label",14),re(14,"\u0414\u043b\u0438\u043d\u0430(\u043c)"),k(),Te(15,"input",15),ze(16,Pxe,2,0,"span",13),k(),L(17,"span",10)(18,"label",16),re(19,"\u0412\u044b\u0441\u043e\u0442\u0430(\u043c)"),k(),Te(20,"input",17),ze(21,Oxe,2,0,"span",13),k(),L(22,"span",10)(23,"label",18),re(24,"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"),k(),Te(25,"input",19),ze(26,Nxe,2,0,"span",13),k(),L(27,"span",20)(28,"button",21),re(29,"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c"),k(),ze(30,Fxe,2,0,"button",22),k()()(),L(31,"span",23)(32,"button",24),Oe("click",function(){return qe(o),He(r.turnoffGuides(!!r.isGuideIncluded))}),re(33),k(),L(34,"app-scene",25,0),Oe("saveObjectsEmitter",function(a){return qe(o),He(r.updateRoomObjects(a))}),k(),L(36,"span",26),ze(37,Lxe,2,6,"button",27)(38,Bxe,5,1,"span",28),k()()(),ze(39,Uxe,4,1,"div",29)(40,Vxe,13,0,"ng-template",null,1,vs)(42,Hxe,22,0,"ng-template",null,2,vs)(44,zxe,16,0,"ng-template",null,3,vs)}if(2&i){let o,s,a,l;q(2),oo("rotate",void 0===r.currentViewRoom?"0deg":"225deg"),q(2),oo("opacity",void 0===r.currentViewRoom?1:0),ee("formGroup",r.roomForm),q(7),ee("ngIf",(null==(o=r.roomForm.get("width"))?null:o.invalid)&&(null==(o=r.roomForm.get("width"))?null:o.touched)),q(5),ee("ngIf",(null==(s=r.roomForm.get("length"))?null:s.invalid)&&(null==(s=r.roomForm.get("length"))?null:s.touched)),q(5),ee("ngIf",(null==(a=r.roomForm.get("height"))?null:a.invalid)&&(null==(a=r.roomForm.get("height"))?null:a.touched)),q(5),ee("ngIf",(null==(l=r.roomForm.get("name"))?null:l.invalid)&&(null==(l=r.roomForm.get("name"))?null:l.touched)),q(2),ee("disabled",!r.roomForm.valid),q(2),ee("ngIf",void 0!==r.currentIdClickedRoom),q(2),ee("title",r.isGuideIncluded?"\u0412\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c":"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c"),q(),Ca(" \u041f\u043e\u0434\u0441\u043a\u0430\u0437\u043a\u0438 \u043f\u043e \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044e ",r.isGuideIncluded?"\u0432\u043a\u043b\u044e\u0447\u0435\u043d\u044b":"\u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u044b"," "),q(),oo("opacity",r.sceneOpenToggle&&void 0!==r.currentViewRoom?1:0)("z-index",r.sceneOpenToggle&&void 0!==r.currentViewRoom?1:0),ee("roomData",void 0!==r.currentViewRoom?r.planHouse[r.currentViewRoom]:r.lastPlanHouse),q(2),dr("viewRoomSmallScreen",void 0!==r.currentViewRoom),q(),ee("ngForOf",r.planHouse),q(),ee("ngIf",!r.sceneOpenToggle&&void 0!==r.currentViewRoom),q(),ee("ngIf",r.isGuideVisible&&r.isGuideIncluded)}},dependencies:[g_,Au,yg,mg,Ed,uT,hg,pg,fT,eO,Ac,yh,Cs,v7],styles:['@charset "UTF-8";@font-face{font-family:Calypso;src:url(/assets/fonts/Calypso.ttf) format("truetype");font-weight:400}@font-face{font-family:Courier New;src:url(/assets/fonts/Courier\\ New.ttf) format("truetype");font-weight:400}*[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}html[_ngcontent-%COMP%]{scroll-behavior:smooth}img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.workArea[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:1fr;grid-area:1/1/2/2}app-scene[_ngcontent-%COMP%]{grid-area:1/1/2/2}.roomSpan[_ngcontent-%COMP%]{grid-area:1/1/2/2;display:grid;gap:10px;grid-template-columns:repeat(10,calc(10% - 10px));grid-template-rows:repeat(10,calc(10% - 10px));aspect-ratio:1;justify-content:space-around;z-index:0}.room[_ngcontent-%COMP%]{background-color:#344e41;border-radius:10px;cursor:pointer;z-index:3;border:none;transition:all .75s ease-in-out,background-color .4s ease-in-out;color:#dad7cd;font-size:1em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.guideSwitcher[_ngcontent-%COMP%]{grid-area:1/1/2/2;height:40px;width:fit-content;padding:10px;align-self:flex-start;justify-self:center;background:none;border:none;border-bottom:1px solid transparent;cursor:pointer;color:gray;margin-top:-45px;transition:all .3s ease-in-out;position:relative}.guideSwitcher[_ngcontent-%COMP%]:hover{color:#fff!important;border-bottom-color:#fff}.guideSwitcher[_ngcontent-%COMP%]:hover:after{width:100%}.guideSwitcher[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:0;width:0;height:1px;background:#fff;transition:width .3s ease-in-out}.dividerWithText[_ngcontent-%COMP%]{display:flex;align-items:center;margin:20px 0}.dividerLine[_ngcontent-%COMP%]{flex:1;height:2px;background-color:#1f1f1f}.dividerText[_ngcontent-%COMP%]{padding:0 10px;color:#666;font-size:14px}.planHouseModule[_ngcontent-%COMP%]{display:grid;grid-template-rows:1fr;grid-template-columns:1fr}.roomView[_ngcontent-%COMP%]{margin-left:30px;align-self:start;margin-top:30px}.addModuleBtn[_ngcontent-%COMP%]{grid-area:1/1/2/2;background:none;border:none;z-index:5;width:35px;aspect-ratio:1;margin-top:10px;justify-self:end;cursor:pointer;rotate:45deg;transition:all .4s ease-in-out}.submitAddModuleFormBtn[_ngcontent-%COMP%]:disabled{background-color:#344e41}.addModuleSpan[_ngcontent-%COMP%]{grid-area:1/1/2/2;display:grid;grid-template-columns:1fr;grid-template-rows:1fr;min-width:300px;width:35%;justify-self:end;padding-right:30px;height:fit-content;margin-top:30px;margin-right:30px}@media (max-width: 450px){.addModuleSpan[_ngcontent-%COMP%]{display:none}}.addModuleFormContent[_ngcontent-%COMP%]{grid-area:1/1/2/2;width:calc(100% - 60px);padding:0 45px;display:flex;flex-direction:column;gap:15px;box-shadow:0 0 5px #fff;overflow:hidden;transition:all .4s ease-in-out;max-height:0;border-radius:10px;background-color:#000;z-index:4}.openAddModule[_ngcontent-%COMP%]{max-height:1000px;padding:30px 45px}.addModuleInputSpan[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px}.inputLabel[_ngcontent-%COMP%]{color:#dad7cd}.addModuleInput[_ngcontent-%COMP%]{border-radius:10px;background-color:transparent;border:#888888 1px solid;padding:10px;outline:none;color:#fff}.addModuleInput.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#ff6b6b;background-color:#ff6b6b0d}.validation-error[_ngcontent-%COMP%]{color:#ff6b6b;font-size:12px;margin-top:4px;display:block;height:16px}.addModuleTitle[_ngcontent-%COMP%]{color:#a3b18a;text-align:center}.functionShopsModuleBtns[_ngcontent-%COMP%]{display:flex;gap:10px}.submitAddModuleFormBtn[_ngcontent-%COMP%]{background-color:#a3b18a;color:#fff;border-radius:10px;padding:15px;width:100%;border:none;cursor:pointer}.deleteItemAddModuleBtn[_ngcontent-%COMP%]{height:50px;aspect-ratio:1;display:flex;align-items:center;justify-content:center;border-radius:10px;background-color:#a3b18a;border:none;cursor:pointer}.deleteItemAddModuleBtn[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{height:25px}.none[_ngcontent-%COMP%]{display:none}.categoriesSpan[_ngcontent-%COMP%]{width:30%;margin-top:100px}.categoriesSpan[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff;text-align:center}.furnitureCategoriesButtonsSpan[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;height:250px;max-height:400px;padding:15px;overflow-y:scroll;overflow-x:hidden;width:100%}.furnitureCategoryButton[_ngcontent-%COMP%]{background-color:#344e41;border-radius:10px;text-align:center;place-content:center;width:100%;height:50px;flex-shrink:0;color:#fff;cursor:pointer;border:none;text-decoration:none;transition:all .3s ease-in-out}.furnitureCategoryButton[_ngcontent-%COMP%]:hover{transform:scale(1.05)}@media (max-width: 768px){.furnitureCategoriesButtonsSpan[_ngcontent-%COMP%]{width:100%}.viewRoomSmallScreen[_ngcontent-%COMP%]{flex-direction:column}.furnitureCategoriesButtonsSpan[_ngcontent-%COMP%]{flex-direction:row;flex-wrap:wrap}.furnitureCategoryButton[_ngcontent-%COMP%]{width:calc(30% - 5px)}.addModuleSpan[_ngcontent-%COMP%]{margin-right:0;padding-right:0}.workArea[_ngcontent-%COMP%]{flex-direction:column}}.furnitureCategory[_ngcontent-%COMP%]{grid-area:1/1/2/2;background-color:#000;z-index:4;display:flex;flex-direction:column;gap:30px;height:0px;padding:0 10px;overflow:hidden;transition:all .5s ease-in-out}.furnitureCategoryTitle[_ngcontent-%COMP%]{text-align:center;color:#fff}.furnitureList[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-around}.openFurniturelist[_ngcontent-%COMP%]{height:100%;padding:50px 10px 10px}.furnitureItem[_ngcontent-%COMP%]{flex:1 1 calc(40% - 10px);display:flex;gap:10px;flex-direction:column;align-items:center}.furnitureTitle[_ngcontent-%COMP%]{color:#fff;text-align:center}.furniturePreview[_ngcontent-%COMP%]{width:80%}.furnitureLink[_ngcontent-%COMP%]{background-color:#fff;color:#000;border-radius:10px;text-align:center;border:none;width:75%;text-decoration:none;height:50px;align-content:center}.guideContainer[_ngcontent-%COMP%]{background-color:#000;border-radius:12px;padding:1.5rem;color:#dad7cd;display:flex;flex-direction:column;gap:1.5rem;max-width:100%;box-sizing:border-box}.guideSection[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem;flex:1}.guideText[_ngcontent-%COMP%]{font-size:clamp(1rem,2vw,1.3rem);margin:0;color:#a3b18a;text-align:center;line-height:1.4}.animationContainer[_ngcontent-%COMP%]{position:relative;width:140px;aspect-ratio:1;margin:.5rem 0}.mouse[_ngcontent-%COMP%]{position:absolute;width:40px}.xMouse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_crossAnimation 3s infinite ease-in-out}.pressMouse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pressAnimation 1.5s infinite ease-in-out}.pressMousetwice[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pressAnimationTwice 1.5s infinite ease-in-out}@keyframes _ngcontent-%COMP%_pressAnimation{0%,40%{transform:translateY(0)}20%{transform:translateY(10px)}}@keyframes _ngcontent-%COMP%_pressAnimationTwice{0%,30%,60%{transform:translateY(0)}15%,45%{transform:translateY(10px)}}.keyboardHint[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.8rem;width:100%;max-width:300px;justify-content:center}.enterKey[_ngcontent-%COMP%]{width:100px;aspect-ratio:2}.middleArrows[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center}.arrowsWrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:10px}.arrowKey[_ngcontent-%COMP%]{width:40px;aspect-ratio:1;opacity:.5;transition:opacity .3s}.arrowKey.top[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulseArrow 2s infinite 0s}.arrowKey.right[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulseArrow 2s infinite .5s}.arrowKey.bottom[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulseArrow 2s infinite 1s}.arrowKey.left[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulseArrow 2s infinite 1.5s}@keyframes _ngcontent-%COMP%_crossAnimation{0%,to{transform:translateY(50%)}25%{transform:translate(100px,50%)}50%{transform:translate(50px)}75%{transform:translate(50px,100%)}}@keyframes _ngcontent-%COMP%_pulseArrow{0%,to{opacity:.5;transform:scale(1)}50%{opacity:1;transform:scale(1.2)}}.guideOverlay[_ngcontent-%COMP%]{position:fixed;inset:0;display:flex;justify-content:center;align-items:center;background-color:#000000b3;z-index:10}.guideOverlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.guideSpan[_ngcontent-%COMP%]{position:relative;background-color:#000;border-radius:12px;padding:2rem;max-width:90%;width:50%;max-height:90vh;overflow-y:auto;box-shadow:0 0 20px #a3b18a4d}.closeIcon[_ngcontent-%COMP%]{position:absolute;top:1rem;right:1rem;width:1.5rem;height:1.5rem;cursor:pointer;rotate:45deg;transition:transform .2s}.closeIcon[_ngcontent-%COMP%]:hover{transform:scale(1.1)}@media (max-width: 768px){.guideContainer[_ngcontent-%COMP%]{padding:1rem;gap:1rem}.animationContainer[_ngcontent-%COMP%]{max-width:150px}.keyboardHint[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}.arrowsWrapper[_ngcontent-%COMP%]{width:60%}.guideSpan[_ngcontent-%COMP%]{padding:1.5rem}}@media (max-width: 480px){.guideText[_ngcontent-%COMP%]{font-size:.9rem}.animationContainer[_ngcontent-%COMP%]{max-width:120px}}']})}return n})();function cA(){return/windows nt|macintosh|x11|linux/.test(navigator.userAgent.toLowerCase())}let E2=(()=>{class n{httpModule;baseServiceUrl=Es+"find?q=";inputFurnitureNameSubject=new Lr("");furnitureName$=this.inputFurnitureNameSubject.asObservable();constructor(t){this.httpModule=t}setFurnitureName(t){this.inputFurnitureNameSubject.next(t)}GETfindFurnitures(t){return nr(this.httpModule.get(this.baseServiceUrl+t))}static \u0275fac=function(i){return new(i||n)(Ze(Mu))};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Gxe=(n,e)=>({variantCardDesktop:n,variantCardMobile:e});function jxe(n,e){1&n&&(L(0,"h3"),re(1,"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e :("),k())}function Wxe(n,e){if(1&n&&(L(0,"span",11)(1,"div")(2,"h3",12),re(3),k(),L(4,"a",13),re(5),r_(6,"costFormat"),k()(),Te(7,"img",14),k()),2&n){const t=e.$implicit,i=me();ee("ngClass",_4(7,Gxe,i.checkDesktop(),!i.checkDesktop())),q(3),Ei(t.name),q(),ee("routerLink",i.getUrl(t.id,t.category)),q(),Ei(o_(6,5,t.cost)),q(2),ee("src",i.getImage(t.id,t.colorRequest),mc)}}let b7=(()=>{class n{finderService;elementRef;renderer;imageService;route;variantsSpan;inputElement;foundFurniture;debounceTimer=null;constructor(t,i,r,o,s){this.finderService=t,this.elementRef=i,this.renderer=r,this.imageService=o,this.route=s}ngAfterViewInit(){this.variantsSpan=this.elementRef.nativeElement.querySelector(".variantsSpan"),this.inputElement=this.elementRef.nativeElement.querySelector(".finderInput")}findFurnitures(t){var i=this;return N(function*(){const r=yield i.finderService.GETfindFurnitures(t);i.openFoundResultsList(),r.length>0?(i.closeFoundResultsList(),setTimeout(()=>{i.foundFurniture=r,i.openFoundResultsList()},400)):void 0!==i.foundFurniture?i.foundFurniture.length=0:i.foundFurniture=[]})()}openFoundResultsList(){this.variantsSpan&&this.renderer.addClass(this.variantsSpan,"variantsSpanOpen")}closeFoundResultsList(){this.variantsSpan&&this.renderer.removeClass(this.variantsSpan,"variantsSpanOpen")}checkDesktop=cA;clearInput(){this.inputElement.value="",this.inputProcess(),this.closeFoundResultsList()}checkShopPage(t){let i=this.route.root;for(;i.firstChild;)i=i.firstChild;return"shop"===i.snapshot.data.pageName&&(this.finderService.setFurnitureName(t),!0)}inputProcess(){const t=this.inputElement.value;clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{0!==t.length?this.checkShopPage(t)||this.findFurnitures(t):this.checkShopPage(t)&&this.closeFoundResultsList()},300)}getImage(t,i){return this.imageService.GETmainImage(t,i)}getUrl(t,i){return`/shop/${i??"all"}/${t}`}static \u0275fac=function(i){return new(i||n)(se(E2),se(gi),se(Dl),se(Ux),se(Eu))};static \u0275cmp=mo({type:n,selectors:[["app-finder"]],decls:12,vars:2,consts:[[1,"finder"],[1,"finderSpan"],["routerLink","/shop","title","\u041f\u043e\u0438\u0441\u043a",1,"finderBtn","btn"],["loading","lazy","src","/assets/images/searchIcon.svg","alt","search"],["placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0431\u0435\u043b\u0438","type","text",1,"finderInput",3,"input"],["title","\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u043f\u043e\u043b\u0435",1,"closeBtn","btn",3,"click"],["src","/assets/images/cancelIcon.svg","alt",""],[1,"variantsSpan"],[4,"ngIf"],["class","variantCard",3,"ngClass",4,"ngFor","ngForOf"],["routerLink","/shop",1,"openShopBtn"],[1,"variantCard",3,"ngClass"],[1,"cardName"],[1,"cardCost",3,"routerLink"],["alt","",1,"cardImage",3,"src"]],template:function(i,r){1&i&&(L(0,"span",0)(1,"span",1)(2,"button",2),Te(3,"img",3),k(),L(4,"input",4),Oe("input",function(){return r.inputProcess()}),k(),L(5,"button",5),Oe("click",function(){return r.clearInput()}),Te(6,"img",6),k()(),L(7,"span",7),ze(8,jxe,2,0,"h3",8)(9,Wxe,8,10,"span",9),L(10,"button",10),re(11,"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043c\u0430\u0433\u0430\u0437\u0438\u043d"),k()()()),2&i&&(q(8),ee("ngIf",void 0!==r.foundFurniture&&0===r.foundFurniture.length),q(),ee("ngForOf",r.foundFurniture))},dependencies:[sg,Au,Cs,hh,hT],styles:['@import"https://fonts.googleapis.com/css2?family=Gloock&display=swap";@font-face{font-family:Calypso;src:url(/assets/fonts/Calypso.ttf) format("truetype");font-weight:400}@font-face{font-family:Courier New;src:url(/assets/fonts/Courier\\ New.ttf) format("truetype");font-weight:400}*[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}html[_ngcontent-%COMP%]{scroll-behavior:smooth}img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.finder[_ngcontent-%COMP%]{width:100%;min-height:100%;display:grid;grid-template-columns:1fr;grid-template-rows:auto 1fr}.finderSpan[_ngcontent-%COMP%]{width:100%;height:48px;display:flex;gap:10px;border-radius:15px;background-color:#fff;padding:0 10px;z-index:3;grid-area:1/1/2/2;align-items:center;justify-content:space-around}.btn[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{height:100%}.btn[_ngcontent-%COMP%]{aspect-ratio:1;background:none;border:none;cursor:pointer}.finderBtn[_ngcontent-%COMP%]{height:90%}.closeBtn[_ngcontent-%COMP%]{height:50%;align-self:center;filter:opacity(.75)}.finderInput[_ngcontent-%COMP%]{width:75%;background:none;border:none;outline:none;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.variantsSpan[_ngcontent-%COMP%]{transition:all .5s ease-in-out;overflow:hidden;max-height:0;grid-area:1/1/2/2;background-color:#000;border-radius:15px;box-shadow:0 0 5px #fff;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;gap:10px;box-sizing:border-box;width:calc(100% + 20px);z-index:2}.variantsSpanOpen[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.variantsSpanOpen[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none;padding:60px 10px 10px;overflow-y:scroll;max-height:400px}.variantCard[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;height:80%;transition:all .5s ease-in-out}.variantCard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{text-align:center}.cardCost[_ngcontent-%COMP%]{border-radius:5px;color:gray;transition:all .5s ease-in-out;cursor:pointer;text-decoration:none;font-variant-numeric:tabular-nums}.variantCardDesktop[_ngcontent-%COMP%]:hover{height:90%}.variantCardDesktop[_ngcontent-%COMP%]:hover   .cardCost[_ngcontent-%COMP%]{padding:15px 45px;color:#000;background-color:#fff}.variantCardDesktop[_ngcontent-%COMP%]:hover   .cardName[_ngcontent-%COMP%]{margin-bottom:25px}.variantCardDesktop[_ngcontent-%COMP%]:hover   .cardImage[_ngcontent-%COMP%]{height:65%}.variantCardMobile[_ngcontent-%COMP%]{height:90%}.variantCardMobile[_ngcontent-%COMP%]   .cardCost[_ngcontent-%COMP%]{margin-top:10px;display:block;padding:0 45px;height:50px;line-height:50px;color:#000;background-color:#fff;font-size:18px}.variantCardMobile[_ngcontent-%COMP%]   .cardName[_ngcontent-%COMP%]{font-size:23px;margin-bottom:50px}.variantCardMobile[_ngcontent-%COMP%]   .cardImage[_ngcontent-%COMP%]{height:65%}.cardImage[_ngcontent-%COMP%]{height:60%;width:fit-content;transition:all .5s ease-in-out}.cardName[_ngcontent-%COMP%]{color:#fff;transition:all .5s ease-in-out}.variantCard[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h3[_ngcontent-%COMP%]{margin:5px 0}.variantsSpan[_ngcontent-%COMP%] > h3[_ngcontent-%COMP%]{color:#fff}.openShopBtn[_ngcontent-%COMP%]{width:200px;border-radius:10px;background-color:#fff;padding:20px;border:none;margin-bottom:10px;transition:transform .2s ease-in-out;cursor:pointer}.openShopBtn[_ngcontent-%COMP%]:hover{transform:scale(1.05)}']})}return n})();function $xe(n,e){if(1&n){const t=rn();L(0,"button",5),Oe("click",function(){return qe(t),He(me().toggleMenu())}),Te(1,"img",6),k()}2&n&&dr("active",me().menuOpen)}function qxe(n,e){1&n&&(L(0,"div",7),Te(1,"app-finder"),L(2,"span",8)(3,"a",9),Te(4,"img",10),k(),L(5,"a",11),Te(6,"img",12),k(),L(7,"a",13),Te(8,"img",14),k(),L(9,"a",15),Te(10,"img",16),k()()())}function Xxe(n,e){1&n&&(L(0,"div",17),Te(1,"app-finder"),L(2,"a",18),Te(3,"img",10),L(4,"div"),re(5,"\u0410\u043a\u043a\u0430\u0443\u043d\u0442"),k()(),L(6,"a",19),Te(7,"img",12),L(8,"div"),re(9,"\u0420\u0430\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430"),k()(),L(10,"a",20),Te(11,"img",14),L(12,"div"),re(13,"\u041c\u0435\u0431\u0435\u043b\u044c"),k()(),L(14,"a",21),Te(15,"img",16),L(16,"div"),re(17,"\u041c\u0430\u0433\u0430\u0437\u0438\u043d"),k()()())}let my=(()=>{class n{menuOpen=!1;isMobileView=!1;ngOnInit(){this.checkViewport()}checkViewport(){this.isMobileView=window.innerWidth<=768,this.isMobileView||(this.menuOpen=!1)}toggleMenu(){this.menuOpen=!this.menuOpen}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=mo({type:n,selectors:[["app-navigation-panel"]],hostBindings:function(i,r){1&i&&Oe("resize",function(s){return r.checkViewport(s)},0,Zf)},decls:6,vars:3,consts:[[1,"navigationSpan"],["routerLink","/",1,"homeBtn","navigationBtn"],["class","hamburger-menu",3,"active","click",4,"ngIf"],["class","desktop-content",4,"ngIf"],["class","mobile-menu",4,"ngIf"],[1,"hamburger-menu",3,"click"],["ng","","loading","lazy","src","/assets/images/hamburgerMenuIcon.svg","alt","menu"],[1,"desktop-content"],[1,"mainBtns"],["title","\u0410\u043a\u043a\u0430\u0443\u043d\u0442","routerLink","/account",1,"accountBtn","navigationBtn"],["loading","lazy","src","/assets/images/accountIcon.svg","alt","account"],["title","\u0420\u0430\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430","routerLink","/plan",1,"createBtn","navigationBtn"],["src","/assets/images/planIcon.svg","alt","plan"],["title","\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u0431\u0435\u043b\u044c","routerLink","/create/new",1,"navigationBtn"],["loading","lazy","src","/assets/images/furnitureIcon.svg","alt","furniture"],["title","\u041c\u0430\u0433\u0430\u0437\u0438\u043d","routerLink","/shop",1,"navigationBtn"],["loading","lazy","src","/assets/images/shopIcon.svg","alt","shop"],[1,"mobile-menu"],["routerLink","/account",1,"mobile-menu-item"],["routerLink","/plan",1,"mobile-menu-item"],["routerLink","/create/new",1,"mobile-menu-item"],["routerLink","/shop",1,"mobile-menu-item"]],template:function(i,r){1&i&&(L(0,"nav",0)(1,"a",1),re(2,"HQ"),k(),ze(3,$xe,2,2,"button",2)(4,qxe,11,0,"div",3)(5,Xxe,18,0,"div",4),k()),2&i&&(q(3),ee("ngIf",r.isMobileView),q(),ee("ngIf",!r.isMobileView),q(),ee("ngIf",r.isMobileView&&r.menuOpen))},dependencies:[hh,b7,Cs],styles:['@charset "UTF-8";@font-face{font-family:Calypso;src:url(/assets/fonts/Calypso.ttf) format("truetype");font-weight:400}@font-face{font-family:Courier New;src:url(/assets/fonts/Courier\\ New.ttf) format("truetype");font-weight:400}*[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}html[_ngcontent-%COMP%]{scroll-behavior:smooth}img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.desktop-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:80%;height:100%}.navigationBtn[_ngcontent-%COMP%] > img[_ngcontent-%COMP%], svg[_ngcontent-%COMP%]{height:100%}app-finder[_ngcontent-%COMP%]{height:80%;width:60%}.homeBtn[_ngcontent-%COMP%]{color:#dad7cd;font-family:Gloock;font-size:27.5px;text-decoration:none;align-content:center}.navigationSpan[_ngcontent-%COMP%]{box-sizing:border-box;display:flex;background-color:#000;border-radius:10px;gap:5px;justify-content:space-around;width:90vw;min-width:768px;margin:0 auto;height:60px;align-items:center;border:1px solid rgba(163,177,138,.3);position:relative}@media (max-width: 768px){.navigationSpan[_ngcontent-%COMP%]{justify-content:space-between;padding:0 15px;min-width:auto}}.navigationBtn[_ngcontent-%COMP%]{height:80%;background:none;border:none;cursor:pointer}.mainBtns[_ngcontent-%COMP%]{height:75%;display:flex;gap:15px;align-items:center}.createBtn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:sepia(4%)}.hamburger-menu[_ngcontent-%COMP%]{display:none;background:none;border:none;cursor:pointer;padding:0;height:30px;width:30px;transition:all .5s ease-in-out}.hamburger-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.hamburger-menu.active[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:brightness(0) saturate(100%) invert(64%) sepia(11%) saturate(1233%) hue-rotate(71deg) brightness(92%) contrast(86%)}@media (max-width: 768px){.hamburger-menu[_ngcontent-%COMP%]{display:block}}.mobile-menu[_ngcontent-%COMP%]{display:none;position:absolute;top:100%;margin-top:10px;left:0;right:0;background-color:#000;border-radius:10px;padding:15px;flex-direction:column;gap:15px;z-index:100;border:1px solid rgba(163,177,138,.3)}.mobile-menu[_ngcontent-%COMP%]   app-finder[_ngcontent-%COMP%]{width:calc(100% - 20px);margin-bottom:10px;height:40px}.mobile-menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;color:#dad7cd;text-decoration:none;padding:8px}.mobile-menu-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .mobile-menu-item[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px}.mobile-menu-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px}@media (max-width: 768px){.desktop-content[_ngcontent-%COMP%]{display:none}.mobile-menu[_ngcontent-%COMP%]{display:flex}}']})}return n})();const Yxe={name:"Onte Bucle White",colors:[{color:"#FFC2CC",imagesData:{images:["/assets/images/sofaSliderPhotos/1.png","/assets/images/sofaSliderPhotos/2.png","/assets/images/sofaSliderPhotos/3.png","/assets/images/sofaSliderPhotos/4.png"],idMainImage:0}}],description:"\u041c\u0435\u0445\u0430\u043d\u0438\u0437\u043c: \u043f\u0430\u043d\u0442\u043e\u0433\u0440\u0430\u0444\n\u0412\u044b\u0441\u043e\u0442\u0430 \u043e\u0442 \u043f\u043e\u043b\u0430: 12 \u0441\u043c\n\u042f\u0449\u0438\u043a \u0434\u043b\u044f \u0431\u0435\u043b\u044c\u044f: \u0434\u0430\n\u041c\u0430\u043a\u0441. \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430: 100 \u043a\u0433",shops:[{cost:125990,url:"https://www.divan.ru/blagoveshchensk/product/divan-uglovoj-onte-bucle-white"},{cost:84990,url:"https://avtorm.ru/catalog/product-divan-uglovoy-onte-bucle-white"}],additionalData:{category:"sofa"},proportions:{width:1,height:1,length:1}},Zxe=[{name:"\u041f\u0440\u0438\u0445\u043e\u0436\u0430\u044f",objects:[],gridArea:"1 / 1 / 3 / 4",roomProportions:{width:3,length:2,height:3}},{name:"\u0421\u0430\u043d\u0443\u0437\u0435\u043b",objects:[],gridArea:"3 / 1 / 4 / 2",roomProportions:{width:1,length:1,height:3}},{name:"\u0421\u0430\u043d\u0443\u0437\u0435\u043b",objects:[],gridArea:" 4 / 1 / 5 / 2",roomProportions:{width:1,length:1,height:3}},{name:"\u0413\u043e\u0441\u0442\u0438\u043d\u043d\u0430\u044f",objects:[],gridArea:"5 / 1 / 8 / 5",roomProportions:{width:4,length:3,height:3}},{name:"\u0421\u043f\u0430\u043b\u044c\u043d\u044f",objects:[],gridArea:" 3 / 2 / 5 / 4",roomProportions:{width:2,length:2,height:3}}],w7=n=>({activeChapterBtn:n}),x7=n=>({opacityDisable:n});function Kxe(n,e){1&n&&(L(0,"span",24)(1,"div",25)(2,"span",26),Te(3,"div")(4,"div")(5,"div")(6,"div"),k()(),L(7,"span",27)(8,"span",28),Te(9,"div",29)(10,"div",30)(11,"div",31)(12,"div",32),k(),L(13,"h1",33),re(14,"HOUSEQUALITY"),k(),L(15,"span",34)(16,"button",35),re(17,"\u041c\u0430\u0433\u0430\u0437\u0438\u043d"),k(),L(18,"button",36),re(19,"\u041c\u0435\u0431\u0435\u043b\u044c"),k(),L(20,"button",37),re(21,"\u041f\u0440\u043e\u0435\u043a\u0442\u044b"),k(),L(22,"button",38),re(23,"\u0410\u043a\u043a\u0430\u0443\u043d\u0442"),k()()()())}function Jxe(n,e){1&n&&(L(0,"a",39),re(1,"\u041f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u043a\u0430"),k())}let Qxe=(()=>{class n{elementRef;router;constructor(t,i){this.elementRef=t,this.router=i}furnitureTemplate="create";furnitureExampleData=Yxe;planHouseExampleData=Zxe;isMobileView=!1;ngAfterViewInit(){this.elementRef.nativeElement.querySelectorAll("app-create-furniture,app-plan-house").forEach(t=>{t.querySelectorAll("*").forEach(i=>{i.setAttribute("tabindex","-1"),i.style.pointerEvents="none"})})}ngOnInit(){this.checkViewport()}checkViewport(){this.isMobileView=window.innerWidth<=600}focusFinder(){const t=this.elementRef.nativeElement.querySelector(".finderInput");t&&t.focus()}openViewFurniture(){this.furnitureTemplate="view"}openCreateFurniture(){this.furnitureTemplate="create"}navigateToPage(t){this.router.navigateByUrl(t)}static \u0275fac=function(i){return new(i||n)(se(gi),se(Ea))};static \u0275cmp=mo({type:n,selectors:[["app-main-page"]],hostBindings:function(i,r){1&i&&Oe("resize",function(s){return r.checkViewport(s)},0,Zf)},decls:60,vars:17,consts:[["class","startScreenSpan",4,"ngIf"],[1,"mainInformation"],[1,"projectPreviewSpan"],[1,"someSpan"],[1,"chapterTitle",2,"margin-bottom","0"],[1,"descriptionText"],[1,"exampleFunctions"],[1,"quarter-circle","figureFunction"],[1,"exampleFunctionTitle"],[1,"exampleFunctionDescription"],[1,"square","figureFunction",2,"border-radius","20px"],[1,"chapterTitle"],[1,"chapterChangeBtnsSpan"],[1,"changeChapterBtn",3,"click","ngClass"],[1,"furnitureModule"],[1,"furnitureModuleVariant",3,"click","furnitureData","ngClass"],[3,"click","planHouse"],[1,"footerColumnsSpan"],[1,"footerColumn"],[1,"footerMenuBtn",2,"color","#DAD7CD",3,"click"],["routerLink","/account",1,"footerMenuBtn"],["routerLink","/create/new",1,"footerMenuBtn",2,"color","#DAD7CD"],["routerLink","/plan","class","footerMenuBtn",4,"ngIf"],[1,"projectFooterTitle"],[1,"startScreenSpan"],[1,"circleDecoration"],[1,"circleDecorationSpan"],[1,"startInformationSpan"],[1,"decorationFigures"],[1,"quarter-circle"],[1,"square"],[1,"parallelogram"],[1,"circle"],[1,"projectTitle"],[1,"navigationStartMenu"],["routerLink","/shop",1,"startNavigationBtn"],["routerLink","/create/new",1,"startNavigationBtn"],["routerLink","/plan",1,"startNavigationBtn"],["routerLink","/account",1,"startNavigationBtn"],["routerLink","/plan",1,"footerMenuBtn"]],template:function(i,r){1&i&&(ze(0,Kxe,24,0,"span",0),L(1,"span",1),Te(2,"app-navigation-panel"),L(3,"span",2)(4,"span",3)(5,"h2",4),re(6,"\u0412\u0430\u0448 \u0438\u0434\u0435\u0430\u043b\u044c\u043d\u044b\u0439 \u0434\u043e\u043c"),k(),L(7,"h3",5),re(8,"HouseQuality - \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0430 \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0438\u0434\u0435\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0434\u043e\u043c\u0430. \u0417\u0430\u0439\u0434\u0438\u0442\u0435 \u0432 \u043d\u0430\u0448 \u043c\u0430\u0433\u0430\u0437\u0438\u043d \u0446\u0438\u0444\u0440\u043e\u0432\u043e\u0433\u043e \u0434\u0438\u0437\u0430\u0439\u043d\u0430 \u0438 \u043d\u0430\u0447\u043d\u0438\u0442\u0435 \u0441\u0432\u043e\u0435 \u043f\u0443\u0442\u0435\u0448\u0435\u0441\u0442\u0432\u0438\u0435!"),k(),L(9,"span",6)(10,"div",7)(11,"h2",8),re(12,"\u0421\u0442\u0438\u043b\u044c"),k(),L(13,"h3",9),re(14,"\u0412\u0430\u0448\u0430 \u0438\u0434\u0435\u044f"),k()(),L(15,"div",10)(16,"h2",8),re(17,"\u0414\u043e\u043c"),k(),L(18,"h3",9),re(19,"\u0412\u0430\u0448\u0430 \u0437\u043e\u043d\u0430"),k()(),L(20,"div",7)(21,"h2",8),re(22,"\u041f\u043b\u0430\u043d"),k(),L(23,"h3",9),re(24,"\u041d\u043e\u0432\u044b\u0439 \u0432\u0438\u0434"),k()(),L(25,"div",10)(26,"h2",8),re(27,"\u041c\u0435\u0431\u0435\u043b\u044c"),k(),L(28,"h3",9),re(29,"\u0411\u043e\u043b\u044c\u0448\u043e\u0439 \u0432\u044b\u0431\u043e\u0440"),k()()()(),L(30,"span",3)(31,"h2",11),re(32,"\u0421\u043e\u0437\u0434\u0430\u0435\u043c \u0438 \u0432\u043e\u043f\u043b\u043e\u0449\u0430\u0435\u043c \u0432\u0430\u0448\u0438 \u043c\u0435\u0447\u0442\u044b"),k(),L(33,"span",12)(34,"button",13),Oe("click",function(){return r.openCreateFurniture()}),re(35,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u0431\u0435\u043b\u044c"),k(),L(36,"button",13),Oe("click",function(){return r.openViewFurniture()}),re(37,"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043c\u0435\u0431\u0435\u043b\u044c"),k()()(),L(38,"span",14)(39,"app-create-furniture",15),Oe("click",function(){return r.navigateToPage("/create/new")}),k(),L(40,"app-view-furniture",15),Oe("click",function(){return r.navigateToPage("/shop")}),k()(),L(41,"span",3)(42,"h2",11),re(43,"\u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u0441\u0432\u043e\u0439 \u0434\u043e\u043c"),k(),L(44,"h3",5),re(45,"\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u043a\u043e\u043c\u043d\u0430\u0442\u044b \u0438 \u043f\u0435\u0440\u0435\u0434\u0432\u0438\u043d\u044c\u0442\u0435 \u0438\u0445"),k()(),L(46,"app-plan-house",16),Oe("click",function(){return r.navigateToPage("/plan")}),k()()(),L(47,"footer")(48,"span",17)(49,"span",18)(50,"a",19),Oe("click",function(){return r.focusFinder()}),re(51,"\u041d\u0430\u0439\u0442\u0438 \u043c\u0435\u0431\u0435\u043b\u044c"),k(),L(52,"a",20),re(53,"\u0410\u043a\u043a\u0430\u0443\u043d\u0442"),k()(),L(54,"span",18)(55,"a",21),re(56,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u0431\u0435\u043b\u044c"),k(),ze(57,Jxe,2,0,"a",22),k()(),L(58,"h2",23),re(59,"HouseQuality 2025"),k()()),2&i&&(ee("ngIf",!r.isMobileView),q(34),ee("ngClass",Sa(9,w7,"create"===r.furnitureTemplate)),q(2),ee("ngClass",Sa(11,w7,"view"===r.furnitureTemplate)),q(3),ee("furnitureData",r.furnitureExampleData)("ngClass",Sa(13,x7,"view"===r.furnitureTemplate)),q(),ee("furnitureData",r.furnitureExampleData)("ngClass",Sa(15,x7,"create"===r.furnitureTemplate)),q(6),ee("planHouse",r.planHouseExampleData),q(11),ee("ngIf",!r.isMobileView))},dependencies:[pT,Tj,uA,sg,my,hh,Cs],styles:['@import"https://fonts.googleapis.com/css2?family=Gloock&display=swap";@font-face{font-family:Calypso;src:url(/assets/fonts/Calypso.ttf) format("truetype");font-weight:400}@font-face{font-family:Courier New;src:url(/assets/fonts/Courier\\ New.ttf) format("truetype");font-weight:400}*[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}html[_ngcontent-%COMP%]{scroll-behavior:smooth}img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.startScreenSpan[_ngcontent-%COMP%]{width:100vw;display:grid;grid-template-columns:1fr;grid-template-rows:1fr;padding-top:5vh;overflow:hidden;background:#a3b18a;background:linear-gradient(0deg,#a3b18a,#dad7cd)}@media (max-width: 600px){.startScreenSpan[_ngcontent-%COMP%]{padding-top:3vh}}.circleDecoration[_ngcontent-%COMP%]{grid-area:1/1/2/2}.circleDecorationSpan[_ngcontent-%COMP%]{clip-path:inset(0 0 50% 0);margin-bottom:-50%;display:grid;aspect-ratio:1;place-items:center;content-visibility:auto}.circleDecorationSpan[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{background-color:#3a5a40;border-radius:50%;grid-area:1/1/2/2;aspect-ratio:1;animation:_ngcontent-%COMP%_wave 2s infinite ease-in-out}.circleDecorationSpan[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(1){opacity:1;width:50%;animation-delay:0s}.circleDecorationSpan[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2){opacity:.8;width:65%;animation-delay:.3s}.circleDecorationSpan[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(3){opacity:.6;width:80%;animation-delay:.6s}.circleDecorationSpan[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(4){opacity:.4;width:95%;animation-delay:.9s}@keyframes _ngcontent-%COMP%_wave{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}.decorationFigures[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:30px;height:45px;width:350px;grid-area:1/1/2/2;z-index:1;justify-content:center}@media (max-width: 600px){.decorationFigures[_ngcontent-%COMP%]{width:280px;gap:15px;height:35px}}.parallelogram[_ngcontent-%COMP%]{border-radius:10px;aspect-ratio:1/2;transform:skew(-20deg);background-color:#344e41;height:100%}.quarter-circle[_ngcontent-%COMP%]{aspect-ratio:1;border-radius:100% 10px 10px;background-color:#344e41;height:100%}.square[_ngcontent-%COMP%]{border-radius:10px;aspect-ratio:1;background-color:#344e41;height:100%}.circle[_ngcontent-%COMP%]{width:39px;height:39px;position:relative;border:3px solid #344E41;border-radius:50%}.circle[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:39px;height:39px;background-color:#344e41;border-radius:50%;clip-path:inset(0 50% 0 0)}.circle[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;width:39px;height:39px;background-color:transparent;border-radius:50%}.startInformationSpan[_ngcontent-%COMP%]{display:flex;gap:20px;flex-direction:column;align-items:center;grid-area:1/1/2/2;z-index:1;margin-top:10px}@media (max-width: 600px){.startInformationSpan[_ngcontent-%COMP%]{gap:15px;margin-top:5px}}.projectTitle[_ngcontent-%COMP%]{font-family:Gloock;font-size:8vw;font-weight:400;color:#000}@media (max-width: 600px){.projectTitle[_ngcontent-%COMP%]{font-size:12vw}}.navigationStartMenu[_ngcontent-%COMP%]{display:flex;gap:10px}@media (max-width: 768px){.navigationStartMenu[_ngcontent-%COMP%]{display:none}}.startNavigationBtn[_ngcontent-%COMP%]{padding:5px;background:none;border:none;font-size:1.75vw;cursor:pointer;text-decoration:none;color:#000}.mainInformation[_ngcontent-%COMP%]{background-color:#000;display:flex;flex-direction:column;align-items:center;gap:50px;padding:50px;width:calc(100vw - 100px)}@media (max-width: 600px){.mainInformation[_ngcontent-%COMP%]{padding:30px 15px;width:calc(100vw - 30px);gap:30px}}.someSpan[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px;justify-content:start}@media (max-width: 600px){.someSpan[_ngcontent-%COMP%]{width:100%;align-items:center;text-align:center}}.chapterTitle[_ngcontent-%COMP%]{font-family:Calypso;font-weight:700;font:3.5vw/1 Calypso;color:#dad7cd;width:60%}@media (max-width: 1024px){.chapterTitle[_ngcontent-%COMP%]{font-size:5vw}}@media (max-width: 768px){.chapterTitle[_ngcontent-%COMP%]{font-size:6vw}}@media (max-width: 600px){.chapterTitle[_ngcontent-%COMP%]{font-size:7vw;width:90%}}.descriptionText[_ngcontent-%COMP%]{color:#a3b18a;width:50%;font-size:20px}@media (max-width: 768px){.descriptionText[_ngcontent-%COMP%]{width:65%}}@media (max-width: 600px){.descriptionText[_ngcontent-%COMP%]{width:90%;font-size:4vw}}.exampleFunctions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;flex-direction:row;gap:50px;font-size:15px}@media (max-width: 768px){.exampleFunctions[_ngcontent-%COMP%]{width:350px}}@media (max-width: 600px){.exampleFunctions[_ngcontent-%COMP%]{height:auto;flex-wrap:wrap;gap:20px;justify-content:center}}.figureFunction[_ngcontent-%COMP%]{display:flex;height:150px;flex-direction:column;justify-content:center;gap:5px;background-color:#344e41b3}.figureFunction[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{text-align:left;margin-left:-10px}@media (max-width: 600px){.figureFunction[_ngcontent-%COMP%]{width:40%;height:120px}}.exampleFunctionTitle[_ngcontent-%COMP%]{font-family:Calypso;font-weight:700;font-size:25px;color:#dad7cd;margin:0 0 0 -10px;cursor:default}@media (max-width: 600px){.exampleFunctionTitle[_ngcontent-%COMP%]{font-size:5vw}}.exampleFunctionDescription[_ngcontent-%COMP%]{color:#a3b18a}@media (max-width: 600px){.exampleFunctionDescription[_ngcontent-%COMP%]{font-size:3.5vw}}.chapterChangeBtnsSpan[_ngcontent-%COMP%]{display:flex;gap:30px;width:450px}@media (max-width: 600px){.chapterChangeBtnsSpan[_ngcontent-%COMP%]{justify-content:center;width:100%;gap:15px}}.changeChapterBtn[_ngcontent-%COMP%]{line-height:50px;cursor:pointer;background-color:#344e41;color:#fff;border:none;border-radius:10px;width:50%;aspect-ratio:4;font-size:1.15rem;transition:all .5s ease-in-out}@media (max-width: 600px){.changeChapterBtn[_ngcontent-%COMP%]{font-size:15px;padding:10px;width:calc(50% - 20px);height:50px;line-height:normal}}.projectPreviewSpan[_ngcontent-%COMP%]{width:80%;min-width:550px}@media (max-width: 1100px){.projectPreviewSpan[_ngcontent-%COMP%]{width:100%}}@media (max-width: 600px){.projectPreviewSpan[_ngcontent-%COMP%]{min-width:auto}}.activeChapterBtn[_ngcontent-%COMP%]{background-color:#a3b18a;color:#000}.furnitureModule[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:1fr;place-items:center}.furnitureModuleVariant[_ngcontent-%COMP%]{display:block;grid-area:1/1/2/2;transition:all .5s ease-in-out;width:100%;z-index:1}.opacityDisable[_ngcontent-%COMP%]{opacity:0;z-index:-1}app-plan-house[_ngcontent-%COMP%]{margin-top:50px;width:calc(100vw - 100px)}@media (max-width: 600px){app-plan-house[_ngcontent-%COMP%]{width:100%}}footer[_ngcontent-%COMP%]{width:calc(100vw - 200px);background-color:#000;padding:100px;display:flex;flex-direction:column;gap:50px}@media (max-width: 600px){footer[_ngcontent-%COMP%]{width:calc(100vw - 40px);padding:50px 20px;gap:30px}}.footerColumnsSpan[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-around;width:100%}@media (max-width: 600px){.footerColumnsSpan[_ngcontent-%COMP%]{flex-direction:column;gap:30px}}.footerColumn[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px}@media (max-width: 600px){.footerColumn[_ngcontent-%COMP%]{align-items:center}}.footerColumn[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none}.footerMenuBtn[_ngcontent-%COMP%]{background:none;color:#a3b18a;font-size:18px;border:none;text-align:start;cursor:pointer}@media (max-width: 600px){.footerMenuBtn[_ngcontent-%COMP%]{font-size:4.5vw;text-align:center}}.projectFooterTitle[_ngcontent-%COMP%]{color:#a3b18a;color:1.15vw;font-weight:400;text-align:center;cursor:default}@media (max-width: 600px){.projectFooterTitle[_ngcontent-%COMP%]{font-size:4.5vw}}app-navigation-panel[_ngcontent-%COMP%]{margin-left:calc(-50vw + 50%);position:sticky;top:30px;z-index:6;width:100%}@media (max-width: 600px){app-navigation-panel[_ngcontent-%COMP%]{top:15px}}app-view-furniture[_ngcontent-%COMP%], app-create-furniture[_ngcontent-%COMP%], app-plan-house[_ngcontent-%COMP%]{display:block;cursor:pointer;width:100%}']})}return n})();function T2(n){return"email"===n.accountType}let Vx=(()=>{class n{httpModule;accountCookieService;baseServiceUrl=Es+"account";constructor(t,i){this.httpModule=t,this.accountCookieService=i}POSTcreateAccount(t){let i=(new di).set("accountType",t.accountType).set("nickname",t.nickname);return T2(t)&&(i=i.set("email",t.email).set("password",t.password)),nr(this.httpModule.post(this.baseServiceUrl,i))}DELETEaccountJwt(t){const i=(new di).set("jwt",t);return nr(this.httpModule.delete(this.baseServiceUrl+"/jwt/delete",{params:i}))}PUTupdateSecondaryAccountData(t){const i=new di({fromObject:{nickname:t.nickname,jwt:t.jwt}});return nr(this.httpModule.put(this.baseServiceUrl,null,{params:i}))}DELETEaccount(t){const i=(new di).set("jwt",t);return nr(this.httpModule.delete(this.baseServiceUrl,{params:i}))}GETaccount(t){var i=this;return N(function*(){const r=(new di).set("jwt",t);try{let{accountData:o}=yield nr(i.httpModule.get(i.baseServiceUrl,{params:r}));return o.furnitures=o.furnitures.map(s=>({...s,previewUrl:Es+s.previewUrl})),{accountData:o}}catch(o){throw console.error("Error in GETfurnitureCard:",o),o}})()}checkJwt(){return!!this.accountCookieService.getJwt()}static \u0275fac=function(i){return new(i||n)(Ze(Mu),Ze(ju))};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),A2=(()=>{class n{httpModule;baseServiceUrl=Es+"auth/";constructor(t){this.httpModule=t}POSTcreateLongJWT(t){let i=(new di).set("accountType",t.accountType);return T2(t)&&(i=i.set("email",t.email).set("password",t.password)),nr(this.httpModule.post(this.baseServiceUrl+"jwt/long",i))}POSTcreateShortJWT(t){let i=(new di).set("email",t);return nr(this.httpModule.post(this.baseServiceUrl+"jwt/temporary",null,{params:i}))}PUTupdateBaseData(t){const i={accountType:t.accountType,jwt:t.jwt};return T2(t)&&(i.password=t.password),new di({fromObject:i}),nr(this.httpModule.put(this.baseServiceUrl+"account",t))}GETrequestPasswordCode(t){let i=(new di).set("email",t);return nr(this.httpModule.get(this.baseServiceUrl+"account/code",{params:i}))}static \u0275fac=function(i){return new(i||n)(Ze(Mu))};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function eMe(n,e){1&n&&Te(0,"div",43),2&n&&oo("grid-area",e.$implicit.gridArea)}function tMe(n,e){if(1&n){const t=rn();L(0,"div",39),Oe("click",function(){const r=qe(t).index;return He(me(2).openProject(r))}),L(1,"h4",40),re(2),k(),L(3,"div",41),ze(4,eMe,1,2,"div",42),k()()}if(2&n){const t=e.$implicit;q(2),Ei(t.name),q(2),ee("ngForOf",t.rooms)}}function nMe(n,e){if(1&n&&(L(0,"a",44)(1,"h4",45),re(2),k(),Te(3,"img",46),k()),2&n){const t=e.$implicit;ee("routerLink","/create/"+t._id),q(2),Ei(t.name),q(),ee("src",t.previewUrl,mc)}}function iMe(n,e){if(1&n){const t=rn();L(0,"div",14)(1,"div",15)(2,"div",16),Te(3,"img",17),L(4,"label",18)(5,"input",19),Oe("change",function(r){return qe(t),He(me().uploadAvatar(r))}),k(),Te(6,"img",20),k()(),L(7,"div",21)(8,"h2",22),re(9),k(),L(10,"div",23)(11,"div",24)(12,"span",25),re(13,"\u041f\u0440\u043e\u0435\u043a\u0442\u044b:"),k(),L(14,"span",26),re(15),k()(),L(16,"div",24)(17,"span",25),re(18,"\u041c\u0435\u0431\u0435\u043b\u044c:"),k(),L(19,"span",26),re(20),k()(),L(21,"div",24)(22,"span",25),re(23,"Email:"),k(),L(24,"span",26),re(25),k()()()(),L(26,"div",27)(27,"button",28),Oe("click",function(){return qe(t),He(me().openEditForm())}),Te(28,"img",29),k(),L(29,"button",30),Oe("click",function(){return qe(t),He(me().logout())}),Te(30,"img",31),k()()(),L(31,"div",32)(32,"h3",33),re(33,"\u041c\u043e\u0438 \u043f\u0440\u043e\u0435\u043a\u0442\u044b"),k(),L(34,"div",34),ze(35,tMe,5,2,"div",35),k()(),L(36,"div",36)(37,"h3",33),re(38,"\u041c\u043e\u044f \u043c\u0435\u0431\u0435\u043b\u044c"),k(),L(39,"div",37),ze(40,nMe,4,3,"a",38),k()()()}if(2&n){const t=me();q(3),ee("src",t.accountData.avatarUrl,mc),q(6),Ei(t.accountData.nickname),q(6),Ei(t.accountData.projects.length),q(5),Ei(t.accountData.furnitures.length),q(5),Ei(t.accountData.email),q(10),ee("ngForOf",t.accountData.projects),q(5),ee("ngForOf",t.accountData.furnitures)}}function rMe(n,e){1&n&&(L(0,"div",47),re(1," \u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f "),k())}function oMe(n,e){1&n&&(L(0,"div",47),re(1," \u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0443\u043c 6 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 "),k())}function sMe(n,e){if(1&n&&(L(0,"div",8)(1,"label",48),re(2,"\u041d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c"),k(),Te(3,"input",49),ze(4,oMe,2,0,"div",11),k()),2&n){let t,i;const r=me();q(3),dr("invalid",(null==(t=r.editForm.get("password"))?null:t.invalid)&&(null==(t=r.editForm.get("password"))?null:t.touched)),q(),ee("ngIf",(null==(i=r.editForm.get("password"))?null:i.invalid)&&(null==(i=r.editForm.get("password"))?null:i.touched))}}let aMe=(()=>{class n{accountService;router;accountCookieService;imageServerControlService;imageClientControlService;authService;notification;accountData;isEditFormOpen=!1;editForm;constructor(t,i,r,o,s,a,l){this.accountService=t,this.router=i,this.accountCookieService=r,this.imageServerControlService=o,this.imageClientControlService=s,this.authService=a,this.notification=l}ngOnInit(){this.checkAuthAndLoadData(),this.initEditForm()}updateSecondaryAccountData(t){var i=this;return N(function*(){if(!i.accountData)return;const r={jwt:t,nickname:i.editForm.value.nickname};try{yield i.accountService.PUTupdateSecondaryAccountData(r),i.accountData.nickname=i.editForm.value.nickname,i.notification.setSuccess("\u0414\u0430\u043d\u043d\u044b\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b",5e3)}catch(o){throw i.notification.setError("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043d\u0438\u043a\u043d\u0435\u0439\u043c\u0430",5e3),console.error(o),o}})()}saveChanges(){var t=this;return N(function*(){if(!t.accountData||!t.editForm.valid)return void t.notification.setError("\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0444\u043e\u0440\u043c\u044b",5e3);const i=t.accountCookieService.getJwt(),r=t.accountCookieService.getUserType();if(i&&r)try{yield t.updateSecondaryAccountData(i),yield t.updateBaseDataIfNeeded(i,r),t.closeEditForm(),t.notification.setSuccess("\u0414\u0430\u043d\u043d\u044b\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b",5e3)}catch(o){t.notification.setError("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445",5e3),console.error(o)}else t.notification.setError("\u041e\u0448\u0438\u0431\u043a\u0430 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438",5e3)})()}updateBaseDataIfNeeded(t,i){var r=this;return N(function*(){if(void 0===r.accountData?.password||!r.editForm.value.password||"google"===i)return;const o={jwt:t,accountType:i,password:r.editForm.value.password};try{yield r.authService.PUTupdateBaseData(o),r.accountData.password=r.editForm.value.password}catch(s){throw r.notification.setError("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u0430\u0440\u043e\u043b\u044f",5e3),console.error(s),s}})()}loadUserData(t){var i=this;return N(function*(){try{const r=(yield i.accountService.GETaccount(t)).accountData;i.accountData={email:r.email,nickname:r.nickname,projects:r.projects,avatarUrl:i.imageServerControlService.GETaccountAvatar(t),furnitures:r.furnitures},void 0!==r.password&&(i.accountData.password=r.password)}catch(r){console.error(r)}})()}uploadAvatar(t){var i=this;return N(function*(){const r=i.accountCookieService.getJwt();if(!r||!i.accountData)return;const s=t.target.files?.[0];if(s)try{const a=yield i.imageClientControlService.compressImage(s);if(!a)return void i.notification.setError("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0436\u0430\u0442\u0438\u044f \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f",5e3);yield i.imageServerControlService.POSTuploadUserAvatar(a,r),i.accountData.avatarUrl=URL.createObjectURL(a),i.notification.setSuccess("\u0410\u0432\u0430\u0442\u0430\u0440 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d",5e3)}catch(a){i.notification.setError("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0430\u0432\u0430\u0442\u0430\u0440\u0430",5e3),console.error(a)}else i.notification.setError("\u0424\u0430\u0439\u043b \u043d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d",5e3)})()}checkAuthAndLoadData(){const t=this.accountCookieService.getJwt();t?this.loadUserData(t):this.router.navigateByUrl("/login")}initEditForm(){this.editForm=new Ko({nickname:new Li(this.accountData?.nickname,[pn.required,pn.minLength(3),pn.maxLength(30)])}),"email"===this.accountCookieService.getUserType()&&this.editForm.addControl("password",new Li(this.accountData?.password,[pn.required,pn.minLength(6)]))}openEditForm(){this.accountData?this.isEditFormOpen=!0:this.notification.setError("\u0414\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043d\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u044b",5e3)}closeEditForm(){this.isEditFormOpen=!1,this.editForm.reset()}openProject(t){this.router.navigateByUrl("/plan/"+t)}logout(){const t=this.accountCookieService.getJwt();t&&this.accountService.DELETEaccountJwt(t),this.accountCookieService.deleteJwt(),this.accountCookieService.deleteAccountType(),this.router.navigateByUrl("/")}static \u0275fac=function(i){return new(i||n)(se(Vx),se(Ea),se(ju),se(Ux),se(Ej),se(A2),se(kl))};static \u0275cmp=mo({type:n,selectors:[["app-account-page"]],decls:18,vars:9,consts:[[1,"account-page"],["class","account-container",4,"ngIf"],[1,"edit-modal"],[1,"modal-content"],[1,"close-btn",3,"click"],["src","/assets/images/addIcon.svg","alt","\u0417\u0430\u043a\u0440\u044b\u0442\u044c"],[1,"edit-form",3,"ngSubmit","formGroup"],[1,"form-title"],[1,"form-group"],["for","nickname"],["id","nickname","formControlName","nickname"],["class","error-message",4,"ngIf"],["class","form-group",4,"ngIf"],["type","submit",1,"save-btn",3,"disabled"],[1,"account-container"],[1,"profile-card"],[1,"avatar-container"],["alt","\u0410\u0432\u0430\u0442\u0430\u0440",1,"avatar-image",3,"src"],[1,"avatar-edit-btn"],["type","file","id","avatarInput","accept",".png,.jpeg,.jpg",3,"change"],["src","/assets/images/editIcon.svg","alt","\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440"],[1,"profile-info"],[1,"profile-name"],[1,"profile-stats"],[1,"stat-item"],[1,"stat-label"],[1,"stat-value"],[1,"profile-actions"],["title","\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",1,"edit-btn",2,"width","27px",3,"click"],["src","/assets/images/editIcon.svg","alt","\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"],["title","\u0412\u044b\u0439\u0442\u0438",1,"logout-btn",2,"width","35px",3,"click"],["src","/assets/images/logoutIcon.svg","alt","\u0412\u044b\u0439\u0442\u0438"],[1,"projects-section"],[1,"section-title"],[1,"projects-grid"],["class","project-card",3,"click",4,"ngFor","ngForOf"],[1,"furniture-section"],[1,"furniture-grid"],["class","furniture-card",3,"routerLink",4,"ngFor","ngForOf"],[1,"project-card",3,"click"],[1,"project-name"],[1,"project-scheme"],["class","room",3,"grid-area",4,"ngFor","ngForOf"],[1,"room"],[1,"furniture-card",3,"routerLink"],[1,"furniture-name"],["alt","\u041f\u0440\u0435\u0432\u044c\u044e \u043c\u0435\u0431\u0435\u043b\u0438",1,"furniture-image",3,"src"],[1,"error-message"],["for","password"],["id","password","type","password","formControlName","password"]],template:function(i,r){if(1&i&&(L(0,"div",0),Te(1,"app-navigation-panel"),ze(2,iMe,41,7,"div",1),L(3,"div",2)(4,"div",3)(5,"button",4),Oe("click",function(){return r.closeEditForm()}),Te(6,"img",5),k(),L(7,"form",6),Oe("ngSubmit",function(){return r.saveChanges()}),L(8,"h3",7),re(9,"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0444\u0438\u043b\u044f"),k(),L(10,"div",8)(11,"label",9),re(12,"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"),k(),Te(13,"input",10),ze(14,rMe,2,0,"div",11),k(),ze(15,sMe,5,3,"div",12),L(16,"button",13),re(17," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f "),k()()()()()),2&i){let o,s;q(2),ee("ngIf",r.accountData),q(),dr("active",r.isEditFormOpen),q(4),ee("formGroup",r.editForm),q(6),dr("invalid",(null==(o=r.editForm.get("nickname"))?null:o.invalid)&&(null==(o=r.editForm.get("nickname"))?null:o.touched)),q(),ee("ngIf",(null==(s=r.editForm.get("nickname"))?null:s.invalid)&&(null==(s=r.editForm.get("nickname"))?null:s.touched)),q(),ee("ngIf",r.editForm.get("password")),q(),ee("disabled",!r.editForm.valid)}},dependencies:[my,Au,Cs,yg,mg,Ed,hg,pg,Ac,yh,Zae,hh],styles:['@charset "UTF-8";@font-face{font-family:Calypso;src:url(/assets/fonts/Calypso.ttf) format("truetype");font-weight:400}@font-face{font-family:Courier New;src:url(/assets/fonts/Courier\\ New.ttf) format("truetype");font-weight:400}*[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}html[_ngcontent-%COMP%]{scroll-behavior:smooth}img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.account-page[_ngcontent-%COMP%]{background:#000;min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:30px 20px;font-family:Courier New,Courier,monospace;color:#dad7cd}.account-container[_ngcontent-%COMP%]{max-width:1200px;width:100%;margin-top:30px}.profile-card[_ngcontent-%COMP%]{background:#000000b3;border-radius:15px;padding:30px;display:flex;align-items:flex-start;gap:30px;margin-bottom:30px;border:1px solid rgba(163,177,138,.3);position:relative}.avatar-container[_ngcontent-%COMP%]{position:relative;width:250px;aspect-ratio:1;flex-shrink:0}.avatar-container[_ngcontent-%COMP%]   .avatar-image[_ngcontent-%COMP%]{width:100%;aspect-ratio:1;border-radius:50%;object-fit:cover}.avatar-container[_ngcontent-%COMP%]   .avatar-edit-btn[_ngcontent-%COMP%]{position:absolute;bottom:10px;right:10px;background:#344e41;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;border:2px solid black;transition:all .3s}.avatar-container[_ngcontent-%COMP%]   .avatar-edit-btn[_ngcontent-%COMP%]:hover{transform:scale(1.1);background:#436554}.avatar-container[_ngcontent-%COMP%]   .avatar-edit-btn[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.avatar-container[_ngcontent-%COMP%]   .avatar-edit-btn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:15px;padding:10px;aspect-ratio:1}.profile-info[_ngcontent-%COMP%]{flex-grow:1}.profile-info[_ngcontent-%COMP%]   .profile-name[_ngcontent-%COMP%]{font-family:Calypso,Courier,monospace;font-size:2rem;margin-bottom:15px;color:#a3b18a;text-shadow:0 0 10px rgba(163,177,138,.3)}.profile-info[_ngcontent-%COMP%]   .profile-stats[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:fit-content;flex-wrap:wrap;gap:20px}.profile-info[_ngcontent-%COMP%]   .profile-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{background:#a3b18a1a;padding:8px 15px;border-radius:20px;border:1px solid rgba(163,177,138,.3);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.profile-info[_ngcontent-%COMP%]   .profile-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-weight:700;margin-right:5px}.profile-info[_ngcontent-%COMP%]   .profile-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#a3b18a}.stat-item[_ngcontent-%COMP%]{max-width:min(768px,100vw - 500px)}.profile-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px;align-items:center}.profile-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;transition:all .3s}.profile-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:scale(1.1);opacity:.8}.profile-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{aspect-ratio:1}.section-title[_ngcontent-%COMP%]{font-family:Calypso,Courier,monospace;font-size:1.8rem;margin-bottom:20px;color:#a3b18a;text-shadow:0 0 5px rgba(163,177,138,.3);padding-bottom:10px;border-bottom:1px solid rgba(163,177,138,.3)}.projects-section[_ngcontent-%COMP%], .furniture-section[_ngcontent-%COMP%]{background:#000000b3;border-radius:15px;padding:25px;margin-bottom:30px;box-shadow:0 5px 15px #0000004d;border:1px solid rgba(163,177,138,.3)}.projects-grid[_ngcontent-%COMP%], .furniture-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:20px}.project-card[_ngcontent-%COMP%]{background:#a3b18a1a;border-radius:10px;padding:15px;cursor:pointer;transition:all .3s;border:1px solid rgba(163,177,138,.2)}.project-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 5px 15px #a3b18a33;border-color:#a3b18a}.project-card[_ngcontent-%COMP%]   .project-name[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:15px;color:#dad7cd;text-align:center}.project-card[_ngcontent-%COMP%]   .project-scheme[_ngcontent-%COMP%]{display:grid;width:100%;aspect-ratio:1;gap:5px;grid-template-columns:repeat(10,1fr);grid-template-rows:repeat(10,1fr)}.project-card[_ngcontent-%COMP%]   .project-scheme[_ngcontent-%COMP%]   .room[_ngcontent-%COMP%]{background:#344e41;border-radius:3px;transition:all .3s}.furniture-card[_ngcontent-%COMP%]{background:#a3b18a1a;border-radius:10px;padding:15px;text-decoration:none;transition:all .3s;border:1px solid rgba(163,177,138,.2);display:flex;flex-direction:column;align-items:center}.furniture-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 5px 15px #a3b18a33;border-color:#a3b18a}.furniture-card[_ngcontent-%COMP%]   .furniture-name[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:15px;color:#dad7cd;text-align:center}.furniture-card[_ngcontent-%COMP%]   .furniture-image[_ngcontent-%COMP%]{width:100%;aspect-ratio:1;border-radius:5px}.edit-modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000c;display:flex;justify-content:center;align-items:center;opacity:0;pointer-events:none;transition:all .3s;z-index:1000}.edit-modal.active[_ngcontent-%COMP%]{opacity:1;pointer-events:all}.edit-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{background:#000;border-radius:15px;padding:30px;width:90%;max-width:500px;position:relative;box-shadow:0 0 20px #a3b18a4d;border:1px solid #A3B18A;box-sizing:border-box}.edit-modal[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{position:absolute;top:15px;right:15px;background:none;border:none;cursor:pointer}.edit-modal[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:25px;height:25px;rotate:45deg;transition:all .3s}.edit-modal[_ngcontent-%COMP%]   .form-title[_ngcontent-%COMP%]{font-family:Calypso,Courier,monospace;color:#a3b18a;text-align:center;margin-bottom:25px;font-size:1.8rem}.edit-modal[_ngcontent-%COMP%]   .edit-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.edit-modal[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px}.edit-modal[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.9rem;color:#dad7cd}.edit-modal[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:#ffffff1a;border:1px solid rgba(163,177,138,.5);border-radius:5px;padding:12px 15px;color:#dad7cd;font-family:Courier New,Courier,monospace;transition:all .3s}.edit-modal[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#a3b18a;box-shadow:0 0 0 2px #a3b18a33}.edit-modal[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input.invalid[_ngcontent-%COMP%]{border-color:#ff6b6b;background:#ff6b6b1a;animation:_ngcontent-%COMP%_shake .5s ease}.edit-modal[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#ff6b6b;font-size:.8rem;margin-top:3px}.edit-modal[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]{background:#a3b18a;color:#000;border:none;border-radius:5px;padding:15px;font-family:Courier New,Courier,monospace;font-size:1.1rem;cursor:pointer;transition:all .3s;margin-top:10px}.edit-modal[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 5px 15px #a3b18a66}.edit-modal[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]:disabled{background:#344e41;color:#00000080;cursor:not-allowed}@keyframes _ngcontent-%COMP%_shake{0%,to{transform:translate(0)}20%,60%{transform:translate(-5px)}40%,80%{transform:translate(5px)}}@media (max-width: 900px){.stat-item[_ngcontent-%COMP%]{max-width:calc(100vw - 150px)}.profile-card[_ngcontent-%COMP%]{flex-direction:column;align-items:center;text-align:center}.profile-card[_ngcontent-%COMP%]   .profile-info[_ngcontent-%COMP%]{width:100%}.profile-card[_ngcontent-%COMP%]   .profile-info[_ngcontent-%COMP%]   .profile-stats[_ngcontent-%COMP%]{margin:0 auto}.profile-card[_ngcontent-%COMP%]   .profile-actions[_ngcontent-%COMP%]{flex-direction:row;width:100%;justify-content:center}.projects-grid[_ngcontent-%COMP%], .furniture-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(220px,1fr))}}@media (max-width: 600px){.account-page[_ngcontent-%COMP%]{padding:20px}.avatar-container[_ngcontent-%COMP%]{width:200px}.stat-item[_ngcontent-%COMP%]{max-width:calc(100vw - 100px)}.profile-card[_ngcontent-%COMP%]{padding:20px 0}.projects-section[_ngcontent-%COMP%], .furniture-section[_ngcontent-%COMP%]{padding:20px}.profile-name[_ngcontent-%COMP%], .section-title[_ngcontent-%COMP%]{font-size:1.5rem!important}.modal-content[_ngcontent-%COMP%]{width:95%!important;padding:20px!important}}']})}return n})();const lMe=["signup"],uMe=["signin"],cMe=["code"],dMe=["changePassword"],fMe=["requestPasswordChange"],dA=()=>({standalone:!0});function hMe(n,e){1&n&&oh(0)}function pMe(n,e){1&n&&(L(0,"div",23),re(1," \u0412\u0432\u0435\u0434\u0438\u0442\u0435 4-\u0437\u043d\u0430\u0447\u043d\u044b\u0439 \u043a\u043e\u0434 "),k())}function gMe(n,e){if(1&n){const t=rn();L(0,"form",13),Oe("ngSubmit",function(){return qe(t),He(me().checkMatchCodes())}),L(1,"h2",14),re(2,"\u0421\u043c\u0435\u043d\u0430 \u043f\u0430\u0440\u043e\u043b\u044f"),k(),L(3,"span",15)(4,"label",16),re(5,"\u041a\u043e\u0434 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f"),k(),L(6,"span",17)(7,"input",18,5),Oe("input",function(){qe(t);const r=yo(8),o=yo(10);return He(me().onInput(r,o))})("keyup.backspace",function(){qe(t);const r=yo(8);return He(me().onBackspace(r,r))}),Pl("ngModelChange",function(r){qe(t);const o=me();return bu(o.inputValues[0],r)||(o.inputValues[0]=r),He(r)}),k(),L(9,"input",18,6),Oe("input",function(){qe(t);const r=yo(10),o=yo(12);return He(me().onInput(r,o))})("keyup.backspace",function(){qe(t);const r=yo(8),o=yo(10);return He(me().onBackspace(o,r))}),Pl("ngModelChange",function(r){qe(t);const o=me();return bu(o.inputValues[1],r)||(o.inputValues[1]=r),He(r)}),k(),L(11,"input",18,7),Oe("input",function(){qe(t);const r=yo(12),o=yo(14);return He(me().onInput(r,o))})("keyup.backspace",function(){qe(t);const r=yo(10),o=yo(12);return He(me().onBackspace(o,r))}),Pl("ngModelChange",function(r){qe(t);const o=me();return bu(o.inputValues[2],r)||(o.inputValues[2]=r),He(r)}),k(),L(13,"input",18,8),Oe("input",function(){qe(t);const r=yo(14);return He(me().onInput(r,null))})("keyup.backspace",function(){qe(t);const r=yo(12),o=yo(14);return He(me().onBackspace(o,r))}),Pl("ngModelChange",function(r){qe(t);const o=me();return bu(o.inputValues[3],r)||(o.inputValues[3]=r),He(r)}),k()(),ze(15,pMe,2,0,"div",19),k(),L(16,"span",20)(17,"button",21),Oe("click",function(){return qe(t),He(me().changeTemplate("signin"))}),re(18,"\u042f \u0432\u0441\u043f\u043e\u043c\u043d\u0438\u043b \u043f\u0430\u0440\u043e\u043b\u044c"),k()(),L(19,"button",22),re(20),k()()}if(2&n){let t,i,r,o,s;const a=me();q(7),dr("invalid",(null==(t=a.codeForm.get("code"))?null:t.invalid)&&(null==(t=a.codeForm.get("code"))?null:t.touched)),Rl("ngModel",a.inputValues[0]),ee("ngModelOptions",i_(19,dA)),q(2),dr("invalid",(null==(i=a.codeForm.get("code"))?null:i.invalid)&&(null==(i=a.codeForm.get("code"))?null:i.touched)),Rl("ngModel",a.inputValues[1]),ee("ngModelOptions",i_(20,dA)),q(2),dr("invalid",(null==(r=a.codeForm.get("code"))?null:r.invalid)&&(null==(r=a.codeForm.get("code"))?null:r.touched)),Rl("ngModel",a.inputValues[2]),ee("ngModelOptions",i_(21,dA)),q(2),dr("invalid",(null==(o=a.codeForm.get("code"))?null:o.invalid)&&(null==(o=a.codeForm.get("code"))?null:o.touched)),Rl("ngModel",a.inputValues[3]),ee("ngModelOptions",i_(22,dA)),q(2),ee("ngIf",(null==(s=a.codeForm.get("code"))?null:s.invalid)&&(null==(s=a.codeForm.get("code"))?null:s.touched)),q(4),ee("disabled",!a.codeForm.valid),q(),Ca(" ",a.codeForm.valid?"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c":"\u041d\u0435\u043f\u043e\u043b\u043d\u044b\u0439 \u043a\u043e\u0434"," ")}}function mMe(n,e){1&n&&(L(0,"div",23),re(1," Email \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u0435\u043d "),k())}function _Me(n,e){1&n&&(L(0,"div",23),re(1," \u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 email "),k())}function yMe(n,e){1&n&&(L(0,"div",23),re(1," \u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c "),k())}function vMe(n,e){if(1&n){const t=rn();L(0,"form",24),Oe("ngSubmit",function(){return qe(t),He(me().signinUser())}),L(1,"h2",14),re(2,"\u0412\u0445\u043e\u0434"),k(),L(3,"span",25)(4,"label",26),re(5,"Email"),k(),Te(6,"input",27),ze(7,mMe,2,0,"div",19)(8,_Me,2,0,"div",19),k(),L(9,"span",25)(10,"label",28),re(11,"\u041f\u0430\u0440\u043e\u043b\u044c"),k(),Te(12,"input",29),ze(13,yMe,2,0,"div",19),k(),L(14,"span",20)(15,"button",21),Oe("click",function(){return qe(t),He(me().changeTemplate("signup"))}),re(16,"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),k(),L(17,"button",21),Oe("click",function(){return qe(t),He(me().changeTemplate("requestChange"))}),re(18,"\u0417\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"),k()(),L(19,"button",22),re(20),k()()}if(2&n){let t,i,r,o,s;const a=me();ee("formGroup",a.signinForm),q(6),dr("invalid",(null==(t=a.signinForm.get("email"))?null:t.invalid)&&(null==(t=a.signinForm.get("email"))?null:t.touched)),q(),ee("ngIf",(null==(i=a.signinForm.get("email"))||null==i.errors?null:i.errors.required)&&(null==(i=a.signinForm.get("email"))?null:i.touched)),q(),ee("ngIf",(null==(r=a.signinForm.get("email"))||null==r.errors?null:r.errors.email)&&(null==(r=a.signinForm.get("email"))?null:r.touched)),q(4),dr("invalid",(null==(o=a.signinForm.get("password"))?null:o.invalid)&&(null==(o=a.signinForm.get("password"))?null:o.touched)),q(),ee("ngIf",(null==(s=a.signinForm.get("password"))?null:s.invalid)&&(null==(s=a.signinForm.get("password"))?null:s.touched)),q(6),ee("disabled",!a.signinForm.valid),q(),Ca(" ",a.signinForm.valid?"\u0412\u043e\u0439\u0442\u0438":"\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0444\u043e\u0440\u043c\u0443"," ")}}function bMe(n,e){1&n&&(L(0,"div",23),re(1," \u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 email "),k())}function wMe(n,e){if(1&n){const t=rn();L(0,"form",24),Oe("ngSubmit",function(){return qe(t),He(me().requestChangeCode())}),L(1,"h2",14),re(2,"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f"),k(),L(3,"div",25)(4,"label",30),re(5,"Email"),k(),Te(6,"input",31),ze(7,bMe,2,0,"div",19),k(),L(8,"div",20)(9,"button",21),Oe("click",function(){return qe(t),He(me().changeTemplate("signin"))}),re(10,"\u041d\u0430\u0437\u0430\u0434 \u043a \u0432\u0445\u043e\u0434\u0443"),k()(),L(11,"button",22),re(12," \u0417\u0430\u043f\u0440\u043e\u0441\u0438\u0442\u044c \u043a\u043e\u0434 "),k()()}if(2&n){let t,i;const r=me();ee("formGroup",r.requestChangeForm),q(6),dr("invalid",(null==(t=r.requestChangeForm.get("email"))?null:t.invalid)&&(null==(t=r.requestChangeForm.get("email"))?null:t.touched)),q(),ee("ngIf",(null==(i=r.requestChangeForm.get("email"))?null:i.invalid)&&(null==(i=r.requestChangeForm.get("email"))?null:i.touched)),q(4),ee("disabled",r.requestChangeForm.invalid)}}function xMe(n,e){1&n&&(L(0,"div",23),re(1," \u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0443\u043c 6 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 "),k())}function MMe(n,e){1&n&&(L(0,"div",23),re(1," \u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442 "),k())}function CMe(n,e){if(1&n){const t=rn();L(0,"form",24),Oe("ngSubmit",function(){return qe(t),He(me().changePasswordUser())}),L(1,"h2",14),re(2,"\u041d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c"),k(),L(3,"span",25)(4,"label",32),re(5,"\u041d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c"),k(),Te(6,"input",33),ze(7,xMe,2,0,"div",19),k(),L(8,"span",25)(9,"label",34),re(10,"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"),k(),Te(11,"input",35),ze(12,MMe,2,0,"div",19),k(),L(13,"button",22),re(14),k()()}if(2&n){let t,i,r,o;const s=me();ee("formGroup",s.changePasswordForm),q(6),dr("invalid",(null==(t=s.changePasswordForm.get("newPassword"))?null:t.invalid)&&(null==(t=s.changePasswordForm.get("newPassword"))?null:t.touched)),q(),ee("ngIf",(null==(i=s.changePasswordForm.get("newPassword"))?null:i.invalid)&&(null==(i=s.changePasswordForm.get("newPassword"))?null:i.touched)),q(4),dr("invalid",((null==(r=s.changePasswordForm.get("repeatPassword"))?null:r.invalid)||(null==s.changePasswordForm.errors?null:s.changePasswordForm.errors.mismatch))&&(null==(r=s.changePasswordForm.get("repeatPassword"))?null:r.touched)),q(),ee("ngIf",(null==s.changePasswordForm.errors?null:s.changePasswordForm.errors.mismatch)&&(null==(o=s.changePasswordForm.get("repeatPassword"))?null:o.touched)),q(),ee("disabled",!s.changePasswordForm.valid),q(),Ca(" ",s.changePasswordForm.valid?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c":"\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0444\u043e\u0440\u043c\u0443"," ")}}function SMe(n,e){1&n&&(L(0,"div",23),re(1," Email \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u0435\u043d "),k())}function EMe(n,e){1&n&&(L(0,"div",23),re(1," \u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 email "),k())}function TMe(n,e){1&n&&(L(0,"div",23),re(1," \u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f "),k())}function AMe(n,e){1&n&&(L(0,"div",23),re(1," \u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0443\u043c 6 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 "),k())}function DMe(n,e){if(1&n){const t=rn();L(0,"form",24),Oe("ngSubmit",function(){return qe(t),He(me().signUpUser())}),L(1,"h2",14),re(2,"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),k(),L(3,"span",25)(4,"label",26),re(5,"Email"),k(),Te(6,"input",27),ze(7,SMe,2,0,"div",19)(8,EMe,2,0,"div",19),k(),L(9,"span",25)(10,"label",36),re(11,"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"),k(),Te(12,"input",37),ze(13,TMe,2,0,"div",19),k(),L(14,"span",25)(15,"label",28),re(16,"\u041f\u0430\u0440\u043e\u043b\u044c"),k(),Te(17,"input",29),ze(18,AMe,2,0,"div",19),k(),L(19,"span",20)(20,"button",21),Oe("click",function(){return qe(t),He(me().changeTemplate("signin"))}),re(21,"\u0423\u0436\u0435 \u0435\u0441\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442?"),k()(),L(22,"button",22),re(23),k()()}if(2&n){let t,i,r,o,s,a,l;const u=me();ee("formGroup",u.signupForm),q(6),dr("invalid",(null==(t=u.signupForm.get("email"))?null:t.invalid)&&(null==(t=u.signupForm.get("email"))?null:t.touched)),q(),ee("ngIf",(null==(i=u.signupForm.get("email"))||null==i.errors?null:i.errors.required)&&(null==(i=u.signupForm.get("email"))?null:i.touched)),q(),ee("ngIf",(null==(r=u.signupForm.get("email"))||null==r.errors?null:r.errors.email)&&(null==(r=u.signupForm.get("email"))?null:r.touched)),q(4),dr("invalid",(null==(o=u.signupForm.get("nickname"))?null:o.invalid)&&(null==(o=u.signupForm.get("nickname"))?null:o.touched)),q(),ee("ngIf",(null==(s=u.signupForm.get("nickname"))?null:s.invalid)&&(null==(s=u.signupForm.get("nickname"))?null:s.touched)),q(4),dr("invalid",(null==(a=u.signupForm.get("password"))?null:a.invalid)&&(null==(a=u.signupForm.get("password"))?null:a.touched)),q(),ee("ngIf",(null==(l=u.signupForm.get("password"))?null:l.invalid)&&(null==(l=u.signupForm.get("password"))?null:l.touched)),q(4),ee("disabled",!u.signupForm.valid),q(),Ca(" ",u.signupForm.valid?"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f":"\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0444\u043e\u0440\u043c\u0443"," ")}}let IMe=(()=>{class n{accountService;authService;router;notification;accountCookieService;cdr;constructor(t,i,r,o,s,a){this.accountService=t,this.authService=i,this.router=r,this.notification=o,this.accountCookieService=s,this.cdr=a}currentFormTemplate;inputValues=new Array(4).fill("");currentChangeCode;currentJwtToken;signupTemplate;signinTemplate;codeTemplate;changePasswordTemplate;requestPasswordChangeTemplate;ngOnInit(){this.accountCookieService.getJwt()&&this.router.navigateByUrl("/account")}ngAfterViewInit(){this.currentFormTemplate=this.signinTemplate,this.cdr.detectChanges()}requestChangeCode(){var t=this;return N(function*(){if(!t.requestChangeForm.invalid)try{t.currentChangeCode=(yield t.authService.GETrequestPasswordCode(t.requestChangeForm.value.email)).resetCode,t.changeTemplate("code")}catch(i){console.log(i)}})()}signinUser(){var t=this;return N(function*(){if(t.signinForm.invalid)return;const i={email:t.signinForm.value.email,password:t.signinForm.value.password,accountType:"email"};try{const r=(yield t.authService.POSTcreateLongJWT(i)).jwt;t.accountCookieService.setJwt(r,"long"),t.accountCookieService.setUserType("email"),t.router.navigateByUrl("/account")}catch(r){console.log(r)}})()}signUpUser(){var t=this;return N(function*(){if(!t.signupForm.invalid)try{const i={email:t.signupForm.value.email,password:t.signupForm.value.password,nickname:t.signupForm.value.nickname,accountType:"email"};yield t.accountService.POSTcreateAccount(i);const r=(yield t.authService.POSTcreateLongJWT(i)).jwt;t.accountCookieService.setJwt(r,"long"),t.accountCookieService.setUserType("email"),t.router.navigateByUrl("/account")}catch(i){console.log(i)}})()}changePasswordUser(){var t=this;return N(function*(){if(t.changePasswordForm.invalid||!t.currentJwtToken)return;const i={password:t.changePasswordForm.value.newPassword,accountType:"email",jwt:t.currentJwtToken};try{yield t.authService.PUTupdateBaseData(i),t.changeTemplate("signin")}catch(r){console.log(r)}})()}checkMatchCodes(){var t=this;return N(function*(){if(t.codeForm.value.code===t.currentChangeCode)try{t.currentJwtToken=(yield t.authService.POSTcreateShortJWT(t.requestChangeForm.value.email)).jwt,t.changeTemplate("changePassword")}catch(i){console.log(i)}else t.notification.setError("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043a\u043e\u0434",2500)})()}passwordMatchValidator=t=>{const i=t;return i.get("newPassword")?.value===i.get("repeatPassword")?.value?null:{mismatch:!0}};onInput(t,i){this.codeForm.patchValue({code:this.inputValues.join("")}),i&&t.value&&i.focus()}onBackspace(t,i){!t.value&&i&&i.focus(),this.codeForm.patchValue({code:this.inputValues.join("")})}changeTemplate(t){this.currentFormTemplate={requestChange:this.requestPasswordChangeTemplate,code:this.codeTemplate,signin:this.signinTemplate,signup:this.signupTemplate,changePassword:this.changePasswordTemplate}[t]||this.signinTemplate}signupForm=new Ko({email:new Li("",[pn.required,pn.email]),nickname:new Li("",[pn.required]),password:new Li("",[pn.required,pn.minLength(6)])});codeForm=new Ko({code:new Li("",[pn.required,pn.minLength(4)])});changePasswordForm=new Ko({newPassword:new Li("",[pn.required,pn.minLength(6)]),repeatPassword:new Li("",[pn.required,pn.minLength(6)])},{validators:this.passwordMatchValidator});signinForm=new Ko({email:new Li("",[pn.required,pn.email]),password:new Li("",[pn.required])});requestChangeForm=new Ko({email:new Li("",[pn.required,pn.email])});static \u0275fac=function(i){return new(i||n)(se(Vx),se(A2),se(Ea),se(kl),se(ju),se(wu))};static \u0275cmp=mo({type:n,selectors:[["app-login-page"]],viewQuery:function(i,r){if(1&i&&(ys(lMe,5,Ws),ys(uMe,5,Ws),ys(cMe,5,Ws),ys(dMe,5,Ws),ys(fMe,5,Ws)),2&i){let o;Po(o=Oo())&&(r.signupTemplate=o.first),Po(o=Oo())&&(r.signinTemplate=o.first),Po(o=Oo())&&(r.codeTemplate=o.first),Po(o=Oo())&&(r.changePasswordTemplate=o.first),Po(o=Oo())&&(r.requestPasswordChangeTemplate=o.first)}},decls:15,vars:1,consts:[["code",""],["signin",""],["requestPasswordChange",""],["changePassword",""],["signup",""],["input1",""],["input2",""],["input3",""],["input4",""],[1,"body"],[1,"login-container"],[1,"formModule"],[4,"ngTemplateOutlet"],[1,"addModuleSpan",3,"ngSubmit"],[1,"addModuleTitle"],[1,"addModuleInputSpan",2,"align-items","center"],["for","#input1",1,"inputLabel"],[1,"input-group"],["type","text","maxlength","1",3,"input","keyup.backspace","ngModelChange","ngModel","ngModelOptions"],["class","error-message",4,"ngIf"],[1,"additionalFuntions"],["type","button",3,"click"],["type","submit",1,"submitAddModuleFormBtn",3,"disabled"],[1,"error-message"],[1,"addModuleSpan",3,"ngSubmit","formGroup"],[1,"addModuleInputSpan"],["for","email",1,"inputLabel"],["formControlName","email","id","email","type","email",1,"addModuleInput"],["for","password",1,"inputLabel"],["formControlName","password","id","password","type","password",1,"addModuleInput"],[1,"inputLabel"],["formControlName","email","type","email",1,"addModuleInput"],["for","newPassword",1,"inputLabel"],["formControlName","newPassword","id","newPassword","type","password",1,"addModuleInput"],["for","repeatPassword",1,"inputLabel"],["formControlName","repeatPassword","id","repeatPassword","type","password",1,"addModuleInput"],["for","nickname",1,"inputLabel"],["formControlName","nickname","id","nickname","type","text",1,"addModuleInput"]],template:function(i,r){1&i&&(L(0,"span",9),Te(1,"app-navigation-panel"),L(2,"div",10)(3,"div",11),ze(4,hMe,1,0,"ng-container",12),k()()(),ze(5,gMe,21,23,"ng-template",null,0,vs)(7,vMe,21,10,"ng-template",null,1,vs)(9,wMe,13,5,"ng-template",null,2,vs)(11,CMe,15,9,"ng-template",null,3,vs)(13,DMe,24,13,"ng-template",null,4,vs)),2&i&&(q(4),ee("ngTemplateOutlet",r.currentFormTemplate))},dependencies:[my,yg,mg,Ed,hg,pg,nO,Ac,yh,g_,iO,lT,Ew,Cs],styles:['@font-face{font-family:Calypso;src:url(/assets/fonts/Calypso.ttf) format("truetype");font-weight:400}@font-face{font-family:Courier New;src:url(/assets/fonts/Courier\\ New.ttf) format("truetype");font-weight:400}*[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}html[_ngcontent-%COMP%]{scroll-behavior:smooth}img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}app-navigation-panel[_ngcontent-%COMP%]{margin-top:30px}.body[_ngcontent-%COMP%]{padding:0;margin:0;min-height:100vh;display:flex;flex-direction:column;align-items:center;background-color:#000;background-size:cover;position:relative}.login-container[_ngcontent-%COMP%]{width:100%;max-width:500px;margin:auto;padding:20px}.formModule[_ngcontent-%COMP%]{background-color:#000;border-radius:10px;padding:30px;width:calc(100% - 60px);box-shadow:0 0 5px #fff;border:1px solid rgba(255,255,255,.1)}.addModuleTitle[_ngcontent-%COMP%]{color:#dad7cd;text-align:center;font-size:2rem;margin-bottom:30px;font-weight:400}.addModuleInputSpan[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:20px;position:relative}.inputLabel[_ngcontent-%COMP%]{color:#dad7cd;margin-bottom:8px;font-size:.9rem}.addModuleInput[_ngcontent-%COMP%]{background-color:#ffffff1a;border:1px solid rgba(255,255,255,.2);border-radius:5px;padding:12px 15px;color:#dad7cd;font-size:1rem;transition:all .3s ease}.addModuleInput[_ngcontent-%COMP%]:focus{outline:none;border-color:#a3b18a;box-shadow:0 0 0 2px #a3b18a33}.addModuleInput.invalid[_ngcontent-%COMP%]{border-color:#ff6b6b;background-color:#ff6b6b1a}.error-message[_ngcontent-%COMP%]{color:#ff6b6b;font-size:.8rem;margin-top:5px}.input-group[_ngcontent-%COMP%]{display:flex;gap:12px;margin-bottom:20px}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:40px;aspect-ratio:1;text-align:center;font-size:24px;font-family:Courier New,monospace;background:#ffffff1a;border:2px solid #A3B18A;border-radius:12px;color:#dad7cd;transition:all .3s ease;outline:none}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#b1bd9c;box-shadow:0 0 0 3px #a3b18a33;transform:translateY(-2px)}.input-group[_ngcontent-%COMP%]   input.invalid[_ngcontent-%COMP%]{border-color:#ff6b6b;background:#ff6b6b1a;animation:_ngcontent-%COMP%_shake .5s ease}@keyframes _ngcontent-%COMP%_shake{0%,to{transform:translate(0)}20%,60%{transform:translate(-5px)}40%,80%{transform:translate(5px)}}.submitAddModuleFormBtn[_ngcontent-%COMP%]{width:100%;padding:15px;background-color:#a3b18a;color:#000;border:none;border-radius:5px;font-size:1rem;cursor:pointer;transition:all .3s ease;margin-top:10px}.submitAddModuleFormBtn[_ngcontent-%COMP%]:hover{background-color:#acb996}.submitAddModuleFormBtn[_ngcontent-%COMP%]:disabled{background-color:#a3b18a80;cursor:not-allowed}.additionalFuntions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin:20px 0}.additionalFuntions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:#dad7cd;cursor:pointer;font-size:.9rem;padding:5px 0;position:relative}.additionalFuntions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:0;width:0;height:1px;background:#dad7cd;transition:width .3s}.additionalFuntions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:after{width:100%}@media (max-width: 768px){.formModule[_ngcontent-%COMP%]{padding:20px}.addModuleTitle[_ngcontent-%COMP%]{font-size:1.5rem}}@media (max-width: 480px){.login-container[_ngcontent-%COMP%]{padding:10px}.additionalFuntions[_ngcontent-%COMP%]{flex-direction:column;gap:10px}}']})}return n})();const RMe=["planHouse"],D2=n=>({disabled:n});function PMe(n,e){1&n&&(L(0,"p",6),re(1,"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u0441 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u044b\u0445 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u0435\u043d. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440."),k())}function OMe(n,e){1&n&&Te(0,"div",23),2&n&&oo("grid-area",e.$implicit.gridArea)}function NMe(n,e){if(1&n){const t=rn();L(0,"span",16)(1,"button",17),Oe("click",function(){const r=qe(t).index;return He(me(3).openProject(r))}),L(2,"h3",18),re(3),k(),L(4,"div",19),ze(5,OMe,1,2,"div",20),k()(),L(6,"button",21),Oe("click",function(){const r=qe(t).index;return He(me(3).deleteProject(r))}),Te(7,"img",22),k()()}if(2&n){const t=e.$implicit;q(3),Ei(t.name),q(2),ee("ngForOf",t.rooms)}}function FMe(n,e){if(1&n){const t=rn();L(0,"span",12),ze(1,NMe,8,2,"span",13),L(2,"button",14),Oe("click",function(){return qe(t),He(me(2).openAddModule())}),L(3,"h3"),re(4,"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"),k(),Te(5,"img",15),k()()}if(2&n){const t=me(2);ee("ngClass",Sa(2,D2,void 0!==t.currentProjectId)),q(),ee("ngForOf",t.accountData.projects)}}function LMe(n,e){if(1&n){const t=rn();L(0,"button",24),Oe("click",function(){return qe(t),He(me(2).closeProject())}),Te(1,"img",15),k()}}function kMe(n,e){if(1&n){const t=rn();L(0,"app-plan-house",25,0),Oe("callSaveEmitter",function(){return qe(t),He(me(2).saveProject())})("planHouseEmitter",function(r){return qe(t),He(me(2).updatePlanData(r))}),k()}if(2&n){const t=me(2);ee("ngClass",Sa(2,D2,void 0===t.currentProjectId))("planHouse",t.accountData.projects[t.currentProjectId].rooms)}}function BMe(n,e){if(1&n&&(L(0,"span",7),ze(1,FMe,6,4,"span",8),L(2,"span",9),ze(3,LMe,2,0,"button",10)(4,kMe,2,4,"app-plan-house",11),k()()),2&n){const t=me();q(),ee("ngIf",void 0!==t.accountData),q(),ee("ngClass",Sa(4,D2,void 0===t.currentProjectId)),q(),ee("ngIf",null==t.getCurrentViewRoom()),q(),ee("ngIf",void 0!==t.currentProjectId)}}function UMe(n,e){if(1&n){const t=rn();L(0,"form",26),Oe("ngSubmit",function(){return qe(t),He(me().createProject())}),L(1,"button",27),Oe("click",function(){return qe(t),He(me().closeAddModule())}),Te(2,"img",28),k(),L(3,"span",29)(4,"h2",30),re(5,"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0434\u043e\u043c\u0430"),k(),L(6,"span",31)(7,"label",32),re(8,"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"),k(),Te(9,"input",33),k(),L(10,"button",34),re(11,"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c"),k()()()}if(2&n){const t=me();ee("formGroup",t.projectNameForm),q(10),ee("disabled",!t.projectNameForm.valid)}}let fA=(()=>{class n{accountService;accountCookieService;router;route;elemenetRef;renderer;projectService;notification;location;constructor(t,i,r,o,s,a,l,u,c){this.accountService=t,this.accountCookieService=i,this.router=r,this.route=o,this.elemenetRef=s,this.renderer=a,this.projectService=l,this.notification=u,this.location=c}hasRoomIdBeenProcessed=!1;addModule;currentPlanHouse;accountData;checkDesktop=cA();currentProjectId=void 0;planHouse;ngOnInit(){const t=this.accountCookieService.getJwt();t?this.pageInit(t):this.router.navigateByUrl("/login")}ngAfterViewInit(){this.addModule=this.elemenetRef.nativeElement.querySelector(".addModule")}ngAfterViewChecked(){if(this.hasRoomIdBeenProcessed||!this.planHouse||!this.route.snapshot.params.roomId)return;const t=parseInt(this.route.snapshot.params.roomId);setTimeout(()=>{"number"==typeof t&&(this.planHouse.currentViewRoom=t,this.planHouse.currentIdClickedRoom=t,this.planHouse.openViewRoom(t),this.planHouse.sceneOpenToggle=!0,this.planHouse.guideTemplate=this.planHouse.roomGuideTemplate,this.hasRoomIdBeenProcessed=!0)},0)}pageInit(t){var i=this;return N(function*(){try{i.accountData=(yield i.accountService.GETaccount(t)).accountData,i.route.paramMap.subscribe(r=>{if(null===r.get("planId"))return;const o=parseInt(r.get("planId"));i.accountData.projects.length>=o&&o>=0&&void 0!==i.accountData.projects[o]?i.currentProjectId=o:i.router.navigateByUrl("/plan")})}catch(r){console.log(r)}})()}createProject(){var t=this;return N(function*(){t.closeAddModule();const i=t.accountCookieService.getJwt();if(t.projectNameForm.value&&t.projectNameForm.value.name&&i)try{const r=yield t.projectService.POSTcreateProject(i,t.projectNameForm.value.name);t.accountData.projects=[...t.accountData.projects,r.projectData],t.notification.setSuccess("\u041f\u0440\u043e\u0435\u043a\u0442 \u0441\u043e\u0437\u0434\u0430\u043d",5e3)}catch(r){console.log(r)}})()}saveProject(){var t=this;return N(function*(){if(void 0===t.currentProjectId)return;const i=t.accountData.projects[t.currentProjectId]._id,r=t.currentPlanHouse;if(void 0===r)return;const o=t.accountCookieService.getJwt();if(!o)return;const s={rooms:r,name:t.accountData.projects[t.currentProjectId].name};try{yield t.projectService.PUTupdateProject(o,i,s),t.notification.setSuccess("\u041f\u0440\u043e\u0435\u043a\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d",5e3)}catch(a){console.log(a)}})()}deleteProject(t){var i=this;return N(function*(){const r=i.accountCookieService.getJwt(),o=i.accountData.projects[t]._id;!r||!o||(yield i.projectService.DELETEdeleteProject(r,o),i.notification.setSuccess("\u041f\u0440\u043e\u0435\u043a\u0442 \u0443\u0434\u0430\u043b\u0435\u043d",5e3),i.accountData.projects.splice(t,1))})()}getCurrentViewRoom(){if(void 0!==this.planHouse)return this.planHouse.currentViewRoom}updatePlanData(t){this.currentPlanHouse=t,this.accountData.projects[this.currentProjectId].rooms=t}closeAddModule(){this.addModule&&this.renderer.addClass(this.addModule,"disabled")}openAddModule(){this.addModule&&this.renderer.removeClass(this.addModule,"disabled")}closeProject(){this.saveProject(),this.currentProjectId=void 0;const t=this.location.path().split("/").slice(0,-1).join("/");this.location.replaceState(t)}openProject(t){const i=this.location.path()+"/"+t;this.location.replaceState(i),this.currentProjectId=t}projectNameForm=new Ko({name:new Li("",[pn.required])});static \u0275fac=function(i){return new(i||n)(se(Vx),se(ju),se(Ea),se(Eu),se(gi),se(Dl),se(S2),se(kl),se(bd))};static \u0275cmp=mo({type:n,selectors:[["app-plan-house-page"]],viewQuery:function(i,r){if(1&i&&ys(RMe,5),2&i){let o;Po(o=Oo())&&(r.planHouse=o.first)}},decls:6,vars:3,consts:[["planHouse",""],[1,"body"],["class","mobileAlert",4,"ngIf"],["class","functionalModule",4,"ngIf"],[1,"addModule","disabled"],["class","addModuleSpan",3,"formGroup","ngSubmit",4,"ngIf"],[1,"mobileAlert"],[1,"functionalModule"],["class","chooseProjectSpan",3,"ngClass",4,"ngIf"],[1,"planModule",3,"ngClass"],[3,"click",4,"ngIf"],[3,"ngClass","planHouse","callSaveEmitter","planHouseEmitter",4,"ngIf"],[1,"chooseProjectSpan",3,"ngClass"],["class","projectCard",4,"ngFor","ngForOf"],[1,"addProjectCard","projectCard",2,"cursor","pointer",3,"click"],["src","/assets/images/addIcon.svg","alt",""],[1,"projectCard"],[1,"mainProjectInformation",3,"click"],[1,"projectTitle"],[1,"projectSchem"],["class","room",3,"grid-area",4,"ngFor","ngForOf"],[1,"deleteProjectBtn",3,"click"],["src","/assets/images/deleteIcon.svg","alt",""],[1,"room"],[3,"click"],[3,"callSaveEmitter","planHouseEmitter","ngClass","planHouse"],[1,"addModuleSpan",3,"ngSubmit","formGroup"],["type","button",1,"closeAddModuleBtn",3,"click"],["loading","lazy","src","/assets/images/addIcon.svg","alt",""],[1,"addModuleFormContent"],[1,"addModuleTitle"],[1,"addModuleInputSpan"],["for","name",1,"inputLabel"],["formControlName","name","id","name","type","text",1,"addModuleInput"],["type","submit",1,"submitAddModuleFormBtn",3,"disabled"]],template:function(i,r){1&i&&(L(0,"span",1),Te(1,"app-navigation-panel"),ze(2,PMe,2,0,"p",2)(3,BMe,5,6,"span",3),k(),L(4,"span",4),ze(5,UMe,12,2,"form",5),k()),2&i&&(q(2),ee("ngIf",!r.checkDesktop),q(),ee("ngIf",r.checkDesktop),q(2),ee("ngIf",r.accountData))},dependencies:[my,uA,Au,Cs,yg,mg,Ed,hg,pg,Ac,yh,sg],styles:['@font-face{font-family:Calypso;src:url(/assets/fonts/Calypso.ttf) format("truetype");font-weight:400}@font-face{font-family:Courier New;src:url(/assets/fonts/Courier\\ New.ttf) format("truetype");font-weight:400}*[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}html[_ngcontent-%COMP%]{scroll-behavior:smooth}img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}app-navigation-panel[_ngcontent-%COMP%]{margin-top:30px}.planModule[_ngcontent-%COMP%]{grid-area:1/1/2/2;display:flex;flex-direction:row;gap:10px;width:100%;transition:all .5s ease-in-out}.planModule[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{width:35px;height:35px;background:none;border:none;cursor:pointer}.planModule[_ngcontent-%COMP%] > button[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{rotate:45deg}app-plan-house[_ngcontent-%COMP%]{width:90%}.body[_ngcontent-%COMP%]{background-color:#000;gap:60px;display:flex;flex-direction:column;align-items:center;min-height:100vh}.chooseProjectSpan[_ngcontent-%COMP%]{width:calc(100% - 60px);z-index:0;gap:30px;display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-between;transition:all .5s ease-in-out;grid-area:1/1/2/2}@media (max-width: 1024px){.chooseProjectSpan[_ngcontent-%COMP%]{justify-content:center}}.projectCard[_ngcontent-%COMP%]{width:45%;position:relative;aspect-ratio:4/3;display:flex;justify-content:space-between;align-items:center;flex-direction:column;gap:10px;border-radius:10px;border:1px solid rgba(163,177,138,.3);background-color:#000;overflow:hidden;transition:transform .2s ease-in-out;padding:3px}.projectCard[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}@media (max-width: 1024px){.projectCard[_ngcontent-%COMP%]{width:clamp(450px,70%,700px)}}.deleteProjectBtn[_ngcontent-%COMP%]{height:35px;align-self:flex-end;margin:10px;background:none;border:none;aspect-ratio:1;cursor:pointer}.mainProjectInformation[_ngcontent-%COMP%]{display:flex;height:90%;width:100%;z-index:3;flex-direction:column;align-items:center;background:none;border:none;cursor:pointer}.addProjectCard[_ngcontent-%COMP%]{justify-content:center;background-color:#344e41;box-shadow:none}.projectCard[_ngcontent-%COMP%] > h3[_ngcontent-%COMP%]{font-size:2em;color:#fff}.addProjectCard[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:40px}.projectTitle[_ngcontent-%COMP%]{color:#fff;text-align:center;font-weight:700;font-size:20px}.projectSchem[_ngcontent-%COMP%]{display:grid;height:80%;aspect-ratio:1;gap:7px;grid-template-columns:repeat(10,1fr);grid-template-rows:repeat(10,1fr)}.room[_ngcontent-%COMP%]{background-color:#344e41;border-radius:5px}.disabled[_ngcontent-%COMP%]{filter:opacity(0);pointer-events:none}.functionalModule[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:1fr;align-items:flex-start;justify-items:center;width:90vw}@media (max-width: 768px){.functionalModule[_ngcontent-%COMP%]{width:calc(100vw - 10px)}}.addModule[_ngcontent-%COMP%]{z-index:4;transition:all .5s ease-in-out;position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:#000000bf;display:flex;justify-content:center;align-items:center}.addModuleSpan[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:1fr}.addModuleFormContent[_ngcontent-%COMP%]{grid-area:1/1/2/2;width:25vw;border-radius:10px;background-color:#000;padding:30px 45px;display:flex;flex-direction:column;gap:15px;box-shadow:0 0 10px #fff}.addModuleInputSpan[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px}.inputLabel[_ngcontent-%COMP%]{color:#dad7cd}.addModuleInput[_ngcontent-%COMP%]{border-radius:10px;background-color:transparent;border:#888888 1px solid;padding:10px;outline:none;color:#fff}.addModuleTitle[_ngcontent-%COMP%]{color:#a3b18a;text-align:center}.submitAddModuleFormBtn[_ngcontent-%COMP%]{background-color:#a3b18a;color:#fff;border-radius:10px;padding:15px;width:100%;border:none;cursor:pointer}.submitAddModuleFormBtn[_ngcontent-%COMP%]:disabled{background-color:#344e41}.closeAddModuleBtn[_ngcontent-%COMP%]{grid-area:1/1/2/2;background:none;border:none;z-index:3;width:30px;aspect-ratio:1;margin-right:10px;margin-top:10px;justify-self:end;cursor:pointer}.closeAddModuleBtn[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{transform:rotate(45deg)}.dividerWithText[_ngcontent-%COMP%]{display:flex;align-items:center;margin:20px 0}.dividerLine[_ngcontent-%COMP%]{flex:1;height:2px;background-color:#1f1f1f}.dividerText[_ngcontent-%COMP%]{padding:0 10px;color:#666;font-size:14px;text-transform:uppercase}.mobileAlert[_ngcontent-%COMP%]{color:#fff;width:300px;font-size:20px}']})}return n})();function VMe(n,e){if(1&n){const t=rn();L(0,"button",7),Oe("click",function(){return qe(t),He(me().deleteColor())}),Te(1,"img",8),k()}2&n&&oo("background-color",me().deleteColorCalculate())}let HMe=(()=>{class n{route;cookieService;furnitureCardService;serverImageControl;router;furnitureModelService;notification;routeSub=new Yi;idPage;createFurnitureComponent;createFurnitureComponentRef;furnitureData={name:"",description:"",colors:[],shops:[],additionalData:{},proportions:{width:null,height:null,length:null}};constructor(t,i,r,o,s,a,l){this.route=t,this.cookieService=i,this.furnitureCardService=r,this.serverImageControl=o,this.router=s,this.furnitureModelService=a,this.notification=l}ngOnInit(){const t=this.cookieService.getJwt();t?this.routeSub=this.route.paramMap.subscribe(i=>{this.idPage=i.get("id")??"new",this.clearFurnitureCard(),"new"!==this.idPage&&this.pageInit(t)}):this.router.navigateByUrl("/login")}ngOnDestroy(){this.routeSub&&this.routeSub.unsubscribe()}pageInit(t){var i=this;return N(function*(){try{const r=yield i.furnitureCardService.GETfurnitureCard(i.idPage,t);if(!1===r.authorMatched)return void i.router.navigateByUrl("/create/new");i.furnitureData=r.furnitureCard,i.createFurnitureComponent.currentColorId=0}catch(r){i.router.navigateByUrl("/create/new"),console.error(r)}})()}transformUrlArrayToBlob(t){return N(function*(){return yield Promise.all(t.map(function(){var r=N(function*(o){const a=yield(yield fetch(o.toString())).blob();return URL.revokeObjectURL(o),a});return function(o){return r.apply(this,arguments)}}()))})()}deleteFurnitureCard(){var t=this;return N(function*(){const i=t.cookieService.getJwt();if(!i)return;const r=[()=>t.furnitureModelService.DELETEfurnitureModel(i,t.idPage),()=>t.serverImageControl.DELETEproject(i,t.idPage),()=>t.furnitureCardService.DELETEfurnitureCard(i,t.idPage)];for(const o of r)try{yield o()}catch{}t.router.navigateByUrl("/account")})()}createFurnitureCard(){var t=this;return N(function*(){const i=t.cookieService.getJwt();if(t.checkValid("create")&&i)try{const r=t.createFurnitureComponent.furnitureData,o=(yield t.furnitureCardService.POSTcreateFurnitureCard(r,i)).furnitureData._id;for(const a of r.colors){const u={images:yield t.transformUrlArrayToBlob(a.imagesData.images),idMainImage:a.imagesData.idMainImage};yield t.serverImageControl.POSTuploadProjectImages(a.color,u,i,o)}t.furnitureModelService.POSTuploadFurnitureModel(t.createFurnitureComponent.furnitureModelInput.files[0],i,o,"create"),t.notification.setSuccess("\u041c\u0435\u0431\u0435\u043b\u044c \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430",5e3),t.router.navigateByUrl("/account")}catch(r){console.error(r)}})()}updateFurnitureCard(){var t=this;return N(function*(){const i=t.cookieService.getJwt();if(t.checkValid("update")&&i)try{const r=t.createFurnitureComponent.furnitureData;yield t.furnitureCardService.PUTupdateFurnitureCard(r,t.idPage,i),t.notification.setSuccess("\u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430",2500);let o=0;yield t.serverImageControl.DELETEproject(i,t.idPage),r.colors.forEach(function(){var a=N(function*(l){if(0===l.imagesData.images.length)return;const c={images:yield t.transformUrlArrayToBlob(l.imagesData.images),idMainImage:l.imagesData.idMainImage};yield t.serverImageControl.POSTuploadProjectImages(l.color,c,i,t.idPage),o++});return function(l){return a.apply(this,arguments)}}()),o>0&&t.notification.setSuccess("\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b",2500);const s=t.createFurnitureComponent.furnitureModelInput.files;s[0]&&t.furnitureModelService.POSTuploadFurnitureModel(s[0],i,t.idPage,"update")}catch(r){console.error(r)}})()}checkValid(t){const{colors:i,shops:r,proportions:o,name:s}=this.furnitureData,a=this.createFurnitureComponent.furnitureModelInput.files[0];if(0==i.length)return this.createFurnitureComponent.openColorModule(),!1;if(0==s.length){const l=this.createFurnitureComponentRef.nativeElement.querySelector(".furnitureTitle");return l&&l.focus(),this.notification.setError("\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0431\u0435\u043b\u0438",5e3),!1}if(!o.height||!o.width||!o.length)return this.createFurnitureComponent.openAdditional(),this.notification.setError("\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b",5e3),!1;if(!a&&"create"===t){const l=this.createFurnitureComponentRef.nativeElement.querySelector(".furnitureModelInput");return l&&l.click(),this.notification.setError("\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 3D \u043c\u043e\u0434\u0435\u043b\u044c",5e3),!1}if(0==r.length)return this.createFurnitureComponent.openShopsModule(),this.notification.setError("\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u044b",5e3),!1;for(let l of i)if(0==l.imagesData.images.length){const u=this.createFurnitureComponentRef.nativeElement.querySelector(".uploadImagesInput");return u&&u.click(),this.notification.setError("\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f",5e3),!1}return!0}clearFurnitureCard(){this.createFurnitureComponent&&(this.createFurnitureComponent.currentColorId=void 0),this.furnitureData={name:"",description:"",colors:[],shops:[],additionalData:{},proportions:{width:null,height:null,length:null}}}deleteColorCalculate(){if(this.createFurnitureComponent&&void 0!==this.createFurnitureComponent.currentColorId)return this.createFurnitureComponent.furnitureData.colors[this.createFurnitureComponent.currentColorId].color}deleteColor(){this.createFurnitureComponent.deleteColor()}getCurrentColorId(){if(this.createFurnitureComponent)return this.createFurnitureComponent.currentColorId}static \u0275fac=function(i){return new(i||n)(se(Eu),se(ju),se(Dw),se(Ux),se(Ea),se(C2),se(kl))};static \u0275cmp=mo({type:n,selectors:[["app-create-furniture-page"]],viewQuery:function(i,r){if(1&i&&(ys(pT,5),ys(pT,5,gi)),2&i){let o;Po(o=Oo())&&(r.createFurnitureComponent=o.first),Po(o=Oo())&&(r.createFurnitureComponentRef=o.first)}},decls:9,vars:7,consts:[[1,"body"],[3,"furnitureData"],[1,"functionalBtns"],["title","\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u0446\u0432\u0435\u0442","class","functionalBtn deleteBtn deleteColorBtn colorCircle",3,"background-color","click",4,"ngIf"],[1,"functionalBtn","confirmBtn",3,"click"],[1,"functionalBtn","deleteBtn",3,"click","title"],["alt","",3,"src"],["title","\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u0446\u0432\u0435\u0442",1,"functionalBtn","deleteBtn","deleteColorBtn","colorCircle",3,"click"],["src","/assets/images/cancelIcon.svg","alt","x","srcset",""]],template:function(i,r){1&i&&(L(0,"span",0),Te(1,"app-navigation-panel")(2,"app-create-furniture",1),L(3,"span",2),ze(4,VMe,2,2,"button",3),L(5,"button",4),Oe("click",function(){return"new"===r.idPage?r.createFurnitureCard():r.updateFurnitureCard()}),re(6),k(),L(7,"button",5),Oe("click",function(){return"new"===r.idPage?r.clearFurnitureCard():r.deleteFurnitureCard()}),Te(8,"img",6),k()()()),2&i&&(q(2),ee("furnitureData",r.furnitureData),q(2),ee("ngIf",void 0!==r.getCurrentColorId()),q(2),Ca(" ","new"===r.idPage?"\u0421\u043e\u0437\u0434\u0430\u0442\u044c":"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c"," "),q(),ee("title","new"===r.idPage?"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0444\u043e\u0440\u043c\u0443":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443 \u043c\u0435\u0431\u0435\u043b\u0438"),q(),oo("rotate","new"===r.idPage?"45deg":"0deg"),ee("src","assets/images/"+("new"===r.idPage?"addIcon.svg":"deleteIcon.svg"),mc))},dependencies:[my,pT,Cs],styles:['@font-face{font-family:Calypso;src:url(/assets/fonts/Calypso.ttf) format("truetype");font-weight:400}@font-face{font-family:Courier New;src:url(/assets/fonts/Courier\\ New.ttf) format("truetype");font-weight:400}*[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}html[_ngcontent-%COMP%]{scroll-behavior:smooth}img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}button[_ngcontent-%COMP%]{transition:all .3s ease-in-out}button[_ngcontent-%COMP%]:hover{transform:translateY(-3px)}.body[_ngcontent-%COMP%]{min-height:100vh;background-color:#000;width:100vw;display:flex;flex-direction:column;align-items:center}app-navigation-panel[_ngcontent-%COMP%]{margin-top:30px}app-create-furniture[_ngcontent-%COMP%]{width:80%}.functionalBtns[_ngcontent-%COMP%]{margin-top:20px;width:clamp(300px,30vw,400px);display:flex;height:50px;gap:10px;justify-content:center;margin-bottom:30px;z-index:1}.functionalBtn[_ngcontent-%COMP%]{height:100%;border-radius:10px;background-color:#344e41;border:none;cursor:pointer}.confirmBtn[_ngcontent-%COMP%]{width:75%;color:#fff;background-color:#344e41;padding:15px}.deleteBtn[_ngcontent-%COMP%]{aspect-ratio:1;padding:1em;display:flex;align-items:center;justify-content:center}.colorCircle[_ngcontent-%COMP%]{border-radius:100%;height:100%;aspect-ratio:1;display:flex;align-items:center;justify-content:center;transition:all .3s ease-in-out;box-shadow:0 0 5px #fff}.colorCircle[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:50%;height:50%}.deleteColorBtn[_ngcontent-%COMP%]{padding:5px;background-color:transparent}@media (max-width: 1440px){app-create-furniture[_ngcontent-%COMP%]{width:90%}}@media (max-width: 600px){.body[_ngcontent-%COMP%]{width:100vw;padding:0 10px;box-sizing:border-box}app-navigation-panel[_ngcontent-%COMP%], app-create-furniture[_ngcontent-%COMP%]{width:100%}.functionalBtns[_ngcontent-%COMP%]{width:100%;max-width:400px;gap:5px}.confirmBtn[_ngcontent-%COMP%]{width:100%;padding:10px}}']})}return n})(),kc=(()=>{class n{constructor(){this.change$=new Xr}ngOnChanges(){this.change$.next()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=_t({type:n,standalone:!1,features:[as]})}}return n})();class Na{constructor(e){this.year=e}static isValidYear(e){return Number.isInteger(e)&&gh(e,0,1e4)}static isLeapYear(e){return e%400==0||e%4==0&&e%100!=0}static getAbsoluteLeapYears(e){return Math.ceil(e/400)+(Math.ceil(e/4)-Math.ceil(e/100))}static lengthBetween(e,t){return t.year-e.year}static normalizeYearPart(e){return F3(e,0,9999)}get formattedYear(){return String(this.year).padStart(4,"0")}get isLeapYear(){return Na.isLeapYear(this.year)}get absoluteLeapYears(){return Na.getAbsoluteLeapYears(this.year)}yearBefore({year:e}){return this.year<e}yearSameOrBefore({year:e}){return this.year<=e}yearSame({year:e}){return this.year===e}yearSameOrAfter({year:e}){return this.year>=e}yearAfter({year:e}){return this.year>e}append({year:e=0}){return new Na(this.year+e)}toString(){return this.formattedYear}valueOf(){return this.year}[Symbol.toPrimitive](e){return Date.prototype[Symbol.toPrimitive].call(this,e)}toJSON(){return this.formattedYear}}class os extends Na{constructor(e,t){super(e),this.month=t}static isValidMonth(e,t){return Na.isValidYear(e)&&os.isValidMonthPart(t)}static getMonthDaysCount(e,t){switch(e){case 3:case 5:case 10:case 8:return 30;case 1:return t?29:28;default:return 31}}static currentLocal(){const e=new Date;return new os(e.getFullYear(),e.getMonth())}static currentUtc(){const e=new Date;return new os(e.getUTCFullYear(),e.getUTCMonth())}static lengthBetween(e,t){return t.month+12*t.year-(e.month+12*e.year)}static normalizeMonthPart(e){return F3(e,0,11)}static isValidMonthPart(e){return Number.isInteger(e)&&gh(e,0,12)}get formattedMonthPart(){return String(this.month+1).padStart(2,"0")}get daysCount(){return os.getMonthDaysCount(this.month,this.isLeapYear)}monthBefore(e){return this.yearBefore(e)||this.yearSame(e)&&this.month<e.month}monthSameOrBefore(e){return this.yearBefore(e)||this.yearSame(e)&&this.month<=e.month}monthSame(e){return this.yearSame(e)&&this.month===e.month}monthSameOrAfter(e){return this.yearAfter(e)||this.yearSame(e)&&this.month>=e.month}monthAfter(e){return this.yearAfter(e)||this.yearSame(e)&&this.month>e.month}append({year:e=0,month:t=0}){const i=12*(this.year+e)+this.month+t;return new os(Math.floor(i/12),i%12)}toString(){return`${this.formattedMonthPart}.${this.formattedYear}`}valueOf(){return this.toLocalNativeDate().valueOf()}toJSON(){return`${super.toJSON()}-${this.formattedMonthPart}`}toLocalNativeDate(){return new Date(this.year,this.month)}toUtcNativeDate(){return new Date(Date.UTC(this.year,this.month))}}class Rs extends os{constructor(e,t,i){super(e,t),this.day=i}static fromLocalNativeDate(e){return new Rs(e.getFullYear(),e.getMonth(),e.getDate())}static fromUtcNativeDate(e){return new Rs(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())}static isValidDay(e,t,i){return os.isValidMonth(e,t)&&Number.isInteger(i)&&gh(i,1,os.getMonthDaysCount(t,Na.isLeapYear(e))+1)}static currentLocal(){const e=new Date,t=e.getFullYear(),i=e.getMonth(),r=e.getDate();return new Rs(t,i,r)}static currentUtc(){const e=new Date,t=e.getUTCFullYear(),i=e.getUTCMonth(),r=e.getUTCDate();return new Rs(t,i,r)}static normalizeOf(e,t,i){const r=Na.normalizeYearPart(e),o=os.normalizeMonthPart(t),s=Rs.normalizeDayPart(i,o,r);return new Rs(r,o,s)}static lengthBetween(e,t){return Math.round((t.toLocalNativeDate().getTime()-e.toLocalNativeDate().getTime())/864e5)}static parseRawDateString(e,t="DMY"){switch(t){case"MDY":return{day:parseInt(e.slice(3,5),10),month:parseInt(e.slice(0,2),10)-1,year:parseInt(e.slice(6,10),10)};case"YMD":return{day:parseInt(e.slice(8,10),10),month:parseInt(e.slice(5,7),10)-1,year:parseInt(e.slice(0,4),10)};default:return{day:parseInt(e.slice(0,2),10),month:parseInt(e.slice(3,5),10)-1,year:parseInt(e.slice(6,10),10)}}}static normalizeParse(e,t="DMY"){const{day:i,month:r,year:o}=this.parseRawDateString(e,t);return Rs.normalizeOf(o,r,i)}static jsonParse(e){const{day:t,month:i,year:r}=this.parseRawDateString(e,"YMD");if(!os.isValidMonth(r,i)||!Number.isInteger(t)||!gh(t,1,os.getMonthDaysCount(i,Na.isLeapYear(r))+1))throw new WMe(r,i,t);return new Rs(r,i,t)}static normalizeDayPart(e,t,i){return F3(e,1,os.getMonthDaysCount(t,Na.isLeapYear(i)))}get formattedDayPart(){return String(this.day).padStart(2,"0")}get isWeekend(){const e=this.dayOfWeek(!1);return 6===e||0===e}dayOfWeek(e=!0){const t=e?this.toLocalNativeDate().getDay()-1:this.toLocalNativeDate().getDay();return t<0?6:t}dayBefore(e){return this.monthBefore(e)||this.monthSame(e)&&this.day<e.day}daySameOrBefore(e){return this.monthBefore(e)||this.monthSame(e)&&this.day<=e.day}daySame(e){return this.monthSame(e)&&this.day===e.day}daySameOrAfter(e){return this.monthAfter(e)||this.monthSame(e)&&this.day>=e.day}dayAfter(e){return this.monthAfter(e)||this.monthSame(e)&&this.day>e.day}dayLimit(e,t){return null!==e&&this.dayBefore(e)?e:null!==t&&this.dayAfter(t)?t:this}append({year:e=0,month:t=0,day:i=0}){const r=12*(this.year+e)+this.month+t;let o=Math.floor(r/12),s=r%12,a=Math.min(this.day,os.getMonthDaysCount(s,Na.isLeapYear(o)))+i;for(;a>os.getMonthDaysCount(s,Na.isLeapYear(o));)a-=os.getMonthDaysCount(s,Na.isLeapYear(o)),11===s?(o++,s=0):s++;for(;a<1;)0===s?(o--,s=11):s--,a+=os.getMonthDaysCount(s,Na.isLeapYear(o));return new Rs(o,s,a)}getFormattedDay(e,t){const i=this.formattedDayPart,r=this.formattedMonthPart,o=this.formattedYear;switch(e){case"MDY":return`${r}${t}${i}${t}${o}`;case"YMD":return`${o}${t}${r}${t}${i}`;default:return`${i}${t}${r}${t}${o}`}}toString(e="DMY",t="."){return this.getFormattedDay(e,t)}toJSON(){return`${super.toJSON()}-${this.formattedDayPart}`}toLocalNativeDate(){return new Date(this.year,this.month,this.day)}toUtcNativeDate(){return new Date(Date.UTC(this.year,this.month,this.day))}}class WMe extends Error{constructor(e,t,i){super("")}}new Rs(0,0,1),new Rs(9999,11,31),new Rs(2099,11,31),Symbol;const $Me={name:"english",months:["January","February","March","April","May","June","July","August","September","October","November","December"],close:"Close",clear:"Clear",nothingFoundMessage:"Nothing found",defaultErrorMessage:"Value is invalid",spinTexts:["Previous","Next"],shortWeekDays:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],countries:{AD:"Andorra",AE:"United Arab Emirates",AF:"Afghanistan",AG:"Antigua & Barbuda",AI:"Anguilla",AL:"Albania",AM:"Armenia",AO:"Angola",AR:"Argentina",AT:"Austria",AU:"Australia",AW:"Aruba",AZ:"Azerbaijan",BA:"Bosnia & Herzegovina",BB:"Barbados",BD:"Bangladesh",BE:"Belgium",BF:"Burkina Faso",BG:"Bulgaria",BH:"Bahrain",BI:"Burundi",BJ:"Benin",BL:"St. Barth\xe9lemy",BM:"Bermuda",BN:"Brunei",BO:"Bolivia",BQ:"Caribbean Netherlands",BR:"Brazil",BS:"Bahamas",BT:"Bhutan",BW:"Botswana",BY:"Belarus",BZ:"Belize",CA:"Canada",CD:"Congo - Kinshasa",CF:"Central African Republic",CG:"Congo - Brazzaville",CH:"Switzerland",CI:"C\xf4te d\u2019Ivoire",CL:"Chile",CM:"Cameroon",CN:"China",CO:"Colombia",CR:"Costa Rica",CU:"Cuba",CV:"Cape Verde",CW:"Cura\xe7ao",CY:"Cyprus",CZ:"Czechia",DE:"Germany",DJ:"Djibouti",DK:"Denmark",DM:"Dominica",DO:"Dominican Republic",DZ:"Algeria",EC:"Ecuador",EE:"Estonia",EG:"Egypt",ER:"Eritrea",ES:"Spain",ET:"Ethiopia",FI:"Finland",FJ:"Fiji",FK:"Falkland Islands",FM:"Federated States of Micronesia",FR:"France",GA:"Gabon",GB:"United Kingdom",GD:"Grenada",GE:"Georgia",GF:"French Guiana",GH:"Ghana",GI:"Gibraltar",GL:"Greenland",GM:"Gambia",GN:"Guinea",GP:"Guadeloupe",GQ:"Equatorial Guinea",GR:"Greece",GT:"Guatemala",GW:"Guinea-Bissau",GY:"Guyana",HK:"Hong Kong",HN:"Honduras",HR:"Croatia",HT:"Haiti",HU:"Hungary",ID:"Indonesia",IE:"Ireland",IL:"Israel",IN:"India",IQ:"Iraq",IR:"Iran",IS:"Iceland",IT:"Italy",JM:"Jamaica",JO:"Jordan",JP:"Japan",KE:"Kenya",KG:"Kyrgyzstan",KH:"Cambodia",KM:"Comoros",KN:"St. Kitts & Nevis",KP:"North Korea",KR:"South Korea",KW:"Kuwait",KY:"Cayman Islands",KZ:"Kazakhstan",LA:"Laos",LB:"Lebanon",LC:"St. Lucia",LI:"Liechtenstein",LK:"Sri Lanka",LR:"Liberia",LS:"Lesotho",LT:"Lithuania",LU:"Luxembourg",LV:"Latvia",LY:"Libya",MA:"Morocco",MC:"Monaco",MD:"Moldova",ME:"Montenegro",MF:"St. Martin",MG:"Madagascar",MK:"North Macedonia",ML:"Mali",MM:"Myanmar (Burma)",MN:"Mongolia",MO:"Macao",MQ:"Martinique",MR:"Mauritania",MS:"Montserrat",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"Mexico",MY:"Malaysia",MZ:"Mozambique",NA:"Namibia",NC:"New Caledonia",NE:"Niger",NG:"Nigeria",NI:"Nicaragua",NL:"Netherlands",NO:"Norway",NP:"Nepal",NZ:"New Zealand",OM:"Oman",PA:"Panama",PE:"Peru",PF:"French Polynesia",PG:"Papua New Guinea",PH:"Philippines",PK:"Pakistan",PL:"Poland",PT:"Portugal",PW:"Palau",PY:"Paraguay",QA:"Qatar",RE:"R\xe9union",RO:"Romania",RS:"Serbia",RU:"Russia",RW:"Rwanda",SA:"Saudi Arabia",SB:"Solomon Islands",SC:"Seychelles",SD:"Sudan",SE:"Sweden",SG:"Singapore",SH:"St. Helena",SI:"Slovenia",SK:"Slovakia",SL:"Sierra Leone",SM:"San Marino",SN:"Senegal",SO:"Somalia",SR:"Suriname",ST:"S\xe3o Tom\xe9 & Pr\xedncipe",SV:"El Salvador",SX:"Sint Maarten",SY:"Syria",SZ:"Eswatini",TC:"Turks & Caicos Islands",TD:"Chad",TG:"Togo",TH:"Thailand",TJ:"Tajikistan",TL:"Timor-Leste",TM:"Turkmenistan",TN:"Tunisia",TO:"Tonga",TR:"T\xfcrkiye",TT:"Trinidad & Tobago",TW:"Taiwan",TZ:"Tanzania",UA:"Ukraine",UG:"Uganda",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VC:"St. Vincent & Grenadines",VE:"Venezuela",VG:"British Virgin Islands",VN:"Vietnam",VU:"Vanuatu",WS:"Samoa",XK:"Kosovo",YE:"Yemen",YT:"Mayotte",ZA:"South Africa",ZM:"Zambia",ZW:"Zimbabwe",AC:"Ascension Island",AS:"American Samoa",AX:"\xc5land Islands",CC:"Cocos (Keeling) Islands",CK:"Cook Islands",CX:"Christmas Island",EH:"Western Sahara",FO:"Faroe Islands",GG:"Guernsey",GU:"Guam",IM:"Isle of Man",JE:"Jersey",IO:"British Indian Ocean Territory",KI:"Kiribati",MH:"Marshall Islands",MP:"Northern Mariana Islands",NF:"Norfolk Island",NR:"Nauru",NU:"Niue",PM:"Saint Pierre and Miquelon",PR:"Puerto Rico",PS:"Palestine",SJ:"Svalbard and Jan Mayen",SS:"South Sudan",TA:"Tristan da Cunha",TK:"Tokelau",TV:"Tuvalu",VA:"Holy See",VI:"Virgin Islands",WF:"Wallis and Futuna"},cancel:"Cancel",done:"Done",more:"More",otherDate:"Other date...",showAll:"Show all",hide:"Hide",mobileCalendarTexts:["Choose day","Choose range","Choose days"],range:["from","to"],countTexts:["Plus","Minus"],time:{"HH:MM":"HH:MM","HH:MM AA":"HH:MM AA","HH:MM:SS":"HH:MM:SS","HH:MM:SS AA":"HH:MM:SS AA","HH:MM:SS.MSS":"HH:MM:SS.MSS","HH:MM:SS.MSS AA":"HH:MM:SS.MSS AA"},dateTexts:{DMY:"dd.mm.yyyy",MDY:"mm.dd.yyyy",YMD:"yyyy.mm.dd"},digitalInformationUnits:["B","KiB","MiB"],passwordTexts:["Show password","Hide password"],copyTexts:["Copy","Copied"],shortCalendarMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],pagination:["Previous page","Next page"],fileTexts:{loadingError:"Upload failed",preview:"Preview",remove:"Remove"},inputFileTexts:{defaultLabelSingle:"or drop\xa0it\xa0here",defaultLabelMultiple:"or drop\xa0them\xa0here",defaultLinkSingle:"Choose a file",defaultLinkMultiple:"Choose files",maxSizeRejectionReason:"File is larger than",formatRejectionReason:"Wrong file type",drop:"Drop file here",dropMultiple:"Drop files here"},multiSelectTexts:{all:"Select all",none:"Select none"},confirm:{yes:"Yes",no:"No"},previewTexts:{rotate:"Rotate"},zoomTexts:{zoomOut:"Zoom out",zoomIn:"Zoom in",reset:"Reset"},phoneSearch:"Type country or code",showHideText:"Show/Hide",paginationTexts:{pages:"Pages",linesPerPage:"Lines per page",of:"of"},cardNumber:["Number","Card number"],cardExpiry:["Expires","Valid through"],colorSelectorModeNames:["Solid color","Gradient"],toolbarTools:{undo:"Undo",redo:"Redo",font:"Font",fontStyle:"Font style",fontSize:"Font size",bold:"Bold",italic:"Italic",underline:"Underline",strikeThrough:"Strike through",justify:"Justify",justifyLeft:"Justify left",justifyCenter:"Justify center",justifyRight:"Justify right",justifyFull:"Justify full",list:"List",indent:"Indent",outdent:"Outdent",unorderedList:"Unordered list",orderedList:"Ordered list",quote:"Quote",foreColor:"Color",backColor:"Background color",hiliteColor:"Highlight color",clear:"Clear",link:"Link",attach:"Attach file",tex:"Insert TeX",code:"Code",image:"Insert image",insertHorizontalRule:"Insert horizontal rule",superscript:"Superscript",subscript:"Subscript",insertTable:"Insert table",insertGroup:"Insert group",hiliteGroup:"Hilite group",removeGroup:"Remove group",insertAnchor:"Insert anchor",mergeCells:"Merge cells",splitCells:"Split cells",rowsColumnsManaging:"Managing rows and columns",cellColor:"Cell color",setDetails:"Details",removeDetails:"Remove details"},editorEditLink:{urlExample:"example.com",anchorExample:"anchor"},editorTableCommands:[["Insert column before","Insert column after"],["Insert row before","Insert row after"],["Delete column","Delete row"]],editorCodeOptions:["Code in the text","Code in block"],editorFontOptions:{small:"Small",large:"Large",normal:"Normal",title:"Title",subtitle:"Subtitle"},inputSearch:{popular:"Popular",history:"Recent",placeholder:"Type query",hotkey:"to search",all:"All",empty:"Nothing found"}},qMe=on(()=>$Me),XMe=on(()=>$t(j(qMe)));function um(n){return()=>j(XMe).pipe(Nt(e=>e[n]))}Fi(),Fi("tuiLanguage");const JMe=on(()=>j(fr).defaultView?.matchMedia?.("(prefers-reduced-motion: reduce)").matches??!1),C7=(on(()=>j(JMe)?0:1),Fi("assets/taiga-ui/icons"));Fi({check:"@tui.check",close:"@tui.x",error:"@tui.circle-alert",more:"@tui.chevron-right",search:"@tui.search",ellipsis:"@tui.ellipsis"});const eCe=Fi("tuiDark");Fi($t((on(()=>{let n=!0;const e=j(ole),t=j(eCe),i=e.getItem(t),r=j(Zs).matchMedia("(prefers-color-scheme: dark)"),o=fs(!!((i&&JSON.parse(i))??r.matches));return ag(r,"change").pipe(Ms(()=>!e.getItem(t)),function qE(n){n||(iu(),n=j(Hs));const e=new Kn(t=>n.onDestroy(t.next.bind(t)));return t=>t.pipe(l_(e))}()).subscribe(()=>{n=!0,o.set(r.matches)}),function P4(n,e){!e?.injector&&iu();const t=e?.injector??j(no);let r,i=!0!==e?.manualCleanup?t.get(Hs):null;const o=t.get(p0,null,{optional:!0}),s=t.get(fu);return null===o||e?.forceRoot?r=function Mte(n,e,t){const i=Object.create(bte);return i.fn=n,i.scheduler=e,i.notifier=t,i.zone=typeof Zone<"u"?Zone.current:null,i.scheduler.schedule(i),i.notifier.notify(12),i}(n,t.get(VB),s):(r=function xte(n,e,t){const i=Object.create(wte);return i.view=n,i.zone=typeof Zone<"u"?Zone.current:null,i.notifier=e,i.fn=t,n[23]??=new Set,n[23].add(i),i.consumerMarkedDirty(i),i}(o.view,s,n),i instanceof WM&&i._lView===o.view&&(i=null)),r.injector=t,null!==i&&(r.onDestroyFn=i.onDestroy(()=>r.destroy())),new vte(r)}(()=>{const s=String(o());n?n=!1:e.setItem(t,s)}),Object.assign(o,{reset:()=>{e.removeItem(t),n=!0,o.set(r.matches)}})}),{mode:"DMY",separator:"."}))),Fi(n=>n.isWeekend?"weekend":"weekday"),Fi(1),on(um("months")),on(um("close")),on(um("clear")),on(um("nothingFoundMessage")),on(um("defaultErrorMessage")),on(um("spinTexts")),on(um("shortWeekDays")),Fi(""),Fi(""),Fi({}),on(()=>{const n=j(C7);return e=>`${n}/${e.replace("@tui.","").split(".").join("/")}.svg`}),Fi({mobile:768,desktopSmall:1024,desktopLarge:1280});Fi($t({precision:NaN,decimalSeparator:".",thousandSeparator:"\xa0",rounding:"truncate",decimalMode:"pad"})),on(()=>new gi(j(fr).documentElement)),on(()=>{const n=j(fr);return Md(li(n,"selectionchange"),li(n,"mouseup"),li(n,"mousedown").pipe(xs(()=>li(n,"mousemove").pipe(l_(li(n,"mouseup"))))),li(n,"keydown"),li(n,"keyup")).pipe(m_())}),Fi({decrement:"@tui.chevron-left",increment:"@tui.chevron-right"}),Fi("Taiga UI"),on(()=>{const n=j(Zs);return{type:"viewport",getClientRect(){const{height:e=0,offsetTop:t=0}=n.visualViewport||{},i={top:0,left:0,right:n.innerWidth,bottom:n.innerHeight,width:n.innerWidth,height:e+t||n.innerHeight,x:0,y:0};return{...i,toJSON:()=>JSON.stringify(i)}}}}),Fi({AD:"+376###-###",AE:"+971-##-###-####",AF:"+93##-###-####",AG:"+1(268) ###-####",AI:"+1(264) ###-####",AL:"+355(###) ###-###",AM:"+374##-###-###",AO:"+244(###) ###-###",AR:"+54(###) ####-####",AT:"+43(###) ###-####",AU:"+61#-####-####",AW:"+297###-####",AZ:"+994##-###-##-##",BA:"+387 ###-####-##",BB:"+1(246) ###-####",BD:"+880##-###-###",BE:"+32(###) ###-###",BF:"+226##-##-####",BG:"+359(###) ###-###",BH:"+973####-####",BI:"+257##-##-####",BJ:"+229##-##-####",BL:"+590 ## ## ## ## ##",BM:"+1(441) ###-####",BN:"+673###-####",BO:"+591#-###-####",BQ:"+599-###-####",BR:"+55(##) ####-####",BS:"+1(242) ###-####",BT:"+975#-###-###",BW:"+267##-###-###",BY:"+375(##) ###-##-##",BZ:"+501###-####",CA:"+1(###) ###-####",CD:"+243(###) ###-###",CF:"+236-##-##-####",CG:"+242##-###-####",CH:"+41##-###-####",CI:"+225##-##-###-###",CL:"+56#-####-####",CM:"+237#####-####",CN:"+86(###) ####-####",CO:"+57(###) ###-####",CR:"+506####-####",CU:"+53#-###-####",CV:"+238(###) ##-##",CW:"+5999-###-####",CY:"+357##-###-###",CZ:"+420(###) ###-###",DE:"+49(###) ###-###-##",DJ:"+253##-##-##-##",DK:"+45##-##-##-##",DM:"+1(767) ###-####",DO:"+1(###) ###-####",DZ:"+213##-###-####",EC:"+593##-###-####",EE:"+372####-####",EG:"+20(###) ###-####",ER:"+291#-###-###",ES:"+34(###) ###-###",ET:"+251##-###-####",FI:"+358(###) ###-##-##",FJ:"+679##-#####",FK:"+500#####",FM:"+691###-####",FR:"+33 ## ## ## ## ##",GA:"+241##-##-##-##",GB:"+44##-####-####",GD:"+1(473) ###-####",GE:"+995(###) ###-###",GF:"+594 ## ## ## ## ##",GH:"+233(###) ###-###",GI:"+350###-#####",GL:"+299##-##-##",GM:"+220(###) ##-##",GN:"+224##-###-###",GP:"+590 ## ## ## ## ##",GQ:"+240##-###-####",GR:"+30(###) ###-####",GT:"+502#-###-####",GW:"+245#-######",GY:"+592###-####",HK:"+852####-####",HN:"+504####-####",HR:"+385##-###-####",HT:"+509##-##-####",HU:"+36(###) ###-###",ID:"+62(###) ###-##-###",IE:"+353(###) ###-###",IL:"+972##-###-####",IN:"+91(####) ###-###",IQ:"+964(###) ###-####",IR:"+98(###) ###-####",IS:"+354###-####",IT:"+39(###) ####-###",JM:"+1(876) ###-####",JO:"+962#-####-####",JP:"+81-##-####-####",KE:"+254###-######",KG:"+996(###) ###-###",KH:"+855##-###-###",KM:"+269##-#####",KN:"+1(869) ###-####",KP:"+850####-#############",KR:"+82##-###-####",KW:"+965####-####",KY:"+1(345) ###-####",KZ:"+7(###) ###-##-##",LA:"+856##-##-###-###",LB:"+961##-###-###",LC:"+1(758) ###-####",LI:"+423(###) ###-####",LK:"+94##-###-####",LR:"+231##-###-###",LS:"+266#-###-####",LT:"+370(###) ##-###",LU:"+352(###) ###-###",LV:"+371##-###-###",LY:"+218##-###-####",MA:"+212##-####-###",MC:"+377###-###-###",MD:"+373####-####",ME:"+382##-###-###",MF:"+590 ## ## ## ## ##",MG:"+261##-##-#####",MK:"+389##-###-###",ML:"+223##-##-####",MM:"+95##-###-###",MN:"+976##-##-####",MO:"+853####-####",MQ:"+596 ## ## ## ## ##",MR:"+222##-##-####",MS:"+1(664) ###-####",MT:"+356####-####",MU:"+230####-####",MV:"+960###-####",MW:"+265#-####-####",MX:"+52(###) ###-####",MY:"+60(###) ###-###",MZ:"+258##-###-###",NA:"+264##-###-####",NC:"+687 ### ###",NE:"+227##-##-####",NG:"+234(###) ###-####",NI:"+505####-####",NL:"+31##-###-####",NO:"+47(###) ##-###",NP:"+977##-###-###",NZ:"+64(###) ###-####",OM:"+968##-###-###",PA:"+507###-####",PE:"+51(###) ###-###",PF:"+689 ## ## ## ##",PG:"+675(###) ##-###",PH:"+63(###) ###-####",PK:"+92(###) ###-####",PL:"+48(###) ###-###",PT:"+351##-###-####",PW:"+680###-####",PY:"+595(###) ###-###",QA:"+974####-####",RE:"+262 ## ## ## ## ##",RO:"+40##-###-####",RS:"+381##-###-####",RU:"+7### ###-##-##",RW:"+250(###) ###-###",SA:"+966#-####-####",SB:"+677###-####",SC:"+248#-###-###",SD:"+249##-###-####",SE:"+46##-###-####",SG:"+65####-####",SH:"+290####",SI:"+386##-###-###",SK:"+421(###) ###-###",SL:"+232##-######",SM:"+378####-######",SN:"+221##-###-####",SO:"+252##-###-###",SR:"+597###-####",ST:"+239##-#####",SV:"+503##-##-####",SX:"+1(721) ###-####",SY:"+963##-####-###",SZ:"+268##-##-####",TC:"+1(649) ###-####",TD:"+235##-##-##-##",TG:"+228##-###-###",TH:"+66##-###-####",TJ:"+992##-###-####",TL:"+670###-#####",TM:"+993#-###-####",TN:"+216##-###-###",TO:"+676#####",TR:"+90(###) ###-####",TT:"+1(868) ###-####",TW:"+886#-####-####",TZ:"+255##-###-####",UA:"+380(##) ###-##-##",UG:"+256(###) ###-###",US:"+1(###) ###-####",UY:"+598#-###-##-##",UZ:"+998##-###-####",VC:"+1(784) ###-####",VE:"+58(###) ###-####",VG:"+1(284)###-####",VN:"+84(###) ####-###",VU:"+678##-#####",WS:"+685##-####",XK:"+383##-###-###",YE:"+967###-###-###",YT:"+262 ## ## ## ## ##",ZA:"+27##-###-####",ZM:"+260##-###-####",ZW:"+263#-######",VA:"+39 #### ###-####",WF:"+681 ## ##-##",VI:"+1(340) ###-####",JE:"+44(####) ######",AC:"+247###-####",TV:"+686###-####",TK:"+690###-####",TA:"+290###-####",SS:"+211### ###-###",SJ:"+47 ## ##-##-##",PS:"+970 #### ###-###",PR:"+1(###) ###-####",PM:"+508 ### ##-##-##",NU:"+683 ###-####",NR:"+674 ###-####",NF:"+672##-####",MP:"+1(670) ###-####",MH:"+692 ###-####",KI:"+686 ####-####",IO:"+246 ### ####",IM:"+44(####) ######",GU:"+1(###) ###-###",GG:"+44(###) ###-####",FO:"+298 ######",EH:"+212 #### #####",CX:"+61 # ####-####",CK:"+682 ## ###",CC:"+61 # ####-####",AX:"+358 ## ###-####",AS:"+1(###) ###-####"}),Fi(),on(()=>vo(j(fr).fonts?.ready||ws).pipe(QP({bufferSize:1,refCount:!1}))),Fi({}),on(()=>function Lce(n){return N3(n)||yG.test(n.userAgent)}(j(hw))),on(()=>!!j(Zs).chrome),on(()=>void 0!==j(Zs)?.mozCancelFullScreen),on(()=>j(Zs).location.host.endsWith("stackblitz.io")),Fi(),Fi();Fi("textfield");Fi(),on(()=>j(Zs).matchMedia("(any-pointer: coarse)").matches),Fi();new Kn(yl);Fi({iconCleaner:"@tui.x",hintOnDisabled:!1});const N7=on(()=>new lCe);let lCe=(()=>{class n extends kc{constructor(){super(...arguments),this.appearance=""}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275dir=_t({type:n,selectors:[["","tuiTextfieldAppearance",""]],inputs:{appearance:[0,"tuiTextfieldAppearance","appearance"]},standalone:!1,features:[Cn([Sc(N7,n)]),In]})}}return n})();const F7=on(()=>new uCe);let uCe=(()=>{class n extends kc{constructor(){super(...arguments),this.cleaner=!1}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275dir=_t({type:n,selectors:[["","tuiTextfieldCleaner",""]],inputs:{cleaner:[0,"tuiTextfieldCleaner","cleaner"]},standalone:!1,features:[Cn([Sc(F7,n)]),In]})}}return n})();const L7=on(()=>new cCe);let cCe=(()=>{class n extends kc{static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275dir=_t({type:n,selectors:[["","tuiTextfieldCustomContent",""]],inputs:{customContent:[0,"tuiTextfieldCustomContent","customContent"]},standalone:!1,features:[Cn([Sc(L7,n)]),In]})}}return n})();const k7=on(()=>new dCe);let dCe=(()=>{class n extends kc{constructor(){super(...arguments),this.filler=""}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275dir=_t({type:n,selectors:[["","tuiTextfieldFiller",""]],inputs:{filler:[0,"tuiTextfieldFiller","filler"]},standalone:!1,features:[Cn([Sc(k7,n)]),In]})}}return n})();const B7=on(()=>new fCe);let fCe=(()=>{class n extends kc{static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275dir=_t({type:n,selectors:[["","tuiTextfieldIcon",""]],inputs:{icon:[0,"tuiTextfieldIcon","icon"]},standalone:!1,features:[Cn([Sc(B7,n)]),In]})}}return n})();const U7=on(()=>new hCe);let hCe=(()=>{class n extends kc{static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275dir=_t({type:n,selectors:[["","tuiTextfieldIconLeft",""]],inputs:{iconStart:[0,"tuiTextfieldIconLeft","iconStart"]},standalone:!1,features:[Cn([Sc(U7,n)]),In]})}}return n})();const V7=on(()=>new pCe);let pCe=(()=>{class n extends kc{constructor(){super(...arguments),this.labelOutside=!1}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275dir=_t({type:n,selectors:[["","tuiTextfieldLabelOutside",""]],inputs:{labelOutside:[0,"tuiTextfieldLabelOutside","labelOutside"]},standalone:!1,features:[Cn([Sc(V7,n)]),In]})}}return n})();const H7=on(()=>new gCe);let gCe=(()=>{class n extends kc{constructor(){super(...arguments),this.postfix=""}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275dir=_t({type:n,selectors:[["","tuiTextfieldPostfix",""]],inputs:{postfix:[0,"tuiTextfieldPostfix","postfix"]},standalone:!1,features:[Cn([Sc(H7,n)]),In]})}}return n})();const z7=on(()=>new mCe);let mCe=(()=>{class n extends kc{constructor(){super(...arguments),this.prefix=""}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275dir=_t({type:n,selectors:[["","tuiTextfieldPrefix",""]],inputs:{prefix:[0,"tuiTextfieldPrefix","prefix"]},standalone:!1,features:[Cn([Sc(z7,n)]),In]})}}return n})();const G7=on(()=>new _Ce);let _Ce=(()=>{class n extends kc{constructor(){super(...arguments),this.size="l"}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Vn(n)))(r||n)}})()}static{this.\u0275dir=_t({type:n,selectors:[["","tuiTextfieldSize",""]],inputs:{size:[0,"tuiTextfieldSize","size"]},standalone:!1,features:[Cn([Sc(G7,n)]),In]})}}return n})(),yCe=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Hp({type:n})}static{this.\u0275inj=Ku({})}}return n})();Fi();let j7=(()=>{class n{httpModule;baseServiceUrl=Es+"shop";abortController=null;constructor(t){this.httpModule=t}GETgetCategoryData(t,i,r){var o=this;return N(function*(){o.abortController&&o.abortController.abort(),o.abortController=new AbortController;try{let s=`${o.baseServiceUrl}?category=${t}&startRange=${i}`;if(r&&Object.keys(r).length>0){const f=new URLSearchParams;f.append("filters",JSON.stringify(r)),s+=`&${new URLSearchParams(f).toString()}`}const a=yield fetch(s,{signal:o.abortController.signal});if(!a.ok){const f=yield a.text();throw new Error(`\u041e\u0448\u0438\u0431\u043a\u0430: ${a.status} \u2014 ${f}`)}const c=(yield a.json()).resultsArray.map(f=>({...f,previewUrl:Es+f.previewUrl}));return{resultsArray:c,resultsClientFiltersData:o.getFindOptionsByResult(c)}}catch(s){throw"AbortError"===s.name||console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430:",s),s}})()}getFindOptionsByResult(t){let i={colors:[],minCost:1/0,maxCost:-1/0};return t.forEach(r=>{r.cost<i.minCost&&(i.minCost=r.cost),r.cost>i.maxCost&&(i.maxCost=r.cost),i.colors.push(...r.colors)}),i.minCost=i.minCost!==1/0?i.minCost:0,i.maxCost=i.maxCost!==-1/0?i.maxCost:0,i.colors=[...new Set(i.colors)],i}static \u0275fac=function(i){return new(i||n)(Ze(Mu))};static \u0275prov=Ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const vCe=n=>({disabled:n}),bCe=n=>({fieldData:n});function wCe(n,e){if(1&n&&(L(0,"h1",10),re(1),k()),2&n){const t=me();q(),Ca(" ",void 0!==t.currentCategoryId?t.categoryArray[t.currentCategoryId].translateMany:"\u0412\u0441\u0435","")}}function xCe(n,e){if(1&n){const t=rn();L(0,"span",14)(1,"button",15),Oe("click",function(){return qe(t),He(me(2).closeFurniture())}),Te(2,"img",16),k(),L(3,"span",17),Te(4,"app-view-furniture",18),L(5,"button",19),Oe("click",function(){return qe(t),He(me(2).openAddModule())}),re(6,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),k()()()}if(2&n){const t=me(2);q(4),ee("furnitureCardId",t.furnitureCardId)}}function MCe(n,e){1&n&&Te(0,"app-finder")}function CCe(n,e){if(1&n){const t=rn();L(0,"button",38),Oe("click",function(){const r=qe(t).index;return He(me(3).changeCategory(r))}),re(1),k()}if(2&n){const t=e.$implicit,i=e.index;dr("active",me(3).currentCategoryId===i),q(),Ca(" ",t.translateOne," ")}}function SCe(n,e){1&n&&(L(0,"strong",39),re(1,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0447\u0438\u0441\u043b\u0430"),k())}function ECe(n,e){1&n&&Te(0,"img",42)}function TCe(n,e){if(1&n){const t=rn();L(0,"button",40),Oe("click",function(){const r=qe(t).$implicit,o=me(3);return He(o.selectedColors.includes(r)?o.deleteSelectedColor(r):o.addSelectedColor(r))}),ze(1,ECe,1,0,"img",41),k()}if(2&n){const t=e.$implicit,i=me(3);oo("background-color",t),q(),ee("ngIf",i.selectedColors.includes(t))}}function ACe(n,e){1&n&&oh(0)}function DCe(n,e){if(1&n&&(L(0,"span",45)(1,"strong",23),re(2),k(),ze(3,ACe,1,0,"ng-container",46),k()),2&n){const t=e.$implicit;me(4);const i=yo(10),r=yo(12);q(2),Ei(t.name),q(),ee("ngTemplateOutlet","select"===t.type?i:r)("ngTemplateOutletContext",Sa(3,bCe,t))}}function ICe(n,e){if(1&n&&(L(0,"span",43),ze(1,DCe,4,5,"span",44),k()),2&n){const t=me(3);q(),ee("ngForOf",t.categoryArray[t.currentCategoryId].filters)}}function RCe(n,e){if(1&n){const t=rn();L(0,"button",47),Oe("click",function(){return qe(t),He(me(3).requestWithFilters())}),re(1," \u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u044b "),k()}}function PCe(n,e){if(1&n&&(L(0,"div",48)(1,"h2",49),re(2),k(),Te(3,"img",50),L(4,"a",51),re(5),r_(6,"costFormat"),k()()),2&n){let t;const i=e.$implicit,r=me(3);q(2),Ei(i.name),q(),ee("src",i.previewUrl,mc),q(),ee("routerLink","/shop/"+(null!==(t=r.categoryName)&&void 0!==t?t:"all")+"/"+i.furnitureCardId),q(),Ei(o_(6,4,i.cost))}}function OCe(n,e){1&n&&(L(0,"span",52)(1,"strong"),re(2,"\u041c\u0435\u0431\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430"),k(),Te(3,"img",53),k())}function NCe(n,e){if(1&n){const t=rn();L(0,"span",20)(1,"span",21),ze(2,MCe,1,0,"app-finder",22),L(3,"strong",23),re(4,"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f"),k(),L(5,"span",24),ze(6,CCe,2,3,"button",25),L(7,"button",26),Oe("click",function(){return qe(t),He(me(2).changeCategory(void 0))}),re(8," \u0412\u0441\u0435 "),k()(),L(9,"strong",23),re(10,"\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c"),k(),L(11,"form",27),Te(12,"input",28)(13,"hr")(14,"input",29),k(),ze(15,SCe,2,0,"strong",30),L(16,"strong",23),re(17,"\u0426\u0432\u0435\u0442"),k(),L(18,"span",31),ze(19,TCe,2,3,"button",32),k(),ze(20,ICe,2,1,"span",33)(21,RCe,2,0,"button",34),k(),L(22,"span",35),ze(23,PCe,7,6,"div",36)(24,OCe,4,0,"span",37),k()()}if(2&n){const t=me(2);q(2),ee("ngIf",t.checkViewport()),q(4),ee("ngForOf",t.categoryArray),q(),dr("active",null==t.currentCategoryId),q(4),ee("formGroup",t.costForm),q(),ee("placeholder","\u043e\u0442 "+t.clientFiltersObject.minCost),q(2),ee("placeholder","\u0434\u043e "+t.clientFiltersObject.maxCost),q(),ee("ngIf",!t.costForm.valid),q(4),ee("ngForOf",t.clientFiltersObject.colors),q(),ee("ngIf",void 0!==t.currentCategoryId),q(),ee("ngIf",void 0!==t.currentCategoryId),q(2),ee("ngForOf",t.getClientFilteredFurnitures())("ngForTrackBy",t.trackByFn),q(),ee("ngIf",0===t.getClientFilteredFurnitures().length)}}function FCe(n,e){if(1&n&&(L(0,"span",11),ze(1,xCe,7,1,"span",12)(2,NCe,25,14,"span",13),k()),2&n){const t=me();q(),ee("ngIf",t.furnitureCardId),q(),ee("ngIf",!t.furnitureCardId)}}function LCe(n,e){if(1&n&&(L(0,"a",60),re(1),k()),2&n){const t=e.$implicit,i=e.index,r=me().index;ee("routerLink",me(2).getPlanUrl(r,i)),q(),Ei(t.name)}}function kCe(n,e){if(1&n&&(L(0,"span")(1,"h3",58),re(2),k(),ze(3,LCe,2,2,"a",59),k()),2&n){const t=e.$implicit;q(2),Ei(t.name),q(),ee("ngForOf",t.rooms)}}function BCe(n,e){1&n&&(L(0,"a",61),re(1,"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043b\u0430\u043d"),k())}function UCe(n,e){if(1&n&&(L(0,"span",54)(1,"h2",55),re(2,"\u041f\u0440\u043e\u0435\u043a\u0442\u044b"),k(),ze(3,kCe,4,2,"span",56)(4,BCe,2,0,"a",57),k()),2&n){const t=me();q(3),ee("ngForOf",t.accountProjects),q(),ee("ngIf",0==t.accountProjects.length)}}function VCe(n,e){1&n&&Te(0,"img",42)}function HCe(n,e){if(1&n){const t=rn();L(0,"button",64),Oe("click",function(){const r=qe(t).$implicit,o=me(2).fieldData,s=me();return He(s.queryGroup[o.field].includes(r.queryValue)?s.deleteSelectedOption(r.queryValue,o.field):s.addSelectedOption(r.queryValue,o.field))}),ze(1,VCe,1,0,"img",41),L(2,"p"),re(3),k()()}if(2&n){const t=e.$implicit,i=me(2).fieldData,r=me();q(),ee("ngIf",r.queryGroup[i.field].includes(t.queryValue)),q(2),Ei(t.name)}}function zCe(n,e){if(1&n&&(ih(0),L(1,"span",62),ze(2,HCe,4,2,"button",63),k(),rh()),2&n){const t=me().fieldData;q(2),ee("ngForOf",t.options)}}function GCe(n,e){if(1&n&&ze(0,zCe,3,1,"ng-container",22),2&n){const t=e.fieldData;ee("ngIf",me().queryGroup[t.field])}}function jCe(n,e){if(1&n&&(ih(0),L(1,"form",27),Te(2,"input",65)(3,"hr")(4,"input",66),k(),rh()),2&n){const t=me().fieldData,i=me();q(),ee("formGroup",i.queryGroup[t.field])}}function WCe(n,e){if(1&n&&ze(0,jCe,5,1,"ng-container",22),2&n){const t=e.fieldData;ee("ngIf",me().queryGroup[t.field])}}let B2=(()=>{class n{route;shopService;router;accountService;accountCookieService;notification;categoryService;location;elementRef;finderService;furnitureNameSubscription;funritureName="";queryGroup={};furnitureCardId;categoryName;accountProjects;currentCategoryId;furnituresArray=[];openAddModuleToggle=!1;categoryArray=[];clientFiltersObject;selectedColors=[];constructor(t,i,r,o,s,a,l,u,c,f){this.route=t,this.shopService=i,this.router=r,this.accountService=o,this.accountCookieService=s,this.notification=a,this.categoryService=l,this.location=u,this.elementRef=c,this.finderService=f}ngOnInit(){var t=this;return N(function*(){t.clearClientFilters(),t.processRouteParams(),t.furnitureNameSubscription=t.finderService.furnitureName$.subscribe(r=>{t.furnituresArray=[],t.funritureName=r,t.requestFurnitures(t.categoryName??"all",0,t.handleQueryData())});const i=t.accountCookieService.getJwt();if(i)try{t.accountProjects=(yield t.accountService.GETaccount(i)).accountData.projects}catch(r){console.log(r)}})()}ngOnDestroy(){this.furnitureNameSubscription.unsubscribe()}initCategories(){var t=this;return N(function*(){try{t.categoryArray=(yield t.categoryService.GETgetAllCategories()).categoryArray,t.categoryArray.forEach((i,r)=>{t.categoryName===i.name&&(t.currentCategoryId=r,t.initQueryGroup())}),void 0===t.currentCategoryId&&t.categoryArray.length>0&&"all"!==t.categoryName&&t.router.navigateByUrl("/shop")}catch(i){console.log(i)}})()}furnituresInit(){var t=this;return N(function*(){void 0!==t.categoryName?yield t.requestFurnitures(t.categoryName,0):yield t.requestFurnitures("all",0),t.setScrollObserver()})()}requestFurnitures(t,i,r){var o=this;return N(function*(){const s=yield o.shopService.GETgetCategoryData(t,i,r);o.furnituresArray=[...o.furnituresArray,...s.resultsArray],o.clientFiltersObject=s.resultsClientFiltersData})()}clearClientFilters(){this.clientFiltersObject={colors:[],minCost:0,maxCost:0}}initQueryGroup(){void 0!==this.currentCategoryId&&(this.queryGroup={},this.categoryArray[this.currentCategoryId].filters.forEach(t=>{this.queryGroup[t.field]=t&&"select"===t.type?[]:new Ko({min:new Li(null,[this.numberOrEmptyValidator]),max:new Li(null,[this.numberOrEmptyValidator])})}))}numberOrEmptyValidator(t){const i=t.value;return null==i||""===i?null:isNaN(i)||i<0?{notNumber:!0}:null}processRouteParams(){const t=this.route.snapshot.params;this.categoryName=t.category,this.furnitureCardId=t.furnitureCardId,this.initCategories()}setScrollObserver(){var t=this;const i=this.elementRef.nativeElement.querySelector(".category"),r=i.querySelectorAll(".furnitureItem"),l=new IntersectionObserver((u,c)=>{u.forEach(function(){var f=N(function*(h){if(h.isIntersecting){const g=h.target;(Array.from(r).indexOf(g)+1)%8==0&&!g.dataset.observed&&(g.dataset.observed="true",void 0!==t.categoryName?yield t.requestFurnitures(t.categoryName,t.furnituresArray.length,t.handleQueryData()):yield t.requestFurnitures("all",t.furnituresArray.length,t.handleQueryData()))}});return function(h){return f.apply(this,arguments)}}())},{root:i,rootMargin:"0px",threshold:.5});r.forEach(u=>l.observe(u))}checkViewport(){return window.innerWidth<=768}requestWithFilters(){this.furnituresArray.length=0,this.requestFurnitures(this.categoryName??"all",0,this.handleQueryData())}handleQueryData(){const t={};return this.funritureName.length>0&&(t.name=this.funritureName),Object.keys(this.queryGroup).forEach(i=>{if(this.queryGroup[i]instanceof Ko){if(!this.queryGroup[i].valid)return;const{min:r,max:o}=this.queryGroup[i].value;(+r>0||+o>0)&&(t[i]={min:+r,max:+o})}else this.queryGroup[i].length>0&&(t[i]=this.queryGroup[i])}),t}addSelectedColor(t){this.selectedColors.push(t)}deleteSelectedColor(t){const i=this.selectedColors.findIndex(r=>r===t);this.selectedColors.splice(i,1)}addSelectedOption(t,i){this.queryGroup[i]&&this.queryGroup[i].push(t)}deleteSelectedOption(t,i){if(!this.queryGroup[i])return;const r=this.queryGroup[i].findIndex(o=>o===t);this.queryGroup[i].splice(r,1)}openAddModule(){this.accountCookieService.getJwt()||this.router.navigateByUrl("/login"),this.openAddModuleToggle=!0}closeAddModule(){this.openAddModuleToggle=!1}checkDesktop=cA;changeCategory(t){this.furnituresArray.length=0,this.currentCategoryId=t;let i="/shop";void 0!==t?(this.categoryName=this.categoryArray[t].name,i+="/"+this.categoryArray[t].name):this.categoryName=void 0,this.location.replaceState(i),this.furnituresInit(),this.initQueryGroup()}closeFurniture(){this.router.navigateByUrl("/shop"+("all"===this.categoryName?"":"/"+this.categoryName))}getPlanUrl(t,i){return`/plan/${t}/${i}/${this.furnitureCardId}`}trackByFn(t,i){return i.id}getClientFilteredFurnitures(){return this.costForm.valid?this.furnituresArray.filter(t=>{const i=0===this.selectedColors.length||[...new Set([...t.colors,...this.selectedColors])].length<t.colors.length+this.selectedColors.length,{minCost:r,maxCost:o}=this.costForm.value;return i&&+(r||-1/0)<=t.cost&&t.cost<=+(o||1/0)}):[]}costForm=new Ko({minCost:new Li(null,[this.numberOrEmptyValidator]),maxCost:new Li(null,[this.numberOrEmptyValidator])});static \u0275fac=function(i){return new(i||n)(se(Eu),se(j7),se(Ea),se(Vx),se(ju),se(kl),se(rO),se(bd),se(gi),se(E2))};static \u0275cmp=mo({type:n,selectors:[["app-shop-page"]],features:[Cn([])],decls:13,vars:6,consts:[["selectFilter",""],["rangeFilter",""],[1,"body"],["class","categoryTitle","title","\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f",4,"ngIf"],["class","shopModule",4,"ngIf"],[1,"addModule",3,"ngClass"],[1,"addModuleSpan"],["type","button","title","\u0417\u0430\u043a\u0440\u044b\u0442\u044c",1,"closeAddModuleBtn",3,"click"],["loading","lazy","src","/assets/images/addIcon.svg","alt","\u0417\u0430\u043a\u0440\u044b\u0442\u044c"],["class","addModuleFormContent",4,"ngIf"],["title","\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f",1,"categoryTitle"],[1,"shopModule"],["class","viewFurnitureSpan",4,"ngIf"],["class","mainArea",4,"ngIf"],[1,"viewFurnitureSpan"],["title","\u0417\u0430\u043a\u0440\u044b\u0442\u044c",1,"closeFurniture",3,"click"],["src","/assets/images/addIcon.svg","alt","\u0417\u0430\u043a\u0440\u044b\u0442\u044c"],[1,"furnitureCard"],[3,"furnitureCardId"],["title","\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u0431\u0435\u043b\u044c",1,"chooseAddProjectBtn",3,"click"],[1,"mainArea"],[1,"params"],[4,"ngIf"],[1,"paramsChapterTitle"],[1,"furnitureCategoriesButtonsSpan"],["class","furnitureCategoryButton","title","\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044e",3,"active","click",4,"ngFor","ngForOf"],["title","\u0412\u0441\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438",1,"furnitureCategoryButton",3,"click"],[1,"rangeInputsSpan",3,"formGroup"],["formControlName","minCost","type","text",1,"rangeInput",3,"placeholder"],["formControlName","maxCost","type","text",1,"rangeInput",3,"placeholder"],["class","paramsError",4,"ngIf"],[1,"colorsChooseSpan"],["class","colorItem",3,"background-color","click",4,"ngFor","ngForOf"],["class","categoryFilters",4,"ngIf"],["class","useFiltersBtn",3,"click",4,"ngIf"],[1,"category"],["class","furnitureItem",4,"ngFor","ngForOf","ngForTrackBy"],["class","noItemsMsgSpan",4,"ngIf"],["title","\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044e",1,"furnitureCategoryButton",3,"click"],[1,"paramsError"],[1,"colorItem",3,"click"],["src","/assets/images/cancelIcon.svg","alt","x","srcset","",4,"ngIf"],["src","/assets/images/cancelIcon.svg","alt","x","srcset",""],[1,"categoryFilters"],["class","categoryFilter",4,"ngFor","ngForOf"],[1,"categoryFilter"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"useFiltersBtn",3,"click"],[1,"furnitureItem"],["title","\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0431\u0435\u043b\u0438",1,"furnitureTitle"],["loading","lazy","alt","\u041f\u0440\u0435\u0432\u044c\u044e \u043c\u0435\u0431\u0435\u043b\u0438","title","\u041f\u0440\u0435\u0432\u044c\u044e \u043c\u0435\u0431\u0435\u043b\u0438",1,"furniturePreview",3,"src"],["title","\u0426\u0435\u043d\u0430 \u043c\u0435\u0431\u0435\u043b\u0438",1,"furnitureLink",3,"routerLink"],[1,"noItemsMsgSpan"],["src","/assets/images/furnitureIcon.svg","alt","","srcset",""],[1,"addModuleFormContent"],["title","\u041f\u0440\u043e\u0435\u043a\u0442\u044b",1,"addModuleTitle"],[4,"ngFor","ngForOf"],["routerLink","/plan","class","noProjectsBtn","title","\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043b\u0430\u043d",4,"ngIf"],["title","\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u0430"],["title","\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043c\u043d\u0430\u0442\u044b",3,"routerLink",4,"ngFor","ngForOf"],["title","\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043c\u043d\u0430\u0442\u044b",3,"routerLink"],["routerLink","/plan","title","\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043b\u0430\u043d",1,"noProjectsBtn"],[1,"selectFilterOptionsSpan"],["class","selectFilterOption",3,"click",4,"ngFor","ngForOf"],[1,"selectFilterOption",3,"click"],["placeholder","\u043e\u0442","formControlName","min","type","text",1,"rangeInput"],["placeholder","\u0434\u043e","formControlName","max","type","text",1,"rangeInput"]],template:function(i,r){if(1&i){const o=rn();L(0,"span",2),Te(1,"app-navigation-panel"),ze(2,wCe,2,1,"h1",3)(3,FCe,3,2,"span",4),k(),L(4,"span",5)(5,"span",6)(6,"button",7),Oe("click",function(){return qe(o),He(r.closeAddModule())}),Te(7,"img",8),k(),ze(8,UCe,5,2,"span",9),k()(),ze(9,GCe,1,1,"ng-template",null,0,vs)(11,WCe,1,1,"ng-template",null,1,vs)}2&i&&(q(2),ee("ngIf",!r.furnitureCardId),q(),ee("ngIf",r.furnituresArray),q(),ee("ngClass",Sa(4,vCe,!r.openAddModuleToggle)),q(4),ee("ngIf",r.accountProjects))},dependencies:[b7,yg,mg,Ed,hg,pg,Ac,yh,g_,iO,my,Au,Cs,Tj,hh,sg,hT,yCe],styles:['@charset "UTF-8";@font-face{font-family:Calypso;src:url(/assets/fonts/Calypso.ttf) format("truetype");font-weight:400}@font-face{font-family:Courier New;src:url(/assets/fonts/Courier\\ New.ttf) format("truetype");font-weight:400}*[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}html[_ngcontent-%COMP%]{scroll-behavior:smooth}img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.furnitureLink[_ngcontent-%COMP%], .furnitureCategoryButton[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.furnitureLink[_ngcontent-%COMP%]:hover, .furnitureCategoryButton[_ngcontent-%COMP%]:hover{transform:translateY(-3px)}app-navigation-panel[_ngcontent-%COMP%]{margin-top:30px;z-index:10}app-finder[_ngcontent-%COMP%]{width:calc(100% - 20px)}.body[_ngcontent-%COMP%]{min-height:calc(100vh - 30px);background-color:#000;display:flex;align-items:center;flex-direction:column;gap:30px;padding-bottom:30px}.furnitureCategoryButton[_ngcontent-%COMP%]{background-color:#344e41;border-radius:10px;text-align:center;place-content:center;width:100%;height:50px;color:#fff;cursor:pointer;border:none}.shopModule[_ngcontent-%COMP%]{width:90%;margin:0 auto;display:grid;grid-template-columns:1fr;grid-template-rows:1fr;z-index:1}.category[_ngcontent-%COMP%]{width:75%;height:60vh;transition:all .5s ease-in-out;overflow-y:scroll;display:flex;flex-wrap:wrap;justify-content:space-around;z-index:1}.categoryTitle[_ngcontent-%COMP%]{text-align:center;color:#fff}.params[_ngcontent-%COMP%]{width:20%;min-width:230px;display:flex;flex-direction:column;gap:10px}.params[_ngcontent-%COMP%]   .paramsChapterTitle[_ngcontent-%COMP%]{color:#fff}.params[_ngcontent-%COMP%]   .paramsError[_ngcontent-%COMP%]{color:red}.furnitureItem[_ngcontent-%COMP%]{flex:1 1 calc(40% - 10px);max-width:60%;display:flex;gap:10px;flex-direction:column;align-items:center;justify-content:space-between}.furnitureTitle[_ngcontent-%COMP%]{color:#fff;text-align:center}.furniturePreview[_ngcontent-%COMP%]{width:80%;border-radius:10px}.furnitureLink[_ngcontent-%COMP%]{background-color:#fff;color:#000;border-radius:10px;text-align:center;border:none;width:75%;text-decoration:none;height:50px;align-content:center}.furnitureCategoriesButtonsSpan[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px;width:100%;justify-content:start;padding-top:5px;padding-right:5px;max-height:300px;overflow-y:scroll;margin-bottom:10px}.furnitureCategoriesButtonsSpan[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{background-color:#a3b18a;color:#000}.furnitureCategoryButton[_ngcontent-%COMP%]{background-color:#344e41;border-radius:10px;text-align:center;place-content:center;width:100%;height:50px;flex-shrink:0;color:#fff;cursor:pointer;border:none}.closeFurniture[_ngcontent-%COMP%]{background:none;border:none;width:35px;aspect-ratio:1;align-self:flex-start;cursor:pointer;grid-area:1/1/2/2;z-index:2}.closeFurniture[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{rotate:45deg}.viewFurnitureSpan[_ngcontent-%COMP%]{width:100%;display:grid;grid-template-columns:1fr;grid-template-rows:1fr;gap:10px;grid-area:1/1/2/2}.mainArea[_ngcontent-%COMP%]{grid-area:1/1/2/2;display:flex}app-view-furniture[_ngcontent-%COMP%]{width:95%}.furnitureCard[_ngcontent-%COMP%]{grid-area:1/1/2/2;width:100%;display:flex;flex-direction:column;align-items:center;z-index:1}.chooseAddProjectBtn[_ngcontent-%COMP%]{width:clamp(250px,35%,320px);padding:15px;background-color:#a3b18a;color:#dad7cd;border-radius:10px;border:none;cursor:pointer}.addModule[_ngcontent-%COMP%]{z-index:4;transition:all .5s ease-in-out;position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:#000000bf;display:flex;justify-content:center;align-items:center}.addModuleSpan[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:1fr}.addModuleFormContent[_ngcontent-%COMP%]{grid-area:1/1/2/2;width:25vw;border-radius:10px;background-color:#000;padding:30px 45px;display:flex;flex-direction:column;align-items:center;gap:15px;box-shadow:0 0 10px #fff}.addModuleTitle[_ngcontent-%COMP%]{color:#a3b18a;text-align:center}.closeAddModuleBtn[_ngcontent-%COMP%]{grid-area:1/1/2/2;background:none;border:none;z-index:3;width:30px;aspect-ratio:1;margin-right:10px;margin-top:10px;justify-self:end;cursor:pointer}.closeAddModuleBtn[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{transform:rotate(45deg)}.disabled[_ngcontent-%COMP%]{opacity:0;z-index:0}.addModuleFormContent[_ngcontent-%COMP%]{padding-top:20px}.addModuleFormContent[_ngcontent-%COMP%] > span[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:10px;color:#dad7cd;border-radius:10px;text-decoration:none;text-align:center}.addModuleFormContent[_ngcontent-%COMP%] > span[_ngcontent-%COMP%] > h3[_ngcontent-%COMP%]{background-color:#a3b18a;width:calc(100% - 20px);margin-bottom:0;cursor:default}.addModuleFormContent[_ngcontent-%COMP%] > span[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{background-color:#344e41;width:calc(80% - 20px);align-self:end;margin-top:5px}.addModuleFormContent[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;max-height:400px;overflow-y:scroll;padding-right:10px}.noProjectsBtn[_ngcontent-%COMP%]{color:#dad7cd;text-align:center;width:50%;padding:15px 10px;background-color:#344e41;border-radius:10px;text-decoration:none;transition:background-color .3s ease-in-out}.noProjectsBtn[_ngcontent-%COMP%]:hover{background-color:#a3b18a}.rangeInputsSpan[_ngcontent-%COMP%]{width:100%;display:flex;gap:5px;flex-direction:row;color:#fff;align-items:center}.rangeInputsSpan[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{width:10px;height:2px;background-color:#fff;border:none}.rangeInputsSpan[_ngcontent-%COMP%]   .rangeInput[_ngcontent-%COMP%]{width:45%;border-radius:10px;padding:10px;border:2px solid #A3B18A;outline:none;background-color:#fff}.useFiltersBtn[_ngcontent-%COMP%]{width:100%;height:50px;border-radius:10px;border:none;background-color:#344e41;color:#fff;cursor:pointer;transition:transform .2s ease-in-out}.useFiltersBtn[_ngcontent-%COMP%]:hover{transform:translateY(-3px)}.categoryFilters[_ngcontent-%COMP%]{max-height:300px;overflow-y:scroll;width:100%;display:flex;flex-direction:column;gap:10px;padding-right:5px}.categoryFilter[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px;width:100%}.noItemsMsgSpan[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;height:fit-content;align-self:center;align-items:center}.noItemsMsgSpan[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#dad7cd;font-size:30px}.noItemsMsgSpan[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px}.selectFilterOptionsSpan[_ngcontent-%COMP%]{display:flex;width:100%;gap:5px;flex-wrap:wrap}.selectFilterOptionsSpan[_ngcontent-%COMP%]   .selectFilterOption[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px;width:fit-content;padding:10px;border-radius:50px;border:none;outline:none;background-color:#dad7cd;cursor:pointer;transition:transform .2s ease-in-out}.selectFilterOptionsSpan[_ngcontent-%COMP%]   .selectFilterOption[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.selectFilterOptionsSpan[_ngcontent-%COMP%]   .selectFilterOption[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:17px;aspect-ratio:1}.selectFilterOptionsSpan[_ngcontent-%COMP%]   .selectFilterOption[_ngcontent-%COMP%]:hover{transform:translateY(-3px)}.colorsChooseSpan[_ngcontent-%COMP%]{display:flex;width:100%;flex-wrap:wrap;gap:5px}.colorsChooseSpan[_ngcontent-%COMP%]   .colorItem[_ngcontent-%COMP%]{width:35px;aspect-ratio:1;outline:none;border:none;display:flex;align-items:center;justify-content:center;border-radius:50%;cursor:pointer;box-shadow:0 0 1px #fff;transition:transform .2s ease-in-out}.colorsChooseSpan[_ngcontent-%COMP%]   .colorItem[_ngcontent-%COMP%]:hover{transform:translateY(-3px)}.colorsChooseSpan[_ngcontent-%COMP%]   .colorItem[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:15px;aspect-ratio:1}@media (max-width: 768px){.category[_ngcontent-%COMP%], .params[_ngcontent-%COMP%], .furnitureCategoriesButtonsSpan[_ngcontent-%COMP%]{width:100%}.furnitureCategoriesButtonsSpan[_ngcontent-%COMP%]{flex-direction:row;flex-wrap:wrap}.furnitureCategoryButton[_ngcontent-%COMP%]{width:calc(20% - 5px)}.mainArea[_ngcontent-%COMP%]{flex-direction:column}.furnitureItem[_ngcontent-%COMP%]{flex:auto;width:100%;max-width:none}}@media (max-width: 600px){.category[_ngcontent-%COMP%]{max-height:50vh;margin-top:15px}.furnitureCategoryButton[_ngcontent-%COMP%]{width:calc(25% - 5px)}.chooseAddProjectBtn[_ngcontent-%COMP%]{width:calc(100% - 20px);max-width:400px}}@media (max-width: 500px){.furnitureCategoryButton[_ngcontent-%COMP%]{width:calc(33% - 5px)}.furnitureCategoriesButtonsSpan[_ngcontent-%COMP%]{max-height:250px}}@media (max-width: 370px){.furnitureCategoryButton[_ngcontent-%COMP%]{width:calc(50% - 5px)}}']})}return n})();const $Ce=[{component:Qxe,path:""},{component:aMe,path:"account"},{component:IMe,path:"login"},{component:fA,path:"plan"},{component:fA,path:"plan/:planId"},{component:fA,path:"plan/:planId/:roomId"},{component:fA,path:"plan/:planId/:roomId/:furnitureCardId"},{component:HMe,path:"create/:id"},{component:B2,path:"shop",data:{pageName:"shop"}},{component:B2,path:"shop/:category",data:{pageName:"shop"}},{component:B2,path:"shop/:category/:furnitureCardId",data:{pageName:"shop"}},{path:"**",redirectTo:"",pathMatch:"full"}],KCe=[{provide:v3,useFactory:()=>new pG},{provide:Ov,useFactory:()=>"BrowserAnimations"},...[{provide:b3,useFactory:function XCe(){return new K8}},{provide:y_,useClass:(()=>{class n extends y_{constructor(t,i,r){super(t,i,r)}ngOnDestroy(){this.flush()}static \u0275fac=function(i){return new(i||n)(Ze(fr),Ze(v3),Ze(b3))};static \u0275prov=Ve({token:n,factory:n.\u0275fac})}return n})()},{provide:bS,useFactory:function YCe(n,e,t){return new Ece(n,e,t)},deps:[U4,y_,Hn]}]],QCe=(n,e)=>({appearBody:n,disappearBody:e});function eSe(n,e){1&n&&Te(0,"img",6)}function tSe(n,e){if(1&n){const t=rn();L(0,"span",7)(1,"button",8),Oe("click",function(){return qe(t),He(me().reloadPage())}),Te(2,"img",9),k(),L(3,"button",8),Oe("click",function(){return qe(t),He(me().logout())}),Te(4,"img",10),k()()}}let $7=(()=>{class n{notificationService;cookieService;constructor(t,i){this.notificationService=t,this.cookieService=i}errorMessage;successMessage;ngOnInit(){this.notificationService.error$.subscribe(t=>{this.errorMessage=t}),this.notificationService.success$.subscribe(t=>{this.successMessage=t})}reloadPage(){window.location.reload()}logout(){this.cookieService.deleteJwt(),this.cookieService.deleteAccountType(),this.reloadPage()}static \u0275fac=function(i){return new(i||n)(se(kl),se(ju))};static \u0275cmp=mo({type:n,selectors:[["app-notification"]],decls:8,vars:11,consts:[[1,"body",3,"ngClass"],["loading","lazy","style","width: 30px; height: 30px","src","/assets/images/successIcon.svg","alt","",4,"ngIf"],[1,"textSpan"],[1,"title"],[1,"errorMessage"],["class","btnsSpan",4,"ngIf"],["loading","lazy","src","/assets/images/successIcon.svg","alt","",2,"width","30px","height","30px"],[1,"btnsSpan"],[1,"solutionBtn",3,"click"],["loading","lazy","src","/assets/images/reloadIcon.svg","alt",""],["loading","lazy","src","/assets/images/logoutIcon.svg","alt",""]],template:function(i,r){1&i&&(L(0,"span",0),ze(1,eSe,1,0,"img",1),L(2,"span",2)(3,"h2",3),re(4),k(),L(5,"h3",4),re(6),k()(),ze(7,tSe,5,0,"span",5),k()),2&i&&(ee("ngClass",_4(8,QCe,r.errorMessage||r.successMessage,!r.errorMessage&&!r.successMessage)),$s("tab-index",r.errorMessage||r.successMessage?1:-1),q(),ee("ngIf",!r.errorMessage),q(3),Ei(r.errorMessage?"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a":"\u0423\u0441\u043f\u0435\u0448\u043d\u043e"),q(),oo("color",r.errorMessage?"red":"green"),q(),Ei(r.errorMessage||r.successMessage),q(),ee("ngIf",r.errorMessage))},dependencies:[sg,Cs],styles:['@font-face{font-family:Calypso;src:url(/assets/fonts/Calypso.ttf) format("truetype");font-weight:400}@font-face{font-family:Courier New;src:url(/assets/fonts/Courier\\ New.ttf) format("truetype");font-weight:400}*[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}html[_ngcontent-%COMP%]{scroll-behavior:smooth}img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.body[_ngcontent-%COMP%]{border-radius:10px;border:1px solid rgba(163,177,138,.3);background-color:#000;width:350px;display:flex;flex-direction:row;padding:0 10px;justify-content:space-around;align-items:center;position:fixed;bottom:-100px;opacity:0;left:50%;transform:translate(-50%);transition:all .5s ease-in-out;z-index:10}.appearBody[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_appearHandler .5s forwards}.disappearBody[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_disappearHandler .5s forwards;z-index:-10}.textSpan[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px;padding:10px 0;font-size:105%;width:60%;justify-content:center}.title[_ngcontent-%COMP%]{color:#fff;margin:0;font-size:17px}.errorMessage[_ngcontent-%COMP%]{margin:0;width:100%;font-weight:400;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.solutionBtn[_ngcontent-%COMP%]{width:100%;height:100%;background:none;margin:0;border:none;cursor:pointer}.solutionBtn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:30px}.btnsSpan[_ngcontent-%COMP%]{display:flex;justify-self:flex-end;width:26%}@keyframes _ngcontent-%COMP%_appearHandler{0%{opacity:0;bottom:-100px}to{opacity:1;bottom:50px}}@keyframes _ngcontent-%COMP%_disappearHandler{0%{opacity:1;bottom:50px}to{opacity:0;bottom:-100px}}']})}return n})();function nSe(n,e){if(1&n){const t=rn();L(0,"div",2),Oe("mouseenter",function(){const r=qe(t).$implicit;return He(me().onMouseEnter(r.id))})("mouseleave",function(){const r=qe(t).$implicit;return He(me().onMouseLeave(r.id))}),L(1,"div",3)(2,"div",4),re(3),k(),L(4,"div",5),re(5),k()(),L(6,"div",6),function cp(){Qt.lFrame.currentNamespace="svg"}(),L(7,"svg",7),Te(8,"circle",8)(9,"circle",9),k(),function lv(){!function CM(){Qt.lFrame.currentNamespace=null}()}(),L(10,"button",10),Oe("click",function(){const r=qe(t).$implicit,o=me();return He("uploading"===r.status?o.cancelUpload(r.id):o.removeFromQueue(r.id))}),Te(11,"img",11),k()()()}if(2&n){const t=e.$implicit,i=me();oo("display",i.checkDesktop()||"success"!==t.status?"flex":"none"),q(3),Ei(t.name),q(2),Ei(t.status),q(4),oo("stroke","error"===t.status?"red":"#344E41"),$s("stroke-dasharray",i.circumference)("stroke-dashoffset",i.calculatePercentage(t.progress)),q(),oo("opacity",i.checkDesktop()?0:1),ee("title","uploading"===t.status?"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0443":"\u0423\u0431\u0440\u0430\u0442\u044c \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430")}}let iSe=(()=>{class n{uploadService;constructor(t){this.uploadService=t}circumference=2*Math.PI*18;checkDesktop=cA;displayUploads=[];hoverMap=new Map;ngOnInit(){this.uploadService.uploads$.subscribe(t=>{this.displayUploads=t.map(i=>this.isHovered(i.id)?this.displayUploads.find(o=>o.id===i.id)??i:i)})}calculatePercentage(t){return this.circumference-t/100*this.circumference}cancelUpload(t){this.uploadService.cancelUpload(t),this.uploadService.removeFileFromQueue(t)}removeFromQueue(t){this.uploadService.removeFileFromQueue(t)}onMouseEnter(t){this.hoverMap.set(t,!0)}onMouseLeave(t){this.hoverMap.set(t,!1)}isHovered(t){return this.hoverMap.get(t)||!1}static \u0275fac=function(i){return new(i||n)(se(y7))};static \u0275cmp=mo({type:n,selectors:[["app-upload-overlay"]],decls:2,vars:1,consts:[[1,"upload-overlay"],["class","upload-item",3,"display","mouseenter","mouseleave",4,"ngFor","ngForOf"],[1,"upload-item",3,"mouseenter","mouseleave"],[1,"file-info"],[1,"file-name"],[1,"file-status"],[1,"progress-wrapper"],["width","40","height","40","viewBox","0 0 40 40",1,"progress-circle"],["cx","20","cy","20","r","18","stroke-width","4","fill","none",1,"progress-bg"],["cx","20","cy","20","r","18","stroke-width","4","fill","none",1,"progress-bar"],[1,"cancel-btn",3,"click","title"],["src","/assets/images/addIcon.svg","alt","Cancel"]],template:function(i,r){1&i&&(L(0,"span",0),ze(1,nSe,12,11,"div",1),k()),2&i&&(q(),ee("ngForOf",r.displayUploads))},dependencies:[Au],styles:['@font-face{font-family:Calypso;src:url(/assets/fonts/Calypso.ttf) format("truetype");font-weight:400}@font-face{font-family:Courier New;src:url(/assets/fonts/Courier\\ New.ttf) format("truetype");font-weight:400}*[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}html[_ngcontent-%COMP%]{scroll-behavior:smooth}img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.upload-overlay[_ngcontent-%COMP%]{position:fixed;bottom:1rem;right:1rem;width:250px;z-index:9999;font-size:14px;display:flex;flex-direction:column;gap:5px}@media (max-width: 500px){.upload-overlay[_ngcontent-%COMP%]{right:calc(50% - 125px);left:calc(50% - 125px)}}.upload-item[_ngcontent-%COMP%]{margin-bottom:.5rem;border:2px solid #A3B18A;padding:1rem;border-radius:10px;background:#000;display:flex;justify-content:space-between;align-items:center;gap:1rem}.file-info[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column;max-width:65%}.file-info[_ngcontent-%COMP%]   .file-name[_ngcontent-%COMP%]{font-weight:700;color:#fff;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.file-info[_ngcontent-%COMP%]   .file-status[_ngcontent-%COMP%]{color:#a3b18a;font-size:12px}.progress-wrapper[_ngcontent-%COMP%]{position:relative;width:40px;height:40px}.progress-wrapper[_ngcontent-%COMP%]   svg.progress-circle[_ngcontent-%COMP%]{transform:rotate(-90deg);width:40px;height:40px;border-radius:50%}.progress-wrapper[_ngcontent-%COMP%]   svg.progress-circle[_ngcontent-%COMP%]   .progress-bg[_ngcontent-%COMP%]{stroke:#dad7cd}.progress-wrapper[_ngcontent-%COMP%]   svg.progress-circle[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{stroke:#344e41;box-shadow:0 0 5px #344e41;transition:stroke-dashoffset .3s ease-in-out;stroke-linecap:round}.progress-wrapper[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:28px;height:28px;padding:0;border:none;background:transparent;cursor:pointer;transform:translate(-50%,-50%);opacity:0;transition:opacity .3s ease}.progress-wrapper[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50%;height:50%;object-fit:contain;box-sizing:border-box;margin-bottom:-3px;rotate:45deg}.progress-wrapper[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]:hover{opacity:1!important}']})}return n})(),q7=(()=>{class n{title="HouseQuality";static \u0275fac=function(i){return new(i||n)};static \u0275cmp=mo({type:n,selectors:[["app-root"]],features:[Cn([Sj,$7,Vx,A2,ju,Ux,S2,uA,v7,Dw,C2,j7,E2,Location])],decls:3,vars:0,template:function(i,r){1&i&&Te(0,"router-outlet")(1,"app-notification")(2,"app-upload-overlay")},dependencies:[MP,$7,iSe],encapsulation:2})}return n})(),rSe=(()=>{class n{notification;constructor(t){this.notification=t}intercept(t,i){return i.handle(t).pipe(Kp(r=>(this.notification.setError(r.error.message,5e3),$b(()=>r))))}static \u0275fac=function(i){return new(i||n)(Ze(kl))};static \u0275prov=Ve({token:n,factory:n.\u0275fac})}return n})();const X7={providers:[function Fse(n,...e){return bl([{provide:PP,multi:!0,useValue:n},[],{provide:Eu,useFactory:z5,deps:[Ea]},{provide:j0,multi:!0,useFactory:G5},e.map(t=>t.\u0275providers)])}($Ce),function Cre(...n){const e=[],t=new Set;for(const{\u0275providers:r,\u0275kind:o}of n)t.add(o),r.length&&e.push(r);const i=t.has(dh.HttpTransferCacheOptions);return bl([[],pte(),t.has(dh.NoHttpTransferCache)||i?[]:vre({}),e])}(),function JCe(){return $o("NgEagerAnimations"),[...KCe]}(),function nre(...n){const e=[Mu,jz,zz,{provide:tE,useExisting:zz},{provide:nE,useFactory:()=>j(kz,{optional:!0})??j(jz)},{provide:Jb,useValue:tre,multi:!0},{provide:aP,useValue:!0},{provide:qz,useClass:ere}];for(const t of n)e.push(...t.\u0275providers);return bl(e)}(function ire(){return function eg(n,e){return{\u0275kind:n,\u0275providers:e}}(ch.LegacyInterceptors,[{provide:Xz,useFactory:Wie},{provide:Jb,useExisting:Xz,multi:!0}])}()),function Dne(){return Ane}(),{provide:Uz,useClass:rSe,multi:!0}]};ez(q7,X7).catch(n=>console.error(n)),ez(q7,X7).then(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/model-scw.js",{scope:"/"}).then(n=>{}).catch(n=>{})}).catch(n=>console.error(n))},886:(zt,Bn,je)=>{var lt=je(991),N="object"==typeof self&&self&&self.Object===Object&&self,dn=lt||N||Function("return this")();zt.exports=dn},901:zt=>{var je=Object.prototype.toString;zt.exports=function lt(N){return je.call(N)}},906:zt=>{zt.exports=function(){var je={},lt=je._fns={};return je.emit=function(dt,Ut,Ct,et,Un,wn,ui){var gr=function N(Mt){for(var dt=lt[Mt]?lt[Mt]:[],Ut=Mt.indexOf(":"),Ct=-1===Ut?[Mt]:[Mt.substring(0,Ut),Mt.substring(Ut+1)],et=Object.keys(lt),Un=0,wn=et.length;Un<wn;Un++){var ui=et[Un];if("*"===ui&&(dt=dt.concat(lt[ui])),2===Ct.length&&Ct[0]===ui){dt=dt.concat(lt[ui]);break}}return dt}(dt);gr.length&&function dn(Mt,dt,Ut){for(var Ct=0,et=dt.length;Ct<et&&dt[Ct];Ct++)dt[Ct].event=Mt,dt[Ct].apply(dt[Ct],Ut)}(dt,gr,[Ut,Ct,et,Un,wn,ui])},je.on=function(dt,Ut){lt[dt]||(lt[dt]=[]),lt[dt].push(Ut)},je.once=function(dt,Ut){this.on(dt,function Ct(){Ut.apply(this,arguments),je.off(dt,Ct)})},je.off=function(dt,Ut){var Ct=[];if(dt&&Ut)for(var et=this._fns[dt],Un=0,wn=et?et.length:0;Un<wn;Un++)et[Un]!==Ut&&Ct.push(et[Un]);Ct.length?this._fns[dt]=Ct:delete this._fns[dt]},je}},951:(zt,Bn,je)=>{var lt=je(886);zt.exports=function(){return lt.Date.now()}},982:(zt,Bn,je)=>{var lt=je(704),N=/[\/\+\.]/;zt.exports=function(dn,Mt){function dt(Ut){var Ct=lt(Ut,dn,N);return Ct&&Ct.length>=2}return Mt?dt(Mt.split(";")[0]):dt}},991:zt=>{var Bn="object"==typeof global&&global&&global.Object===Object&&global;zt.exports=Bn}},zt=>{zt(zt.s=878)}]);